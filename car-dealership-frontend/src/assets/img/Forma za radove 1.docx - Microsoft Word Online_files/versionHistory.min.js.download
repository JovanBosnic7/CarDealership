var versionHistory=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[104],{1759:function(e,t,r){"use strict";r.r(t);var o=r(1),n=r(54),i=r(58),s=r(261),a=r(132),l=function(){function e(){}return e.FetchTelemetryChange="FetchTelemetryChange",e.DarkModeStyling="DarkModeStyling",e.DarkModeHeaderBackArrowColoring="DarkModeHeaderBackArrowColoring",e}(),c=function(){function e(){}return e.setDisabledChangeGates=function(t){t&&t.length>0?e.disabledChangeGates=t.toLowerCase().split(","):e.disabledChangeGates=[]},e.getDisabledChangeGates=function(){return e.disabledChangeGates.toString()},e.isChangeGateEnabled=function(t){return!(t.length<1)&&(e.disabledChangeGates.length<1||e.disabledChangeGates.indexOf(t.toLowerCase())<0)},e.isVHDarkModeSupported=function(){return this.isChangeGateEnabled(l.DarkModeStyling)&&Object(a.a)()},e.disabledChangeGates=[],e}(),d=function(e,t,r,o){this.correlationId=e||"",this.errorType=t,this.status=r,this.statusText=o},p=function(){function e(e,t,r,o){this._theUri="",this._serviceBase="",this._docId="",this._retryCount=3,this._wdEnableDownloadTokens=!1,this._handlerName="versions.ashx",this._handlerQueryParam="DocID",this._appId=0,this._userSessionId="",this._wacCluster="",this._latestStreamServiceBase="",this._useXhr=!1,this._wdEnableDeleteVersions=!1,this._serviceBase=e,this._docId=t,this._wdEnableDownloadTokens=!!r.wdEnableDownloadTokens&&r.wdEnableDownloadTokens,this._retryCount=r.retryCount?r.retryCount:3,this._appId=r.appName?r.appName:0,this._userSessionId=r.userSessionId?r.userSessionId:"",this._wacCluster=r.wacCluster?r.wacCluster:"",this._latestStreamServiceBase=o||"",this._useXhr=!!r.useXhr&&r.useXhr,this._wdEnableDeleteVersions=!!r.wdEnableDeleteVersions&&r.wdEnableDeleteVersions,this.buildVersionHistoryRequestUri()}return e.prototype.versionInfoFromTipVersion=function(e){try{if(!e)return;if(!e.data)return{data:null,errorCode:e.errorCode,message:e.message,isDirty:!1};var t={};return e.data.downloadUrl?(t.DownloadUrl=e.data.downloadUrl,{correlationID:e.correlationID,data:t,isDirty:"true"===e.data.isDirty}):(t.DownloadUrl=null,{data:t,errorCode:e.errorCode,message:"null download url",isDirty:!1})}catch(t){var r="versionInfoFromTipVersion exception: "+t.message;return n.a.sendTraceTag(579342617,i.a.msoulscat_Wac_VersionHistory,s.a.Error,r),{data:e.data,errorCode:138,message:r,isDirty:!1}}},e.prototype.getAppIdHeader=function(e){switch(e){case 120:return"Excel";case 100:return"PPT";case 110:return"Word"}return"None"},e.prototype.requestTipVersionAsync=function(){return Object(o.b)(this,void 0,void 0,(function(){var e,t,r,a,l;return Object(o.e)(this,(function(o){switch(o.label){case 0:e={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster}},t="&waccluster="+this._wacCluster,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchRetry(this._latestStreamServiceBase+t,e,this._retryCount)];case 2:return r=o.sent(),[2,this.versionInfoFromTipVersion(r)];case 3:return a=o.sent(),l="requestTipVersionAsync fetchRetry exception: "+a.message,n.a.sendTraceTag(591934727,i.a.msoulscat_Wac_VersionHistory,s.a.Error,l),[2,{errorCode:128,message:l,isDirty:!1}];case 4:return[2]}}))}))},e.prototype.requestTipVersion=function(){return this.requestTipVersionAsync()},e.prototype.requestVersionHistory=function(){var e={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"}},t="&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(e.method,this._theUri+t,e.headers,null,this._retryCount):this.fetchRetry(this._theUri+t,e,this._retryCount)},e.prototype.requestDownloadToken=function(e,t){var r={method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"},body:JSON.stringify({RevisionIDs:e,OptionalIDs:t})},o="&action=GetDownloadToken&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(r.method,this._theUri+o,r.headers,r.body,this._retryCount):this.fetchRetry(this._theUri+o,r,this._retryCount)},e.prototype.requestDeleteVersions=function(e){if(!e||0===e.length||e.includes(void 0)){return Promise.resolve({errorCode:135,message:"requestDeleteVersions: revisionIDs list is null."})}var t={method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"},body:JSON.stringify({RevisionIDs:e})},r="&action=DeleteVersions&wdEnableDeleteVersions="+this._wdEnableDeleteVersions.toString();return this._useXhr?this.xhrRetry(t.method,this._theUri+r,t.headers,t.body,1):this.fetchRetry(this._theUri+r,t,1)},e.prototype.buildVersionHistoryRequestUri=function(){this._serviceBase.indexOf(this._handlerName)<0?this._theUri=this._serviceBase+this._handlerName+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId):this._theUri=this._serviceBase+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId)},e.prototype.xhrRetry=function(t,r,a,p,u){return Object(o.b)(this,void 0,void 0,(function(){var h,g,f,m,v,b,S,C,y;return Object(o.e)(this,(function(o){switch(o.label){case 0:g=!1,f="",m=1,v=0,b=0,S=0,o.label=1;case 1:if(!(S<u))return[3,7];c.isChangeGateEnabled(l.FetchTelemetryChange)&&(b+=1),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.xhr(t,r,a,p)];case 3:return(h=o.sent())?(g=!1,m=0):(g=!0,m=133,f=c.isChangeGateEnabled(l.FetchTelemetryChange)?"VersionHistoryRequestManager::xhrRetry: unexpected null response from xhr, tryNumber: "+b+" of "+u:"xhrRetry: unexpected null response from xhr.",n.a.sendTraceTag(591934728,i.a.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(l.FetchTelemetryChange)?s.a.Warning:s.a.Error,f)),[3,5];case 4:return C=o.sent(),f=c.isChangeGateEnabled(l.FetchTelemetryChange)?"VersionHistoryRequestManager::xhrRetry xhr exception: ":"xhrRetry xhr exception: ",C instanceof d?(g=e.isRetriableError(C.errorType),m=C.errorType,f+=C.statusText,v=C.status):(g=!0,m=132,f+=C.message),c.isChangeGateEnabled(l.FetchTelemetryChange)&&(f+=", tryNumber: "+b+" of "+u+", isRetriableError: "+g),n.a.sendTraceTag(591934729,i.a.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(l.FetchTelemetryChange)?s.a.Warning:s.a.Error,f),[3,5];case 5:if(!g)return[3,7];o.label=6;case 6:return S+=1,[3,1];case 7:return c.isChangeGateEnabled(l.FetchTelemetryChange)&&(y=!h||0!==m,n.a.sendTraceTag(574128981,i.a.msoulscat_Wac_VersionHistory,y?s.a.Error:s.a.Info,"VersionHistoryRequestManager::xhrRetry exiting loop; tryNumber: "+b+" of "+u+", isError: "+y)),h?0!==m?[2,{errorCode:m,responseStatusCode:v,message:f,correlationId:h.headers.get("X-CorrelationId")}]:[2,h]:[2,{errorCode:m,message:f}]}}))}))},e.prototype.xhr=function(t,r,o,n){var i=this;return new Promise((function(s,a){var l=new XMLHttpRequest;l.open(t,r,!0),l.onload=function(){if(200===this.status)try{var t=JSON.parse(l.response);s({errorCode:0,data:t,correlationId:this.getResponseHeader("X-CorrelationId")})}catch(e){a(new d(this.getResponseHeader("X-CorrelationId"),131,this.status,"xhr: exception, statusText: "+this.statusText+", error: "+e.message))}else{var r=this.getResponseHeader("X-ErrorCode");a(new d(this.getResponseHeader("X-CorrelationId"),e.parseResponseError(this.status,null!=r?r:""),this.status,"xhr: failed, statusText: "+this.statusText+", X-ErrorCode: "+r))}},l.onerror=function(){var t=this.getResponseHeader("X-ErrorCode");a(new d(this.getResponseHeader("X-CorrelationId"),e.parseResponseError(this.status,null!=t?t:""),this.status,"xhr: onerror, statusText: "+this.statusText+", X-ErrorCode: "+t))},i.addXhrHeaders(o,l),l.send(n)}))},e.prototype.addXhrHeaders=function(e,t){if(e)for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])},e.prototype.fetchRetry=function(t,r,a){return Object(o.b)(this,void 0,void 0,(function(){var d,p,u,h,g,f,m,v,b;return Object(o.e)(this,(function(o){switch(o.label){case 0:d=null,p=1,u="",h=!1,g=0,f=0,o.label=1;case 1:if(!(f<a))return[3,7];c.isChangeGateEnabled(l.FetchTelemetryChange)&&(g+=1),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,fetch(t,r)];case 3:return(d=o.sent())?d.ok?h=!1:(h=e.isRetriableError(this.parseServerError(d)),u=c.isChangeGateEnabled(l.FetchTelemetryChange)?"VersionHistoryRequestManager::fetchRetry status: "+d.status+", statusText: "+d.statusText+", errorCode: "+e.getResponseErrorCode(d)+", correlationId: "+d.headers.get("X-CorrelationId")+", tryNumber: "+g+" of "+a+", isRetriableError: "+h:"fetchRetry status: "+d.status+", statusText: "+d.statusText+", errorCode: "+e.getResponseErrorCode(d)+", correlationId: "+d.headers.get("X-CorrelationId"),n.a.sendTraceTag(591934731,i.a.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(l.FetchTelemetryChange)?s.a.Warning:s.a.Error,u)):(h=!0,p=124,u=c.isChangeGateEnabled(l.FetchTelemetryChange)?"VersionHistoryRequestManager::fetchRetry: unexpected null response from fetch, tryNumber: "+g+" of "+a:"fetchRetry: unexpected null response from fetch.",n.a.sendTraceTag(591934730,i.a.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(l.FetchTelemetryChange)?s.a.Warning:s.a.Error,u)),[3,5];case 4:return m=o.sent(),h=!0,p=107,u=c.isChangeGateEnabled(l.FetchTelemetryChange)?"VersionHistoryRequestManager::fetchRetry fetch exception: "+m.message+"}, tryNumber: "+g+" of "+a:"fetchRetry fetch exception: "+m.message,n.a.sendTraceTag(591934732,i.a.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(l.FetchTelemetryChange)?s.a.Warning:s.a.Error,u),[3,5];case 5:if(!h)return[3,7];o.label=6;case 6:return f+=1,[3,1];case 7:if(c.isChangeGateEnabled(l.FetchTelemetryChange)&&(v=!d||1!==p,n.a.sendTraceTag(574128982,i.a.msoulscat_Wac_VersionHistory,v?s.a.Error:s.a.Info,"VersionHistoryRequestManager::fetchRetry exiting loop; tryNumber: "+g+" of "+a+", isError: "+v)),!d)return[2,{errorCode:p,message:u}];if(!d.ok)return[2,{errorCode:this.parseServerError(d),responseStatusCode:d.status,message:u,correlationId:d.headers.get("X-CorrelationId")}];o.label=8;case 8:return o.trys.push([8,10,,11]),[4,d.json()];case 9:return[2,{errorCode:0,data:o.sent(),correlationId:d.headers.get("X-CorrelationId")}];case 10:return b=o.sent(),u="fetchRetry response.json exception: "+b.message+", status: "+d.status+", statusText: "+d.statusText,n.a.sendTraceTag(591934733,i.a.msoulscat_Wac_VersionHistory,s.a.Error,u),[2,{errorCode:102,responseStatusCode:d.status,message:u,correlationId:d.headers.get("X-CorrelationId")}];case 11:return[2]}}))}))},e.prototype.parseServerError=function(t){var r;return e.parseResponseError(t.status,null!==(r=t.headers.get("X-ErrorCode"))&&void 0!==r?r:"")},e.parseResponseError=function(e,t){var r;switch(e){case 503:r=108;break;case 502:r=109;break;case 401:r=110;break;case 410:r=134}switch(t){case"VersioningNotEnabled":r=104;break;case"FileNotFound":r=105;break;case"VersionTooOld":r=106;break;case"FileNotFound":r=105;break;case"ServiceUnavailable":r=108;break;case"BadGateway":r=109;break;case"Unauthorized":r=110;break;case"InternalServerError":r=111;break;case"EmptyVersionMetadatas":r=112;break;case"FailedHostDownload":r=113;break;case"FailedToAddDownloadToVersionStore":r=114;break;case"FailedToCacheParts":r=115;break;case"FailedToDownloadVersionMetadata":r=116;break;case"FailedToDownloadParts":r=117;break;case"InvalidDocID":r=118;break;case"MissingDocID":r=119;break;case"NullDocID":r=120;break;case"NullHashedDocID":r=121;break;case"NullGetDownloadAccessTokenRequest":r=122;break;case"FailedToDownloadVersionFromHost":r=123;break;default:r=1}return r},e.getResponseErrorCode=function(t){var r,o;return null!==(o=null!==(r=e.getResponseStatusError(t.status))&&void 0!==r?r:t.headers.get("X-ErrorCode"))&&void 0!==o?o:""},e.getResponseStatusError=function(e){switch(e){case 503:return"ServiceUnavailable";case 502:return"BadGateway";case 401:return"Unauthorized";case 410:return"Gone"}return null},e.isRetriableError=function(e){switch(e){case 104:case 105:case 134:case 106:case 118:case 119:case 120:case 121:case 121:return!1}return!0},e}(),u=["#0078d4","#4f6bed","#e3008c","#004e8c","#005b70","#750b1c","#0b6a0b","#8764b8","#a4262c","#038387","#c239b3","#d13438","#498205","#5c2e91","#ca5010","#986f0b","#881798","#8e562e"],h=function(){function e(){}return e.getInitialsColorFromName=function(e){if(!e)return this.getColorByIndex(0);for(var t=0;t<this.nameColorMap.length;t+=1){var r=this.nameColorMap[t];if(r.name===e)return this.getColorByIndex(r.colorIndex)}var o={name:e,colorIndex:this.getNextColorIndex()};return this.nameColorMap.push(o),this.getColorByIndex(o.colorIndex)},e.getNextColorIndex=function(){return this.currentColorIndex=(this.currentColorIndex+1)%u.length,this.currentColorIndex},e.getColorByIndex=function(e){return u[e%u.length]},e.currentColorIndex=0,e.nameColorMap=[],e}(),g=function(){function e(){}return Object.defineProperty(e,"UILocale",{get:function(){return null!=this.uiLocale&&""!==this.uiLocale?this.uiLocale:"en-us"},set:function(e){this.uiLocale=e},enumerable:!0,configurable:!0}),e.uiLocale="",e}();function f(e,t,r){return!(!e||null===t||null===r||e.length<=t||e.length<=r)&&(e.length-1!==t&&e.length-1!==r&&Intl.DateTimeFormat(g.UILocale,{month:"long",day:"numeric",year:"numeric"}).format(e[t].Time)===Intl.DateTimeFormat(g.UILocale,{month:"long",day:"numeric",year:"numeric"}).format(e[r].Time))}var m=function(){function e(e,t,r,o,n,i,s,a,l,c){this.Versions=[],this._isDisposed=!1,this._getCachedTokensCount=0,this._cachedTokensPrefetchCount=0,this._versionHistoryRequestManager=l||new p(n,i,s,a),this._versionHistoryReadyEvent=e,this._perfTelemetryInfos=c,this._downloadTokenReadyEvent=t,this._fullAppErrorEvent=r,this._tipVersionTokenReadyEvent=o}return e.prototype.getTipVersion=function(){return Object(o.b)(this,void 0,void 0,(function(){var t,r,a,l,c,d,p;return Object(o.e)(this,(function(o){switch(o.label){case 0:t=Date.now(),n.a.sendTraceTag(590144346,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,JSON.stringify({event:"getTipVersion: started",startTime:t})),null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionStart",TelemetryEventData:t.toString()}),r=Date.now(),a=0,this._tipVersionResponse=null,l=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._versionHistoryRequestManager.requestTipVersion()];case 2:return l=o.sent(),[3,4];case 3:return c=o.sent(),a=Date.now(),n.a.sendTraceTag(591934734,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getTipVersion:: requestTipVersion exception",error:c.message,startTime:t,duration:a-t,versionReqDuration:a-r})),[2,!1];case 4:return d=Date.now(),this._tipVersionResponse=l,null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionEnd",TelemetryEventData:Date.now().toString()}),l?l.data?l.data.DownloadUrl?(this.Versions&&this.Versions.length>0&&!this.Versions[0].DownloadUrl&&!l.isDirty?(n.a.sendTraceTag(595882755,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"Storing First Version Download Url, sending TipVersionTokenReadyEvent"),e.updateVersionInfo(this.Versions[0],l.data)):n.a.sendTraceTag(595882756,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"No Versions list, sending TipVersionTokenReadyEvent"),p=Date.now(),this.fireTipVersionTokenReadyEvent(l.data,l.correlationID),a=Date.now(),n.a.sendTraceTag(590144347,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,JSON.stringify({event:"getTipVersion: ended",error:"None",startTime:t,duration:a-t,versionReqDuration:d-r,eventFireDuration:a-p,versionCount:this.Versions.length})),[2,!0]):(n.a.sendTraceTag(591934737,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getTipVersion: !response.data.DownloadUrl",error:"null download url",startTime:t,duration:Date.now()-t,versionReqDuration:d-r})),[2,!1]):(n.a.sendTraceTag(591934736,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getTipVersion: !response.data",error:"errorCode: "+l.errorCode+", errorMessage: "+l.message,startTime:t,duration:Date.now()-t,versionReqDuration:d-r})),[2,!1]):(n.a.sendTraceTag(591934735,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getTipVersion: !response",error:"null response",startTime:t,duration:Date.now()-t,versionReqDuration:d-r})),[2,!1])}}))}))},e.prototype.getVersions=function(){return Object(o.b)(this,void 0,void 0,(function(){var t,r,a,l,c,d,p,u,h,g,f,m,v=this;return Object(o.e)(this,(function(o){switch(o.label){case 0:t=1,r=500,a=Date.now(),n.a.sendTraceTag(590144348,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,JSON.stringify({event:"getVersions: started",startTime:a})),null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListStart",TelemetryEventData:a.toString()}),l=Date.now(),c=0,d=0,p=null,u=3,h=0,o.label=1;case 1:if(!(h<u))return[3,7];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this._versionHistoryRequestManager.requestVersionHistory()];case 3:return p=o.sent(),[3,5];case 4:return g=o.sent(),c=Date.now(),this.fireFullAppErrorEvent(126),d=Date.now(),n.a.sendTraceTag(591934738,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getVersions: requestVersionHistory exception",error:g.message,startTime:a,duration:d-a,versionReqDuration:c-l,eventFireDuration:d-c})),[2,!1];case 5:if(!p||!p.data||p.data.Versions&&p.data.Versions[0])return[3,7];o.label=6;case 6:return h+=1,[3,1];case 7:return f=Date.now(),null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListEnd",TelemetryEventData:Date.now().toString()}),p?p.data?p.data.Versions?p.data.Versions[0]?this._isDisposed?(n.a.sendTraceTag(590127842,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getVersions: this._isDisposed",error:"this object is disposed",startTime:a,duration:Date.now()-a,versionReqDuration:f-l})),[2,!1]):(this.Versions=p.data.Versions?p.data.Versions.filter((function(e){return e.Time=new Date(e.Time.toString())})):[],this.Versions.sort((function(e,t){return e&&t&&e.Time&&t.Time?t.Time.getTime()-e.Time.getTime():0})),this.Versions.forEach((function(t){return e.updateAuthorColorInfo(t)})),this.Versions.length>0&&(this.Versions[0].RevisionID&&!this.Versions[0].DownloadUrl&&this._tipVersionResponse&&this._tipVersionResponse.data.DownloadUrl&&!this._tipVersionResponse.isDirty&&(n.a.sendTraceTag(595882271,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"Using stored tip version as first version downloadurl"),this.Versions[0].DownloadUrl=this._tipVersionResponse.data.DownloadUrl,this.Versions[0].WopiInfo=this._tipVersionResponse.data.WopiInfo),c=Date.now(),this._cachedTokensPrefetchCount<t&&(m=[],setTimeout((function(){v.getDownloadToken(m,void 0).then((function(){}),(function(){}))}),r),this._cachedTokensPrefetchCount+=1,n.a.sendTraceTag(574660755,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"getVersions: prefetching cached URLs after version list request complete")),this.fireVersionsReadyEvent(this.Versions,p.correlationID)),d=Date.now(),n.a.sendTraceTag(590144349,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,JSON.stringify({event:"getVersions: ended",error:"None",startTime:a,duration:d-a,versionReqDuration:f-l,eventFireDuration:d-c,versionCount:this.Versions.length})),[2,!0]):(c=Date.now(),this.fireFullAppErrorEventWithDefaultCode(p.errorCode),d=Date.now(),n.a.sendTraceTag(595682910,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getVersions: !response.data.Versions[0]",error:"null Versions[0]",startTime:a,duration:d-a,versionReqDuration:f-l,eventFireDuration:d-c})),[2,!1]):(c=Date.now(),this.fireFullAppErrorEventWithDefaultCode(p.errorCode),d=Date.now(),n.a.sendTraceTag(595682909,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getVersions: !response.data.Versions",error:"null Versions",startTime:a,duration:d-a,versionReqDuration:f-l,eventFireDuration:d-c})),[2,!1]):(c=Date.now(),this.fireFullAppErrorEventWithDefaultCode(p.errorCode),d=Date.now(),n.a.sendTraceTag(591934740,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getVersions: !response.data",error:"errorCode: "+p.errorCode+", errorMessage: "+p.message,startTime:a,duration:d-a,versionReqDuration:f-l,eventFireDuration:d-c})),[2,!1]):(c=Date.now(),this.fireFullAppErrorEvent(129),d=Date.now(),n.a.sendTraceTag(591934739,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getVersions: !response",error:"null response",startTime:a,duration:d-a,versionReqDuration:f-l,eventFireDuration:d-c})),[2,!1])}}))}))},e.prototype.getDownloadToken=function(t,r){return Object(o.b)(this,void 0,void 0,(function(){var a,l,c,d,p,u,h,g,f=this;return Object(o.e)(this,(function(o){switch(o.label){case 0:a=Date.now(),n.a.sendTraceTag(590144350,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,JSON.stringify({event:"getDownloadToken: started",startTime:a})),null!=this._perfTelemetryInfos&&t.length>0&&this._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenStart",TelemetryEventData:a.toString()}),l=this.getOrderedOptionalTokenList(t),c=Date.now(),d=0,p=0,u=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._versionHistoryRequestManager.requestDownloadToken(t,l)];case 2:return u=o.sent(),this._getCachedTokensCount+=1,[3,4];case 3:return h=o.sent(),d=Date.now(),this.fireFullAppErrorEvent(127),p=Date.now(),n.a.sendTraceTag(591934741,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getDownloadToken: requestDownloadToken exception",error:h.message,startTime:a,duration:p-a,versionReqDuration:d-c,eventFireDuration:p-d})),[2,!1];case 4:return g=Date.now(),null!=this._perfTelemetryInfos&&t.length>0&&this._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenEnd",TelemetryEventData:Date.now().toString()}),u?u.data?u.data.Versions&&u.data.Versions[0]?(r&&(r.correlationID=u.correlationID),this._isDisposed?(n.a.sendTraceTag(590127872,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getDownloadToken: this._isDisposed",error:"this object is disposed",startTime:a,duration:Date.now()-a,versionReqDuration:g-c})),[2,!1]):(u.data.Versions.forEach((function(t){if(t&&t.DownloadUrl){var o=f.Versions.filter((function(e){return e.RevisionID===t.RevisionID}));o[0]&&(o[0].DownloadUrl=t.DownloadUrl,null!==t.WopiInfo&&(o[0].WopiInfo=t.WopiInfo),r&&(r.baseVersion&&r.baseVersion.RevisionID===t.RevisionID?e.updateVersionInfo(r.baseVersion,t):r.currentVersion&&r.currentVersion.RevisionID===t.RevisionID&&e.updateVersionInfo(r.currentVersion,t)))}})),d=Date.now(),this.fireDownloadTokenReadyEvent(this.Versions,r),p=Date.now(),n.a.sendTraceTag(590144351,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,JSON.stringify({event:"getDownloadToken ended",error:"None",startTime:a,duration:p-a,versionReqDuration:g-c,eventFireDuration:p-d,versionCount:t.length})),[2,!0])):(u.data.Versions&&!u.data.Versions[0]&&0===t.length||(d=Date.now(),u&&u.errorCode?this.fireFullAppErrorEvent(u.errorCode):this.fireFullAppErrorEvent(101),p=Date.now(),u.data.Versions?n.a.sendTraceTag(590127843,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getDownloadToken: !response.data.Versions[0]",error:"null Versions[0]",startTime:a,duration:p-a,versionReqDuration:g-c,eventFireDuration:p-d})):n.a.sendTraceTag(595907533,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getDownloadToken: !response.data.Version",error:"null Versions",startTime:a,duration:p-a,versionReqDuration:g-c,eventFireDuration:p-d}))),[2,!1]):(d=Date.now(),this.fireFullAppErrorEventWithDefaultCode(u.errorCode),p=Date.now(),n.a.sendTraceTag(591934743,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getDownloadToken: !response.data",error:"errorCode: "+u.errorCode+", errorMessage: "+u.message,startTime:a,duration:p-a,versionReqDuration:g-c,eventFireDuration:p-d})),[2,!1]):(d=Date.now(),this.fireFullAppErrorEvent(130),p=Date.now(),n.a.sendTraceTag(591934742,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"getDownloadToken: !response",error:"null response",startTime:a,duration:p-a,versionReqDuration:g-c,eventFireDuration:p-d})),[2,!1])}}))}))},e.prototype.getOrderedOptionalTokenList=function(e){var t,r=this,o=[];t=e.length>0?e[0]:"-1";var n=[],i=[],s=!1,a=-1,l=[];this.Versions.forEach((function(e,o){e.RevisionID===t?(s=!0,a=o):o>0&&!e.DownloadUrl&&!f(r.Versions,o,o-1)&&(s?n.push(e.RevisionID):i.unshift(e.RevisionID)),r._getCachedTokensCount<2&&l.length<15&&!e.DownloadUrl&&o!==a&&l.push(e.RevisionID)}));for(var c=0;c<1;c+=1){n.length>c&&!o.includes(n[c])&&o.push(n[c]),i.length>c&&!o.includes(i[c])&&o.push(i[c]);var d=a-1-c,p=a+1+c;d>=0&&!o.includes(this.Versions[d].RevisionID)&&!this.Versions[d].DownloadUrl&&o.push(this.Versions[d].RevisionID),a>=0&&p<this.Versions.length&&!o.includes(this.Versions[p].RevisionID)&&!this.Versions[p].DownloadUrl&&o.push(this.Versions[p].RevisionID)}return l.forEach((function(e){o.includes(e)||o.push(e)})),o},e.prototype.dispose=function(){this._isDisposed=!0,this.Versions=[]},e.prototype.deleteVersions=function(e){return Object(o.b)(this,void 0,void 0,(function(){var t,r,a,l;return Object(o.e)(this,(function(o){switch(o.label){case 0:null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"DeleteVersionsStart",TelemetryEventData:Date.now().toString()}),r=[],o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._versionHistoryRequestManager.requestDeleteVersions(e)];case 2:return t=o.sent(),[3,4];case 3:return a=o.sent(),n.a.sendTraceTag(589312513,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"deleteVersions requestDeleteVersions exception: "+a.message),this.fireFullAppErrorEvent(136),[2,null];case 4:return null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"DeleteVersionsEnd",TelemetryEventData:Date.now().toString()}),t?t.data?t.data.Versions?(t.data.Versions.forEach((function(e){return(null==e?void 0:e.RevisionID)?r.push(e.RevisionID):void 0})),l=e.filter((function(e){return!r.includes(e)})),this.Versions=this.Versions.filter((function(e){return!e.RevisionID||!l.includes(e.RevisionID)})),[2,r]):(n.a.sendTraceTag(589312516,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"deleteVersions failed: !response.data.Versions"),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,null]):(n.a.sendTraceTag(589312515,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"deleteVersions: null response.data, errorCode: "+t.errorCode+", errorMessage: "+t.message),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,null]):(n.a.sendTraceTag(589312514,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"deleteVersions: unexpected null response."),this.fireFullAppErrorEvent(137),[2,null])}}))}))},e.prototype.fireTipVersionTokenReadyEvent=function(e,t){if(!this._isDisposed){var r={tipVersion:e,updatedVersions:this.Versions,containerDiv:document.getElementById("vhViewer"),correlationID:t};n.a.sendTraceTag(595882757,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"fireTipVersionTokenReadyEvent"),this._tipVersionTokenReadyEvent.fireEvent(r)}},e.prototype.fireVersionsReadyEvent=function(e,t){if(!this._isDisposed){var r={versions:e,containerDiv:document.getElementById("vhViewer"),correlationID:t};n.a.sendTraceTag(595914892,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"fireVersionsReadyEvent"),this._versionHistoryReadyEvent.fireEvent(r)}},e.prototype.fireDownloadTokenReadyEvent=function(e,t){if(!this._isDisposed){var r={updatedVersions:e,versionSelected:t};n.a.sendTraceTag(595907532,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"fireDownloadTokenReadyEvent"),this._downloadTokenReadyEvent.fireEvent(r)}},e.prototype.fireFullAppErrorEventWithDefaultCode=function(e){e?this.fireFullAppErrorEvent(e):(this.fireFullAppErrorEvent(100),n.a.sendTraceTag(577380355,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"VHFailedToLoadVersionList"))},e.prototype.fireFullAppErrorEvent=function(e){this._isDisposed||(n.a.sendTraceTag(595906849,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"fireFullAppErrorEvent, error code: "+e),this._fullAppErrorEvent.fireEvent(e))},e.updateVersionInfo=function(e,t){null!=e?null!=t?(e.DownloadUrl=t.DownloadUrl,e.WopiInfo=t.WopiInfo):n.a.sendTraceTag(595858567,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"updateVersionInfo, currentVersionInfo is null"):n.a.sendTraceTag(595858566,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"currentVersionInfo, currentVersionInfo is null")},e.updateAuthorColorInfo=function(e){e.Authors&&e.Authors.forEach((function(e){e&&(e.InitialsColor=h.getInitialsColorFromName(e.UserName))}))},e}(),v=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e}(),b=r(0),S=r(56),C=r(218),y=r(12),D=r(3),V=function(e){return e?E:T},T={versionCardRootSelectedBackgroundColor:"#D2D0CE",versionCardRootBackgroundColor:"#EDEBE9",versionCardRootSelectedBoxShadow:"",versionCardRootFocusSelectedBackgroundColor:"#D2D0CE",versionCardRootFocusBackgroundColor:"#EDEBE9",versionCardRootFocusBorder:"#000000",versionCardRootHoverBackground:"#E1DFDD",versionCardRootActiveBackground:"#C8C6C4",versionCardAuthorNameColor:"#252423",versionCardTimestampColor:"#252423",versionCardExpandCollapseIconColor:"#303030",errorDefaultButtonColor:"",errorDefaultButtonBorder:"",errorDefaultButtonHoverColor:"",errorDefaultButtonFocusBorder:"",errorDefaultButtonActiveColor:"",headerDefaultButtonColor:"",headerDefaultButtonBorder:"rgba(200, 198, 196, 1.0)",headerDefaultButtonFont:"",headerDefaultButtonHoverBorderColor:"",headerDefaultButtonHoverBackground:"",headerDefaultButtonHoverFont:"",headerDefaultButtonFocusBorder:"#000000",headerDefaultButtonActiveColor:"",headerDefaultButtonActiveFont:"",headerDefaultButtonActiveBorder:"",headerDefaultButtonDisabledBackground:"",headerDefaultButtonDisabledText:"",headerDefaultButtonDisabledBorder:"",spinnerBorder:"#dddddd",spinnerTopColor:"",vhViewerBackground:"#EDEBE9",vhHeaderBackground:"#F4F3F1",headerBackArrowAndIterator:"#4A4A4A",headerText:"#4A4A4A",headerIteratorTooltip:"#252423",viewerNoSelectionBackground:"#E4E4E4",viewerNoSelectionText:"#4A4A4A",viewerErrorBackground:"#EDEBE9",viewerErrorMessage:"#252423",viewerLoadingBackground:"#EDEBE9",paneBorder:"#DEDEDE",paneBackground:"#EDEBE9",paneHeaderColor:"#505050",dialogBackgroundColor:"#F3F3F3",fullAppErrorBackground:"#FFFFFF",fullAppErrorText:"#252423"},E={versionCardRootSelectedBackgroundColor:"#000000",versionCardRootBackgroundColor:"#1B1A19",versionCardRootSelectedBoxShadow:"",versionCardRootFocusSelectedBackgroundColor:"#000000",versionCardRootFocusBackgroundColor:"#1B1A19",versionCardRootFocusBorder:"white",versionCardRootHoverBackground:"#201F1E",versionCardRootActiveBackground:"#000000",versionCardAuthorNameColor:"#F3F2F1",versionCardTimestampColor:"#F3F2F1",versionCardExpandCollapseIconColor:"#F3F2F1",errorDefaultButtonColor:"white",errorDefaultButtonBorder:"",errorDefaultButtonHoverColor:"#F3F2F1",errorDefaultButtonFocusBorder:"",errorDefaultButtonActiveColor:"#E1DFDD",headerDefaultButtonColor:"#1B1A19",headerDefaultButtonBorder:"#484644",headerDefaultButtonFont:"#F3F2F1",headerDefaultButtonHoverBorderColor:"#161514",headerDefaultButtonHoverBackground:"#161514",headerDefaultButtonHoverFont:"#F3F2F1",headerDefaultButtonFocusBorder:"white",headerDefaultButtonActiveColor:"#000000",headerDefaultButtonActiveFont:"#F3F2F1",headerDefaultButtonActiveBorder:"#484644",headerDefaultButtonDisabledBackground:"#797775",headerDefaultButtonDisabledText:"#605E5C",headerDefaultButtonDisabledBorder:"#3B3A39",spinnerBorder:"#3B3A39",spinnerTopColor:"",vhViewerBackground:"#1B1A19",vhHeaderBackground:"#252423",headerBackArrowAndIterator:"#E1DFDD",headerText:"#E1DFDD",headerIteratorTooltip:"#F3F2F1",viewerNoSelectionBackground:"#1B1A19",viewerNoSelectionText:"#F3F2F1",viewerErrorBackground:"#1B1A19",viewerErrorMessage:"#F3F2F1",viewerLoadingBackground:"#1B1A19",paneBorder:"transparent",paneBackground:"#1B1A19",paneHeaderColor:"#F3F2F1",dialogBackgroundColor:"#000000",fullAppErrorBackground:"#1B1A19",fullAppErrorText:"#F3F2F1"},_=Object(y.c)((function(e,t){if(void 0===t&&(t=!1),c.isVHDarkModeSupported()){var r=V(t).dialogBackgroundColor;return{root:Object(D.eb)({backgroundColor:r,display:"flex",flexFlow:"row",width:"100%",height:"100%",overflow:"auto",direction:e?"rtl":"ltr"}),dialog:Object(D.eb)({display:"flex",flexFlow:"row",width:"100%",height:"100%",minWidth:"1000px",minHeight:"200px"}),hidden:Object(D.eb)({display:"none"}),fullAppErrorDiv:Object(D.eb)({display:"flex",flexFlow:"column",width:"100%",height:"100%"})}}return{root:Object(D.eb)({backgroundColor:"#F3F3F3",display:"flex",flexFlow:"row",width:"100%",height:"100%",overflow:"auto",direction:e?"rtl":"ltr"}),dialog:Object(D.eb)({display:"flex",flexFlow:"row",width:"100%",height:"100%",minWidth:"1000px",minHeight:"200px"}),hidden:Object(D.eb)({display:"none"}),fullAppErrorDiv:Object(D.eb)({display:"flex",flexFlow:"column",width:"100%",height:"100%"})}})),w=r(49),x=r(1185),H=r(294),k=Object(y.c)((function(e,t){var r=V(e);return A("",t,r)})),I=Object(y.c)((function(e,t){return void 0===e&&(e="#B7472A"),void 0===t&&(t=!1),A(e,t)})),A=Object(y.c)((function(e,t,r){return void 0===e&&(e="#B7472A"),{root:Object(D.eb)({display:"flex",flexFlow:"column",flexBasis:"22%",flexGrow:1,flexShrink:1.5,maxWidth:"338px",minWidth:"338px",height:"calc(100% - 2px)",border:c.isVHDarkModeSupported()&&r?"1px solid "+r.paneBorder:"1px solid #DEDEDE",backgroundColor:c.isVHDarkModeSupported()&&r?r.paneBackground:"#EDEBE9"}),scrollRegion:Object(D.eb)({flexFlow:"column",overflowY:"auto",overflowX:"hidden",marginBottom:"40px",marginTop:"16px"}),loadingDiv:Object(D.eb)({display:"flex",flexGrow:1,justifyContent:"center",alignItems:"center"}),loadingSpinner:Object(D.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:c.isVHDarkModeSupported()&&r?r.spinnerBorder:"#dddddd",borderTopColor:c.isVHDarkModeSupported()&&r?r.spinnerTopColor:e}}}),paneHeader:Object(D.eb)({width:"",color:c.isVHDarkModeSupported()&&r?r.paneHeaderColor:"#505050",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"15px",fontWeight:600,lineHeight:"17px",marginLeft:"12px",marginRight:"12px",marginTop:"14px",marginBottom:"4px"}),showChangesDiv:Object(D.eb)({display:t?"flex":"none",height:t?"":"0px",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:600,marginTop:"16px"}),hidden:Object(D.eb)({display:"none"})}})),O=r(159),B=r(380),F={overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},R=Object(y.c)((function(e,t,r){return N(e,"",t,V(r))})),j=Object(y.c)((function(e,t,r){return N(e,t,r)})),N=Object(y.c)((function(e,t,r,n){var i,s,a,l,d,p,u,h,g;return{root:Object(D.eb)({backgroundColor:c.isVHDarkModeSupported()&&n?e?n.versionCardRootSelectedBackgroundColor:n.versionCardRootBackgroundColor:e?"#D2D0CE":"#EDEBE9",marginLeft:"",marginRight:"",marginBottom:Object(B.b)()?"-3px":"",padding:"12px 0 12px 16px",display:"flex",flexFlow:"row",outline:"none",boxShadow:e?(r?"inset -4px 0 0 ":"inset 4px 0 0 ")+(c.isVHDarkModeSupported()&&n?n.versionCardRootSelectedBoxShadow:t):"",selectors:(i={},i[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:e?"Highlight":"ButtonFace",color:e?"HighlightText":"ButtonText",boxShadow:e?(r?"inset -6px 0 0 ":"inset 6px 0 0 ")+(Object(B.b)()?"GrayText":"LinkText"):""}),i[":focus"]={backgroundColor:c.isVHDarkModeSupported()&&n?e?n.versionCardRootFocusSelectedBackgroundColor:n.versionCardRootFocusBackgroundColor:e?"#D2D0CE":"#EDEBE9",padding:"11px 0 11px 15px",border:c.isVHDarkModeSupported()&&n?"1px solid "+n.versionCardRootFocusBorder:"1px solid #000000",boxShadow:e?(r?"inset -3px 0 0 ":"inset 3px 0 0 ")+(c.isVHDarkModeSupported()&&n?n.versionCardRootSelectedBoxShadow:t):"",selectors:(s={},s[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",padding:"12px 0 12px 16px",border:"none",boxShadow:e?(r?"inset -6px 0 0 ":"inset 6px 0 0 ")+(Object(B.b)()?"GrayText":"LinkText"):""}),s)},i[":hover"]={backgroundColor:c.isVHDarkModeSupported()&&n?n.versionCardRootHoverBackground:"#E1DFDD",selectors:(a={},a[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText"}),a)},i[":active"]={backgroundColor:c.isVHDarkModeSupported()&&n?n.versionCardRootActiveBackground:"#C8C6C4",selectors:(l={},l[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight"}),l)},i)},F),cardMouseDownStyleForIE:Object(D.eb)({position:"relative",padding:"11px 0 11px 15px",boxShadow:e?(r?"inset -3px 0 0":"inset 3px 0 0 ")+(c.isVHDarkModeSupported()&&n?n.versionCardRootSelectedBoxShadow:t):"",border:c.isVHDarkModeSupported()&&n?"1px solid "+n.versionCardRootFocusBorder:"1px solid #000000",selectors:{":hover":{backgroundColor:c.isVHDarkModeSupported()&&n?n.versionCardRootActiveBackground:"#C8C6C4",selectors:(d={},d[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",padding:"12px 0 12px 16px",boxShadow:e?(r?"inset -6px 0 0 ":"inset 6px 0 0 ")+"GrayText":"",border:"none"}),d)}}}),body:Object(D.eb)({width:"100%",display:"flex",flexFlow:"column",cursor:"pointer",selectors:(p={},p[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"inherit"}),p)}),authorBold:Object(D.eb)({display:"inline-block",fontWeight:"inherit",marginTop:""}),miniAuthorDiv:Object(D.eb)({display:"flex",flexFlow:"row",marginLeft:"20px",marginRight:"20px",marginTop:"4px",selectors:(u={},u[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"inherit"}),u)}),authorName:Object(D.eb)({color:c.isVHDarkModeSupported()&&n?n.versionCardAuthorNameColor:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"11px",marginLeft:"6px",selectors:(h={},h[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"inherit"}),h)}),groupContextMenuDiv:Object(D.eb)({display:"inline-block",position:"relative",float:"right",marginRight:"16px",height:"14px",maxWidth:Object(B.b)()?"22px":"14px"}),groupTimestampDiv:Object(D.eb)({display:"inline-block"}),groupTimestampMenuDiv:Object(D.eb)({display:"inline-block",width:"auto",color:c.isVHDarkModeSupported()&&n?n.versionCardTimestampColor:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontWeight:e?"600":"normal",fontSize:"11px",marginTop:"",marginLeft:"20px",marginRight:"",selectors:(g={},g[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"inherit"}),g)})}})),M=r(815);function L(e,t,r){var o=t||new Date,a=(o.getTime()-e.getTime())/1e3,l=Math.floor((o.getTime()-6e4*o.getTimezoneOffset())/864e5),c=Math.floor((e.getTime()-6e4*e.getTimezoneOffset())/864e5),d=o.getTime()-(36e5*o.getHours()+6e4*o.getMinutes()+1e3*o.getSeconds())-(o.getDay()+6)%7*864e5,p=d-6048e5,u=p-6048e5,h=u-6048e5,g=M.namespace();if(g.setup({locale:G(),missingTranslation:"ignore"}),null!=r){if(e<=o){if(a<120)return{friendlyDateString:r.JustNow,friendlyGroupString:r.TodayVersionsLabel};if(a<3600){var f=Math.floor(a/60);return isNaN(f)?(n.a.sendTraceTag(594883874,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"Minutes ago is NaN, input date was: "+e.toUTCString()),{friendlyDateString:z(e),friendlyGroupString:r.TodayVersionsLabel}):{friendlyDateString:g(r.MinutesAgo,{mins:f}),friendlyGroupString:r.TodayVersionsLabel}}if(c===l){var m=Math.floor(a/3600);return isNaN(m)?(n.a.sendTraceTag(594883875,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"Hours ago is NaN, input date was: "+e.toUTCString()),{friendlyDateString:z(e),friendlyGroupString:r.TodayVersionsLabel}):{friendlyDateString:g(r.HoursAgo,{hours:m}),friendlyGroupString:r.TodayVersionsLabel}}if(c===l-1)return{friendlyDateString:r.YesterdayWithTime.replace("{0}",z(e)),friendlyGroupString:r.YesterdayVersionsLabel};if(e.getTime()>=d){var v=Intl.DateTimeFormat(G(),{weekday:"long"}).format(e);return{friendlyDateString:r.DateTimeComboNoAt.replace("{0}",v).replace("{1}",z(e)),friendlyGroupString:v}}if(e.getTime()>=p)return W(e,r);if(e.getTime()>=u&&e.getMonth()===o.getMonth())return W(e,r);if(e.getTime()>=h&&e.getMonth()===o.getMonth())return W(e,r);if(function(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}(e,o))return W(e,r);if(function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()-1}(e,o))return W(e,r);if(e.getFullYear()===o.getFullYear())return W(e,r);var b=Intl.DateTimeFormat(G(),{month:"long",day:"numeric",year:"numeric"}).format(e);return{friendlyDateString:r.DateTimeComboNoAt.replace("{0}",b).replace("{1}",z(e)),friendlyGroupString:b}}return{friendlyDateString:r.JustNow,friendlyGroupString:r.TodayVersionsLabel}}return n.a.sendTraceTag(595682912,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"localizedStrings is null. Version date: "+e.toUTCString()+", Now: "+o.toUTCString()),{friendlyDateString:Intl.DateTimeFormat(G(),{month:"long",day:"numeric",year:"numeric"}).format(e>o?o:e),friendlyGroupString:Intl.DateTimeFormat(G(),{month:"long",day:"numeric",year:"numeric"}).format(e>o?o:e)}}function W(e,t){var r=Intl.DateTimeFormat(G(),{month:"long",day:"numeric"}).format(e);return{friendlyDateString:t.DateTimeComboNoAt.replace("{0}",r).replace("{1}",z(e)),friendlyGroupString:r}}function z(e){return Intl.DateTimeFormat(G(),{hour:"numeric",minute:"numeric"}).format(e)}function G(){return g.UILocale}var U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.d)(t,e),t.prototype.componentDidMount=function(){P.register(this)},t.prototype.componentWillUnmount=function(){P.unregister(this)},t.prototype.render=function(){return L(this.props.date,void 0,this.props.localizedStrings).friendlyDateString},t}(b.PureComponent),P=new(function(){function e(){this.components=[]}return e.prototype.register=function(e){var t=this;this.components.push(e),void 0===this.timerId&&(this.timerId=window.setInterval((function(){return t.onTimerFired()}),6e4))},e.prototype.unregister=function(e){this.components=this.components.filter((function(t){return t!==e})),this.components.length||window.clearInterval(this.timerId)},e.prototype.onTimerFired=function(){this.components.forEach((function(e){return e.forceUpdate()}))},e}()),q=Object(y.c)((function(e,t){var r,n;void 0===t&&(t=!1);var i="";return c.isVHDarkModeSupported()&&(i=V(t).versionCardAuthorNameColor),{authorRole:Object(D.eb)({fontWeight:"normal",fontSize:"12px",color:c.isVHDarkModeSupported()?i:"#252423",selectors:(r={},r[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"inherit"}),r)}),authorName:Object(D.eb)({color:c.isVHDarkModeSupported()?i:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:600,selectors:(n={},n[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"inherit"}),n)}),colorBlock:Object(D.eb)({backgroundColor:e,width:"8px",height:"8px",marginRight:"4px",display:"inline-block"})}})),X=r(2178);function J(e,t){return e.EmailAddress===t.EmailAddress&&e.LogOnName===t.LogOnName&&e.UserName===t.UserName}function K(e){switch(e){case 2:return 4;case 3:return 2}return 0}var Y=r(547);function Z(e,t){return t||e.GuestUserDisplayName}var Q=b.memo((function(e){var t=Z(e.localizedStrings,e.name),r=function(e,t){return t||h.getInitialsColorFromName(e)}(t,e.color),o=c.isVHDarkModeSupported()?q(r,Object(Y.b)()):q(r),n=e.role?e.role:e.actionType?function(e,t){switch(e){case 1:return t.UserAction;case 4:return t.UserRenameAction;case 2:case 3:return t.UserRestoreAction}}(e.actionType,e.localizedStrings):void 0;if(n){var i=Object(X.a)(e.localizedStrings.UserActionComboString,(function(e){return"0"===e?b.createElement("span",{className:o.authorName},b.createElement("span",{className:o.colorBlock,"data-is-focusable":!1}),t):"1"===e?b.createElement("span",{className:o.authorRole},n):""}));return b.createElement("span",null,i)}var s=e.actionType?function(e,t){switch(e){case 5:return t.UserModifyRenameActions;case 6:case 7:return t.UserRestoreRenameActions}}(e.actionType,e.localizedStrings):void 0;if(s){i=Object(X.a)(s,(function(e){return"0"===e?b.createElement("span",{className:o.authorName},b.createElement("span",{className:o.colorBlock,"data-is-focusable":!1}),t):""}));return b.createElement("span",{className:o.authorRole},i)}return b.createElement("span",{className:o.authorName},b.createElement("span",{className:o.colorBlock}),t)})),$=r(277),ee=r(252),te=r.n(ee),re=Object(y.c)((function(e){var t,r;return{contextMenuButtonStyles:{rootHasMenu:{display:"inline-flex",position:"relative",height:"16px",width:"16px",padding:"0",selectors:(t={},t[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"ButtonText",fill:"ButtonText"}),t[":hover"]={selectors:(r={},r[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"HighlightText",fill:"HighlightText"}),r)},t),direction:e?"rtl":"ltr"},menuIcon:{width:"12px",margin:"0 2px"}},contextMenuItemStyles:{root:{fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",fontWeight:"normal",height:"auto",width:"auto",direction:e?"rtl":"ltr"}}}}));function oe(e,t){return void 0===t&&(t="versionHistorySprite"),t+"."+e}var ne=function(){function e(){}return e.isEnableMenu=function(t,r){return e.isSaveEnabled(t)||e.isDownloadEnabled(t)||e.isDeleteEnabled(t,r)},e.isSaveEnabled=function(e){return!e.disableSaveACopy&&e.wdEnableSaveACopy&&e.wdEnableSaveACopyOverFlowMenu},e.isDownloadEnabled=function(e){return!e.disableSaveACopy&&e.wdEnableDownloadVersion},e.isDeleteEnabled=function(e,t){return e.wdEnableDeleteVersions&&!t},e}(),ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._contextMenuRef=b.createRef(),t}return Object(o.d)(t,e),t.prototype.render=function(){var e=re(this.props.appSettings.isRtl),t=[];if(this.props.onSaveACopyClicked&&t.push({key:"vh-save-a-copy",name:this.props.localizedStrings.SaveACopy,styles:e.contextMenuItemStyles,onClick:this.props.onSaveACopyClicked}),this.props.onDownloadVersionClicked&&t.push({key:"vh-download-version",name:this.props.localizedStrings.Download,styles:e.contextMenuItemStyles,onClick:this.props.onDownloadVersionClicked}),this.props.onDeleteVersionsClicked&&t.push({key:"vh-delete-versions",name:this.props.localizedStrings.Delete,styles:e.contextMenuItemStyles,onClick:this.props.onDeleteVersionsClicked}),t.length<1)return null;var r={iconName:oe(te.a.Ellipsis_12)},o={items:t};return b.createElement($.a,{id:"vh-context-menu",componentRef:this._contextMenuRef,styles:e.contextMenuButtonStyles,ariaLabel:this.props.localizedStrings.MoreOptions,title:this.props.localizedStrings.MoreOptions,menuProps:o,menuIconProps:r})},t.prototype.openMenu=function(){var e;null===(e=this._contextMenuRef.current)||void 0===e||e.openMenu()},t}(b.Component),se=r(475),ae=r(93),le=function(e){function t(t){var r=e.call(this,t)||this;return r._root=b.createRef(),r._rootHTMLElement=null,r._contextMenu=b.createRef(),r.onFocus=function(){r._root.current&&(r._root.current.tabIndex=-1,r._root.current.focus(),r._rootHTMLElement||(r._rootHTMLElement=document.getElementById(r._root.current.id)),r._rootHTMLElement&&Object(O.b)(!0,r._rootHTMLElement))},r.onClick=function(){var e={currentVersion:r.props.currentVersion,baseVersion:r.props.baseVersion,noBaseToCompareTo:!r.props.baseVersion};r.props.onVersionSelectedAction(e),n.a.sendTraceTag(595632832,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"User manually selected a version"),Object(ae.logUserAction)("VersionHistorySelectVersion")},r.onContextMenu=function(e){var t;e.preventDefault(),null===(t=r._contextMenu.current)||void 0===t||t.openMenu()},r.onKeyDownInCard=function(e){if(e.shiftKey&&(e.which||e.keyCode)===w.a.f10)return void r.onContextMenu(e);(e.which===w.a.left&&!r.props.appSettings.isRtl||e.which===w.a.right&&r.props.appSettings.isRtl)&&r.props.onLeftButton&&r.props.onLeftButton()},r.onCardMouseDownHandlerForIE=function(){var e=c.isVHDarkModeSupported()?R(r.props.isSelected,r.props.appSettings.isRtl,Object(Y.b)()):j(r.props.isSelected,r.props.appColors.primary,r.props.appSettings.isRtl);r._root&&r._root.current&&r._root.current.classList.toggle(e.cardMouseDownStyleForIE)},r.onCardMouseUpHandlerForIE=function(){var e=c.isVHDarkModeSupported()?R(r.props.isSelected,r.props.appSettings.isRtl,Object(Y.b)()):j(r.props.isSelected,r.props.appColors.primary,r.props.appSettings.isRtl);r._root&&r._root.current&&(r._root.current.classList.toggle(e.cardMouseDownStyleForIE),r._root.current.focus())},r.onDownloadVersionClicked=function(){var e;r.props.onDownloadVersionSelectedAction&&(n.a.sendTraceTag(592316623,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"Download clicked."),r.props.onDownloadVersionSelectedAction(null!==(e=r.props.currentVersion.DownloadUrl)&&void 0!==e?e:""))},r.onSaveACopyClicked=function(){var e;r.props.onSaveACopySelectedAction&&(n.a.sendTraceTag(592065615,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"SaveACopy clicked."),r.props.onSaveACopySelectedAction(null!==(e=r.props.currentVersion.DownloadUrl)&&void 0!==e?e:""))},r.onDeleteVersionsClicked=function(){r.props.onDeleteVersionsSelectedAction&&r.props.currentVersion.RevisionID&&(n.a.sendTraceTag(590147736,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"DeleteVersions clicked."),r.props.onDeleteVersionsSelectedAction([r.props.currentVersion.RevisionID]))},r}return Object(o.d)(t,e),t.prototype.render=function(){var e,t,r=this,a=this.props,l=a.currentVersion,d=a.isSelected,p=a.ariaPosinset,u=a.ariaSetsize,h=c.isVHDarkModeSupported()?R(d,this.props.appSettings.isRtl,Object(Y.b)()):j(d,this.props.appColors.primary,this.props.appSettings.isRtl),g=[],f=(t=[],(e=l).Authors&&e.Authors.length>0?e.Authors.forEach((function(e){e&&t.push({type:1,author:e})})):t.push({type:1,author:{UserName:e.AuthorID}}),e.Events&&e.Events.forEach((function(e){if(e&&e.Author){for(var r=!1,o=0,n=t;o<n.length;o++){var i=n[o];J(i.author,e.Author)&&(r=!0,i.type|=K(e.Type))}r||t.push({author:e.Author,type:K(e.Type)})}})),{time:e.Time,events:t});if(!f.time)return n.a.sendTraceTag(594367690,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({msg:"Version missing timestamp or author",id:l.RevisionID})),!1;f.events.forEach((function(e){if(e){var t=l.RevisionID+"_"+Object(C.a)();g.push(b.createElement("div",{className:h.miniAuthorDiv},b.createElement(Q,{key:t,name:e.author.UserName,color:e.author.InitialsColor,actionType:e.type,localizedStrings:r.props.localizedStrings})))}}));var m=b.createElement(U,{date:f.time,localizedStrings:this.props.localizedStrings});return b.createElement("div",Object(o.a)({ref:this._root,id:"vhCard"+this.props.currentVersion.RevisionID,onClick:this.onClick,className:h.root,"data-is-focusable":!0,"data-unique-id":this.props.currentVersion.RevisionID,"aria-selected":d,role:"treeitem","aria-posinset":p,"aria-setsize":u,onKeyDown:this.onKeyDownInCard},Object(se.c)()?{onMouseDown:this.onCardMouseDownHandlerForIE,onMouseUp:this.onCardMouseUpHandlerForIE}:{}),b.createElement("div",{className:h.body},b.createElement("div",{className:h.groupTimestampMenuDiv},b.createElement("div",{className:h.groupTimestampDiv},m),this.isShowContextMenu()&&b.createElement("div",{className:h.groupContextMenuDiv},this.getVersionHistoryContextMenu())),b.createElement("div",{className:h.authorBold},g)))},t.prototype.isShowContextMenu=function(){return ne.isEnableMenu(this.props.appSettings,this.props.isTipVersion)&&this.props.isSelected},t.prototype.getVersionHistoryContextMenu=function(){return b.createElement(ie,{ref:this._contextMenu,appSettings:this.props.appSettings,localizedStrings:this.props.localizedStrings,onDownloadVersionClicked:ne.isDownloadEnabled(this.props.appSettings)?this.onDownloadVersionClicked:void 0,onSaveACopyClicked:ne.isSaveEnabled(this.props.appSettings)?this.onSaveACopyClicked:void 0,onDeleteVersionsClicked:ne.isDeleteEnabled(this.props.appSettings,this.props.isTipVersion)?this.onDeleteVersionsClicked:void 0})},t}(b.Component),ce=r(930),de=Object(y.c)((function(e,t,r){return ue(e,"",t,V(r))})),pe=Object(y.c)((function(e,t,r){return ue(e,t,r)})),ue=Object(y.c)((function(e,t,r,n){var i,s,a,l,d,p,u,h,g,f,m,v,b,S,C,y={height:"16px",width:"16px",color:c.isVHDarkModeSupported()&&n?n.versionCardExpandCollapseIconColor:"#303030",lineHeight:"16px",verticalAlign:"center",display:"none",cursor:"pointer"},V={display:"flex",width:"auto",padding:"16px 0 16px 12px",selectors:(i={},i[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:e?"Highlight":"ButtonFace",color:e?"HighlightText":"ButtonText",fill:e?"HighlightText":"ButtonText"}),i["svg > path.OfficeIconColors_m22"]={selectors:(s={},s[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{fill:e?"HighlightText !important":"ButtonText !important"}),s)},i[":hover"]={backgroundColor:c.isVHDarkModeSupported()&&n?n.versionCardRootHoverBackground:"#E1DFDD",selectors:(a={},a[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",fill:"HighlightText"}),a)},i[":hover svg > path.OfficeIconColors_m22"]={selectors:(l={},l[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{fill:"HighlightText !important"}),l)},i[":focus"]={outline:"0",border:c.isVHDarkModeSupported()&&n?"1px solid "+n.versionCardRootFocusBorder:"1px solid #000000",boxShadow:e?(r?"inset -3px 0 0 ":"inset 3px 0 0 ")+(c.isVHDarkModeSupported()&&n?n.versionCardRootSelectedBoxShadow:t):"",padding:"15px 0 15px 11px",selectors:(d={},d[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",fill:"HighlightText",boxShadow:e?(r?"inset -6px 0 0 ":"inset 6px 0 0 ")+(Object(B.b)()?"GrayText":"LinkText"):"",border:"none",padding:"16px 0 16px 12px"}),d)},i[":focus svg > path.OfficeIconColors_m22"]={selectors:(p={},p[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{fill:"HighlightText !important"}),p)},i[":active"]={backgroundColor:c.isVHDarkModeSupported()&&n?n.versionCardRootActiveBackground:"#C8C6C4",selectors:(u={},u[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",fill:"HighlightText"}),u)},i[":active svg > path.OfficeIconColors_m22"]={selectors:(h={},h[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{fill:"HighlightText !important"}),h)},i)};return{toggleSpan:Object(D.eb)({flexBasis:"16px",height:"16px",width:"16px"}),sectionName:Object(D.eb)({display:"inline-flex",color:c.isVHDarkModeSupported()&&n?n.versionCardTimestampColor:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"15px",fontWeight:"normal",selectors:(g={},g[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"inherit"}),g)}),sectionHeaderFocusBackground:Object(D.eb)({padding:"15px 0 15px 11px",boxShadow:e?(r?"inset -3px 0 0 ":"inset 3px 0 0 ")+(c.isVHDarkModeSupported()&&n?n.versionCardRootSelectedBoxShadow:t):"",backgroundColor:c.isVHDarkModeSupported()&&n?e?n.versionCardRootSelectedBackgroundColor:n.versionCardRootFocusBackgroundColor:e?"#D2D0CE":"#EDEBE9",border:c.isVHDarkModeSupported()&&n?"1px solid "+n.versionCardRootFocusBorder:"1px solid #000000",selectors:(f={},f[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{boxShadow:e?(r?"inset -6px 0 0":"inset 6px 0 0 ")+(Object(B.b)()?"GrayText":"LinkText"):"",border:"none",padding:"16px 0 16px 12px"}),f)},V),sectionHeader:Object(D.eb)({boxShadow:e?(r?"inset -4px 0 0 ":"inset 4px 0 0 ")+(c.isVHDarkModeSupported()&&n?n.versionCardRootSelectedBoxShadow:t):"",backgroundColor:c.isVHDarkModeSupported()&&n?e?n.versionCardRootSelectedBackgroundColor:n.versionCardRootBackgroundColor:e?"#D2D0CE":"#EDEBE9",selectors:(m={},m[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{boxShadow:e?(r?"inset -6px 0 0":"inset 6px 0 0 ")+(Object(B.b)()?"GrayText":"LinkText"):""}),m)},V),sectionHeaderMouseDownStyleForIE:Object(D.eb)({position:"relative",padding:"15px 0 15px 11px",boxShadow:e?(r?"inset -3px 0 0 ":"inset 3px 0 0 ")+c.isVHDarkModeSupported()&&n?n.versionCardRootSelectedBoxShadow:t:"",border:c.isVHDarkModeSupported()&&n?"1px solid "+n.versionCardRootFocusBorder:"1px solid #000000",selectors:{":hover":{backgroundColor:c.isVHDarkModeSupported()&&n?n.versionCardRootActiveBackground:"#C8C6C4",selectors:(v={},v[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",padding:"16px 0 16px 12px",boxShadow:e?(r?"inset -6px 0 0 ":"inset 6px 0 0 ")+"GrayText":"",border:"none"}),v)}}}),sectionNameDiv:Object(D.eb)({width:"",flexBasis:"calc(100% - 20px)",color:c.isVHDarkModeSupported()&&n?n.versionCardTimestampColor:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",verticalAlign:"center",lineHeight:"16px",cursor:"pointer",marginRight:"8px",marginLeft:"8px",selectors:(b={},b[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"inherit"}),b)}),currentVersionDiv:Object(D.eb)({fontSize:"12px",paddingTop:"4px",fontWeight:"normal",paddingBottom:"2px"}),authorsList:Object(D.eb)({fontSize:"12px",marginTop:"4px",fontWeight:"normal"}),expand:Object(D.eb)(Object(o.a)(Object(o.a)({},y),{display:"none"}),c.isVHDarkModeSupported()?(S={},S["svg > path.OfficeIconColors_m22"]={fill:n?n.versionCardExpandCollapseIconColor:""},S):{}),collapse:Object(D.eb)(Object(o.a)(Object(o.a)({},y),{display:"inline-block"}),c.isVHDarkModeSupported()?(C={},C["svg > path.OfficeIconColors_m22"]={fill:n?n.versionCardExpandCollapseIconColor:""},C):{}),versionList:Object(D.eb)({display:"none"}),contextMenuDiv:Object(D.eb)({display:"inline-block",position:"relative",float:"right",top:"",marginRight:"8px",height:"16px",width:"16px",maxWidth:Object(B.b)()?"22px":"16px"}),timestampDiv:Object(D.eb)({display:"inline-block"}),versionItemDiv:Object(D.eb)({display:"inline-block",width:"100%",padding:0,border:"none"})}})),he=r(233),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._list=b.createRef(),t._id=Object(C.a)(),t._header=b.createRef(),t._chevronButton=b.createRef(),t._headerHTMLElement=null,t._groupVersion=void 0,t._isExpanded=!1,t._firstVersionCard=void 0,t._headerDescribedBy="",t._contextMenu=b.createRef(),t.isShowContextMenu=function(){return ne.isEnableMenu(t.props.appSettings,t.props.containsTip)&&t.props.selectedGroupName===t.props.label},t.onDownloadVersionClicked=function(){var e;n.a.sendTraceTag(593293320,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"Download clicked."),t.props.onDownloadVersionSelectedAction(null!==(e=t.props.currentSectionVersion.DownloadUrl)&&void 0!==e?e:"")},t.onSaveACopyClicked=function(){var e;n.a.sendTraceTag(591987292,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"Save a copy clicked."),t.props.onSaveACopySelectedAction(null!==(e=t.props.currentSectionVersion.DownloadUrl)&&void 0!==e?e:"")},t.onDeleteVersionsClicked=function(){n.a.sendTraceTag(590147735,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"DeleteVersions clicked.");var e=[];t.props.versions.forEach((function(t){return t.RevisionID?e.push(t.RevisionID):void 0})),t.props.onDeleteVersionsSelectedAction(e)},t.setDescribedBy=function(){t._isExpanded?t._headerDescribedBy="":t._headerDescribedBy=t._id+"DisplayString "+t._id+"AuthorList",t.props.containsTip&&(t._headerDescribedBy+=" "+t._id+"Tip"),t._header&&t._header.current&&t._header.current.setAttribute("aria-describedby",t._headerDescribedBy)},t.onSectionHeaderFocus=function(){var e=c.isVHDarkModeSupported()?de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(Y.b)()):pe(t.props.selectedGroupName===t.props.label,t.props.appColors.primary,t.props.appSettings.isRtl);t._header&&t._header.current&&(t._header.current.className=e.sectionHeaderFocusBackground)},t.onSectionHeaderBlur=function(){var e=c.isVHDarkModeSupported()?de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(Y.b)()):pe(t.props.selectedGroupName===t.props.label,t.props.appColors.primary,t.props.appSettings.isRtl);t._header&&t._header.current&&(t._header.current.className=e.sectionHeader)},t.onSectionHeaderMouseDownHandlerForIE=function(){var e=c.isVHDarkModeSupported()?de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(Y.b)()):pe(t.props.selectedGroupName===t.props.label,t.props.appColors.primary,t.props.appSettings.isRtl);t._header&&t._header.current&&t._header.current.classList.toggle(e.sectionHeaderMouseDownStyleForIE)},t.onSectionHeaderMouseUpHandlerForIE=function(){var e=c.isVHDarkModeSupported()?de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(Y.b)()):pe(t.props.selectedGroupName===t.props.label,t.props.appColors.primary,t.props.appSettings.isRtl);t._header&&t._header.current&&(t._header.current.classList.toggle(e.sectionHeaderMouseDownStyleForIE),t._header.current.focus())},t.renderToggleSpan=function(e){return b.createElement("span",{className:e.toggleSpan,ref:t._chevronButton,"aria-expanded":"false",role:"button",onClick:t.onSectionIconClick,"aria-label":t.props.localizedStrings.ExpandCollapseChevronButtonAriaLabel.replace("{0}",t.props.clickableGroupChevronAriaLabel)},b.createElement(he.a,{id:t._id+"IconExpand",className:e.expand,iconName:oe(te.a.CommonControlChevronDown_16)}),b.createElement(he.a,{id:t._id+"IconCollapse",className:e.collapse,iconName:oe(t.props.appSettings.isRtl?te.a.CommonControlChevronLeft_16:te.a.CommonControlChevronRight_16)}))},t.renderVersionCardList=function(e){return b.createElement(ce.a,{id:t._id,className:e.versionList,ref:t._list,items:t.props.versions,onRenderCell:t.onRenderListItem,onShouldVirtualize:t.onShouldVirtualize,getKey:t.getListItemKey,role:"presentation"})},t.renderAndSetAuthorList=function(){var e=c.isVHDarkModeSupported()?de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(Y.b)()):pe(t.props.selectedGroupName===t.props.label,t.props.appColors.primary,t.props.appSettings.isRtl),r=fe(t.props.versions,t.props.localizedStrings),o=[];switch(r.length){case 0:n.a.sendTraceTag(595644672,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"there were no authors to display");break;case 1:o=t.render1To4Authors(t.props.localizedStrings.OneUserAuthorList,r);break;case 2:o=t.render1To4Authors(t.props.localizedStrings.TwoUserAuthorList,r);break;case 3:o=t.render1To4Authors(t.props.localizedStrings.ThreeUserAuthorList,r);break;case 4:o=t.render1To4Authors(t.props.localizedStrings.FourUserAuthorList,r);break;default:o=Object(X.a)(t.props.localizedStrings.FivePlusUserAuthorList,(function(e){return"3"===e?(r.length-3).toString():t.renderAuthor(r[parseInt(e,10)])}))}return t._groupVersion&&(t._groupVersion.Authors=r),b.createElement("div",{id:t._id+"AuthorList",className:e.authorsList},o)},t.render1To4Authors=function(e,r){return Object(X.a)(e,(function(e){return t.renderAuthor(r[parseInt(e,10)])}))},t.renderAuthor=function(e){return b.createElement(Q,{name:e.UserName,color:e.InitialsColor,localizedStrings:t.props.localizedStrings})},t.getListItemKey=function(e,t){return e.RevisionID||""},t.getBaseVersion=function(e,t,r){var o=null;return t.forEach((function(n,i){n===e&&(o=i!==t.length-1?t[i+1]:r)})),o},t.onShouldVirtualize=function(){return!1},t._commonCardProps={localizedStrings:t.props.localizedStrings,onVersionSelectedAction:t.props.onVersionSelectedAction},t.onRenderListItem=function(e,r){if(void 0!==e){var o=c.isVHDarkModeSupported()?de(t.props.selectedGroupName===t.props.label,t.props.appSettings.isRtl,Object(Y.b)()):pe(t.props.selectedGroupName===t.props.label,t.props.appColors.primary,t.props.appSettings.isRtl),n=new le({localizedStrings:t._commonCardProps.localizedStrings,currentVersion:e,baseVersion:t.getBaseVersion(e,t.props.versions,t.props.finalBaseVersion),isSelected:!t.props.selectedGroupName&&t.props.selectedVersionId===e.RevisionID,ariaPosinset:void 0!==r?r+1:0,ariaSetsize:t.props.versions.length,appSettings:t.props.appSettings,appColors:t.props.appColors,isTipVersion:0===r&&t.props.containsTip,onVersionSelectedAction:t._commonCardProps.onVersionSelectedAction,onLeftButton:t.programaticFocus,onDownloadVersionSelectedAction:t.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:t.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:t.props.onDeleteVersionsSelectedAction});return 0===r&&(t._firstVersionCard=n),b.createElement("div",{className:o.versionItemDiv,role:"presentation"},n.render())}},t.onSectionIconClick=function(e){t.expandOrCollapseSubsection(!t.isListVisible()),e.stopPropagation()},t.onSectionClicked=function(){n.a.sendTraceTag(595632606,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"group section header manually selected"),Object(ae.logUserAction)("VersionHistorySelectVersionGroup"),t.onSectionSelected()},t.onSectionSelected=function(){var e={currentVersion:t._groupVersion?t._groupVersion:t.props.currentSectionVersion,baseVersion:t.props.finalBaseVersion,groupName:t.props.label,noBaseToCompareTo:!t.props.finalBaseVersion};t.props.onVersionSelectedAction(e),t.isListVisible()&&t.expandOrCollapseSubsection(!1),(t.props.appSettings.wdEnableDeleteVersions||t.props.appSettings.wdEnableSaveACopyOverFlowMenu)&&t.programaticFocus()},t.isListVisible=function(){var e=document.getElementById(t._id);return null!=e&&"block"===e.style.display},t.onContextMenu=function(e){var r;e.preventDefault(),null===(r=t._contextMenu.current)||void 0===r||r.openMenu()},t.onKeyDownInSectionHeader=function(e){if(e.shiftKey&&(e.which||e.keyCode)===w.a.f10)return void t.onContextMenu(e);e.which===w.a.left&&!t.props.appSettings.isRtl||e.which===w.a.right&&t.props.appSettings.isRtl?t.expandOrCollapseSubsection(!1):(e.which===w.a.right&&!t.props.appSettings.isRtl||e.which===w.a.left&&t.props.appSettings.isRtl)&&(t._isExpanded?t._firstVersionCard&&t._firstVersionCard.onFocus():t.expandOrCollapseSubsection(!0)),e.which===w.a.enter&&t.onSectionSelected()},t.programaticFocus=function(){t._header&&t._header.current&&(t._header.current.focus(),t._headerHTMLElement||(t._headerHTMLElement=document.getElementById(t._header.current.id)),t._headerHTMLElement&&Object(O.b)(!0,t._headerHTMLElement))},t.displayElement=function(e,t){t&&(t.style.display=e?"block":"none")},t.setAriaExpanded=function(e,t){null==t||t.setAttribute("aria-expanded",e?"true":"false")},t}return Object(o.d)(t,e),t.prototype.render=function(){var e=c.isVHDarkModeSupported()?de(this.props.selectedGroupName===this.props.label,this.props.appSettings.isRtl,Object(Y.b)()):pe(this.props.selectedGroupName===this.props.label,this.props.appColors.primary,this.props.appSettings.isRtl),t=this.props.versions;this._groupVersion=Object(o.a)({},this.props.currentSectionVersion);var r=this.renderAndSetAuthorList();this.props.selectedGroupName===this._groupVersion.RevisionID&&this.onSectionSelected(),this.setDescribedBy();var n="";return this.props.versions.forEach((function(e){n+="vhCard"+e.RevisionID+" "})),b.createElement(b.Fragment,null,t.length>0&&b.createElement("div",{id:this._id+"GroupDiv"},b.createElement("div",Object(o.a)({id:this._id+"GroupHeaderDiv",className:1===this.props.positionInSet?[e.sectionHeader,this.props.classNameForItemToBeDefaultFocused].join(" "):e.sectionHeader,onKeyDown:this.onKeyDownInSectionHeader,"aria-label":this.props.clickableGroupDisplayString,role:"treeitem","aria-expanded":"false",ref:this._header,"aria-level":1,"aria-owns":n,"aria-posinset":this.props.positionInSet,"aria-setsize":this.props.subsectionCount,"data-is-focusable":!0,onClick:this.onSectionClicked},Object(se.c)()?{onMouseDown:this.onSectionHeaderMouseDownHandlerForIE,onMouseUp:this.onSectionHeaderMouseUpHandlerForIE}:{onFocus:this.onSectionHeaderFocus,onBlur:this.onSectionHeaderBlur},{"aria-describedby":this._headerDescribedBy,"aria-selected":this.props.selectedGroupName===this.props.label}),this.renderToggleSpan(e),b.createElement("div",{className:e.sectionNameDiv},b.createElement("div",{className:e.sectionName,id:this._id+"DisplayString"},b.createElement("div",{className:e.timestampDiv},this.props.clickableGroupDisplayString)),this.isShowContextMenu()&&b.createElement("div",{className:e.contextMenuDiv},b.createElement(ie,{ref:this._contextMenu,appSettings:this.props.appSettings,localizedStrings:this.props.localizedStrings,onDownloadVersionClicked:ne.isDownloadEnabled(this.props.appSettings)?this.onDownloadVersionClicked:void 0,onSaveACopyClicked:ne.isSaveEnabled(this.props.appSettings)?this.onSaveACopyClicked:void 0,onDeleteVersionsClicked:ne.isDeleteEnabled(this.props.appSettings,this.props.containsTip)?this.onDeleteVersionsClicked:void 0})),this.props.containsTip&&b.createElement("div",{className:e.currentVersionDiv,id:this._id+"Tip"},this.props.localizedStrings.CurrentVersion),r)),this.renderVersionCardList(e)))},t.prototype.componentDidUpdate=function(){},t.prototype.expandOrCollapseSubsection=function(e){this.displayElement(!e,document.getElementById(this._id+"IconCollapse")),this.displayElement(!e,document.getElementById(this._id+"AuthorList")),this.displayElement(e,document.getElementById(this._id)),this.displayElement(e,document.getElementById(this._id+"IconExpand"));var t=this._header.current;this.setAriaExpanded(e,t);var r=this._chevronButton.current;this.setAriaExpanded(e,r),this._isExpanded=e,this.setDescribedBy(),e?n.a.sendTraceTag(595632607,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"group section expanded"):n.a.sendTraceTag(595632608,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"group section collapsed")},t}(b.PureComponent);function fe(e,t){var r=[];return e.forEach((function(e){if(e.Authors&&e.Authors.length>0)e.Authors.forEach((function(e){e&&(r.some((function(t){return J(t,e)}))||r.push(e))}));else{var o=Z(t,e.AuthorID);if(r.some((function(e){return e.UserName===o})))return;var n={UserName:o};r.push(n)}e.Events&&e.Events.forEach((function(e){if(e&&e.Author){var t=e.Author;if(r.some((function(e){return J(e,t)})))return;r.push(t)}else;}))})),r}var me=Object(y.c)((function(){return{nothingFoundRoot:Object(D.eb)({display:"flex",flex:"none",margin:"1px 8px"}),nothingFoundText:Object(D.eb)({padding:"14px",textAlign:"center",margin:"0 auto"})}})),ve=r(939),be=r(190),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._nothingFoundId=Object(C.a)(),t}return Object(o.d)(t,e),t.prototype.render=function(){var e=this,t=me(),r=this.props,a=r.localizedStrings,l=r.versions,c=[];l.forEach((function(e,t){var r=L(e.Time,void 0,a),o=r.friendlyGroupString,n=c.length,i=n>0&&c[n-1].versions.length>0?c[n-1].startIndex:null;0===n?c.push({versions:[e],label:o,startIndex:t,clickableGroupDisplayString:r.friendlyDateString,clickableGroupChevronAriaLabel:r.friendlyGroupString,finalBaseVersion:null,currentSectionVersion:e,containsTip:!0}):f(l,i,t)?c[n-1].versions.push(e):(c[n-1].finalBaseVersion=e,c.push({versions:[e],label:t===l.length-1?o+"_2":o,startIndex:t,clickableGroupDisplayString:r.friendlyDateString,clickableGroupChevronAriaLabel:r.friendlyGroupString,finalBaseVersion:null,currentSectionVersion:e,containsTip:!1}))})),this.props.selectedVersionId||n.a.sendTraceTag(587544262,i.a.msoulscat_Wac_VersionHistory,s.a.Info,JSON.stringify({msg:"Grouped section generated",versionCount:l.length,groupCount:c.length}));var d={selectedVersionId:this.props.selectedVersionId,localizedStrings:this.props.localizedStrings,appSettings:this.props.appSettings,appColors:this.props.appColors,onVersionSelectedAction:this.props.onVersionSelectedAction,onDownloadVersionSelectedAction:this.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:this.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:this.props.onDeleteVersionsSelectedAction};return b.createElement(b.Fragment,null,l.length?b.createElement(ve.a,{direction:be.a.vertical},c.length>0&&c.map((function(t,r){return b.createElement(ge,Object(o.a)({key:t.label,label:t.label,clickableGroupDisplayString:t.clickableGroupDisplayString,clickableGroupChevronAriaLabel:t.clickableGroupChevronAriaLabel,versions:t.versions,finalBaseVersion:t.finalBaseVersion,currentSectionVersion:t.currentSectionVersion,selectedGroupName:e.props.selectedGroupName,containsTip:t.containsTip,positionInSet:r+1,subsectionCount:c.length,classNameForItemToBeDefaultFocused:e.props.classNameForItemToBeDefaultFocused},d))}))):b.createElement("div",{className:t.nothingFoundRoot,tabIndex:0,"aria-labelledby":this._nothingFoundId,role:"note"},b.createElement("div",{className:t.nothingFoundText,id:this._nothingFoundId,"aria-hidden":!0},a.VersionHistoryTitle)))},t}(b.PureComponent),Ce=r(1088),ye=r(1284),De=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ftzone=b.createRef(),t._paneDescribedById="versionHistoryPane",t._classNameForItemToBeDefaultFocused="classNameForItemToBeDefaultFocused",t.getToggleStyles=function(){return{root:{height:14,marginLeft:12},label:{fontSize:13,order:0,marginLeft:0,marginRight:5,marginBottom:4,color:c.isVHDarkModeSupported()&&Object(Y.b)()?"white":""},pill:{width:32,height:14,borderRadius:7,marginBottom:1},thumb:{width:4,height:4,borderRadius:"50%"},text:{display:"none"}}},t.getToggleTheme=function(e){return c.isVHDarkModeSupported()&&Object(Y.b)()?{palette:{themePrimary:e.primary,themeSecondary:e.tint10,themeDark:e.shade10,neutralDark:e.shade20}}:{palette:{themePrimary:e.primary,themeSecondary:e.tint10,themeDark:e.shade10,neutralDark:e.shade20},semanticColors:{inputBackgroundChecked:e.tint10}}},t.renderStandardListView=function(){var e,r=c.isVHDarkModeSupported()?k(Object(Y.b)(),t.props.appSettings.wdEnableShowVersionChanges):I(t.props.appColors.primary,t.props.appSettings.wdEnableShowVersionChanges),n=t.props,i=n.paneLoading,s=n.versions,a=n.viewerLoading,l=n.viewerError,d=n.selectedVersionId,p=!!t.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete&&(a||l),u={localizedStrings:t.props.localizedStrings,selectedVersionId:t.props.selectedVersionId,onVersionSelectedAction:t.props.onVersionSelectedAction,appSettings:t.props.appSettings,appColors:t.props.appColors};return e=void 0!==t.props.appColors?b.createElement(ye.a,Object(o.a)({theme:Object(D.K)(t.getToggleTheme(t.props.appColors)),styles:t.getToggleStyles(),defaultChecked:!0,label:t.props.localizedStrings.ShowChangesText,inlineLabel:!0,onChange:t.onShowVersionChangesChange},{disabled:i||void 0===d||p})):b.createElement(ye.a,Object(o.a)({styles:t.getToggleStyles(),defaultChecked:!0,label:t.props.localizedStrings.ShowChangesText,inlineLabel:!0,onChange:t.onShowVersionChangesChange},{disabled:i||void 0===d||p})),b.createElement(b.Fragment,null,b.createElement("div",{className:r.paneHeader},u.localizedStrings.VersionHistoryTitle),b.createElement("div",{className:r.showChangesDiv},e),i?b.createElement("div",{className:r.loadingDiv},b.createElement(x.a,{className:r.loadingSpinner,size:H.a.large})):b.createElement("div",{className:r.scrollRegion},b.createElement(Se,Object(o.a)({versions:s,selectedGroupName:t.props.selectedGroupName,classNameForItemToBeDefaultFocused:t._classNameForItemToBeDefaultFocused},u,{onDownloadVersionSelectedAction:t.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:t.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:t.props.onDeleteVersionsSelectedAction}))))},t.focus=function(){return t._ftzone.current&&t._ftzone.current.focus()},t.onKeyDown=function(e){e.which!==w.a.up&&e.which!==w.a.down||e.preventDefault()},t.onShowVersionChangesChange=function(e,r){void 0!==r&&(r?n.a.sendTraceTag(595637793,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"Toggle Changes diffs turned on"):n.a.sendTraceTag(595637794,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"Toggle Changes diffs turned off"),t.props.onShowVersionChangesToggledAction(r))},t}return Object(o.d)(t,e),t.prototype.render=function(){var e=c.isVHDarkModeSupported()?k(Object(Y.b)(),this.props.appSettings.wdEnableShowVersionChanges):I(this.props.appColors.primary,this.props.appSettings.wdEnableShowVersionChanges),t=this.props.localizedStrings;return b.createElement(Ce.a,{componentRef:this._ftzone,onKeyDown:this.onKeyDown,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,firstFocusableSelector:this._classNameForItemToBeDefaultFocused,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._paneDescribedById,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderStandardListView(),b.createElement("div",{id:this._paneDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle))},t}(b.PureComponent),Ve=r(253),Te=r(469),Ee=Object(y.c)((function(e,t,r,o,n,i,s){void 0===o&&(o=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===s&&(s=!1);var a=V(r);return we(e,t,"",o,n,i,s,a)})),_e=Object(y.c)((function(e,t,r,o,n,i,s){return void 0===r&&(r="#B7472A"),void 0===o&&(o=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===s&&(s=!1),we(e,t,r,o,n,i,s)})),we=Object(y.c)((function(e,t,r,n,i,s,a,d){var p,u,h,g,f,m;return void 0===r&&(r="#B7472A"),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),{root:Object(D.eb)({display:"flex",flexBasis:"78%",flexFlow:"column",minWidth:"400px",flexGrow:1.5,flexShrink:1,height:"100%"}),vhHeader:Object(D.eb)({height:"48px",width:"100%",backgroundColor:c.isVHDarkModeSupported()&&d?d.vhHeaderBackground:"#F4F3F1",display:"flex"}),vhViewer:Object(D.eb)({backgroundColor:c.isVHDarkModeSupported()&&d?d.vhViewerBackground:"#EDEBE9",flexDirection:"column",flexGrow:1,width:"100%",display:e||t?"none":"flex",position:s?"relative":"static"}),backArrow:Object(D.eb)({height:"20px",width:"20px",color:c.isVHDarkModeSupported()&&d?"":"#4A4A4A",marginLeft:"8px",marginRight:"8px",minWidth:"20px",cursor:"pointer",selectors:(p={},p[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{fill:"ButtonText"}),p)},c.isChangeGateEnabled(l.DarkModeHeaderBackArrowColoring)?{}:(u={},u["svg > path.OfficeIconColors_m24"]={fill:c.isVHDarkModeSupported()&&d?d.headerBackArrowAndIterator:"#4A4A4A"},u)),icon:Object(D.eb)({flex:"none",marginTop:"3px",width:"16px",height:"16px"}),backToDoc:Object(D.eb)({height:"16px",whiteSpace:"nowrap",color:c.isVHDarkModeSupported()&&d?d.headerBackArrowAndIterator:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"16px",cursor:"pointer",marginRight:"8px",selectors:(h={},h[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"ButtonText"}),h)}),unselectedVersion:Object(D.eb)({fontStyle:"italic"}),selectedVersionTime:Object(D.eb)({color:c.isVHDarkModeSupported()&&d?d.headerText:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",fontWeight:600,lineHeight:"16px",marginLeft:"10px",marginRight:"10px"}),changesText:Object(D.eb)({display:a?"flex":"none",height:"16px",color:c.isVHDarkModeSupported()&&d?d.headerText:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"16px",marginLeft:"4px",marginRight:"4px"}),changesCountText:Object(D.eb)({display:a?"flex":"none",height:"16px",width:"fill-content",color:c.isVHDarkModeSupported()&&d?d.headerText:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"16px",cursor:"pointer"}),iteratorIcon:Object(D.eb)({display:a?"flex":"none",height:"16px",width:"16px",color:c.isVHDarkModeSupported()&&d?"":"#4A4A4A",justifyContent:"center",lineHeight:"16px",marginLeft:"12px",marginRight:"12px",cursor:"pointer",selectors:(g={},g[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{fill:"ButtonText"}),g)},c.isVHDarkModeSupported()?(f={},f["svg > path.OfficeIconColors_DynamicColor"]={fill:d?d.headerBackArrowAndIterator:""},f):{}),iteratorTooltip:Object(D.eb)({color:c.isVHDarkModeSupported()&&d?d.headerIteratorTooltip:"#252423",fontFace:"ms-fontSize-Secondary12",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px",paddingTop:"4px",shadow:"ms-depth-8"}),viewerNoSelection:Object(D.eb)({display:"flex",flexFlow:"column",alignItems:"center",backgroundColor:c.isVHDarkModeSupported()&&d?d.viewerNoSelectionBackground:"#E4E4E4",color:c.isVHDarkModeSupported()&&d?d.viewerNoSelectionText:"#4A4A4A",height:"100%",width:"100%",paddingTop:"20vh",boxSizing:"border-box",fontSize:"18px"}),viewerError:Object(D.eb)({display:t?"flex":"none",flexFlow:"column",justifyContent:"center",alignItems:"center",backgroundColor:c.isVHDarkModeSupported()&&d?d.viewerErrorBackground:"#EDEBE9",height:"100%",width:"100%"}),viewerErrorMessage:Object(D.eb)({height:"16px",width:"371px",color:c.isVHDarkModeSupported()&&d?d.viewerErrorMessage:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"22px"}),loadingDiv:Object(D.eb)({display:e&&!t?"flex":"none",justifyContent:"center",alignItems:"center",backgroundColor:c.isVHDarkModeSupported()&&d?d.viewerLoadingBackground:"#EDEBE9",height:"100%",width:"100%",flexFlow:"column"}),loadingSpinner:Object(D.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:c.isVHDarkModeSupported()&&d?d.spinnerBorder:"#dddddd",borderTopColor:c.isVHDarkModeSupported()&&d?d.spinnerTopColor:r}}}),hidden:Object(D.eb)({display:"none"}),saveACopyButton:Object(D.eb)({display:n?"flex":"none",lineHeight:"16px",marginLeft:"5px",marginRight:"5px",whiteSpace:"nowrap"}),restoreButton:Object(D.eb)({display:i?"flex":"none",lineHeight:"16px",marginLeft:"5px",marginRight:"5px"}),headerContent:Object(D.eb)({display:"flex",flexGrow:"1",justifyContent:"space-between",width:"100%",overflow:"auto"}),headerContentGroup:Object(D.eb)({display:"flex",justifyContent:"flex-start",alignItems:"center",marginTop:c.isVHDarkModeSupported()?"5px":"",marginBottom:c.isVHDarkModeSupported()?"5px":"",marginLeft:c.isVHDarkModeSupported()?"5px":"4px",marginRight:c.isVHDarkModeSupported()?"5px":"4px"},c.isChangeGateEnabled(l.DarkModeHeaderBackArrowColoring)?(m={},m["#vhHeaderBackArrow svg > path.OfficeIconColors_m24"]={fill:c.isVHDarkModeSupported()&&d?d.headerBackArrowAndIterator:"#4A4A4A"},m):{})}})),xe=r(368),He=Object(y.c)((function(e,t){var r,n,i,s,a,l,d,p,u,h,g,f;if(void 0===t&&(t=!1),c.isVHDarkModeSupported()){var m=V(t),v="",b="",S="",C="",y="",T="",E="",_="",w="",x="",H="",k="",I="";return e?(v=m.headerDefaultButtonColor,b=m.headerDefaultButtonBorder,S=m.headerDefaultButtonFont,C=m.headerDefaultButtonHoverBorderColor,y=m.headerDefaultButtonHoverBackground,T=m.headerDefaultButtonHoverFont,E=m.headerDefaultButtonFocusBorder,_=m.headerDefaultButtonActiveColor,w=m.headerDefaultButtonActiveFont,x=m.headerDefaultButtonActiveBorder,H=m.headerDefaultButtonDisabledBackground,k=m.headerDefaultButtonDisabledText,I=m.headerDefaultButtonDisabledBorder):(v=m.errorDefaultButtonColor,b=m.errorDefaultButtonBorder,y=m.errorDefaultButtonHoverColor,E=m.errorDefaultButtonFocusBorder,_=m.errorDefaultButtonActiveColor),{defaultButton:Object(D.eb)(Object(se.c)()?{overflow:"visible"}:{},{color:S,borderColor:b,background:v,selectors:(r={},r[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"ButtonFace",color:"ButtonText",border:"1px solid ButtonText"}),r[":hover"]={color:T,background:y,borderColor:C,selectors:(n={},n[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText"}),n)},r[":focus"]={borderColor:E,selectors:(i={},i[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{borderColor:"ButtonText"}),i)},r[":active"]={color:w,background:_,borderColor:x,selectors:(s={},s[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"ButtonText"}),s)},r[":disabled"]={color:k,background:H,borderColor:I,selectors:(a={},a[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Window",color:"GrayText",border:"1px solid GrayText"}),a)},r[":focus::after"]={outline:e?"none !important":"",selectors:(l={},l[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{outline:"1px solid ButtonText !important"}),l)},r)})}}return{defaultButton:Object(D.eb)(Object(se.c)()?{overflow:"visible"}:{},{color:e?e.primary:"",borderColor:e?"rgba(200, 198, 196, 1.0)":"",selectors:(d={},d[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"ButtonFace",color:"ButtonText",border:"1px solid ButtonText"}),d[":hover"]={color:e?e.shade10:"",selectors:(p={},p[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText"}),p)},d[":focus"]={borderColor:e?"black":"",selectors:(u={},u[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{borderColor:"ButtonText"}),u)},d[":active"]={color:e?e.shade10:"",selectors:(h={},h[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"ButtonText"}),h)},d[":disabled"]={selectors:(g={},g[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Window",color:"GrayText",border:"1px solid GrayText"}),g)},d[":focus::after"]={outline:e?"none !important":"",selectors:(f={},f[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{outline:"1px solid ButtonText !important"}),f)},d)})}})),ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.button=b.createRef(),t.focus=function(){if(t.button.current){t.button.current.focus();var e=document.getElementById(t.props.id);e&&Object(O.b)(!0,e)}},t}return Object(o.d)(t,e),t.prototype.render=function(){var e=c.isVHDarkModeSupported()?He(this.props.appColors,Object(Y.b)()):He(this.props.appColors);return b.createElement(xe.a,{componentRef:this.button,text:this.props.text,className:[this.props.className,e.defaultButton].join(" "),id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy})},t}(b.PureComponent),Ie=r(1182),Ae=r(70),Oe=Object(y.c)((function(e){var t,r,n,i,s;return void 0===e&&(e=!1),c.isVHDarkModeSupported()&&(s=V(e)),{backArrow:Object(D.eb)({height:"20px",width:"20px",color:c.isVHDarkModeSupported()&&s?"":"#4A4A4A",lineHeight:"16px",marginLeft:"19px",marginRight:"19px",marginTop:"16px",minWidth:"20px",cursor:"pointer",selectors:(t={},t[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{fill:"ButtonText"}),t)},c.isChangeGateEnabled(l.DarkModeHeaderBackArrowColoring)?{}:(r={},r["svg > path.OfficeIconColors_m24"]={fill:c.isVHDarkModeSupported()&&s?s.headerBackArrowAndIterator:"#4A4A4A"},r)),fullAppError:Object(D.eb)({display:"flex",flexFlow:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",backgroundColor:c.isVHDarkModeSupported()&&s?s.fullAppErrorBackground:"#FFFFFF"}),fullAppErrorTop:Object(D.eb)({height:"24px",width:"284px",color:c.isVHDarkModeSupported()&&s?s.fullAppErrorText:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"18px",fontWeight:"300",lineHeight:"24px",textAlign:"center",marginTop:"38px"}),fullAppErrorSub:Object(D.eb)({height:"32px",width:"239px",color:c.isVHDarkModeSupported()&&s?s.fullAppErrorText:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"15px"}),fullAppErrorButtons:Object(D.eb)({display:"flex",flexFlow:"row",marginTop:"33px"}),vhHeader:Object(D.eb)({height:"48px",width:"100%",backgroundColor:c.isVHDarkModeSupported()&&s?s.vhHeaderBackground:"#F4F3F1",display:"flex"},c.isChangeGateEnabled(l.DarkModeHeaderBackArrowColoring)?(n={},n["#vhHeaderBackArrow svg > path.OfficeIconColors_m24"]={fill:c.isVHDarkModeSupported()&&s?s.headerBackArrowAndIterator:"#4A4A4A"},n):{}),backToDoc:Object(D.eb)({height:"16px",width:"97px",color:c.isVHDarkModeSupported()&&s?s.headerBackArrowAndIterator:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginTop:"16px",cursor:"pointer",selectors:(i={},i[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{color:"ButtonText"}),i)}),errorButtons:Object(D.eb)({marginLeft:"5px",marginRight:"5px"})}})),Be=r(606),Fe=Object(y.c)((function(){var e,t,r,n;return{primaryButton:Object(D.eb)(Object(se.c)()?{overflow:"visible"}:{},{minWidth:"auto",selectors:(e={},e[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"ButtonText",color:"ButtonFace",border:"1px solid ButtonFace"}),e[":hover"]={selectors:(t={},t[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"HighlightText"}),t)},e[":active"]={selectors:(r={},r[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"HighlightText"}),r)},e[":disabled"]={selectors:(n={},n[D.l]=Object(o.a)(Object(o.a)({},Object(D.S)()),{backgroundColor:"ButtonFace",color:"GrayText",border:"1px solid GrayText"}),n)},e)})}})),Re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.button=b.createRef(),t.focus=function(){if(t.button.current){t.button.current.focus();var e=document.getElementById(t.props.id);e&&Object(O.b)(!0,e)}},t.getPrimaryButtonTheme=function(e){return c.isVHDarkModeSupported()&&Object(Y.b)()?{semanticColors:{primaryButtonBackground:e.primary,primaryButtonBorder:e.primary,primaryButtonText:"#F3F2F1",primaryButtonBackgroundHovered:e.shade10,primaryButtonTextHovered:"#F3F2F1",primaryButtonBackgroundPressed:e.shade30,primaryButtonTextPressed:"#F3F2F1",focusBorder:"white",primaryButtonBackgroundDisabled:"#797775",primaryButtonTextDisabled:"#605E5C",buttonBorderDisabled:"#3B3A39"}}:{semanticColors:{primaryButtonBackground:e.primary,primaryButtonBackgroundHovered:e.shade10,primaryButtonBackgroundPressed:e.shade20}}},t}return Object(o.d)(t,e),t.prototype.render=function(){var e=Fe();return b.createElement(Be.a,{componentRef:this.button,text:this.props.text,theme:Object(D.K)(this.getPrimaryButtonTheme(this.props.appColors)),className:[this.props.primaryClassName,e.primaryButton].join(" "),id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy})},t}(b.PureComponent);function je(e){var t;switch(e){case 120:t="xlsx";break;case 100:t="pptx";break;case 110:t="docx";break;default:return""}return"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+t+"_48x1_5.svg"}var Ne,Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.d)(t,e),t.prototype.render=function(){return 104===this.props.fullAppError?this.renderVersioningDisabled():this.renderGenericError()},t.prototype.componentDidUpdate=function(){this.setFocusOnLoad()},t.prototype.componentDidMount=function(){this.setFocusOnLoad()},t.prototype.renderHeader=function(e){return b.createElement("div",{id:"vhHeader",className:e.vhHeader},b.createElement(he.a,{id:c.isChangeGateEnabled(l.DarkModeHeaderBackArrowColoring)?"vhHeaderBackArrow":"backArrow",className:e.backArrow,iconName:oe(te.a.ArrowBack_20),onClick:this.props.onCloseSelectedAction}),b.createElement("div",{id:"backToDoc",className:e.backToDoc,onClick:this.props.onCloseSelectedAction},this.props.localizedStrings.ReturnToDoc))},t.prototype.renderErrorImage=function(){return b.createElement("img",{src:je(this.props.appSettings.appName),role:"presentation",alt:"",width:"62",height:"55"})},t.prototype.renderVersioningDisabled=function(){var e=c.isVHDarkModeSupported()?Oe(Object(Y.b)()):Oe(),t=this.props.localizedStrings.VersioningDisabledError,r=this.props.localizedStrings.VersioningDisabledDetails;return this._primaryButtonForFocus=new Re({text:this.props.localizedStrings.BackLabel,primaryClassName:e.errorButtons,id:"VHErrorBackButton",onClick:this.props.onCloseSelectedAction,isDisabled:!1,appColors:this.props.appColors,ariaDescribedBy:t}),b.createElement(b.Fragment,null,this.renderHeader(e),b.createElement("div",{className:e.fullAppError},this.renderErrorImage(),b.createElement("div",{className:e.fullAppErrorTop}," ",t),b.createElement("div",{className:e.fullAppErrorSub},r),b.createElement("div",{className:e.fullAppErrorButtons},b.createElement(Re,{text:this.props.localizedStrings.TryAgainLabel,primaryClassName:e.errorButtons,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!0,appColors:this.props.appColors}),this._primaryButtonForFocus.render())))},t.prototype.renderGenericError=function(){var e=c.isVHDarkModeSupported()?Oe(Object(Y.b)()):Oe(),t=this.props.localizedStrings.FullAppErrorTextTop,r=this.props.localizedStrings.FullAppErrorTextSub;return this._primaryButtonForFocus=new Re({text:this.props.localizedStrings.TryAgainLabel,primaryClassName:e.errorButtons,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!1,appColors:this.props.appColors,ariaDescribedBy:t}),this._defaultButtonForFocus=new ke({text:this.props.localizedStrings.BackLabel,id:"VHErrorBackButton",className:e.errorButtons,onClick:this.props.onCloseSelectedAction}),b.createElement(b.Fragment,null,this.renderHeader(e),b.createElement("div",{className:e.fullAppError},this.renderErrorImage(),b.createElement("div",{className:e.fullAppErrorTop}," ",t),b.createElement("div",{className:e.fullAppErrorSub},r),b.createElement("div",{className:e.fullAppErrorButtons},this._primaryButtonForFocus.render(),this._defaultButtonForFocus.render())))},t.prototype.setFocusOnLoad=function(){this._primaryButtonForFocus&&this._primaryButtonForFocus.focus()},t}(b.PureComponent),Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ftzoneRoot=b.createRef(),t._ftzoneHeader=b.createRef(),t._ftzoneViewer=b.createRef(),t._saveACopyButton=b.createRef(),t._headerId="VersionHistoryHeader",t.onSaveAsClick=function(){t.getVersionInfoFromId(t.props.selectedVersionId,t.props)&&t.props.onSaveACopySelectedAction(t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.DownloadUrl)},t.renderHeader=function(){var e,r=!!t.getVersionInfoFromId(t.props.selectedVersionId,t.props),o=!!t.props.appSettings.wdEnableSaveACopy&&(!t.props.appSettings.wdEnableSaveACopyOverFlowMenu&&!t.props.appSettings.disableSaveACopy),n=!!t.props.appSettings.wdEnableRestore&&t.props.appSettings.wdEnableRestore,i=!!t.props.appSettings.wdEnableIterator&&t.props.appSettings.wdEnableIterator,s=t.props.appSettings.viewerRootPositionRelative,a=!!t.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete&&(t.props.viewerLoading||t.props.viewerError),l=i&&r&&t.props.totalChangesCount>=0&&t.props.currentChange<=t.props.totalChangesCount,d=c.isVHDarkModeSupported()?Ee(t.props.viewerLoading,t.props.viewerError,Object(Y.b)(),o&&r,n&&r&&t.props.versions[0]&&t.props.selectedVersionId!==t.props.versions[0].RevisionID,s,l):_e(t.props.viewerLoading,t.props.viewerError,t.props.appColors.primary,o&&r,n&&r&&t.props.versions[0]&&t.props.selectedVersionId!==t.props.versions[0].RevisionID,s,l);e=r?b.createElement(U,{date:t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.Time,localizedStrings:t.props.localizedStrings}):b.createElement("div",null);var p=0===t.props.totalChangesCount?t.props.localizedStrings.IteratorNoChangesToolTip:"",u=0===t.props.totalChangesCount?p:t.props.localizedStrings.IteratorTotalChangesLabel.replace("{0}",t.props.localizedStrings.IteratorChangesCountLabel.replace("{0}",t.props.currentChange.toString()).replace("{1}",t.props.totalChangesCount.toString()));return t.createRenderHeader(d,a,i,p,u,e)},t.focus=function(){return t._ftzoneRoot.current&&t._ftzoneRoot.current.focus()},t.focusHeader=function(){return t._ftzoneHeader.current&&t._ftzoneHeader.current.focus()},t.focusViewer=function(){return t._ftzoneViewer.current&&t._ftzoneViewer.current.focus()},t.focusSaveACopy=function(){return t._saveACopyButton.current&&t._saveACopyButton.current.focus()},t.getVersionInfoFromId=function(e,t){if(e){var r=Object(Ve.e)(t.versions,(function(t){return t.RevisionID===e}));return r>=0?{Version:t.versions[r]}:void 0}},t.onRestoreClick=function(){t.getVersionInfoFromId(t.props.selectedVersionId,t.props)&&t.props.onRestoreVersionAction(t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.RevisionID)},t.onBackArrowKeyDown=function(e){e.which!==w.a.enter&&e.which!==w.a.space||t.onBackToDocumentClicked()},t.onIteratorPrevKeyDown=function(e){e.which!==w.a.enter&&e.which!==w.a.space||t.onIteratorPrevClick()},t.onIteratorNextKeyDown=function(e){e.which!==w.a.enter&&e.which!==w.a.space||t.onIteratorNextClick()},t.onBackToDocumentClicked=function(){n.a.sendTraceTag(595632281,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"Back to Document clicked"),t.props.onCloseSelectedAction()},t.onIteratorNextClick=function(){t.props.totalChangesCount>0&&(n.a.sendTraceTag(595648670,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"Iterator Next clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),t.props.onIteratorSelectedAction(!0))},t.onIteratorPrevClick=function(){t.props.totalChangesCount>0&&(n.a.sendTraceTag(595648671,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,"Iterator Previous clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),t.props.onIteratorSelectedAction(!1))},t}return Object(o.d)(t,e),t.prototype.render=function(){var e=c.isVHDarkModeSupported()?Ee(this.props.viewerLoading,this.props.viewerError,Object(Y.b)()):_e(this.props.viewerLoading,this.props.viewerError,this.props.appColors.primary);return b.createElement(b.Fragment,null,b.createElement(Ce.a,{componentRef:this._ftzoneRoot,id:this._headerId,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0,"aria-label":this.props.localizedStrings.HeaderAriaLabel,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderHeader()))},t.prototype.createRenderHeader=function(e,t,r,o,n,i){return this.createRenderWithFocusTrapZone(e,t,r,o,n,i)},t.prototype.createRenderWithFocusTrapZone=function(e,t,r,o,n,i){var s=!!this.getVersionInfoFromId(this.props.selectedVersionId,this.props),a=!this.props.paneLoading&&!s;return b.createElement(b.Fragment,null,b.createElement(Ce.a,{componentRef:this._ftzoneHeader,id:"vhHeader",className:e.vhHeader,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},this.renderHeaderComponents(e,t,o,n,i,r)),a?this.renderBlankLoadLabel(e):this.renderErrorHeader(e),b.createElement(Ce.a,{componentRef:this._ftzoneViewer,className:e.vhViewer,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},b.createElement("div",{id:"vhViewer",className:a?e.hidden:e.vhViewer,tabIndex:0})))},t.prototype.renderBackButtonSection=function(e){return b.createElement("div",{className:e.headerContentGroup,onClick:this.onBackToDocumentClicked,tabIndex:0,onKeyDown:this.onBackArrowKeyDown,role:"button"},b.createElement(he.a,{id:c.isChangeGateEnabled(l.DarkModeHeaderBackArrowColoring)?"vhHeaderBackArrow":"backArrow",className:e.backArrow,iconName:oe(te.a.ArrowBack_20)}),b.createElement("div",{id:"backToDoc",className:e.backToDoc,"aria-label":this.props.localizedStrings.ReturnToDoc},this.props.localizedStrings.ReturnToDoc))},t.prototype.renderSelectedVersionSection=function(e,t){return b.createElement(b.Fragment,null,b.createElement("div",{id:"selectedVersionTime",className:e.selectedVersionTime},t))},t.prototype.renderButtonsSection=function(e,t){return b.createElement(b.Fragment,null,b.createElement(ke,{ref:this._saveACopyButton,text:this.props.localizedStrings.SaveACopy,className:e.saveACopyButton,id:"VHSaveACopyButton",onClick:this.onSaveAsClick,isDisabled:t,appColors:this.props.appColors}),b.createElement(ke,{text:this.props.localizedStrings.RestoreLabel,className:e.restoreButton,id:"VHRestoreButton",onClick:this.onRestoreClick,isDisabled:t,appColors:this.props.appColors}))},t.prototype.iteratorBackIcon=function(){return this.props.appSettings.isRtl?te.a.NextChevronPaddle_24:te.a.BackChevronPaddle_24},t.prototype.iteratorNextIcon=function(){return this.props.appSettings.isRtl?te.a.BackChevronPaddle_24:te.a.NextChevronPaddle_24},t.prototype.renderIteratorSection=function(e,t,r,o){if(o){var n=0===this.props.totalChangesCount?this.props.localizedStrings.IteratorPreviousButtonNoChangesString:this.props.localizedStrings.IteratorPreviousButtonXChangesString.replace("{0}",this.props.totalChangesCount.toString()),i=void 0,s=void 0;return c.isVHDarkModeSupported()&&(i={styles:{content:{color:V(Object(Y.b)()).headerIteratorTooltip}}},s={root:{display:"inline-block"}}),b.createElement(b.Fragment,null,b.createElement("div",{id:"ChangesText",className:e.changesText},this.props.localizedStrings.IteratorChangesLabel),b.createElement(Ie.a,{content:0===this.props.totalChangesCount?t:this.props.localizedStrings.IteratorPreviousChangeButtonLabel,directionalHint:Ae.a.topCenter,className:e.iteratorTooltip,tooltipProps:i,styles:s},b.createElement(he.a,{id:"iterateBack",className:e.iteratorIcon,tabIndex:0,"aria-label":this.props.localizedStrings.IteratorPreviousChangeButtonLabel+" . "+n,role:"button",iconName:oe(this.iteratorBackIcon()),onClick:this.onIteratorPrevClick,onKeyDown:this.onIteratorPrevKeyDown})),b.createElement("div",{id:"CountText",className:e.changesCountText,title:t,"aria-label":r},this.props.localizedStrings.IteratorChangesCountLabel.replace("{0}",this.props.currentChange.toString()).replace("{1}",this.props.totalChangesCount.toString())),b.createElement(Ie.a,{content:0===this.props.totalChangesCount?void 0:this.props.localizedStrings.IteratorNextChangeButtonLabel,directionalHint:Ae.a.topCenter,className:e.iteratorTooltip,tooltipProps:i,styles:s},b.createElement(he.a,{id:"iterateFront",className:e.iteratorIcon,title:t,"aria-label":this.props.localizedStrings.IteratorNextChangeButtonLabel,role:"button",tabIndex:0===this.props.totalChangesCount?void 0:0,iconName:oe(this.iteratorNextIcon()),onClick:this.onIteratorNextClick,onKeyDown:this.onIteratorNextKeyDown})))}},t.prototype.renderHeaderComponents=function(e,t,r,o,n,i){return b.createElement(b.Fragment,null,b.createElement("div",{className:e.headerContent},this.renderBackButtonSection(e),b.createElement("div",{className:e.headerContentGroup},this.renderSelectedVersionSection(e,n),this.renderButtonsSection(e,t)),b.createElement("div",{className:e.headerContentGroup},this.renderIteratorSection(e,r,o,i))))},t.prototype.renderBlankLoadLabel=function(e){return b.createElement(b.Fragment,null,b.createElement("div",{"aria-live":"polite",className:e.viewerNoSelection},b.createElement(Te.a,{delay:50},b.createElement("div",null,this.props.localizedStrings.BlankLoadSelectVersionLabel))))},t.prototype.renderErrorHeader=function(e){return b.createElement(b.Fragment,null,b.createElement("div",{className:e.viewerError},b.createElement("img",{src:je(this.props.appSettings.appName),width:"62",height:"55"}),b.createElement("div",{className:e.viewerErrorMessage},this.props.localizedStrings.ViewerAreaErrorText)),b.createElement("div",{className:e.loadingDiv},b.createElement(x.a,{className:e.loadingSpinner,size:H.a.large})))},t}(b.PureComponent),We=Object(y.c)((function(e){var t=V(e);return{loadingSpinner:Object(D.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:t.spinnerBorder,borderTopColor:t.spinnerTopColor}}})}})),ze=Object(y.c)((function(e){return void 0===e&&(e="#B7472A"),{loadingSpinner:Object(D.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:e}}})}})),Ge=r(1898),Ue=r(449),Pe=r(1061);!function(e){e[e.Hidden=1]="Hidden",e[e.CoauthRestoreDisplayed=2]="CoauthRestoreDisplayed",e[e.CoauthRestoreFailedServer=3]="CoauthRestoreFailedServer",e[e.CoauthRestoreInProgress=4]="CoauthRestoreInProgress"}(Ne||(Ne={}));var qe,Xe=function(e){function t(t){return e.call(this,t)||this}return Object(o.d)(t,e),t.prototype.render=function(){var e=c.isVHDarkModeSupported()?We(Object(Y.b)()):ze(this.props.appColors.primary);switch(this.props.modalErrorState){case Ne.CoauthRestoreDisplayed:return b.createElement(Ge.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.a.normal,title:this.props.localizedStrings.OtherEditors,subText:this.props.localizedStrings.OtherEditorsSubtext,showCloseButton:!1}},b.createElement(Pe.a,null,b.createElement(Re,{text:this.props.localizedStrings.RestoreContinue,primaryClassName:"",id:"VHRestorContinue",onClick:this.props.onDismiss,isDisabled:!1,appColors:this.props.appColors})));case Ne.CoauthRestoreInProgress:return b.createElement(Ge.a,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,modalProps:{isModeless:!0,dragOptions:void 0},dialogContentProps:{type:Ue.a.normal,title:this.props.localizedStrings.RestoreInProgress,showCloseButton:!1}},b.createElement(x.a,{className:e.loadingSpinner,size:H.a.large,ariaLabel:this.props.localizedStrings.RestoreInProgress}));case Ne.CoauthRestoreFailedServer:return b.createElement(Ge.a,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.a.normal,title:this.props.localizedStrings.RestoreFailed,subText:this.props.localizedStrings.RestoreFailedSubtext,showCloseButton:!1}},b.createElement(Pe.a,null,b.createElement(Re,{text:this.props.localizedStrings.RestoreContinue,primaryClassName:"",id:"VHRestorContinue",onClick:this.props.refreshCallback,isDisabled:!1,appColors:this.props.appColors})));case Ne.Hidden:default:return null}},t}(b.PureComponent);!function(e){e[e.Hidden=1]="Hidden",e[e.DeleteConfirmation=2]="DeleteConfirmation",e[e.DeleteInProgress=3]="DeleteInProgress",e[e.DeletePartialFailure=4]="DeletePartialFailure",e[e.DeleteFullFailure=5]="DeleteFullFailure"}(qe||(qe={}));var Je=function(e){function t(t){return e.call(this,t)||this}return Object(o.d)(t,e),t.prototype.render=function(){var e=c.isVHDarkModeSupported()?We(Object(Y.b)()):ze(this.props.appColors.primary);switch(this.props.deleteModalErrorState){case qe.DeleteConfirmation:return b.createElement(Ge.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.a.normal,subText:1===this.props.revisionIDsToDeleteCount?this.props.localizedStrings.DeleteIndividualConfirmation:this.props.localizedStrings.DeleteGroupConfirmation.replace("{0}",this.props.revisionIDsToDeleteCount.toString()),title:this.props.localizedStrings.DeleteContinue}},b.createElement(Pe.a,null,b.createElement(Re,{text:this.props.localizedStrings.Delete,primaryClassName:"",id:"VHDeleteContinue",onClick:this.props.deleteVersions,isDisabled:!1,appColors:this.props.appColors}),b.createElement(ke,{text:this.props.localizedStrings.DeleteCancel,id:"VHDeleteCancel",className:"",onClick:this.props.onDismiss})));case qe.DeleteInProgress:return b.createElement(Ge.a,{hidden:!1,isBlocking:!0,dialogContentProps:{type:Ue.a.normal,title:this.props.localizedStrings.Deleting}},b.createElement(x.a,{className:e.loadingSpinner,size:H.a.large,ariaLabel:"Deleting"}));case qe.DeletePartialFailure:return b.createElement(Ge.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.a.normal,title:this.props.localizedStrings.DeleteFailedPartialGroup,subText:this.props.localizedStrings.DeleteFailedPartialGroupFailureCount.replace("{0}",this.props.failedToDeleteCount.toString()).replace("{1}",this.props.revisionIDsToDeleteCount.toString())+" "+this.props.localizedStrings.DeleteFailedTryAgain}},b.createElement(Pe.a,null,b.createElement(Re,{text:this.props.localizedStrings.BackLabel,primaryClassName:"",id:"VHDeletePartialFailure",onClick:this.props.onDismiss,isDisabled:!1,appColors:this.props.appColors})));case qe.DeleteFullFailure:return b.createElement(Ge.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.a.normal,title:1===this.props.revisionIDsToDeleteCount?this.props.localizedStrings.DeleteFailedIndividual:this.props.localizedStrings.DeleteFailedWholeGroup,subText:this.props.localizedStrings.DeleteFailedTryAgain}},b.createElement(Pe.a,null,b.createElement(Re,{text:this.props.localizedStrings.BackLabel,primaryClassName:"",id:"VHDeleteFullFailure",onClick:this.props.onDismiss,isDisabled:!1,appColors:this.props.appColors})));case qe.Hidden:default:return null}},t}(b.PureComponent),Ke=function(e){function t(t){var r=e.call(this,t)||this;return r._ftzone=b.createRef(),r._vhPane=b.createRef(),r._vhHeader=b.createRef(),r._dialogDescribedById=Object(C.a)(),r.renderVersionHistoryDialog=function(){var e=r.props.versions,t={localizedStrings:r.props.localizedStrings,selectedVersionId:r.props.selectedVersionId,selectedGroupName:r.props.selectedGroupName,totalChangesCount:r.props.totalChangesCount,currentChange:r.props.currentChange,onVersionSelectedAction:r.props.onVersionSelectedAction,onCloseSelectedAction:r.props.onCloseSelectedAction,onRestoreVersionAction:r.props.onRestoreVersionAction,onDeleteVersionsSelectedAction:r.props.onDeleteVersionsSelectedAction,paneLoading:r.props.paneLoading,viewerLoading:r.props.viewerLoading,viewerError:r.props.viewerError,fullAppError:r.props.fullAppError,appSettings:r.props.appSettings,appColors:r.props.appColors,modalErrorState:r.props.modalErrorState,deleteModalErrorState:r.props.deleteModalErrorState,refreshCallback:r.props.refreshCallback,revisionIDsToDeleteCount:r.props.revisionIDsToDeleteCount,failedToDeleteCount:r.props.failedToDeleteCount},n=_(t.appSettings.isRtl);return b.createElement(b.Fragment,null,r.props.fullAppError?b.createElement(b.Fragment,null,b.createElement("div",{className:n.fullAppErrorDiv},b.createElement(Me,Object(o.a)({versions:e},t,{getVersions:r.props.getVersions})))):b.createElement(b.Fragment,null,b.createElement(Xe,Object(o.a)({versions:e},t,{onDismiss:r._onDismiss})),b.createElement(Le,Object(o.a)({versions:e},t,{onSaveACopySelectedAction:r.props.onSaveACopySelectedAction,onRestoreVersionAction:r.props.onRestoreVersionAction,onIteratorSelectedAction:r.props.onIteratorSelectedAction,ref:r._vhHeader})),r.props.appSettings.wdEnableDeleteVersions?b.createElement(Je,Object(o.a)({versions:e},t,{onDismiss:r._onDeleteDismiss,deleteVersions:r.props.deleteVersions})):b.createElement(b.Fragment,null),b.createElement(De,Object(o.a)({versions:e},t,{onShowVersionChangesToggledAction:r.props.onShowVersionChangesToggledAction,onDownloadVersionSelectedAction:r.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:r.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:r.props.onDeleteVersionsSelectedAction,ref:r._vhPane}))))},r.focus=function(){return r._vhPane.current&&r._vhPane.current.focus()},r.focusHeader=function(){r._vhHeader.current&&r._vhHeader.current.focusHeader()},r.focusSaveACopy=function(){r._vhHeader.current&&r._vhHeader.current.focusSaveACopy()},r._onDismiss=function(){t.setModalError(Ne.Hidden)},r._onDeleteDismiss=function(){t.setDeleteModalError(qe.Hidden)},r}return Object(o.d)(t,e),t.prototype.render=function(){var e=c.isVHDarkModeSupported()?_(this.props.appSettings.isRtl,Object(Y.b)()):_(this.props.appSettings.isRtl),t=this.props.localizedStrings;return b.createElement(Ce.a,{componentRef:this._ftzone,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._dialogDescribedById,role:"group","aria-roledescription":t.VersionHistoryTitle},b.createElement("div",{className:e.dialog},this.renderVersionHistoryDialog(),b.createElement("div",{id:this._dialogDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle)))},t.prototype.focusViewer=function(){this._vhHeader.current&&this._vhHeader.current.focusViewer()},t}(b.PureComponent),Ye=r(186);var Ze,Qe=r(2125),$e=r(782),et=r(404);function tt(e,t,r){return versionHistorySprite&&(versionHistorySprite.icons=versionHistorySprite.icons.map((function(e){return Object(o.a)(Object(o.a)({},e),{id:oe(e.id)})})),Object(D.jb)({icons:Object(Ye.iconSpriteToReactMap)(versionHistorySprite)}),versionHistorySprite=void 0),new Promise((function(n){S.render(b.createElement(rt,Object(o.a)({ref:function(e){return n(e)}},t,r)),e)}))}!function(e){e[e.SelectOlderSubsection=1]="SelectOlderSubsection",e[e.SelectNewerSubsection=2]="SelectNewerSubsection",e[e.SelectOlderVersion=3]="SelectOlderVersion",e[e.SelectNewerVersion=4]="SelectNewerVersion",e[e.SelectTipSubsection=5]="SelectTipSubsection"}(Ze||(Ze={}));var rt=function(e){function t(t){var r=e.call(this,t)||this;return r._dialog=b.createRef(),r.selectedVersionId=null,r.onVersionSelectedAction=function(e){if(e.currentVersion&&e.currentVersion.RevisionID){if(n.a.sendTraceTag(595933192,i.a.msoulscat_Wac_VersionHistory,s.a.Info,r.getLoggableVersionInfoString("onVersionSelectedAction - Version selected in pane",e.currentVersion.RevisionID,r.state)),r.selectedVersionId=e.currentVersion.RevisionID?e.currentVersion.RevisionID:void 0,e.currentVersion.DownloadUrl)n.a.sendTraceTag(595907534,i.a.msoulscat_Wac_VersionHistory,s.a.Info,r.getLoggableVersionInfoString("selectVersion - Version selected in pane",e.currentVersion.RevisionID,r.state)),r.setState({selectedVersionId:r.selectedVersionId,selectedGroupName:e.groupName?e.groupName:void 0,viewerError:!1,viewerLoading:!!r.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete},(function(){return r.props.onVersionSelectedAction(e)}));else{r.setState({selectedVersionId:r.selectedVersionId,viewerError:!1,viewerLoading:!0});var t=[e.currentVersion.RevisionID];e.baseVersion&&e.baseVersion.RevisionID&&t.push(e.baseVersion.RevisionID),r.props.getDownloadToken(t,e)}if(e.currentVersion.DownloadUrl&&e.baseVersion&&e.baseVersion.RevisionID&&!e.baseVersion.DownloadUrl){t=[e.currentVersion.RevisionID,e.baseVersion.RevisionID];r.props.getDownloadToken(t,e)}}},r.onCloseSelectedAction=function(){r.props.onCloseSelectedAction(),r.resetState(),r.disableSearchBar(!1)},r.onSaveACopySelectedAction=function(e){n.a.sendTraceTag(595903688,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,r.getLoggableVersionInfoString("onSaveACopySelectedAction",r.state.selectedVersionId,r.state)),r.props.onSaveACopySelectedAction(e)},r.onDownloadVersionSelectedAction=function(e){n.a.sendTraceTag(593072918,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,r.getLoggableVersionInfoString("onDownloadVersionSelectedAction",r.state.selectedVersionId,r.state)),r.props.onDownloadVersionSelectedAction(e)},r.onRestoreVersionAction=function(e){n.a.sendTraceTag(595892446,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,r.getLoggableVersionInfoString("onRestoreVersionAction",e,r.state)),r.props.onRestoreVersionAction(e)},r.onDeleteVersionsSelectedAction=function(e){n.a.sendTraceTag(590147609,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,1===e.length?r.getLoggableVersionInfoString("onDeleteVersionsSelectedAction",e[0],r.state):r.getLoggableVersionInfoString("onDeleteVersionsSelectedAction with {0} versions, info for most recent version in group".replace("{0}",e.length.toString()),e[0],r.state));var t=e.length;r.setState({revisionIDsToDeleteCount:t}),r.props.onDeleteVersionsSelectedAction(e)},r.getInitState=function(){return{versions:[],selectedVersionId:void 0,selectedGroupName:void 0,totalChangesCount:0,currentChange:0,paneLoading:!0,viewerLoading:!0,viewerError:!1,fullAppError:0,modalErrorState:Ne.Hidden,deleteModalErrorState:qe.Hidden,revisionIDsToDeleteCount:0,failedToDeleteCount:0,refreshCallback:function(){}}},r.resetState=function(){r.setState(r.getInitState())},r.getAgeOfTime=function(e){return Date.now()-e.getTime()},r.getVersionInfoFromId=function(e,t){if(e){var r=Object(Ve.e)(t.versions,(function(t){return t.RevisionID===e}));return r>=0?{version:t.versions[r],index:r}:void 0}},r.getLoggableVersionInfoString=function(e,t,o){var n=r.getVersionInfoFromId(t,o);if(n){var i=n.version,s=n.index,a=i.Time?r.getAgeOfTime(i.Time):"-1";return JSON.stringify({msg:e,revisionId:i.RevisionID,revisionAge:a,revisionIndex:s})}return""},r.getGroupTipFromVersion=function(e,t){if(t<0||t>e.length)return n.a.sendTraceTag(589312481,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"getGroupTipFromVersion: index out of bounds: currIndex = {0}".replace("{0}",t.toString())),e[0];if(0===t)return e[0];var o=e[t],a=t-1,l=e[a];for(a-=1;l&&r.areVersionsInSameGroup(o,l);)o=l,l=e[a],a-=1;return o},r.areVersionsInSameGroup=function(e,t){var r,o,n,i,s,a;return e===t||(null===(r=null==e?void 0:e.Time)||void 0===r?void 0:r.getDate())===(null===(o=null==t?void 0:t.Time)||void 0===o?void 0:o.getDate())&&(null===(n=null==e?void 0:e.Time)||void 0===n?void 0:n.getMonth())===(null===(i=null==t?void 0:t.Time)||void 0===i?void 0:i.getMonth())&&(null===(s=null==e?void 0:e.Time)||void 0===s?void 0:s.getFullYear())===(null===(a=null==t?void 0:t.Time)||void 0===a?void 0:a.getFullYear())},r.showDeleteFullOrPartialFailure=function(e,t){return e<=0?(n.a.sendTraceTag(589312482,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"showDeleteFullOrPartialFailure: no versions to delete: toDelete = {0}".replace("{0}",e.toString())),!0):e===t?(r.setDeleteModalError(qe.DeleteFullFailure),!0):(t>0&&(r.setState({failedToDeleteCount:t}),r.setDeleteModalError(qe.DeletePartialFailure)),!1)},r.removeVersions=function(e,t){var o=e.filter((function(e){return!t.includes(e)}));return r.state.versions.filter((function(e){return!e.RevisionID||!o.includes(e.RevisionID)}))},r.selectAfterDelete=function(e,t,o){var a,l;if(0===e)return n.a.sendTraceTag(589312483,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"selectAfterDelete: attempting to delete tip version"),Ze.SelectTipSubsection;if(e<0||e-1>=t.length)return n.a.sendTraceTag(589312512,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"selectAfterDelete: firstIndexDeleted out of bounds: currIndex = {0}".replace("{0}",e.toString())),Ze.SelectTipSubsection;a=t[e-1],l=e>=t.length?void 0:t[e];var c=r.state.versions[e];return o?l?Ze.SelectOlderSubsection:Ze.SelectNewerSubsection:r.areVersionsInSameGroup(c,l)?Ze.SelectOlderVersion:r.areVersionsInSameGroup(c,a)?Ze.SelectNewerVersion:l?Ze.SelectOlderSubsection:Ze.SelectNewerSubsection},r.state=r.getInitState(),r.setModalError=r.setModalError.bind(r),r.setDeleteModalError=r.setDeleteModalError.bind(r),r.setRefreshCallback=r.setRefreshCallback.bind(r),r.disableSearchBar(!0),n.a.sendTraceTag(595933189,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"Pane constructed"),r}return Object(o.d)(t,e),t.prototype.insertVersions=function(e){n.a.sendTraceTag(595933190,i.a.msoulscat_Wac_VersionHistory,s.a.Info,JSON.stringify({msg:"insertVersions",count:e.length})),this.setState({versions:e})},t.prototype.insertVersionsAndClearLoading=function(e){n.a.sendTraceTag(592066071,i.a.msoulscat_Wac_VersionHistory,s.a.Info,JSON.stringify({msg:"insertVersions and clear pane and viewer loading",count:e.length})),this.setState({versions:e,paneLoading:!1,viewerLoading:!1})},t.prototype.removeVersionsAndSelectNext=function(e,t){n.a.sendTraceTag(589939200,i.a.msoulscat_Wac_VersionHistory,s.a.Info,JSON.stringify({msg:"removeVersionsAndSelectNext",count:e.length-t.length}));var r=!1,o=!1;if(!(t.length>0&&(o=!(r=this.showDeleteFullOrPartialFailure(e.length,t.length)),r))){var a=this.state.versions.findIndex((function(t){return t.RevisionID===e[0]})),l=this.removeVersions(e,t),c=this.selectAfterDelete(a,l,o),d=l[a],p=l[a+1],u=l[a-1],h=d;switch(c){case Ze.SelectTipSubsection:this.setVersionsAndSelectSubSection(l,l[0]);break;case Ze.SelectOlderVersion:this.setVersionsAndSelectVersion(l,{currentVersion:d,baseVersion:p,noBaseToCompareTo:!p});break;case Ze.SelectNewerVersion:this.setVersionsAndSelectVersion(l,{currentVersion:u,baseVersion:h,noBaseToCompareTo:!h});break;case Ze.SelectOlderSubsection:this.setVersionsAndSelectSubSection(l,d);break;case Ze.SelectNewerSubsection:this.setVersionsAndSelectSubSection(l,this.getGroupTipFromVersion(l,a-1))}o||this.setDeleteModalError(qe.Hidden)}},t.prototype.setVersionsAndSelectSubSection=function(e,t){this._dialog&&this._dialog.current&&t?(n.a.sendTraceTag(592066072,i.a.msoulscat_Wac_VersionHistory,s.a.Info,JSON.stringify({msg:"insertVersions and select subsection",count:e.length})),this.setState({versions:e,paneLoading:!1,selectedGroupName:t.RevisionID?t.RevisionID:void 0})):(n.a.sendTraceTag(592066073,i.a.msoulscat_Wac_VersionHistory,s.a.Info,JSON.stringify({msg:"insertVersions and clear pane loading",count:e.length})),this.setState({versions:e,paneLoading:!1}))},t.prototype.setTotalChangesCount=function(e){this._dialog&&this._dialog.current&&this.setState({totalChangesCount:e})},t.prototype.setCurrentChangeCount=function(e){this._dialog&&this._dialog.current&&this.setState({currentChange:e})},t.prototype.setViewerLoading=function(e){this.setState({viewerLoading:e})},t.prototype.setViewerError=function(e){this.setState({viewerError:e})},t.prototype.setFullAppErrorCode=function(e){this.setState({fullAppError:e})},t.prototype.hitFullAppError=function(e){this.setState({fullAppError:e,viewerLoading:!1,paneLoading:!1,viewerError:!1})},t.prototype.disableSearchBar=function(e){Object($e.a)(et.a)(Object(Qe.a)(e))},t.prototype.getVersionsTriggered=function(){this.resetState(),this.disableSearchBar(!0)},t.prototype.setModalError=function(e){this.setState({modalErrorState:e})},t.prototype.setDeleteModalError=function(e){this.setState({deleteModalErrorState:e})},t.prototype.setRefreshCallback=function(e){this.setState({refreshCallback:e})},t.prototype.setRestoreFailedAtServer=function(e,t){this.setState({modalErrorState:e,refreshCallback:t})},t.prototype.setVersionsAndSelectVersion=function(e,t){var r=this;if(t.currentVersion&&t.currentVersion.RevisionID){var o=this.state.viewerLoading;n.a.sendTraceTag(595907534,i.a.msoulscat_Wac_VersionHistory,s.a.Info,this.getLoggableVersionInfoString("selectVersion - Version selected in pane",t.currentVersion.RevisionID,this.state)),this.selectedVersionId=t.currentVersion.RevisionID;var a=this.selectedVersionId,l=t.groupName?t.groupName:void 0;o=!!this.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete,n.a.sendTraceTag(592066074,i.a.msoulscat_Wac_VersionHistory,s.a.Info,JSON.stringify({msg:"insertVersions during select",count:e.length})),this.setState({versions:e,paneLoading:!1,viewerLoading:o,selectedVersionId:a,selectedGroupName:l,viewerError:!1},(function(){return r.props.onVersionSelectedAction(t)}))}},t.prototype.render=function(){return b.createElement(Ke,Object(o.a)({ref:this._dialog,setModalError:this.setModalError,setDeleteModalError:this.setDeleteModalError,setRefreshCallback:this.setRefreshCallback},this.props,this.state,{onVersionSelectedAction:this.onVersionSelectedAction,onCloseSelectedAction:this.onCloseSelectedAction,onSaveACopySelectedAction:this.onSaveACopySelectedAction,onDownloadVersionSelectedAction:this.onDownloadVersionSelectedAction,onRestoreVersionAction:this.onRestoreVersionAction,onDeleteVersionsSelectedAction:this.onDeleteVersionsSelectedAction,getVersions:this.props.getVersions,deleteVersions:this.props.deleteVersions,appColors:this.props.appColors,setSaveACopyCanceled:this.setSaveACopyCanceled}))},t.prototype.enterFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focus()},t.prototype.enterHeaderFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focusHeader()},t.prototype.setSaveACopyCanceled=function(){if(this.props.appSettings.wdEnableSaveACopyOverFlowMenu){var e=this.state.versions,t=this.state.selectedVersionId,r=this.state.selectedGroupName,o=this.state.versions.findIndex((function(e){return e.RevisionID===t})),n=e[-1===o?0:o];if(r)this.setVersionsAndSelectSubSection(e,n);else{var i=e[o+1];this.setVersionsAndSelectVersion(e,{currentVersion:n,baseVersion:i,noBaseToCompareTo:!i})}}else this._dialog.current&&this._dialog.current.focusSaveACopy()},t.prototype.enterViewerFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focusViewer()},t}(b.PureComponent),ot={shade30:"#0e336a",shade20:"#13458f",shade10:"#1651aa",primary:"#185abd",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4"},nt={shade30:"#0e336a",shade20:"#002050",shade10:"#124078",primary:"#2b579a",tint10:"#3c65a4",tint20:"#4a78b0",tint30:"#7da3c6",tint40:"#a5b9d1"},it={shade30:"#6e220f",shade20:"#740912",shade10:"#a92b1a",primary:"#b7472a",tint10:"#c75033",tint20:"#e86e58",tint30:"#ed9583",tint40:"#fdc9b5"},st={shade30:"#094624",shade20:"#0C5F32",shade10:"#0F703B",primary:"#107C41",tint10:"#218D51",tint20:"#55B17E",tint30:"#A0D8B9",tint40:"#CAEAD8"};var at=function(){function e(e,t,r,o,i,s,a,l){this._onVersionsReadyEvent=new v,this._onDownloadTokenReadyEvent=new v,this._fullAppErrorEvent=new v,this._onVersionSelectedEvent=new v,this._onTipVersionTokenReadyEvent=new v,this._onCloseSelectedEvent=new v,this._onSaveACopySelectedEvent=new v,this._onDownloadVersionSelectedEvent=new v,this._onRestoreVersionSelectedEvent=new v,this._onIteratorSelectedEvent=new v,this._onAppRefreshTriggeredEvent=new v,this._onShowVersionChangesToggledEvent=new v,n.a.setLogger(t),this._perfTelemetryInfos=l,this._appSettings=a||{appName:0,wdEnableDownloadTokens:!1,retryCount:3,wdEnableSaveACopy:!1,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:"",wacCluster:"",uiLocale:"en-us",isRtl:!1,useXhr:!1,viewerRootPositionRelative:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,disabledChangeGates:"",wdEnableDownloadVersion:!1,wdEnableAppColorUpdate:!1},g.UILocale=this._appSettings.uiLocale,this._versionHistoryStringsBag=e,this._versionHistoryCache=new m(this._onVersionsReadyEvent,this._onDownloadTokenReadyEvent,this._fullAppErrorEvent,this._onTipVersionTokenReadyEvent,r,o,this._appSettings,i,s,this._perfTelemetryInfos),this._revisionIDsToDelete=[],this._onVersionsReadyEvent.addListener(this.onVersionsReady.bind(this)),this._onDownloadTokenReadyEvent.addListener(this.onDownloadTokenReady.bind(this)),this._fullAppErrorEvent.addListener(this.fullAppError.bind(this)),this._onTipVersionTokenReadyEvent.addListener(this.onTipVersionTokenReady.bind(this)),c.setDisabledChangeGates(this._appSettings.disabledChangeGates||"")}return e.prototype.createVersionHistoryDialog=function(e){var t,r=this,o=Date.now();if(n.a.sendTraceTag(590144343,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,JSON.stringify({event:"createVersionHistoryDialog: started",startTime:o})),e){null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogStart",TelemetryEventData:o.toString()});var a={onVersionSelectedAction:this._onVersionSelectedEvent.fireEvent.bind(this._onVersionSelectedEvent),onCloseSelectedAction:this._onCloseSelectedEvent.fireEvent.bind(this._onCloseSelectedEvent),onSaveACopySelectedAction:this._onSaveACopySelectedEvent.fireEvent.bind(this._onSaveACopySelectedEvent),onDownloadVersionSelectedAction:this._onDownloadVersionSelectedEvent.fireEvent.bind(this._onDownloadVersionSelectedEvent),onRestoreVersionAction:this._onRestoreVersionSelectedEvent.fireEvent.bind(this._onRestoreVersionSelectedEvent),onDeleteVersionsSelectedAction:function(e){return r.onDeleteVersionsSelectedEvent(e)},onIteratorSelectedAction:this._onIteratorSelectedEvent.fireEvent.bind(this._onIteratorSelectedEvent),onShowVersionChangesToggledAction:this._onShowVersionChangesToggledEvent.fireEvent.bind(this._onShowVersionChangesToggledEvent),getVersions:function(){return r.getVersions()},getDownloadToken:function(e,t){return r.getDownloadToken(e,t)},deleteVersions:function(){return r.deleteVersions()}},l=nt;if(this._appSettings.appName)switch(this._appSettings.appName){case 110:l=!!this._appSettings.wdEnableAppColorUpdate?ot:nt;break;case 100:l=it;break;case 120:l=st;break;default:n.a.sendTraceTag(592548236,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"invalid app name used"+this._appSettings.appName)}else n.a.sendTraceTag(592548237,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"no app name was passed in");return c.isVHDarkModeSupported()&&(t=l,E.versionCardRootSelectedBoxShadow=t.primary,E.spinnerTopColor=t.primary,T.versionCardRootSelectedBoxShadow=t.primary,T.headerDefaultButtonFont=t.primary,T.headerDefaultButtonHoverFont=t.shade10,T.headerDefaultButtonActiveFont=t.shade10,T.spinnerTopColor=t.primary),tt(e,{localizedStrings:this._versionHistoryStringsBag,appSettings:this._appSettings,appColors:l},a).then((function(e){return r._versionHistoryDialog=e,r._versionHistoryDialog.insertVersions(r._versionHistoryCache.Versions),null!=r._perfTelemetryInfos&&r._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogEnd",TelemetryEventData:Date.now().toString()}),n.a.sendTraceTag(590144344,i.a.msoulscat_Wac_VersionHistory,s.a.Warning,JSON.stringify({event:"createVersionHistoryDialog: ended",error:"None",startTime:o,duration:Date.now()-o,versionCount:r._versionHistoryCache.Versions.length})),e}))}return n.a.sendTraceTag(590144345,i.a.msoulscat_Wac_VersionHistory,s.a.Error,JSON.stringify({event:"createVersionHistoryDialog: ended",error:"no containerElement",startTime:o,duration:Date.now()-o})),Promise.reject(void 0)},e.prototype.getTipVersion=function(){return Object(o.b)(this,void 0,void 0,(function(){var e;return Object(o.e)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this._versionHistoryCache.getTipVersion()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),n.a.sendTraceTag(591680147,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"VersionHistoryController.getTipVersion: unexpected exception, error: "+e.message),[3,3];case 3:return[2]}}))}))},e.prototype.getVersions=function(){return Object(o.b)(this,void 0,void 0,(function(){var e;return Object(o.e)(this,(function(t){switch(t.label){case 0:this._versionHistoryDialog&&this._versionHistoryDialog.getVersionsTriggered(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._versionHistoryCache.getVersions()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),n.a.sendTraceTag(591680148,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"VersionHistoryController.getVersions: unexpected exception, error: "+e.message),[3,4];case 4:return[2]}}))}))},e.prototype.setVersionLoadComplete=function(){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(e){return this._versionHistoryDialog&&(n.a.sendTraceTag(588335171,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"Version done loading"),this._versionHistoryDialog.setViewerLoading(!1)),[2]}))}))},e.prototype.setTotalChangesCount=function(e){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(t){return this._versionHistoryDialog&&(n.a.sendTraceTag(595658889,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"setTotalChangesCount with count:"+e.toString()),this._versionHistoryDialog.setTotalChangesCount(e)),[2]}))}))},e.prototype.setCurrentChangeCount=function(e){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(t){return this._versionHistoryDialog&&(n.a.sendTraceTag(595658890,i.a.msoulscat_Wac_VersionHistory,s.a.Info,"setCurrentChangeCount with count:"+e.toString()),this._versionHistoryDialog.setCurrentChangeCount(e)),[2]}))}))},e.prototype.setFullAppErrorCode=function(e){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(t){return this._versionHistoryDialog&&this._versionHistoryDialog.setFullAppErrorCode(e),[2]}))}))},e.prototype.setViewerError=function(e){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(t){return e&&n.a.sendTraceTag(587309088,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"setViewerError with true"),this._versionHistoryDialog&&this._versionHistoryDialog.setViewerError(e),[2]}))}))},e.prototype.setCoauthRestoreError=function(){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(e){return this._versionHistoryDialog&&(this._versionHistoryDialog.setModalError(Ne.Hidden),this._versionHistoryDialog.setModalError(Ne.CoauthRestoreDisplayed)),[2]}))}))},e.prototype.setRestoreFailedAtServer=function(e){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(t){return this._versionHistoryDialog&&e&&this._versionHistoryDialog.setRestoreFailedAtServer(Ne.CoauthRestoreFailedServer,e),[2]}))}))},e.prototype.setRestoreInProgress=function(){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setModalError(Ne.CoauthRestoreInProgress),[2]}))}))},e.prototype.setDeleteConfirmation=function(){this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(qe.DeleteConfirmation)},e.prototype.setDeleteInProgress=function(){this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(qe.DeleteInProgress)},e.prototype.setDeletePartialFailure=function(){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(qe.DeletePartialFailure),[2]}))}))},e.prototype.setDeleteFullFailure=function(){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(qe.DeleteFullFailure),[2]}))}))},e.prototype.setDisableSaveACopy=function(e){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(t){return this._appSettings&&(this._appSettings.disableSaveACopy=e),[2]}))}))},e.prototype.setSaveACopyCanceled=function(){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.e)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setSaveACopyCanceled(),[2]}))}))},e.prototype.getDownloadToken=function(e,t){return Object(o.b)(this,void 0,void 0,(function(){var r;return Object(o.e)(this,(function(o){switch(o.label){case 0:if(!this._versionHistoryDialog)return[3,4];this._versionHistoryDialog.setFullAppErrorCode(0),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._versionHistoryCache.getDownloadToken(e,t)];case 2:return o.sent(),[3,4];case 3:return r=o.sent(),n.a.sendTraceTag(591680149,i.a.msoulscat_Wac_VersionHistory,s.a.Error,"VersionHistoryController.getDownloadToken: unexpected exception, error: "+r.message),[3,4];case 4:return[2]}}))}))},e.prototype.deleteVersions=function(){var e,t;return Object(o.b)(this,void 0,void 0,(function(){var r;return Object(o.e)(this,(function(o){switch(o.label){case 0:return this.setDeleteInProgress(),[4,this._versionHistoryCache.deleteVersions(this._revisionIDsToDelete)];case 1:return r=o.sent(),null===(e=this._versionHistoryDialog)||void 0===e||e.setDeleteModalError(qe.Hidden),r&&(null===(t=this._versionHistoryDialog)||void 0===t||t.removeVersionsAndSelectNext(this._revisionIDsToDelete,r)),[2]}}))}))},e.prototype.getVersionSelectedEvent=function(){return this._onVersionSelectedEvent},e.prototype.getCloseSelectedEvent=function(){return this._onCloseSelectedEvent},e.prototype.getSaveACopySelectedEvent=function(){return this._onSaveACopySelectedEvent},e.prototype.getDownloadVersionSelectedEvent=function(){return this._onDownloadVersionSelectedEvent},e.prototype.getRestoreVersionSelectedEvent=function(){return this._onRestoreVersionSelectedEvent},e.prototype.getIteratorSelectedEvent=function(){return this._onIteratorSelectedEvent},e.prototype.getVersionsReadyEvent=function(){return this._onVersionsReadyEvent},e.prototype.getAppRefreshTriggeredEvent=function(){return this._onAppRefreshTriggeredEvent},e.prototype.getDownloadTokenReadyEvent=function(){return this._onDownloadTokenReadyEvent},e.prototype.getTipVersionTokenReadyEvent=function(){return this._onTipVersionTokenReadyEvent},e.prototype.getFullAppErrorEvent=function(){return this._fullAppErrorEvent},e.prototype.getShowVersionChangesToggledEvent=function(){return this._onShowVersionChangesToggledEvent},e.prototype.onVersionsReady=function(e){this._versionHistoryDialog&&e&&e.versions&&this._versionHistoryDialog.insertVersionsAndClearLoading(e.versions.filter((function(e){return e})))},e.prototype.onDownloadTokenReady=function(e){if(this._versionHistoryDialog&&e&&e.updatedVersions){var t=e.updatedVersions.filter((function(e){return e}));!e.versionSelected||!e.versionSelected.currentVersion||this._versionHistoryDialog.selectedVersionId&&this._versionHistoryDialog.selectedVersionId!==e.versionSelected.currentVersion.RevisionID?this._versionHistoryDialog.insertVersions(t):this._versionHistoryDialog.setVersionsAndSelectVersion(t,e.versionSelected)}},e.prototype.onTipVersionTokenReady=function(e){if(this._versionHistoryDialog&&e&&e.tipVersion&&e.tipVersion.DownloadUrl&&e.updatedVersions&&e.updatedVersions[0]&&e.tipVersion.DownloadUrl===e.updatedVersions[0].DownloadUrl){var t=e.updatedVersions.filter((function(e){return e}));this._versionHistoryDialog.selectedVersionId&&this._versionHistoryDialog.selectedVersionId!==e.updatedVersions[0].RevisionID?this._versionHistoryDialog.insertVersions(t):this._versionHistoryDialog.setVersionsAndSelectVersion(t,{currentVersion:e.updatedVersions[0],noBaseToCompareTo:!1})}},e.prototype.onDeleteVersionsSelectedEvent=function(e){this._revisionIDsToDelete=e,this.setDeleteConfirmation()},e.prototype.fullAppError=function(e){this._versionHistoryDialog&&this._versionHistoryDialog.hitFullAppError(e)},e}(),lt=function(){function e(){}return e.createVersionHistoryController=function(e,t,r,n,i,s,a){var l=Object(o.a)(Object(o.a)({},OfficeVersionHistoryStrings),FriendlyDatesStrings);return new at(l,e,t,r,n,i,s,a)},e}(),ct=new(function(){function e(){}return e.prototype.getVersionHistoryControllerInstance=function(e){if(e&&e.docId&&e.ulsLogger)return lt.createVersionHistoryController(e.ulsLogger,null===e.serviceBase||void 0===e.serviceBase?"":e.serviceBase,e.docId,null===e.latestStreamServiceBase||void 0===e.latestStreamServiceBase?"":e.latestStreamServiceBase,void 0,e.appSettings,e.perfTelemetryInfos)},e}());r.d(t,"FactoryGlobal",(function(){return ct}))},252:function(e,t){e.exports={CancelGlyph_16:"CancelGlyph_16",ArrowStyle3_20:"ArrowStyle3_20",ArrowBack_20:"ArrowBack_20",BackChevronPaddle_24:"BackChevronPaddle_24",NextChevronPaddle_24:"NextChevronPaddle_24",CommonControlChevronRight_16:"CommonControlChevronRight_16",CommonControlChevronLeft_16:"CommonControlChevronLeft_16",CommonControlChevronDown_16:"CommonControlChevronDown_16",UpChevronMedium_20:"UpChevronMedium_20",DownChevronMedium_20:"DownChevronMedium_20",CommonControlMore_12:"CommonControlMore_12",Ellipsis_12:"Ellipsis_12",HintBarEllipses_20:"HintBarEllipses_20",CommonControlChevronDown_8:"CommonControlChevronDown_8",CommonControlChevronDownGlyph_12:"CommonControlChevronDownGlyph_12",CommonControlChevronUp_8:"CommonControlChevronUp_8",CommonControlChevronRight_12:"CommonControlChevronRight_12",CommonControlChevronRight_16:"CommonControlChevronRight_16",CommonControlChevronLeft_16:"CommonControlChevronLeft_16",CommonControlCheckboxCheck_16:"CommonControlCheckboxCheck_16",CheckmarkWithDynamicColor_16:"CheckmarkWithDynamicColor_16",CommonControlDialogLauncher_8:"CommonControlDialogLauncher_8"}},93:function(e,t){e.exports=otel}},[[1759,2,0,1]]]);
//# sourceMappingURL=versionHistory.min.js.map