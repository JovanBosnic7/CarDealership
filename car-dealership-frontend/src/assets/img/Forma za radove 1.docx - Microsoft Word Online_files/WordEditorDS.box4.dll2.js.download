'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{102:function(z,H,b){b.d(H,"a",function(){return E});z=b(0);var f=b(21),c=b(48),n=b(2),m=b(268),x=b(90),y=b(351),v=b(180),t=b(37),A=b(201),D=b(11),U=b(162),F=b(269);class E{static get Pb(){return E.fc||(E.fc=f.a.instance.resolve("Box4.Styles.IWACStyleReader"))}static oNf(P){switch(P){case 2:return WordEditorIntl.WordEditorStrings.L_TrackChangeDeletionType;case 1:return WordEditorIntl.WordEditorStrings.L_TrackChangeInsertionType;
case 3:return WordEditorIntl.WordEditorStrings.L_TrackChangeFormatType}return null}static A8d(P){const G=new Sys.StringBuilder;P.authorName&&G.append(P.authorName+" ");P.Ij&&G.append(P.Ij.localeFormat(String.format("{0} {1}",Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortDatePattern,Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortTimePattern)));return G.toString()}static dZb(P,G){return P&&G?P.changeType===G.changeType&&P.authorName===G.authorName:!1}static uVf(P,G){return P&&G?3!==P.changeType&&
P.authorName===G.authorName:!1}static E_d(P,G){if(!(P&&G&&P.hd&&G.hd&&Object(A.a)(m.a,P.hd)&&Object(A.a)(m.a,G.hd)))return!1;P=P.hd;G=G.hd;return P&&G?P.authorName===G.authorName&&(1===P.changeType&&2===G.changeType||2===P.changeType&&1===G.changeType):!1}static kpc(P,G){if(!(P&&G&&P.hd&&G.hd)||3!==P.hd.changeType||3!==G.hd.changeType)return!1;const K=E.ZWa(P);P=E.x_b(P);const S=E.ZWa(G);G=E.x_b(G);return K&&S||P&&G||!K&&!S&&!P&&!G}static $wf(P,G,K,S){return E.kpc(G,S)&&(P=P.ka.Vg(G.Od),K=K.ka.Vg(S.Od),
P&&K)?E.Sgf(P.Gl.sk,P.formatting.sk,K.Gl.sk,K.formatting.sk):!1}static Sgf(P,G,K,S){G=G||new x.a;S=S||new x.a;P=P||new x.a;K=K||new x.a;P=P.nZ(G);K=K.nZ(S);return P.equals(K)}static x_b(P){return P&&P.hd?3===P.hd.changeType&&Object(A.a)(y.a,P.hd)&&!!P.hd.Zpb&&15===P.hd.Zpb.type:!1}static ZWa(P){return P&&P.hd?3===P.hd.changeType&&Object(A.a)(m.a,P.hd)&&!P.Od&&-1===P.endCp:!1}static MQb(P,G,K){return E.ae(P,G,t.a.paragraphStyle)!==E.ae(P,K,t.a.paragraphStyle)}static M1d(P,G,K){return E.ae(P,G,t.a.yw)!==
E.ae(P,K,t.a.yw)}static r1h(P){return P?P.localeFormat(String.format("{0} {1}",Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortDatePattern,Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortTimePattern)):""}static ae(P,G,K){let S="Normal";G&&G.hasProperty(K)&&(G=G.ha(K,c.a.nil),G!==c.a.nil&&(P=P.Sb.Va(G),P=new v.a(P),S=E.Pb.ae(P)));return S}static i8a(P){return!!P&&""!==P&&0<P.trim().length&&P!==WordEditorIntl.WordEditorStrings.L_UnknownAuthorName&&(U.App.zGc?P!==WordEditorIntl.WordEditorStrings.l_RemovedAuthorName:
!0)&&P===n.AFrameworkApplication.userName}static yMa(P,G,K){P&&P.continueWith(()=>{P.result.xwc("TrackChangesUsed","TrackChangeFloodgateIsEnabled",K,G)})}static Kmd(P,G,K){P&&P.continueWith(()=>{P.result.xwc("TrackChangesTurnedOnForEveryone","TrackChangesTurnedOnForEveryoneIsEnabled",K,G)})}static Kie(P,G,K){P&&P.continueWith(()=>{P.result.xwc("ReviewModeShareLinksUsed","ReviewModeShareLinksFloodgateIsEnabled",K,G)})}static get k6c(){return this.n5f[F.a.Jh]}static ctf(P,G,K){switch(G){case E.oDb:return String.format(WordEditorIntl.WordEditorStrings.L_ForEveryoneNotification,
K);case E.tjb:return String.format(WordEditorIntl.WordEditorStrings.L_JustMineNotification,K);case E.ndc:switch(P){case E.tjb:return String.format(WordEditorIntl.WordEditorStrings.L_TurnOffJustMineNotification,K);case E.oDb:return String.format(WordEditorIntl.WordEditorStrings.L_TurnOffForEveryoneNotification,K);default:return D.ULS.shipAssertTag(24159001,376,!1,`Unexpected previous Track Change setting. Control ID = ${P}`),""}default:return D.ULS.shipAssertTag(24159002,376,!1,`Unexpected current Track Change setting. Control ID = ${G}`),
""}}}E.fc=null;E.n5f={[0]:"Simple",[1]:"All",[2]:"No",[3]:"Original"};E.tjb="btnTCJustMine";E.ndc="btnTCOff";E.oDb="btnTCForEveryone";Object(z.a)(E,"TrackChangeUtils",null,[])},1103:function(z,H,b){b.r(H);z=b(0);var f=b(201),c=b(1124),n=b(1109),m=b(1299),x=b(1300);class y{constructor(t,A){this.Ulb=!1;this.Sla=null;if(!t)throw Error.argumentNull("annotations");if(!t.Qvc(A))throw Error.argument("structTypeID","Invalid struct type ID");this.Wv=t;this.Ewc=this.Wv.IXh(A);this.FDj=A}get Slc(){return this.Wv}get isReadOnly(){return this.Ulb}get z_a(){return this.FDj}isb(t){if(0>
t||t>=this.Ewc)throw Error.argument("iField","Invalid field index");return this.Sla&&null!=this.Sla[t]?this.Sla[t]:this.Wv.b0h(this.z_a,t)}xtg(t,A){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>t||t>=this.Ewc)throw Error.argument("iField","Invalid field index");if(!this.Wv.Quc(this.Wv.PWb(this.z_a,t),A))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Sla||(this.Sla=Array(this.Ewc)))[t]=A}Gha(){const {Annotations:t}=
b(1103);let A="[";if(this.Sla){let D=!0;for(let U=0;U<this.Ewc;++U){if(null==this.Sla[U])continue;const F=this.Wv.PWb(this.z_a,U);if(t.cDb(F,this.Sla[U],this.Wv.b0h(this.z_a,U)))continue;D?D=!1:A+=", ";A+=this.Wv.c0h(this.z_a,U);A+="=";const E=this.Wv.Gha(F,this.Sla[U]);F===t.eba?(A+='"',A+=c.a.Xzf(E),A+='"'):A+=E}}return A+"]"}isEqual(t){const {Annotations:A}=b(1103);if(this===t)return!0;if(!t||this.Wv!==t.Slc||this.z_a!==t.z_a)return!1;for(let D=0;D<this.Ewc;++D)if(!A.cDb(this.Wv.PWb(this.z_a,D),
this.isb(D),t.isb(D)))return!1;return!0}clone(){const t=new y(this.Wv,this.z_a);this.Sla&&(t.Sla=Array.clone(this.Sla));return t}KV(){return this.isReadOnly?this.clone():this}P2f(){const {Annotations:t}=b(1103);if(!this.isReadOnly&&(this.Ulb=!0,this.Sla))for(let A=0;A<this.Ewc;++A){const D=this.Sla[A];null!=D&&t.r0b(D)}}toString(){return this.Gha()}}Object(z.a)(y,"StructValue",null,[1435,1432]);b.d(H,"Annotations",function(){return v});class v{constructor(t,A){if(!t)throw Error.argumentNull("initData");
if(!A)throw Error.argumentNull("objectFetcher");this.RBl=A.krk;let D=0;var U=A.asb(t.J(D));++D;this.K4f=new m.a(new x.a(U));this.amj=t.J(D);++D;this.rmi=Array(this.Z5d);this.Wmd=Array(this.Z5d);this.vxb=Array(this.Z5d);for(U=0;U<this.Z5d;++U){this.rmi[U]=A.KE(t.J(D));++D;this.Wmd[U]=t.J(D);++D;var F=t.J(D);++D;this.vxb[U]=Array(F);for(var E=0;E<F;++E)this.vxb[U][E]=A.KE(t.J(D)),++D}this.EDj=t.J(D);++D;this.Qmi=Array(this.Vzd);this.bje=Array(this.Vzd);this.cje=Array(this.Vzd);this.aje=Array(this.Vzd);
for(U=0;U<this.Vzd;++U)for(this.Qmi[U]=A.KE(t.J(D)),++D,F=t.J(D),++D,this.bje[U]=Array(F),this.cje[U]=Array(F),this.aje[U]=Array(F),E=0;E<F;++E)this.bje[U][E]=A.KE(t.J(D)),++D,this.cje[U][E]=t.J(D),++D,this.aje[U][E]=({Qka:D}=this.LUa(this.cje[U][E],t,D,null,null,null)).returnValue,v.r0b(this.aje[U][E]);this.Agj=t.J(D);++D;this.r4f=Array(this.mmc);this.s4f=Array(this.mmc);this.q4f=Array(this.mmc);for(U=0;U<this.mmc;++U)this.r4f[U]=A.KE(t.J(D)),++D,this.s4f[U]=t.J(D),++D,this.q4f[U]=({Qka:D}=this.LUa(this.s4f[U],
t,D,null,null,null)).returnValue,v.r0b(this.q4f[U])}had(t){for(let A=0;A<this.mmc;++A)if(this.r4f[A]===t)return A;return-1}ZQh(t){if(!this.Pvc(t))throw Error.argument("attrID","Invalid attribute ID");return this.r4f[t]}getAttributeType(t){if(!this.Pvc(t))throw Error.argument("attrID","Invalid attribute ID");return this.s4f[t]}PWb(t,A){if(!this.Qvc(t))throw Error.argument("structTypeID","Invalid struct type ID");t=this.cje[v.Wzd(t)];if(0>A||A>=t.length)throw Error.argument("iField","Invalid field index");
return t[A]}Gha(t,A){if(!this.o0f(t))throw Error.argument("typeID","Invalid type ID");if(!this.Quc(t,A))throw Error.argument("value","Value is not of the correct type");switch(t){case v.eba:return A;case v.uCa:return A?"True":"False";case v.uPa:case v.zva:return A.toString();case v.kX:return A.Gha();default:if(!v.vI(t)&&v.fCd(t)){t=v.Mzf(t);const F=this.vxb[t].length;switch(this.Wmd[t]){case 0:return this.vxb[t][A];case 1:if(A){var D="";for(var U=1;U<F;++U)A&1<<U-1&&(0<D.length&&(D+=" & "),D+=this.vxb[t][U]);
return D}return this.vxb[t][0];case 2:D="";for(U=0;U<F;++U)A&1<<U&&(0<D.length&&(D+=" & "),D+=this.vxb[t][U]);return D;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Wmd[t]);}}else return A.Gha()}}o0f(t){switch(t){case v.eba:case v.uCa:case v.uPa:case v.zva:case v.kX:return!0;default:return v.vI(t)?this.o0f(v.pab(t)):v.fCd(t)?this.Btl(t):this.Qvc(t)}}Btl(t){t=v.Mzf(t);return 0<=t&&t<this.rmi.length}Qvc(t){t=v.Wzd(t);return 0<=t&&t<this.Qmi.length}Pvc(t){return 0<=t&&t<
this.mmc}Quc(t,A){if(null==A)return!1;switch(t){case v.eba:return"string"===typeof A;case v.uCa:return"boolean"===typeof A;case v.uPa:return"number"===typeof A;case v.zva:return"number"===typeof A;case v.kX:return Object(f.a)(1431,A);default:if(v.vI(t))return Object(f.a)(1434,A)&&A.U6===v.pab(t);if(v.fCd(t)){if("number"!==typeof A)return!1;t=v.Mzf(t);const D=this.vxb[t].length;switch(this.Wmd[t]){case 0:return 0<=A&&A<D;case 1:return!(A&-1<<D-1);case 2:return!!A&&!(A&-1<<D);default:throw Error.invalidOperation("Unrecognized enum type flavor "+
this.Wmd[t]);}}else return Object(f.a)(1435,A)&&A.z_a===t}}get mmc(){return this.Agj}get Z5d(){return this.amj}get Vzd(){return this.EDj}dHk(t){if(!this.Pvc(t))throw Error.argument("attrID","Invalid attribute ID");return this.q4f[t]}IXh(t){if(!this.Qvc(t))throw Error.argument("structTypeID","Invalid struct type ID");return this.bje[v.Wzd(t)].length}c0h(t,A){if(!this.Qvc(t))throw Error.argument("structTypeID","Invalid struct type ID");return this.bje[v.Wzd(t)][A]}b0h(t,A){if(!this.Qvc(t))throw Error.argument("structTypeID",
"Invalid struct type ID");t=this.aje[v.Wzd(t)];if(0>A||A>=t.length)throw Error.argument("iField","Invalid field index");return t[A]}LUa(t,A,D,U,F,E){if(!A)throw Error.argumentNull("initData");if(v.vI(t)){var P=A.J(D);++D;t=v.pab(t);var G=new n.a(this,t);for(var K=0;K<P;++K)Array.add(G.items,({Qka:D}=this.LUa(t,A,D,U,F,E)).returnValue);return{returnValue:G,Qka:D}}switch(t){case v.eba:return{returnValue:(U||this.K4f).KE(A.J(D++)),Qka:D};case v.uCa:return{returnValue:1===A.J(D++),Qka:D};case v.uPa:return{returnValue:A.J(D++),
Qka:D};case v.zva:return{returnValue:(F||this.RBl)[A.J(D++)],Qka:D};case v.kX:t=A.J(D++);P=new c.a(this);for(G=0;G<t;++G)K=A.J(D),++D,E&&(K=E[K]),P.vy(K,({Qka:D}=this.LUa(this.getAttributeType(K),A,D,U,F,E)).returnValue);return{returnValue:P,Qka:D};default:if(v.fCd(t))return{returnValue:A.J(D++),Qka:D};if(v.g3i(t)){P=A.J(D++);G=new y(this,t);for(K=0;K<P;++K){const S=A.J(D);++D;G.xtg(S,({Qka:D}=this.LUa(this.PWb(t,S),A,D,U,F,E)).returnValue)}return{returnValue:G,Qka:D}}throw Error.argument("typeID",
"Invalid type ID");}}static fCd(t){return 16<=(t&16383)&&16384!==(t&16384)&&32768!==(t&32768)}static g3i(t){return 16<=(t&16383)&&16384===(t&16384)&&32768!==(t&32768)}static vI(t){return 32768===(t&32768)}static tSk(t){if(v.vI(t))throw Error.argument("nonListTypeID","Non-list type ID required");return t|32768}static pab(t){if(!v.vI(t))throw Error.argument("listTypeID","List type ID required");return t&-32769}static cDb(t,A,D){switch(t){case v.eba:case v.uCa:case v.uPa:case v.zva:return A===D;case v.kX:return A.isEqual(D);
default:return v.vI(t)?A.isEqual(D):v.fCd(t)?A===D:A.isEqual(D)}}static r0b(t){Object(f.a)(1432,t)&&t.P2f()}static KV(t){return Object(f.a)(1432,t)?t.KV():t}static Mzf(t){return t-16}static Wzd(t){return(t&-16385)-16}}v.eba=1;v.uCa=2;v.uPa=3;v.zva=5;v.kX=9;Object(z.a)(v,"Annotations",null,[1436])},1104:function(z,H,b){z=b(0);var f=b(15),c=b(37),n=b(4),m=b(108),x=b(111),y=b(701),v=b(151),t=b(505),A=b(282),D=b(21),U=b(40),F=b(195),E=b(1),P=b(1197);class G{constructor(I,O){this.imj=I;this.nD=O}J(I){return this.imj.gz(I,
this.nD)}}Object(z.a)(G,"PropertyMergeStrategies",null,[]);var K=b(1294),S=b(1401);b.d(H,"a",function(){return L});class L{constructor(I=null){this.g9g=null;this.Qhc=I||this.vcd()}get Bn(){return 1}get Gxb(){return this.Qhc}vcd(){return[Object(U.a)(this,this.DNm,"tryPreProcessFavoredRevision"),Object(U.a)(this,this.r7j,"cloneObjectAndRemoveNeededProperties"),Object(U.a)(this,this.uNm,"tryMergeNodeInternal")]}get nD(){return 5}get nsd(){return this.g9g||(this.g9g=new G(this.rk(),this.nD))}HC(I,O){const M=
I.Nf.value.He;x.a.instance.Ba(4016352,1,3,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",M.id,M.Kb);I.Jm.ma.uf(Object.assign(new S.a,{Bn:this.Bn,pxc:M.Kb,msd:O}));return!1}dFg(I){const O=I.Nf.value;x.a.instance.Ba(4016353,1,4,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",O.He.id,O.He.Kb);for(let M=0;M<this.Gxb.length;M++)if(!(0,this.Gxb[M])(I))return x.a.instance.Ba(4016354,1,3,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",
O.He.id,O.He.Kb,M),I.Jm.ma.Die("GraphNodeComplexMerge.GetMergeFunctions()",M),this.lzl(I),I.ll=null,!1;x.a.instance.Ba(4016355,1,4,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",O.He.id,O.He.Kb);return!0}lzl(I){I.TJg||(I.TJg=!0,K.a(I.Nf.value.at,"Base",1),K.a(I.Nf.value.He,"Favored",1),K.a(I.Mm.value.He,"Conflict",1))}DNm(I){const O=I.Nf.value,M=this.nsd;if(!O.qT)return!0;let R=!0;O.Fga.forEach((W,Y)=>{if(!Y.qT||I.hg.contains(W))return!0;Y=M.J(W);if(5===Y){const N=O.at.Kb;
x.a.instance.Ba(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",N,W,Y);I.Jm.ma.uf(Object.assign(new S.a,{Bn:this.Bn,pxc:N,msd:W,Dnd:Y}));return R=!1}6===Y&&I.xhg.add(W);return!0});return R}r7j(I){I.ll=I.Nf.value.He.yH();const O=I.xhg,M=I.ll;O&&O.forEach(R=>{M.removeProperty(y.a.oka(R));return!0});return!0}uNm(I){const O=I.Mm.value,M=O.at.Kb,R=this.nsd;let W=!0;O.Fga.forEach((Y,N)=>{const aa=
R.J(Y);W=this.vNm(I,N,Y,aa);W||(I.ll=null,x.a.instance.Ba(4018177,1,3,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",M,Y,aa),I.Jm.ma.uf(Object.assign(new S.a,{Bn:this.Bn,pxc:M,msd:Y,Dnd:aa})));return W});return W}vNm(I,O,M,R){const W=I.ll;if(!O.qT&&8!==R||2===R||7===R||I.hg.contains(M))return!0;if(5===R)return!1;if(4===R||3===R){let Y;if(({value:Y}=I.Nf.value.Fga.xb(M)).returnValue&&Y.qT)return 4!==R;R=0}8===R&&(R=0);if(!R){if(!O.isDeleted)return I=y.a.oka(M),
(L.uWm(O,M,I)||L.vym())&&W.Tma(I,O.newValue),!0;R=6}return 6===R?(W.removeProperty(y.a.oka(M)),!0):1===R?this.HC(I,M):!1}vFl(I,O,M,R){I=I||new v.a;O=O||new v.a;M=M||new v.a;I=I.Q7();const W=new t.a;let Y=I.length;for(let N=Y;N<O.length;N++){let aa=O.Ve(N);I.add(aa);W.add(aa)}for(;Y<M.length;Y++)O=M.Ve(Y),W.contains(O)?x.a.instance.Ba(4018180,1,4,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",O):(I.add(O),R(O));return I}loi(I,O,
M,R){return P.a(I,O,M,R)}SXa(I,O,M){I=I||new v.a;O=O||new v.a;M=M||new v.a;const R=I.UG(),W=O.UG(),Y=M.UG();I=L.filter(I,N=>W.contains(N)&&Y.contains(N));I.UG();I.my(I.length,L.filter(O,N=>!R.contains(N)));I.my(I.length,L.filter(M,N=>!R.contains(N)&&!W.contains(N)));return I}qFl(I,O){const M=y.a.oka(O),R=I.Vc;var W=R.getPropertyObjectIds(I.Nf.value.at,M),Y=R.getPropertyObjectIds(I.Nf.value.He,M);const N=R.getPropertyObjectIds(I.Mm.value.He,M);W=this.SXa(W,Y,N);Y=I.ll;0<W.length?R.setPropertyObjectIds(Y,
M,W):Y.removeProperty(M);I.hg.add(O)}kqb(I,O,M){I.hasProperty(M)?O.Tma(M,I.fW(M)):O.removeProperty(M)}Jfm(I,O){var M=O.Fn();for(const R of M)O.removeProperty(R);M=I.Fn();for(const R of M)O.Tma(R,I.fW(R))}P0f(I,O,M,R,W){O=I.getPropertyInt32(O,W);M=I.getPropertyInt32(M,W);M=null!=O&&null!=M?Math.max(O,M):null!=M?M:null!=O?O:null;null!=M?I.setPropertyInt32(R,W,M):R.removeProperty(W)}Xlf(I,O,M,R,W,Y){O=I(O,W);M=I(M,W);I=I(R,W);R=O.UG();let N=!1;Y&&(N=Y(O,M,I));N?(Y=!0,R=!1):(Y=R.fzh(M),R=R.fzh(I));x.a.instance.Ba(588011013,
1,3,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",y.a.eb(W),O.Go(),M.Go(),I.Go(),Y,R);return{e4c:I,mcb:Y,bcb:R}}o4j(I,O,M,R,W,Y){O=I(O,W);M=I(M,W);I=I(R,W);R=this.pfi(O,M,Y);Y=this.pfi(O,I,Y);x.a.instance.Ba(588011014,1,3,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
y.a.eb(W),O.Go(),M.Go(),I.Go(),R,Y);return{e4c:I,mcb:R,bcb:Y}}pfi(I,O,M){if(!I&&!O)return!0;if(!I||!O)return!1;if(M&&!I.count&&!O.count)return!0;let R=!1;O.forEach((W,Y)=>R=I.Pa(W)&&Y==I.J(W));return R}rk(){const I=L.ctj.value,O=new A.a(0);for(let M=0;M<I.length;M++)O.W(I[M],7);return O}static k1(){return new L}static get instance(){return L.ta.value}static vym(){return D.a.instance.sa("Box4.IFeatureHelper").isFeatureEnabled(127)}static uWm(I,O,M){if(void 0!==I.newValue&&null!==I.newValue||E.a.udi(M.type))return!0;
L.Tzl(I,O,M);return!1}static Tzl(I,O,M){M=M.type===E.a.string;O=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",O);M||(O+=String.format(" [NewValue: {0}] [OldValue: {1}]",I.newValue,I.oldValue));x.a.instance.Ba(19145822,1,2,O)}static filter(I,O){const M=new v.a;I.forEach(R=>{O(R)&&M.add(R);return!0});return M}static cQk(){return[y.a.eb(f.a.JJh),y.a.eb(f.a.lastModifiedTime),y.a.eb(f.a.fI),y.a.eb(f.a.JBc),y.a.eb(f.a.bqg),y.a.eb(c.a.C5b),y.a.eb(n.a.E1d),y.a.eb(n.a.kTb),y.a.eb(m.a.nkm)]}}
L.ta=new F.a(L.k1);L.ctj=new F.a(L.cQk);Object(z.a)(L,"GraphNodeComplexMerge",null,[1847])},1109:function(z,H,b){b.d(H,"a",function(){return c});z=b(0);var f=b(1124);class c{constructor(n,m){this.Ulb=!1;const {Annotations:x}=b(1103);if(!n)throw Error.argumentNull("annotations");if(!n.o0f(m))throw Error.argument("memberTypeID","Invalid type ID");if(x.vI(m))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Wv=n;this.suj=m;this.gp=[]}get Slc(){return this.Wv}get isReadOnly(){return this.Ulb}get U6(){return this.suj}get items(){return this.gp}Gha(){const {Annotations:n}=
b(1103);let m="[";for(let x=0,y=this.items.length;x<y;++x){0<x&&(m+=", ");const v=this.Wv.Gha(this.U6,this.items[x]);this.U6===n.eba?(m+='"',m+=f.a.Xzf(v),m+='"'):m+=v}return m+"]"}isEqual(n){const {Annotations:m}=b(1103);if(this===n)return!0;if(!n||n.Slc!==this.Wv||n.U6!==this.U6||n.items.length!==this.items.length)return!1;for(let x=0;x<this.items.length;++x)if(!m.cDb(this.U6,this.items[x],n.items[x]))return!1;return!0}clone(){const n=new c(this.Wv,this.U6);Array.addRange(n.items,this.items);return n}KV(){return this.isReadOnly?
this.clone():this}P2f(){const {Annotations:n}=b(1103);if(!this.isReadOnly){this.Ulb=!0;for(const m of this.items)n.r0b(m)}}toString(){return this.Gha()}}Object(z.a)(c,"ListValue",null,[1434,1432])},1111:function(z,H,b){z=b(0);var f=b(292);class c{constructor(){this.userId=this.email=this.displayName=null}}Object(z.a)(c,"InsertMentionParameters",null,[]);class n{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(z.a)(n,"InsightsParameters",null,[]);var m=b(1412),x=
b(1413),y=b(1414),v=b(1415),t=b(2),A=b(1172),D=b(1192),U=b(31),F=b(18),E=b(16),P=b(1099);b.d(H,"a",function(){return G});class G{static get kUf(){return"Insights_16x16x32"}static get fzk(){return"Find_16x16x32"}static get Fyi(){return"-Parameterized"}static get Xyg(){return"Parameterized"}static get gAe(){return"bTryQuery"}static get lFg(){return"TellMeSuggestion_"}static get I2i(){return"bTryQueryAlternate"}static get yCg(){return"MenuTellMe"}static get jYl(){const K={},S=[];Array.add(S,{Term:{PeopleType:"Person"}});
K.And=S;return K}static Htf(K){return K+G.Fyi}static getParameter(K){let S="",L="";if(K)for(let I=0;I<K.lMh;++I)"Type"===K.MHf(I)?S=K.getValue(I):"Value"===K.MHf(I)&&(L=K.getValue(I));return new f.a(S,L)}static eoc(K){K=Object.assign(new n,{neighborhood:K,mentionStart:0,mentionLength:K.length});return U.c(K)}static Ohk(K,S,L){K=Object.assign(new c,{displayName:K,email:S,userId:L});return U.c(K)}static vqb(K,S,L=null){K=Object.assign(new D.a,{neighborhood:K,mentionStart:0,mentionLength:K?K.length:
0});S=Object.assign(new A.a,{selection:K,userIntent:null,entryPoint:S,launchData:L});return U.c(S)}static Him(K,S){return G.vqb(K,G.Iim(S))}static Iim(K){switch(K){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static jXf(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static Fge(){const K=t.AFrameworkApplication.K?t.AFrameworkApplication.K.Oa("SovereignEnvironmentName"):
null;return!!K&&0<K.length}static isEnterpriseUser(){const K=t.AFrameworkApplication.K?t.AFrameworkApplication.K.Oa("HostAuthType"):null;return!!K&&"aad"===K.toLowerCase()||"external"===K&&G.nWf()}static Lwg(K){var S=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTellMeServiceForGoLocalEnv",!1);S=!G.jXf()||S;return K.RIm&&S&&!G.Fge()}static Rei(){const K=t.AFrameworkApplication.K?t.AFrameworkApplication.K.Oa("UiHostIntegrationType"):
"";return!!t.AFrameworkApplication.K&&"UnifiedUiHostTeams"===K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static Kwg(K){return K.jib&&K.Kxk&&(K.OAd||K.MAd||K.Vcb)&&!G.Rei()&&G.isEnterpriseUser()&&!G.Fge()}static fXa(){return t.AFrameworkApplication.K?t.AFrameworkApplication.t_a||t.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):t.AFrameworkApplication.t_a}static lAa(K){return!K||G.lfi(K.Oh)}static lfi(K){return!K||
!K.trim().length}static zEg(K){if(!K)return 0;const S=Math.pow(10,5);return Math.round(K*S)/S}static CKm(){var K=new Date;return K?new Date(K.getUTCFullYear(),K.getUTCMonth(),K.getUTCDate(),K.getUTCHours(),K.getUTCMinutes(),K.getUTCSeconds(),K.getUTCMilliseconds()):null}static eNf(K){K=new Date(K);return(G.CKm().getTime()-K.getTime())/1E3}static Kfi(K){const {InsightsMenuItemFactory:S}=b(1411);switch(K){case m.a.CQf:case x.a.ENh:case S.j9h:case y.a.Kqi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":return!0}return K.startsWith(G.gAe)||
K.startsWith(G.lFg)||K.startsWith(G.I2i)||K.startsWith("PeopleSuggestion")||K.startsWith("FileSuggestion")||K.startsWith("FindInDocumentSuggestion")||K.startsWith("NotesSuggestion")||K.startsWith("OnenoteNotesSuggestion")||K.startsWith("SmartLookupFromTellMe")||K.startsWith("GetHelpFromTellMe")||K.startsWith("GetHelpWithDescriptionFromTellMe")?!0:!1}static cIf(K,S){const L=[];Array.add(L,new v.a(400,K));Array.add(L,new v.a(200,S));K={};K.parts=L;return JSON.stringify(K)}static o1h(K){const S=G.eNf(K);
return 60>S?CommonUIStrings.l_TimeSince_SecsAgo:3600>S?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(S/60).toString()):86400>S?String.format(CommonUIStrings.l_TimeSince_HoursAgo,Math.floor(S/3600).toString()):172800>S?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(K)).localeFormat("MMMM dd, yyyy"))}static BJk(K){const S=Array(K.length);for(let L=0;L<K.length;L++)S[L]=K[L].commandId;return S}static nWf(){if("Dev Box"===t.AFrameworkApplication.K.Oa("StatusBarEnvironmentNameToUse"))return!0;
let K=t.AFrameworkApplication.K.Oa("UserPrincipalName");K=P.c(K)?"":E.a.vf(K);const S=t.AFrameworkApplication.K.vE("TellMeIntEnabledForFeatureCrew")?t.AFrameworkApplication.K.gC("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(S,K)&&"inner"===t.AFrameworkApplication.K.Oa("Microsoft365Ring")}static $Pk(K){switch(K.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";
case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static Lu(){return F.a.oG&&
!F.a.em}}G.pze=9E5;Object(z.a)(G,"TellMeUtils",null,[])},1115:function(z,H,b){b.r(H);z=b(0);var f=b(40),c=b(201),n=b(55),m=b(1313),x=b(1118);class y{constructor(Eb,ob,tb,yb,lb){this.groupType=Eb;this.resultType=ob;this.psa=tb;this.Qwf=yb;this.resultIndex=lb}}Object(z.a)(y,"ClickLoggingInfo",null,[]);const v=Eb=>{const ob=[];for(;Eb;)Array.add(ob,"{ContextId:"+Eb.contextId+", IsGraphNodeContext:"+Eb.nn+"}"),Eb=Eb.Km;ob.reverse();return"{"+ob.join(", ")+"}"};class t{constructor(){this.hla=this.sessionId=
null}}Object(z.a)(t,"CorrelationRecord",null,[1339]);var A=b(1155);class D{constructor(Eb,ob){this.Id=null;this.TimeStamp=0;this.Id=Eb;this.TimeStamp=ob}}Object(z.a)(D,"MRUControl",null,[]);var U=b(1297),F=b(1111),E=b(2),P=b(1007);class G{constructor(Eb,ob){this.g9=[];this.y_g=!1;this.pSc="";this.Ohc=ob;this.tc=Eb;this.dsj=Eb.Eo}Xad(){!this.y_g&&this.dsj&&this.tc&&U.a.pol()&&(this.pSc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.tc.application,this.g9=this.xIk(),this.y_g=!0);return this.g9}Psl(Eb){return Eb.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===Eb||"TryOfficeUpsell"===Eb}UVf(Eb){return this.Oil(Eb)||this.Psl(Eb)||F.a.Kfi(Eb)?!1:!0}uTa(Eb){Eb=Eb.ControlId;this.UVf(Eb)&&(Eb=this.Kmg(Eb),this.gdm(Eb),this.ECl(),Array.insert(this.g9,0,new D(Eb,Date.now())),this.pSc.length&&(Eb=JSON.stringify(this.g9),P.a.instance.setItem(this.pSc,Eb)))}xIk(){if(!this.g9.length){var Eb=P.a.instance.getItem(this.pSc);if(!Eb||""===Eb)return this.g9;let ob=null;try{ob=JSON.parse(Eb)}catch(tb){this.Z5j(),ob=null}if(!ob||!ob.length||10<ob.length)return this.g9;
Eb=0;for(const tb of ob)if(this.tc.ehe(tb.Id)&&this.UVf(tb.Id)&&(Array.insert(this.g9,Eb++,tb),Eb===this.Ohc))break}return this.g9}qpf(Eb){Eb=this.Kmg(Eb);for(const ob of this.g9)if(ob.Id===Eb)return!0;return!1}Z5j(){P.a.instance.setItem(this.pSc,"")}nkl(Eb){Eb=this.Kmg(Eb.ControlId);return this.UVf(Eb)?this.qpf(Eb):!1}gdm(Eb){if(0<this.g9.length){let ob=0;for(const tb of this.g9){if(tb.Id===Eb){Array.removeAt(this.g9,ob);break}ob++}}}Kmg(Eb){return"Excel"===this.tc.application&&Eb.startsWith("m_excelWebRenderer_ewaCtl_")?
Eb.substr(26,Eb.length):Eb}ECl(){this.g9.length===this.Ohc&&Array.removeAt(this.g9,this.g9.length-1)}Oil(Eb){Eb=Eb.split("|");let ob="";if(6<=Eb.length)ob=Eb[0];else if(3<=Eb.length){if("3"===Eb[0])return!0;ob=Eb[1]}return ob.startsWith("WA")}static createInstance(Eb){let ob=3;E.AFrameworkApplication.K&&(ob=E.AFrameworkApplication.K.zb("TellMeMaxRecommendedResultsToReturn",3));return new G(Eb,ob)}}Object(z.a)(G,"MruControlsManager",null,[1338]);class K{constructor(Eb){this.FKb=Eb}H5(Eb,ob){let tb;
return Eb.bF&&(tb=this.FKb[Eb.value])?tb.H5(Eb,ob):(tb=this.pSh(Eb.value))?tb.H5(tb.OGl,ob):null}pWk(Eb,ob){if(Eb=this.FKb[Eb])for(const tb of ob)if(ob=F.a.getParameter(tb),ob.key===Eb.Gdg)return ob.value;return null}FJl(Eb){(Eb=this.pSh(Eb))&&Eb.CJl()}pSh(Eb){const ob=Eb.indexOf(F.a.Fyi);return 0<ob?this.FKb[Eb.substring(0,ob)]:null}}Object(z.a)(K,"ParameterizedCommandManager",null,[1337]);var S=b(1177);class L{constructor(Eb){this.Mmi={};this.Kmi={};this.Lmi={};this.Nmi={};this.I4f={};this.Omi=
this.iCl=this.cCl=this.eCl=1;this.rta=Eb;this.o_j();this.VZl();this.VZj();this.LYj()}nS(Eb){this.Mmi[S.a[Eb].toLowerCase()]=this.eCl++}FY(Eb,ob){this.Kmi[S.a[Eb].toLowerCase()]=ob}wTa(Eb){this.Lmi[S.a[Eb].toLowerCase()]=this.cCl++}A9(Eb){this.Nmi[S.a[Eb].toLowerCase()]=this.iCl++}mL(Eb){this.I4f[S.a[Eb].toLowerCase()]=this.Omi++}o_j(){const Eb=!!this.rta&&this.rta.Ucb,ob=!!this.rta&&this.rta.fqd,tb=!!this.rta&&this.rta.Vcb;this.nS(3);this.nS(17);this.nS(15);this.nS(6);this.nS(16);this.nS(0);this.nS(1);
Eb||this.nS(2);Eb&&!ob||this.nS(7);this.nS(14);tb&&this.nS(19);this.nS(13);this.nS(8);this.nS(11);this.nS(9);this.nS(10);Eb&&this.nS(2);Eb&&!ob&&this.nS(7);this.nS(18);this.nS(20);this.nS(12)}VZl(){this.FY(20,1);this.FY(3,3);this.FY(17,3);this.FY(15,3);this.FY(6,3);this.FY(16,5);this.FY(0,5);this.FY(1,1);this.FY(2,1);this.FY(7,2);this.FY(14,3);this.FY(13,2);this.FY(8,1);this.FY(11,1);this.FY(9,1);this.FY(10,1);this.FY(18,1);this.FY(12,1);this.FY(19,2)}VZj(){this.wTa(3);this.wTa(0);this.wTa(16);this.wTa(6);
this.wTa(15);this.wTa(17);this.wTa(14);this.wTa(19);this.wTa(7);this.wTa(13)}LYj(){this.A9(13);this.A9(9);this.A9(11);this.A9(8);this.A9(10);this.A9(19);this.A9(14);this.A9(7);this.A9(2);this.A9(1);this.A9(6);this.A9(17);this.A9(15);this.A9(16);this.A9(0);this.A9(3)}Mhm(){this.I4f={};this.Omi=1}CZk(Eb,ob,tb){this.Mhm();const yb=!!this.rta&&this.rta.Ucb,lb=!!this.rta&&this.rta.fqd,Cc=!!this.rta&&this.rta.Vcb;Eb=Eb&&lb;this.mL(3);this.mL(17);this.mL(15);this.mL(6);this.mL(16);this.mL(0);this.mL(1);
yb&&!lb||!Eb||this.mL(7);ob&&this.mL(14);yb||this.mL(2);tb&&this.mL(13);yb&&!lb||Eb||this.mL(7);ob||this.mL(14);Cc&&this.mL(19);tb||this.mL(13);this.mL(8);this.mL(11);this.mL(9);this.mL(10);yb&&this.mL(2);yb&&!lb&&this.mL(7);this.mL(18);this.mL(20);this.mL(12);return this.I4f}kZ(){return this.rta}}Object(z.a)(L,"GroupsPlacementInfo",null,[]);class I{constructor(Eb,ob){this.Oh=Eb;this.O7b=ob}}Object(z.a)(I,"TellMeQuery",null,[]);var O=b(1298);class M{constructor(Eb,ob){this.Id=null;this.TimeElapsedSinceClick=
0;this.Id=Eb;this.TimeElapsedSinceClick=ob}}Object(z.a)(M,"CommandClickedEvent",null,[]);var R=b(1099);class W{constructor(Eb,ob){this.Iwj=Eb;this.vxa=ob}resultsUpdated(Eb){this.Iwj(R.c(Eb.query)?"":Eb.query.Oh,Eb.Hw,Eb.attributes,this.vxa,Eb.mvc)}}Object(z.a)(W,"ResultsUpdatedCallback",null,[1336]);var Y=b(74);class N{constructor(Eb,ob){this.menuModel=Eb;this.qKi=ob}}Object(z.a)(N,"GeneratedMenuModel",null,[]);class aa{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=
!1;this.ariaRoleDescription=null}}Object(z.a)(aa,"MenuModel",null,[]);class ia{constructor(Eb,ob,tb){this.tc=Eb;this.FKb=ob;this.hda=tb}YEk(Eb,ob,tb){let yb=0;const lb=new aa,Cc=[];let Hc="";lb.sections=[];let Jc=new Y.a;const Ib=!!this.tc&&this.tc.Ucb;var nc=!!this.tc&&this.tc.i_a||E.AFrameworkApplication.pa.mb.i_a;for(const tc of Eb){Eb=0;Ib||(Jc=new Y.a);const fc=new Y.a;let kc=tc.displayName;for(const Bb of tc.results){if(0<=Bb.value.indexOf(F.a.Xyg)){if(Bb.bF){var Gc=this.FKb[Bb.value];if(Gc&&
Bb.value.endsWith(F.a.Xyg)){if("FindParameterized"!==Bb.value&&!nc){const Wb=[];Wb.push(appChrome.actions.setControlLabel(Bb.value,Gc.k$d(Bb)));Wb.push(appChrome.actions.setButtonCommandValueId(Bb.value,Gc.cGf(Bb)));appChrome.api.dispatch(Wb)}Gc=Bb.value.replace(F.a.Xyg,"");Jc.remove(Gc)?Eb--:fc.add(Gc);Jc.add(Bb.value);Eb++}}}else switch(Bb.type){case 5:fc.contains(Bb.value)||(Jc.add(Bb.value),Eb++);break;case 7:Jc.add(Bb.bF);Eb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 6:case 19:case 20:case 21:Jc.add(Bb.value),
Eb++}12===tc.groupType&&(kc=F.a.fXa()?0<ob.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ob):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,ob));20===tc.groupType&&(kc=CommonUIStrings.l_LearningUILiveText)}yb+=Eb;""!==kc&&0<Eb&&(Hc+=" , "+Eb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+kc+" , ");0<Jc.count&&!Ib&&(Eb=appChrome.api.menuSection(Jc.toArray(),tc.displayName,null,S.a[tc.groupType]),Cc.push(Eb))}nc=
null;0<yb&&(nc=0<ob.length?1!==yb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,yb,ob):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,ob):1!==yb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,yb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Ib?(ob=appChrome.api.menuSection(Jc.toArray(),"",null,null),Cc.push(ob)):nc+=Hc);tb&&appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(nc));
lb.sections=Cc;return new N(lb,yb,[])}static get zyf(){return ia.XTg||(ia.XTg=new N(Object.assign(new aa,{sections:[]}),0,[]))}}ia.XTg=null;Object(z.a)(ia,"TellMeMenuDefintionGenerator",null,[]);var ea=b(1200),la=b(1199),xa=b(31);class Ha{constructor(Eb){this.vEj=Eb}Qeb(Eb,ob,tb){const {TellMeActor:yb}=b(1115);yb.instance.rf.taa(ob,la.a.Kzc,Eb.data.ff.toString(),Math.round(window.performance.now()-tb),la.a.Kzc,!0,ea.a.rWa);Eb=xa.b(Eb.data.od);ob=-1;Eb.Index&&(ob=Eb.Index);yb.instance.rf.DAl(ob,this.vEj)}xeb(Eb,
ob,tb){const {TellMeActor:yb}=b(1115);yb.instance.rf.taa(ob,la.a.Kzc,Eb.data.ff.toString(),Math.round(window.performance.now()-tb),la.a.Kzc,!1,ea.a.rWa)}jYk(Eb){if(Eb&&""!==Eb.trim()){const tb=window.performance.now(),yb=E.AFrameworkApplication.g_i;var ob={};ob.Text=Eb;ob.IsFileHash="false";ob=xa.c(ob);E.AFrameworkApplication.he.Hi(yb,2,ob,{"Content-Type":"application/json",Accept:"application/json"},!1,0,lb=>{this.Qeb(lb,Eb.length,tb)},lb=>{this.xeb(lb,Eb.length,tb)},null,null,!1,4E3,6E3)}}}Object(z.a)(Ha,
"TellMeQueryIndexCallback",null,[]);var ua=b(1116);class Ra{constructor(Eb,ob,tb){this.xml=Eb;this.qKi=ob;this.Mpk=tb}}Object(z.a)(Ra,"GeneratedMenuXml",null,[]);var ab=b(1412),Ba=b(16);class Ga{constructor(Eb,ob){this.BHd=Eb||{};this.D4a=ob}get AZa(){return 5}H5(Eb,ob=null){return this.D4a.H5(Eb,ob)||this.fYj(Eb.value)}fYj(Eb){return Ga.fjf(Eb,this.BHd[Eb]||null)}static fjf(Eb,ob=null){Eb=String.format('<ClonedControl Id="{0}" ',Eb);for(let lb in ob){var tb=lb,yb=ob[lb];yb=yb?Ba.a.ve(yb.toString()):
"";Eb+=String.format('{0}="{1}" ',tb,yb)}return Eb+"/>"}}Object(z.a)(Ga,"CommandMenuItemFactory",null,[1332]);var ja=b(301);class X{constructor(){this.Tmj=CommonUIStrings.l_FindInDocumentText}get AZa(){return 8}H5(Eb){var ob=Eb.bF;Eb=Ba.a.ve(Eb.value);const tb=Ba.a.ve(ob);ob=Ba.a.ve(String.format(this.Tmj,ob));return this.vEk(Eb,tb,ob)}vEk(Eb,ob,tb){return ja.a(Eb,"1540292897",tb,F.a.fzk,null,ob,tb,null,null)}}Object(z.a)(X,"FindInDocumentMenuItemFactory",null,[1332]);var fa=b(1413),pa=b(1411),Ia=
b(1414);class ta{get AZa(){return 7}H5(Eb){const ob=Object(n.a)(O.a,Eb);return this.fFk(Ba.a.ve(Eb.value),ob.id)}fFk(Eb,ob){return ja.a(ob,"1404166600",Eb,null,null,Eb,Eb,null,null)}}Object(z.a)(ta,"TryQueryMenuItemFactory",null,[1332]);class oa{constructor(Eb){this.NI=[];this.tc=Eb}GNk(Eb){for(const ob of this.NI)if(ob.AZa===Eb)return ob;return null}ia(Eb){this.NI.push(Eb)}k$l(Eb){this.ia(new Ga(this.tc.Vak,Eb));this.ia(new Ia.a(this.tc.CIl));this.ia(new ab.a(this.tc.Klm,this.tc.Jlm,this.tc.$Im,
this.tc.H$k,this.tc.Rxm));this.ia(new pa.InsightsMenuItemFactory);this.ia(new X);this.ia(new fa.a);this.ia(new ta);this.tc.pFi(this)}}Object(z.a)(oa,"MenuItemFactoryRegistry",null,[]);var va=b(1128);class Fa{constructor(Eb,ob){this.tc=Eb;this.A3g=new oa(this.tc);this.A3g.k$l(ob)}ZEk(Eb,ob){let tb=0;const yb=[],lb=[];for(const Hc of Eb){Eb=F.a.yCg;var Cc=[];for(const Jc of Hc.results){const Ib=this.A3g.GNk(Jc.type).H5(Jc,ob);Eb=F.a.yCg;Cc.push(Ib);if(13===Jc.type||14===Jc.type)Eb="Menu32";17===Jc.type&&
(Eb="MenuTellMeExtended");Jc.groupType=Hc.groupType;lb.push(Object(n.a)(va.a,Jc))}tb=tb?tb:Cc.length;Cc=ja.e("TellMeDropdownControls",Cc);Eb=ja.j("TellMeDropdownMenuSection",Cc,Eb,Hc.displayName);yb.push(Eb)}ob=ja.k(yb,"LookupDropdownMenu");return new Ra(ob,tb,lb)}static get r5d(){return Fa.YTg||(Fa.YTg=new Ra(ja.k([],"LookupDropdownMenu"),0,[]))}}Fa.YTg=null;Object(z.a)(Fa,"TellMeXmlGenerator",null,[]);class cb{}cb.qHl="MRU";cb.test="Test";Object(z.a)(cb,"ActionType",null,[]);var Za=b(1178),gb;(function(Eb){Eb[Eb.Answer=
0]="Answer";Eb[Eb.Definition=1]="Definition";Eb[Eb.Entity=2]="Entity";Eb[Eb.WolframAnswer=3]="WolframAnswer";Eb[Eb.Assistance=4]="Assistance";Eb[Eb.Command=5]="Command";Eb[Eb.Document=6]="Document";Eb[Eb.TryQuery=7]="TryQuery";Eb[Eb.FindInDocument=8]="FindInDocument";Eb[Eb.HelpAction=9]="HelpAction";Eb[Eb.Insights=10]="Insights";Eb[Eb.People=11]="People";Eb[Eb.Image=12]="Image";Eb[Eb.FirstRunResult=13]="FirstRunResult";Eb[Eb.NoCommandsFoundResult=14]="NoCommandsFoundResult";Eb[Eb.TestResult=15]="TestResult";
Eb[Eb.AppsForOffice_Installed=16]="AppsForOffice_Installed";Eb[Eb.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";Eb[Eb.AppsForOffice_Query=18]="AppsForOffice_Query";Eb[Eb.Notes_Onenote=19]="Notes_Onenote";Eb[Eb.Notes_Samsung=20]="Notes_Samsung";Eb[Eb.Notes_Sticky=21]="Notes_Sticky";Eb[Eb.Learning=22]="Learning";Eb[Eb.Unknown=23]="Unknown"})(gb||(gb={}));Object(z.b)("ResultType",gb);var Ya=b(82),fb=b(113),ib=b(188);class hb{constructor(Eb,ob=null){this.KLd="TellMeWAC.";this.Zxj=Eb;
this.vFj=ob}Fgb(Eb,ob,tb){ob=Ya.a.BSb(ob);Eb=Ya.a.vtf(Eb,this.Zxj,this.vFj,tb,ob);fb.a.Fgb(Eb,this.KLd)}TZa(Eb,ob,tb=0){ob=Ya.a.BSb(ob);fb.a.TZa(Object.assign(new ib.a,{name:Eb,dataFields:ob,durationMs:tb}),this.KLd)}}Object(z.a)(hb,"TellMeOtelLogger",null,[1360]);var db=b(130);class da{constructor(Eb,ob,tb,yb,lb,Cc,Hc){this.lpa=this.Fpa=this.nQg=null;this.aDa=Eb;this.qKc=ob;this.zSa=tb;this.Wgc=yb;this.v3a=lb;this.msj=Cc;this.lpa=Hc?Hc:new hb(this.Wgc?x.CuiHelper.Wyg:x.CuiHelper.Rye)}get Eo(){return this.Wgc}get wBa(){return this.zSa}vve(Eb){this.nQg=
Eb;switch(Eb){case ua.a.contextMenu:this.Fpa=ua.a.contextMenu;break;default:this.Fpa=ua.a.tellMe}}$Vj(Eb,ob){this.zSa.hla||(this.zSa.hla=db.a.create().toString(),this.Eki(Eb,!0,ob))}uJh(Eb,ob=!0){this.zSa.hla&&this.ezl(Eb,ob);this.Wgc&&appChrome.api.updateTellMeCorrelationId("");this.zSa.hla=null}Eki(Eb,ob,tb){const {TellMeActor:yb}=b(1115),lb=this.$qa(A.a.Qbb);lb[Za.a.culture]=this.qKc;lb[Za.a.appName]=this.aDa;lb[Za.a.context]=Eb;lb[Za.a.tge]=this.v3a;lb[Za.a.Msl]=this.msj;lb[Za.a.Jrl]=tb;lb[Za.a.rnl]=
ob;lb[Za.a.contentType]=yb.instance.v3d;this.lpa.Fgb(A.a.Qbb,lb,this.nQg);this.Wgc&&appChrome.api.updateTellMeCorrelationId(this.zSa.hla)}ezl(Eb,ob){const tb=this.$qa(A.a.KYb);tb[Za.a.Jrk]=Eb;tb[Za.a.qnl]=ob;this.lpa.TZa(A.a.KYb,tb)}CAl(Eb,ob,tb){let yb=0;!tb&&0<Eb.length&&(yb=Eb.trim().split(" ").length);const lb=this.$qa(A.a.query);lb[Za.a.query]="!";lb[Za.a.Fzc]=ob;lb[Za.a.mCi]=Eb.length;lb[Za.a.Agi]=tb;lb[Za.a.zYm]=yb;this.lpa.Fgb(A.a.query,lb,this.Fpa)}Zzl(Eb,ob,tb,yb,lb,Cc,Hc,Jc=null){const Ib=
this.$qa(A.a.latency);Ib[Za.a.culture]=this.qKc;Ib[Za.a.mCi]=Eb;Ib[Za.a.i3i]=ob;Ib[Za.a.statusCode]=tb;Ib[Za.a.oom]=lb;Ib[Za.a.isSuccess]=Cc;Ib[Za.a.Svl]=Hc;Jc&&(Ib[Za.a.WKm]=Jc);this.lpa.TZa(A.a.latency,Ib,yb)}IAl(Eb,ob){var {TellMeActor:tb}=b(1115);const {isCommandEnabled:yb}=b(1163);if(Eb.results.length){var lb=this.$qa(A.a.rIi);lb[Za.a.psa]=ob.toString();lb[Za.a.groupType]=S.a[Eb.groupType];15===Eb.groupType&&(lb[Za.a.nrl]=tb.instance.FDd);ob=[];tb=[];for(const Cc of Eb.results)lb[Za.a.resultType]||
(lb[Za.a.resultType]=gb[Cc.type]),tb.push(yb(Cc.value)),ob.push(Cc.value);0<ob.length&&(lb[Za.a.Kim]="{"+ob.join(", ")+"}",lb[Za.a.Xsk]="{"+tb.join(", ")+"}");this.lpa.Fgb(A.a.rIi,lb,this.Fpa)}}AFk(Eb){switch(Eb){case 15:case 17:case 6:case 0:case 16:case 1:return"Command";case 3:return cb.qHl;case 12:case 8:case 9:case 10:case 18:return"Insights";case 19:return"Notes"}return S.a[Eb]}Wyl(Eb,ob,tb,yb,lb){const Cc=this.$qa(A.a.click);Cc[Za.a.i3i]=Eb;Cc[Za.a.YWl]=ob;Cc[Za.a.commandId]=tb;Cc[Za.a.Dja]=
yb;Cc[Za.a.actionType]=this.AFk(lb.groupType);Cc[Za.a.resultType]=gb[lb.resultType];Cc[Za.a.groupType]=S.a[lb.groupType];Cc[Za.a.psa]=lb.psa.toString();Cc[Za.a.Qwf]=lb.Qwf.toString();Cc[Za.a.resultIndex]=lb.resultIndex.toString();this.lpa.Fgb(A.a.click,Cc,this.Fpa)}Zyl(Eb,ob){this.zSa.hla||(this.zSa.hla=db.a.create().toString(),this.Eki("",!1,ob));ob=this.$qa(A.a.Xzh);ob[Za.a.Fzc]=Eb;this.lpa.TZa(A.a.Xzh,ob)}Tki(Eb,ob,tb){if(Eb){if(tb)for(let yb in tb)Eb[yb]=tb[yb];this.lpa.TZa(A.a.events,Eb,ob)}}nmd(Eb,
ob,tb=null){const yb=this.$qa(A.a.events);yb[Za.a.event]=Eb;this.Tki(yb,Math.round(ob),tb)}tdb(Eb,ob,tb=null){const yb=this.$qa(A.a.events);yb[Za.a.event]=A.a.error;yb[Za.a.module]=Eb;yb[Za.a.errorMessage]=ob;yb[Za.a.message]=ob;this.Tki(yb,Math.round(window.performance.now()),tb)}Vyl(Eb){const ob=this.$qa(A.a.vxh);ob[Za.a.value]=Eb;ob[Za.a.WDi]=this.Wgc;this.lpa.Fgb(A.a.vxh,ob,this.Fpa)}Jyl(Eb){const ob=this.$qa(A.a.rhh);ob[Za.a.value]=Eb;ob[Za.a.WDi]=this.Wgc;this.lpa.Fgb(A.a.rhh,ob,this.Fpa)}Pyl(Eb){const ob=
this.$qa(A.a.COi);ob[Za.a.value]=Eb;this.lpa.Fgb(A.a.COi,ob,this.Fpa)}EAl(Eb,ob){const tb=this.$qa(A.a.lCi);tb[Za.a.Kzc]=Eb;ob&&(tb[Za.a.hla]=ob);this.lpa.TZa(A.a.lCi,tb)}$qa(Eb){return{["SessionID"]:this.zSa.sessionId,["CorrelationID"]:this.zSa.hla,["Time"]:(new Date).getTime(),["Event"]:Eb,["Scenario"]:this.Fpa}}}Object(z.a)(da,"UsageLogger",null,[1335]);var Wa=b(50),mb=b(1357),Tb=b(1014),Da=b(77),La=b(54),Ta=b(194),Sa=b(316),Hb=b(18),Oa=b(468),za=b(66),$a=b(14);b.d(H,"TellMeActor",function(){return Xb});
class Xb{constructor(){this.D4a=this.tca=this.jb=this.ra=this.qba=this.Bv=this.Za=this.ea=this.rf=this.RYe=this.Wgh=this.wxa=this.tc=null;this.ihc=!1;this.nKe=[];this.kQg=[];this.k4g=[];this.h0g=!1;this.tec=this.hda=null;this.KPc=this.v3a=!1;this.KOd=!0;this.qFb=this.Vec=this.MDa=this.oOc=this.SWg=this.fZe=this.W3g=null;this.TOc=!1;this.M3g=0;this.bec=null;this.vxa=-1;this.C3g=0;this.TPc=!1;this.Xkb=null;this.Sfh=!1}get v3d(){return this.qba?this.qba.contentType:Xb.unknown}$ae(){return this.rf?this.rf.wBa.hla:
null}kZ(){return this.tc}get AGl(){return this.KOd}get sXm(){return this.W3g}get FDd(){return this.Sfh}set FDd(Eb){this.Sfh=Eb}YG(Eb){const ob=window.performance.now();this.hda&&!R.c(Eb)&&(this.hda(Eb),this.rf.wG(A.a.YG,window.performance.now()-ob))}initialize(Eb,ob=null,tb=null,yb=null,lb=null,Cc=null,Hc=null,Jc=null,Ib=null,nc=null){const {InteractionLogger:Gc}=b(1643),{AggregatorResultsProvider:tc}=b(1428);this.tc=Eb;this.v3a=!!E.AFrameworkApplication.pa&&E.AFrameworkApplication.pa.mb.Lcb;this.rf=
yb;if(!yb){yb=new t;yb.sessionId=E.AFrameworkApplication.userSessionId;const fc=Oa.a.ld(E.AFrameworkApplication.lcid)||Oa.a.Ubb;this.rf=new Gc(new da(this.tc.application,fc.name,yb,this.tc.Eo,this.v3a,Eb.jib,null),this.tc.Zak,this.tc)}this.D4a=new K(this.tc.parameterData);this.Wgh=tb||new Fa(this.tc,this.D4a);this.hda=Hc;this.RYe=this.RYe||new ia(this.tc,this.tc.parameterData,Hc);this.jb=Wa.FocusManager.instance();this.tca=G.createInstance(this.tc);this.SWg=new L(Eb);this.ea=lb||E.AFrameworkApplication.qa;
this.Za=Cc||E.AFrameworkApplication.Vb;this.Bv=Ib;this.wxa=ob;Ib?Ib.execute(fc=>{fc.isFeatureEnabled(Xb.QIm,!0).then(kc=>{const {AggregatorResultsProvider:Bb}=b(1428);this.TPc=kc;this.wxa=this.wxa||Bb.createInstance(this.tca,this.tc,this.D4a,this.TPc);return null})}):(this.TPc=!0,this.wxa=this.wxa||tc.createInstance(this.tca,this.tc,this.D4a,this.TPc));this.ra=Jc;this.MDa=Fa.r5d;this.W3g=new Promise(fc=>{this.fZe=fc});nc&&nc.execute(fc=>{this.qba=fc});this.tc.Eo&&F.a.Rei()&&(Eb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,
this.tc.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(Eb,Eb)))}pb(){this.SLj()}jam(Eb){this.oOc=Eb}SLj(){this.ea.La($a.a.tellMe,za.a.frame,Object(f.a)(this,this.tellMe,"tellMe"),96);this.ea.La($a.a.xCg,za.a.frame,Object(f.a)(this,this.ysh,"cacheAsyncMenuRefreshFunction"),96);this.ea.La($a.a.ACg,za.a.frame,Object(f.a)(this,this.fli,"logItemExecuted"),96);this.ea.La($a.a.DCg,za.a.frame,Object(f.a)(this,this.Oki,"logControlDeactivation"),96);this.ea.La($a.a.CCg,za.a.frame,
Object(f.a)(this,this.ali,"logInputFocus"),96);this.ea.La($a.a.zCg,za.a.frame,Object(f.a)(this,this.Qbb,"interactionBegin"),96);this.ea.La($a.a.FCg,za.a.frame,Object(f.a)(this,this.Qbb,"interactionBegin"),96);this.ea.La($a.a.BCg,za.a.frame,Object(f.a)(this,this.$ki,"logInputBlur"),96);this.ea.La($a.a.ECg,za.a.frame,Object(f.a)(this,this.Nki,"logControlActivated"),96);this.ea.La($a.a.NAd,za.a.frame,Object(f.a)(this,this.vOh,"focusSearchBox"),96);this.ea.La($a.a.wCg,za.a.frame,Object(f.a)(this,this.Zyh,
"constructLiveNotificationForMenu"),96);this.ea.La($a.a.GCg,za.a.frame,Object(f.a)(this,this.hUf,"insertTryQuery"),96);this.ea.La($a.a.U1f,za.a.frame,Object(f.a)(this,this.hUf,"insertTryQuery"),96);this.ea.La($a.a.nBf,za.a.frame,Object(f.a)(this,this.Teb,"openOrInsertUrl"),96);this.ea.La($a.a.oBf,za.a.frame,Object(f.a)(this,this.Teb,"openOrInsertUrl"),96);this.ea.La($a.a.pBf,za.a.frame,Object(f.a)(this,this.Teb,"openOrInsertUrl"),96);this.ea.La($a.a.qBf,za.a.frame,Object(f.a)(this,this.Teb,"openOrInsertUrl"),
96);this.ea.La($a.a.rBf,za.a.frame,Object(f.a)(this,this.Teb,"openOrInsertUrl"),96);this.ea.La($a.a.gcg,za.a.frame,Object(f.a)(this,this.Teb,"openOrInsertUrl"),96);this.ea.La($a.a.hcg,za.a.frame,Object(f.a)(this,this.Teb,"openOrInsertUrl"),96);this.ea.La($a.a.icg,za.a.frame,Object(f.a)(this,this.Teb,"openOrInsertUrl"),96);this.ea.La($a.a.jeg,za.a.frame,Object(f.a)(this,this.Ibb,"insertMention"),96);this.ea.La($a.a.keg,za.a.frame,Object(f.a)(this,this.Ibb,"insertMention"),96);this.ea.La($a.a.leg,za.a.frame,
Object(f.a)(this,this.Ibb,"insertMention"),96)}Q9l(Eb){this.KOd=!1;const ob=window.performance.now();Eb.DXa.isCompleted?(this.KOd=!0,this.fZe(!0)):Eb.fJ(()=>{this.KOd=!0;this.fZe(!0);this.rf.wG(A.a.Kmk,window.performance.now()-ob)});this.p$l(Eb)}p$l(Eb){Sa.a.Qtd(Object(f.a)(this,this.D7c,"dispatcher"));Sa.a.P8c([new Ta.a($a.a.tellMe,za.a.frame,96),new Ta.a($a.a.xCg,za.a.frame,96),new Ta.a($a.a.ACg,za.a.frame,96),new Ta.a($a.a.DCg,za.a.frame,96),new Ta.a($a.a.CCg,za.a.frame,96),new Ta.a($a.a.zCg,za.a.frame,
96),new Ta.a($a.a.FCg,za.a.frame,96),new Ta.a($a.a.BCg,za.a.frame,96),new Ta.a($a.a.ECg,za.a.frame,96),new Ta.a($a.a.NAd,za.a.frame,96),new Ta.a($a.a.wCg,za.a.frame,96),new Ta.a($a.a.GCg,za.a.frame,96),new Ta.a($a.a.U1f,za.a.frame,96),new Ta.a($a.a.nBf,za.a.frame,96),new Ta.a($a.a.oBf,za.a.frame,96),new Ta.a($a.a.pBf,za.a.frame,96),new Ta.a($a.a.qBf,za.a.frame,96),new Ta.a($a.a.rBf,za.a.frame,96),new Ta.a($a.a.gcg,za.a.frame,96),new Ta.a($a.a.hcg,za.a.frame,96),new Ta.a($a.a.icg,za.a.frame,96),new Ta.a($a.a.jeg,
za.a.frame,96),new Ta.a($a.a.keg,za.a.frame,96),new Ta.a($a.a.leg,za.a.frame,96)],Eb)}D7c(Eb,ob,tb,yb,lb){if(ob.contextId===za.a.frame)switch(Eb){case $a.a.tellMe:return this.tellMe(Eb,ob,tb,yb,lb);case $a.a.xCg:return this.ysh(Eb,ob,tb,yb,lb);case $a.a.ACg:return this.fli(Eb,ob,tb,yb,lb);case $a.a.DCg:return this.Oki(Eb,ob,tb,yb,lb);case $a.a.CCg:return this.ali(Eb,ob,tb,yb,lb);case $a.a.zCg:return this.Qbb(Eb,ob,tb,yb,lb);case $a.a.FCg:return this.tim(tb);case $a.a.BCg:return this.$ki(Eb,ob,tb,
yb,lb);case $a.a.ECg:return this.Nki(Eb,ob,tb,yb,lb);case $a.a.NAd:return this.vOh(Eb,ob,tb,yb,lb);case $a.a.wCg:return this.Zyh(Eb,ob,tb,yb,lb);case $a.a.GCg:case $a.a.U1f:return this.hUf(Eb,ob,tb,yb,lb);case $a.a.nBf:case $a.a.oBf:case $a.a.pBf:case $a.a.qBf:case $a.a.rBf:case $a.a.gcg:case $a.a.hcg:case $a.a.icg:return this.Teb(Eb,ob,tb,yb,lb);case $a.a.jeg:case $a.a.keg:case $a.a.leg:return this.Ibb(Eb,ob,tb,yb,lb)}return 2}vOh(Eb,ob,tb){if(1===tb)return 32;this.FRi();Eb=!1;(this.tc.jib||this.v3a)&&
(ob=document.getElementById("SearchButton"))&&ob.click();if(!this.tc.jib&&this.v3a)for(ob=document.getElementsByClassName("ms-suiteux-search-box"),tb=0;tb<ob.length;tb++){const yb=ob[tb].querySelector("input[type=search]");yb&&(Eb=Wa.FocusManager.jR(yb))}else Eb=Wa.FocusManager.jR($get(this.tc.Eo?x.CuiHelper.Wyg:x.CuiHelper.Rye));this.KPc=!0;return Eb?32:8}hUf(Eb,ob,tb,yb,lb){if(1===tb)return 32;if(R.c(lb))return this.rf.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.FRi();
Eb=lb.CommandValueId;ob=this.tc.Eo?x.CuiHelper.Wyg:x.CuiHelper.Rye;this.tc.Eo&&!R.c(lb[Tb.a.BOa])&&(lb[Tb.a.BOa]=!1);if(Eb){if(this.tc.Eo)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Eb)),this.Xkb=[18],32;if(lb=$get(ob))lb.value=Eb}return Wa.FocusManager.jR($get(ob))?32:8}FRi(){this.jb.aM(this.tc.jib||this.v3a?this.tc.eub:this.tc.EZa,!1)}tFk(Eb,ob){switch(Eb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,ob);case 3:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,
ob);case 4:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,ob);case 6:case 15:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,ob)}return ob}Zyh(Eb,ob,tb,yb,lb){if(1===tb)return 32;if(R.c(lb))return this.rf.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Eb=this.MDa?this.MDa.qKi:0;lb.Value=1!==Eb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Eb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;
if(this.MDa)for(const Cc of this.MDa.Mpk)lb=Object(c.a)(O.a,Cc)?Cc.id:Ba.a.replaceAll(Cc.value,'"',""),(lb=$get(lb+"-"+F.a.yCg))&&La.a.vq(lb,La.a.lja,Ba.a.ve(this.tFk(Cc.groupType,lb.innerText)));return 32}ysh(Eb,ob,tb,yb,lb){if(1===tb)return 32;if(R.c(lb))return this.rf.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.bec=new Da.a(2,1,0,()=>{lb[mb.a.Callback]()},97);this.MDa&&this.Za.Eb(this.bec);return 32}fli(Eb,ob,tb,yb,lb){if(1===tb)return 32;if(R.c(lb))return this.rf.onError("TellMeActor:LogItemExecuted",
"actiondata comes null"),16;lb.CloseAllMenus&&(Eb=void 0===lb.ParentControlId||null===lb.ParentControlId?"<NA>":lb.ParentControlId,ob=this.tec?this.tec[lb.ControlId]:null,!ob&&this.tec&&"<NA>"!==Eb&&(ob=this.tec[Eb]),ob||(ob=this.ihc&&this.tca.nkl(lb),ob=this.onk(ob,lb.ControlId),ob=new y(ob,23,-1,-1,-1),this.rf.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+lb.ControlId+" determined group:"+S.a[ob.groupType])),this.rf.CMl(lb.ControlId,Eb,lb.CommandId,lb.CloseAllMenus,ob),this.D4a.FJl(lb.ControlId),
lb.Location!==ua.a.contextMenu&&(this.tca.uTa(lb),this.tc.shb&&this.wxa.$Jj(lb.CommandId)));return 32}Oki(Eb,ob,tb,yb,lb){if(1===tb)return 32;U.a.Nsl()&&(new Ha(this.$ae())).jYk(this.Vec);Eb=this.Vec;ob=this.vxa;tb=this.rf.ZHd;if(R.c(lb))return this.rf.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;lb=lb.UILocation;Eb&&0<Eb.length&&this.TPc&&F.a.Lwg(this.tc)&&this.tc.Rge&&19!==lb&&ob>tb&&(this.rf.E3f(Eb),this.rf.ltg(ob));this.rf.Ehm();this.rf.cNl(window.performance.now()-
this.M3g);this.tc.Eo&&(this.qFb=null,this.rf.gBa());this.KPc=this.TOc=!1;this.Vec="";return 32}ali(Eb,ob,tb){if(1===tb)return 32;this.rf.tyb(v(ob),this.KPc);return 32}$ki(Eb,ob,tb){if(1===tb)return 32;this.rf.gBa();this.TOc=!1;return 32}Nki(Eb,ob,tb,yb,lb){if(1===tb)return 32;this.M3g=window.performance.now();Eb=null;lb&&(Eb=lb);this.rf.vve(R.c(Eb)||R.c(Eb.Location)?ua.a.unknown:Eb.Location);this.rf.bNl(this.C3g,this.KPc);this.TOc||this.Aeb();return 32}EBh(Eb,ob){const tb=[],yb=Date.now();for(let lb of Eb)Eb=
(yb-lb.timeStamp)/1E3,Eb=F.a.zEg(Eb),Array.add(tb,new M(ob?lb.commandId:lb.controlId,Eb));return tb}Zfk(){var Eb=this.tca.Xad();const ob=[],tb=Date.now();for(const yb of Eb)Eb=(tb-yb.TimeStamp)/1E3,Eb=F.a.zEg(Eb),Array.add(ob,new M(yb.Id,Eb));return ob}Aeb(){if(!this.TOc){this.ihc=this.TOc=!0;""!==this.tc.xrg&&E.AFrameworkApplication.Lf(this.tc.xrg);if(!this.h0g){this.h0g=!0;const Eb={};Eb.IsMLREnabled=!this.tc.Bol;Eb.IsReactRibbonEnabled=this.tc.Eo;Eb.IsSharedHeaderEnabled=!!E.AFrameworkApplication.pa&&
E.AFrameworkApplication.pa.mb.bA;Eb.IsSearchUxEnabled=this.v3a;Eb.IsTellMeInHeaderEnabled=this.tc.jib;Eb.IsGoLocalEnv=F.a.jXf();Eb.IsSovereignEnvironment=F.a.Fge();Eb.IsTellMeServiceResultsEnabled=F.a.Lwg(this.tc);Eb.IsSubstrateProviderEnabled=F.a.Kwg(this.tc);Eb.ShouldFetchTokens=!!E.AFrameworkApplication.pa&&E.AFrameworkApplication.pa.mb.sBb;Eb.IsSerpletEnabled=F.a.fXa();Eb.FirstOnClickTimeInMS=Math.round(window.performance.now());Eb.IsHeaderHidden=E.AFrameworkApplication.hideHeader||E.AFrameworkApplication.kW;
Eb.IsSearchInHeaderHidden=E.AFrameworkApplication.Yfd;void 0!==window.performance.timing&&null!==window.performance.timing&&(Eb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Eb.IsFindWithMatchesEnabled=this.tc.a7d;Eb.HelpShowsTopSearchResult=this.tc.wyd;Eb.HelpShowsNumberOfMatches=this.tc.vyd;this.rf.RAl(JSON.stringify(Eb))}this.nKe=this.EBh(m.a.instance.Kad(),!1);this.kQg=this.EBh(m.a.instance.Kqc(),!0);this.k4g=this.Zfk();this.rf.Aeb()}}Qbb(Eb,ob,tb,yb,lb){if(1===
tb)return 32;if(R.c(lb))return this.rf.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Hb.a.sT)return 32;this.Aeb();Eb=new W(Object(f.a)(this,this.hBa,"onRequestCompleted"),0);this.vxa++;this.rf.beginQuery("",this.vxa,this.ihc);this.MDa=Fa.r5d;this.qFb=ia.zyf;if(this.wxa)this.wxa.H6(new I("",this.vxa),Eb,this.tc.Eo);else this.rf.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.bec&&this.Za.Eb(this.bec);return 32}tim(Eb){if(1===Eb)return 32;
this.jb.TQ(this.tc.jib||this.v3a?this.tc.eub:this.tc.EZa,!1);return 32}tellMe(Eb,ob,tb,yb,lb){if(1===tb)return 32;if(R.c(lb))return this.rf.onError("TellMeActor:TellMe","actiondata comes null"),16;this.rf.vve(R.c(lb.Location)?ua.a.unknown:lb.Location);Eb=lb.Value;this.tc.Eo||Eb&&""!==Eb.trim()?(!this.qFb&&this.tc.Eo&&(this.rf.tyb(v(ob),this.KPc),this.Aeb()),this.Yvk(Eb,lb.Location),lb.PopulationXML=this.MDa.xml):this.ihc?lb.PopulationXML=this.MDa.xml:(lb.PopulationXML=Fa.r5d.xml,this.qFb=ia.zyf,this.Vec=
"");return 32}Yvk(Eb,ob){this.tc.Eo&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Eb));Eb&&0<Eb.trim().length&&(this.ihc=!1);this.tc.Tuk();ob=R.c(ob)?ua.a.tellMe:ob;if(Eb!==this.Vec||this.tc.Eo){this.vxa++;this.rf.beginQuery(Eb,this.vxa,this.ihc);const tb=new I(Eb,this.vxa),yb=new W(Object(f.a)(this,this.hBa,"onRequestCompleted"),this.vxa);this.MDa=Fa.r5d;this.qFb=ia.zyf;if(this.wxa)this.wxa.H6(tb,yb,this.tc.Eo,ob,this.Xkb),this.Xkb=null;else this.rf.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.C3g=this.vxa;this.Vec=Eb}}uSm(Eb){if(this.tc.Eo){var ob=appChrome.selectors.getActiveControlStates();if(ob=Object(n.a)(Object,ob[Eb.value])){Eb.label=ob.label;let tb=null;"description"in ob&&(tb=ob.description);tb&&Object.getType(tb)===String?Eb.description=tb:"secondaryText"in ob?Eb.description=ob.secondaryText:"fullDescriptionLabel"in ob&&(Eb.description=ob.fullDescriptionLabel)}}}EZl(Eb){this.tec={};let ob=0,tb=0;for(const yb of Eb){Eb=0;for(const lb of yb.results)this.tec[lb.value]=
new y(lb.groupType,lb.type,ob,Eb,tb),Eb++,tb++,lb.label||5!==lb.type||this.uSm(lb);0<Eb&&ob++}}nyc(Eb,ob,tb,yb,lb){if(1===tb)return 32;if(R.c(lb))return this.rf.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(Eb=lb.CommandValueId)&&window.open(Eb,"_blank");return 32}Ibb(Eb,ob,tb,yb,lb){if(1===tb)return 32;if(R.c(lb))return this.rf.onError("TellMeActor:InsertMention","actiondata comes null"),16;Eb=lb.UILocation;let Cc;lb=lb.CommandValueId;try{Cc=xa.a(lb)}catch(Hc){return this.rf.onError("TellMeActor:InsertMention",
"commandValueId is not in proper format"),16}return R.c(Cc)?(this.rf.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):R.c(this.oOc)?(this.rf.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Eb?(this.rf.onError("TellMeActor:InsertMention","location "+Eb+" is unexpected"),16):this.oOc.Ibb(Cc.displayName,Cc.email,Cc.userId)?32:(this.rf.onError("TellMeActor:InsertMention","mention is not inserted"),16)}Teb(Eb,ob,tb,yb,lb){return 1===tb?32:
R.c(lb)?(this.rf.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===lb.UILocation?this.ohl(tb,lb):this.nyc(Eb,ob,tb,yb,lb)}ohl(Eb,ob){if(1===Eb)return 32;if(R.c(ob))return this.rf.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(R.c(this.oOc))return this.rf.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Eb=ob.CommandValueId;return R.c(Eb)?(this.rf.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.oOc.insertHtmlText(Eb)?
32:(this.rf.onError("TellMeActor:InsertUrl","url is not inserted"),16)}hBa(Eb,ob,tb,yb,lb){tb=window.performance.now();this.EZl(ob);this.rf.Rrm(ob);this.tc.Eo?(this.qFb=this.RYe.YEk(ob,Eb,lb),appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.qFb.menuModel,Eb,lb))):this.MDa=this.Wgh.ZEk(ob,this.rf.wBa);this.bec&&this.Za.Eb(this.bec);lb={};lb.GroupsCount=ob.length;lb.QueryID=yb;lb.QueryLength=Eb.length;this.rf.wG(A.a.whk,window.performance.now()-tb,lb)}onk(Eb,ob){return ob.startsWith(this.tc.Eo?
F.a.lFg:F.a.gAe)?4:Eb?3:"bSearchHelp"===ob||ob.startsWith("GetHelpFromTellMe")?7:"bInsights"===ob||ob.startsWith("SmartLookupFromTellMe")?12:ob===this.tc.OBf?2:0}L0(Eb,ob){this.wxa&&this.wxa.L0(Eb,ob)}static get instance(){return Xb.ta||(Xb.ta=new Xb)}}Xb.ta=null;Xb.QIm="mso_tellMeService";Xb.unknown="Unknown";Object(z.a)(Xb,"TellMeActor",null,[])},1116:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{}f.tellMe="TellMe";f.contextMenu="ContextMenu";f.unknown="Unknown";Object(z.a)(f,"TellMeScenario",
null,[])},1124:function(z,H,b){z=b(0);class f{constructor(n,m){this.Tob=n;this.value=m}}Object(z.a)(f,"AttrValuePair",null,[]);b.d(H,"a",function(){return c});class c{constructor(n){this.Ulb=!1;if(!n)throw Error.argumentNull("annotations");this.Wv=n;this.ZZ=[]}get Slc(){return this.Wv}get isReadOnly(){return this.Ulb}get HPf(){return 0<this.ZZ.length}Kp(n){if(!this.Wv.Pvc(n))throw Error.argument("attributeID","Invalid attribute ID");for(const m of this.ZZ)if(n===m.Tob)return n=m.value,{returnValue:!0,
value:n};return{returnValue:!1,value:null}}vy(n,m){var {Annotations:x}=b(1103);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Wv.Pvc(n))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Wv.Quc(this.Wv.getAttributeType(n),m))throw Error.argument("value","Value is not of the correct type for the specified attribute");x.r0b(m);for(x=0;x<this.ZZ.length;++x){const y=this.ZZ[x];if(n===y.Tob){y.value=m;return}}Array.add(this.ZZ,
new f(n,m))}VNa(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Wv.Pvc(n))throw Error.argument("attributeID","Invalid attribute ID");for(let m=0;m<this.ZZ.length;++m)if(n===this.ZZ[m].Tob){Array.removeAt(this.ZZ,m);break}}M7d(n){if(!n)throw Error.argumentNull("action");for(const m of this.ZZ)n(m.Tob,m.value)}clone(){const n=new c(this.Wv);n.P8a(this);return n}P8a(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");
if(!n)throw Error.argumentNull("other");if(n.Slc!==this.Wv)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.ZZ);n.M7d((m,x)=>{this.vy(m,x)})}Gha(){const {Annotations:n}=b(1103);let m="[",x=!0;for(const y of this.ZZ){x?x=!1:m+=", ";m+=this.Wv.ZQh(y.Tob);m+="=";const v=this.Wv.getAttributeType(y.Tob),t=this.Wv.Gha(v,y.value);v===n.eba?(m+='"',m+=c.Xzf(t),m+='"'):m+=t}return m+"]"}isEqual(n){const {Annotations:m}=b(1103);if(!n)throw Error.argumentNull("other");if(this===n)return!0;
if(!n||this.Wv!==n.Slc||this.HPf!==n.HPf)return!1;let x=0,y=null,v=!1;n.M7d((t,A)=>{++x;if(!v){var D=-1;for(let U=0,F=this.ZZ.length;U<F;++U)if(this.ZZ[U].Tob===t){D=U;break}0>D?v=!0:(y||(y=Array(this.ZZ.length)),y[D]=A)}});if(this.ZZ.length!==x||v)return!1;for(let t=0,A=this.ZZ.length;t<A;++t)if(!m.cDb(this.Wv.getAttributeType(this.ZZ[t].Tob),this.ZZ[t].value,y[t]))return!1;return!0}KV(){return this.isReadOnly?this.clone():this}P2f(){const {Annotations:n}=b(1103);if(!this.isReadOnly){this.Ulb=!0;
for(const m of this.ZZ)n.r0b(m.value)}}toString(){return this.Gha()}static Xzf(n){return n.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(z.a)(c,"FeatureBundle",null,[1431,1432])},1128:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{constructor(c,n,m=null,x=null,y=-99999){this.nL="";this.sYd=-1;this.value=c;this.type=n;this.label=this.bF=m;this.groupType=21;this.description=x;this.score=y}}Object(z.a)(f,"ResultBinding",null,[])},1133:function(z,
H,b){b.d(H,"a",function(){return f});z=b(0);class f{constructor(c){this.attributes=null;this.query=c;this.Hw=[]}NF(c){this.Hw.push(c)}cHi(c){const n=[];for(const m of this.Hw)m.groupType!==c&&n.push(m);this.Hw.length!==n.length&&(this.Hw=n)}get mvc(){return!1}}Object(z.a)(f,"SimpleResultsUpdatedEventArgs",null,[1310])},1143:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{constructor(c=21,n=""){this.Js=[];this.groupType=c;this.displayName=n}get results(){return this.Js}eJ(c){c.groupType=
this.groupType;Array.add(this.results,c)}zmg(c=1){if(this.results.length>=c)for(let n=0;n<c;n++)Array.removeAt(this.results,this.results.length-1)}}Object(z.a)(f,"SimpleResultGroup",null,[1311])},1144:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{constructor(){this.H4f=null;this.Xfa=this.J4f=0}WDf(c,n,m){if(!c)throw Error.argumentNull("referenceList");if(0>n||n>c.length)throw Error.argumentOutOfRange("startIndex");if(0>m||m>c.length)throw Error.argumentOutOfRange("length");if(n+m>
c.length)throw Error.argument("Invalid start-length range");this.H4f=c;this.J4f=n;this.Xfa=m}Prb(c,n,m){this.WDf(c.H4f,c.J4f+n,m)}J(c){if(0>c||c>=this.Xfa)throw Error.argumentOutOfRange("index");return this.H4f[this.J4f+c]}get count(){return this.Xfa}static Nsf(c){const n=new f;n.WDf(c,0,c.length);return n}}Object(z.a)(f,"ReadOnlyList",null,[1460])},1155:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{}f.click="Click";f.Qbb="InteractionBegin";f.KYb="InteractionEnd";f.Xzh="ControlActivated";
f.query="Query";f.lCi="QueryIndexRecorded";f.vxh="Clicks";f.rhh="ActionEvents";f.COi="SessionContext";f.latency="Latency";f.rIi="RenderedResults";f.events="Events";f.whk="CreateResultsMenu";f.YG="UpdateRibbonControls";f.Jim="ResultsAggregation";f.H6="IssueQuery";f.T8j="CommandSuggestions";f.error="Error";f.D2f="LoadModelData";f.Kmk="DepsResolveTime";f.BGl="ModelDataWaitTime";f.timedOut="TimedOut";Object(z.a)(f,"EventNames",null,[])},1161:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1232);
class f extends b.a{constructor(){super();this.info=this.Mh=this.eventId=null}get Fra(){return"Misc"}GVb(){this.detail.W("Type",this.Fra);this.detail.W("EventId",this.eventId);this.detail.W("Func",this.Mh);this.detail.W("Info",this.info);return this.detail}}Object(z.a)(f,"BasicMergeFailureDetail",b.a,[])},1162:function(z,H,b){b.d(H,"a",function(){return m});z=b(0);var f=b(505),c=b(701),n=b(1176);class m{constructor(x,y=!0){this.tj=y&&x?x.yH():x;this.Kkc=new f.a}JB(x){this.Kkc.add(c.a.eb(x))}avm(x){this.Kkc=
x}uoi(x){this.tj&&(new n.a(this.tj,x)).Fga.forEach((y,v)=>{v.qT&&!this.Kkc.contains(y)&&(this.Kkc.add(y),v.isDeleted?(v=this.tj,v.hasProperty(c.a.oka(y))&&v.removeProperty(c.a.oka(y))):this.tj.Tma(c.a.oka(y),v.newValue));return!0})}}Object(z.a)(m,"PartialMergeResult",null,[])},1163:function(z,H,b){b.r(H);b.d(H,"updateCommandsState",function(){return A});b.d(H,"isCommandEnabled",function(){return D});b.d(H,"logCommandSuggestions",function(){return U});b.d(H,"getResultGroup",function(){return F});b.d(H,
"isCommandHookQuery",function(){return E});b.d(H,"getCommandsFromQuery",function(){return P});b.d(H,"addHighConfidenceResultsFromLocalMLProvider",function(){return G});var f=b(1178),c=b(1155),n=b(1179),m=b(1128),x=b(1143),y=b(1115),v=b(1111),t=b(2);const A=(K,S)=>{if(S&&S.Eo){const L={};for(const I of K)S.ehe(I)&&(L[I]=appChrome.selectors.getModelType(I));y.TellMeActor.instance.YG(L)}},D=K=>{const S=y.TellMeActor.instance.kZ();return!!S&&(!S.Eo&&S.$hd(K)||S.Eo&&!appChrome.selectors.isControlDisabled(K))},
U=(K,S,L,I)=>{if(y.TellMeActor.instance.rf&&K){const O=[];for(const M of K)O.push(String.format('{{"Id":"{0}","Score":{1}}}',M.commandId,M.score));K={};K[f.a.suggestions]="[{"+O.join(",")+"}]";K[f.a.Agi]=S;K[f.a.groupType]=L;K[f.a.provider]=I;y.TellMeActor.instance.rf.wG(c.a.T8j,window.performance.now(),K)}},F=(K,S,L,I,O,M,R)=>{if(L.HGf){K=L.HGf;var W=S,Y=[];S=[];for(var N of W){W=N.commandId;let aa=N;N.commandId in K&&(W=K[N.commandId],aa=new n.a(W,N.score));Array.contains(S,W)||(Y.push(aa),S.push(W))}S=
Y}N=v.a.BJk(S);A(N,L);W=[];Y=[];N=[];K=new x.a(R);R=15===R||17===R||6===R||3===R?t.AFrameworkApplication.K?t.AFrameworkApplication.K.zb("TellMeMaxRecommendedResultsToReturn",3):3:R&&16!==R?0:5;for(const aa of S){S=aa.commandId.startsWith("btnTellMeOfficeAddIn");if(L.ehe(aa.commandId)&&!S){if(v.a.Kfi(aa.commandId))continue;S=null;O&&M&&(S=O.pWk(aa.commandId,M));D(aa.commandId)?Array.add(W,new m.a(aa.commandId,5,S,null,aa.score)):Array.add(Y,new m.a(aa.commandId,5,S,null,aa.score))}else L.n7a&&S&&I&&
Array.add(N,aa.commandId.substr(21));if(W.length+N.length>=R)break}L=0;for(O=0;O<W.length&&L<R;O++,L++)K.eJ(W[O]);for(O=0;O<Y.length&&L<R;O++,L++)K.eJ(Y[O]);for(O=0;O<N.length&&L<R;O++,L++)I.zTm(N[O],K);return K},E=K=>2<K.length&&";"===K.charAt(0)&&";"===K.charAt(K.length-1)&&!!t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1)),P=K=>{const S=new x.a(0);
var L=K.split(";");K=y.TellMeActor.instance.kZ();for(const I of L)if(0<I.length){L=I.split(":");const O=2===L.length?L[0]:I;if(!K.ehe(O))break;if(1===L.length)L=new m.a(O,5),S.eJ(L);else if(2===L.length)L=new m.a(O,5,L[1]),S.eJ(L);else break}return S},G=(K,S,L)=>{if(!(S&&S.results&&S.results.length&&K&&K.results&&K.results.length))return{returnValue:!1,wcf:K,ndf:S};const I=[];for(var O of S.results)Array.add(I,O.value);O=0;const M=S.results[0].score;for(const R of K.results)if(R.score>L&&!Array.contains(I,
R.value)&&D(R.value)&&(R.score=M,Array.insert(S.results,O,R),O++),2===O)break;return 0<O?(L=S.results.length-5,0<L&&S.zmg(L),{returnValue:!0,wcf:K,ndf:S}):{returnValue:!1,wcf:K,ndf:S}}},1175:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{static tKm(c){return c.toString().charCodeAt(0)}static qsl(c){return 55296<=c&&57343>=c}static charAt(c,n){return c.charAt(n)}static Ynh(c,n){if(c===n)return!0;"\u00a0"===c&&(c=" ");"\u00a0"===n&&(n=" ");return c===n}static Xnh(c,n){if(c===n)return!0;
if(!c||!n||c.length!==n.length)return!1;c=f.CIi(c);n=f.CIi(n);return c===n}static CIi(c){return c.replace(f.ind," ")}static PBb(c,n,m){return c.substring(n,n+m)}}f.ind=RegExp("\u00a0","g");Object(z.a)(f,"CharUtils",null,[])},1176:function(z,H,b){b.d(H,"a",function(){return y});z=b(0);var f=b(282),c=b(701),n=b(195),m=b(40),x=b(1400);class y{constructor(v,t){this.Lvj=v;this.dvj=t;this.QTe=new n.a(()=>this.eid());this.izj=new n.a(Object(m.a)(this,this.pvk,"evaluatePropertyDiffs"))}get at(){return this.Lvj}get He(){return this.dvj}get gLa(){return!!this.He&&
!this.at}get isDeleted(){return!this.He&&!!this.at}get qT(){return this.gLa||this.isDeleted||this.QTe.value}get Fga(){return this.izj.value}eid(v=null){let t=!1;this.Fga.forEach((A,D)=>{t=D.qT&&(!v||7!==v.J(A));return!t});return t}pvk(){const v=new f.a;var t=this.He,A=this.at;if(this.gLa){A=t.Fn();for(var D=0;D<A.length;D++){var U=A[D];v.W(c.a.eb(U),new x.a(U,null,t.fW(U)))}}else if(this.isDeleted)for(t=A.Fn(),D=0;D<t.length;D++)U=t[D],v.W(c.a.eb(U),new x.a(U,A.fW(U),null));else{D=A.Fn();for(U=0;U<
D.length;U++){var F=D[U];let E=c.a.eb(F);const P=A.fW(F),G=t.hasProperty(F)?t.fW(F):null;v.W(E,new x.a(F,P,G))}D=t.Fn();for(U=0;U<D.length;U++)F=D[U],A.hasProperty(F)||v.W(c.a.eb(F),new x.a(F,null,t.fW(F)))}return v}}Object(z.a)(y,"MergeableObjectDiff",null,[])},1177:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);var f;(function(c){c[c.Classifier=0]="Classifier";c[c.AppsForOffice=1]="AppsForOffice";c[c.FindInDocument=2]="FindInDocument";c[c.RecentlyUsed=3]="RecentlyUsed";c[c.TryQuery=4]="TryQuery";
c[c.Empty=5]="Empty";c[c.TryCommand=6]="TryCommand";c[c.Assistance=7]="Assistance";c[c.Answer=8]="Answer";c[c.Definition=9]="Definition";c[c.Entity=10]="Entity";c[c.WolframAnswer=11]="WolframAnswer";c[c.Insights=12]="Insights";c[c.People=13]="People";c[c.Document=14]="Document";c[c.Recommended=15]="Recommended";c[c.ServiceClassifier=16]="ServiceClassifier";c[c.ServiceRecommended=17]="ServiceRecommended";c[c.Image=18]="Image";c[c.Notes=19]="Notes";c[c.Learning=20]="Learning";c[c.None=21]="None"})(f||
(f={}));Object(z.b)("ResultGroupType",f)},1178:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{}f.appName="AppName";f.Dja="CloseAllMenus";f.commandId="CommandId";f.context="Context";f.culture="Culture";f.message="Message";f.errorMessage="ErrorMessage";f.event="Event";f.hla="CorrelationID";f.YWl="ParentUiElement";f.query="Input";f.Fzc="QueryID";f.mCi="QueryLength";f.Kzc="QueryIndex";f.Kim="ResultsList";f.suggestions="Suggestions";f.scenario="Scenario";f.sessionId="SessionID";f.source=
"Source";f.timeStamp="Time";f.i3i="UiElement";f.WDi="ReactUx";f.value="Val";f.statusCode="StatusCode";f.oom="Service";f.isSuccess="IsSuccess";f.WKm="TokenAcquired";f.Svl="LatencyType";f.groupName="GroupName";f.psa="GroupIndex";f.groupType="GroupType";f.resultType="ResultType";f.qnl="IsInputBlur";f.rnl="IsInputFocus";f.Jrl="IsShortCutUsed";f.actionType="ActionType";f.count="Count";f.Jrk="DwellTime";f.Agi="IsZeroTerm";f.zYm="WordsCount";f.tge="IsSearchUxEnabled";f.Msl="IsTellMeInHeaderEnabled";f.module=
"Module";f.resultIndex="ResultIndex";f.Qwf="DisplayIndex";f.Xsk="EnableList";f.provider="Provider";f.contentType="ContentType";f.nrl="IsSelectionBased";Object(z.a)(f,"Columns",null,[])},1179:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{constructor(c,n){this.commandId=c;this.score=n}}Object(z.a)(f,"CommandSuggestion",null,[])},1197:function(z,H,b){b.d(H,"b",function(){return x});b.d(H,"a",function(){return v});var f=b(151),c=b(282),n=b(505),m=b(1402);const x=(A,D,U)=>{const F=y(A,
D,U);let E=0,P=0,G=0,K=new m.a;const S=new f.a;for(let L=0;L<F.length;L++){const I=F.Ve(L+1);K.OYd(A.Ve(E));K.QYd(D.Ve(P));K.VYd(U.Ve(G));E++;P++;for(G++;E<A.length&&(!I||!I.equals(A.Ve(E)));)K.OYd(A.Ve(E)),E++;for(;P<D.length&&(!I||!I.equals(D.Ve(P)));)K.QYd(D.Ve(P)),P++;for(;G<U.length&&(!I||!I.equals(U.Ve(G)));)K.VYd(U.Ve(G)),G++;S.add(K);K=new m.a}for(;E<A.length;)K.OYd(A.Ve(E)),E++;for(;P<D.length;)K.QYd(D.Ve(P)),P++;for(;G<U.length;)K.VYd(U.Ve(G)),G++;K.isEmpty||S.add(K);return S},y=(A,D,U)=>
{const F=new f.a,E=D.UG(),P=U.UG();A.forEach(G=>{E.contains(G)&&P.contains(G)&&F.add(G);return!0});return F},v=(A,D,U)=>{A=A||new f.a;D=D||new f.a;U=U||new f.a;const F=new f.a,E=new c.a(0),P=new n.a;for(var G=0;G<A.length;G++){var K=A.Ve(G);E.W(K,G)}for(A=G=0;G<D.length&&A<U.length;){K=D.Ve(G);let S=U.Ve(A),L=E.gz(K,-1),I=E.gz(S,-1);-1===L?(t(P,F,K),G++):-1===I?(t(P,F,S),A++):L===I?(t(P,F,K),G++,A++):L<I?G++:A++}for(;G<D.length;G++)K=D.Ve(G),-1===E.gz(K,-1)&&t(P,F,K);for(;A<U.length;A++)D=U.Ve(A),
-1===E.gz(D,-1)&&t(P,F,D);return F},t=(A,D,U)=>{A.contains(U)||(D.add(U),A.add(U))}},1198:function(z,H,b){b.d(H,"a",function(){return c});z=b(0);var f=b(48);class c{constructor(){this.cp=0;this.id=f.a.create()}}Object(z.a)(c,"LcsUpdateHint",null,[1449,282])},1199:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{}f.tellMe="TellMe";f.loki="Loki";f.substrate="Substrate";f.Kzc="QueryIndex";f.h_i="TellMeRanker";f.i_i="TellMeRankerLogging";Object(z.a)(f,"Services",null,[])},1200:function(z,
H,b){b.d(H,"a",function(){return f});z=b(0);class f{}f.rWa="HttpRequest";f.provider="Provider";Object(z.a)(f,"LatencyTypes",null,[])},1208:function(z,H,b){z=b(0);var f=b(15),c=b(4),n=b(151),m=b(111),x=b(169),y=b(48),v=b(505),t=b(40),A=b(158),D=b(1232);class U extends D.a{constructor(){super();this.fte=null}get Fra(){return"CreateMergeBlock"}GVb(){this.detail.W("Type",this.Fra);this.detail.W("Revision",this.fte);return this.detail}}Object(z.a)(U,"CreateMergeBlockFailureDetail",D.a,[]);var F=b(1292),
E=b(1294),P=b(1399),G=b(1233),K=b(1162),S=b(1451);b.d(H,"a",function(){return L});class L{static T2d(I,O,M,R,W,Y,N){let aa;aa="";const ia=new n.a;for(let la=0;la<M.length;la++){var ea=void 0;let xa;ea=F.a.dLk(O,M.J(la),R,W,Y,N,I);if(!ea)return{returnValue:null,Udb:aa};({f6f:xa,Udb:ea}=ea.cXh());if(!xa)return{returnValue:null,Udb:aa};aa+=ea;ia.my(ia.length,xa)}return{returnValue:ia,Udb:aa}}static jCh(I,O,M,R,W,Y,N,aa){let ia,ea,la,xa,Ha,ua;ua=Ha=xa=la=ea=ia=null;({Udb:xa,returnValue:ia}=L.T2d(O,Ra=>
I.runtime.pj.J(Ra),M,1,Y,N,aa));if(!ia)return m.a.instance.Ba(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),I.ma.uf(Object.assign(new U,{fte:"Base"})),{returnValue:!1,rL:ia,D9c:ea,kCd:la,HZd:xa,I6d:Ha,vAe:ua};({Udb:Ha,returnValue:ea}=L.T2d(O,Ra=>I.runtime.Aw.J(Ra)||I.runtime.pj.J(Ra),R,2,Y,N,aa));if(!ea)return m.a.instance.Ba(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
I.ma.uf(Object.assign(new U,{fte:"Favored"})),{returnValue:!1,rL:ia,D9c:ea,kCd:la,HZd:xa,I6d:Ha,vAe:ua};({Udb:ua,returnValue:la}=L.T2d(O,Ra=>I.runtime.wp.J(Ra)||I.runtime.pj.J(Ra),W,4,Y,N,aa));return la?{returnValue:!0,rL:ia,D9c:ea,kCd:la,HZd:xa,I6d:Ha,vAe:ua}:(m.a.instance.Ba(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),I.ma.uf(Object.assign(new U,{fte:"Unfavored"})),{returnValue:!1,rL:ia,
D9c:ea,kCd:la,HZd:xa,I6d:Ha,vAe:ua})}static txh(I,O=!1){const M=new n.a;let R=0;for(;R<I.length;){var W=I.J(R);if(1===W.type||4===W.type||2===W.type)M.add(W),R++;else if(3===W.type){let N="";N+=W.character;R++;let aa=W.$Wa,ia=!1;for(;R<I.length;R++){var Y=I.J(R);3===Y.type?W.runId===Y.runId&&W.EJ.equals(Y.EJ)&&(W.Kka===Y.Kka||W.wKa===Y.wKa)&&W.fF.jz(Y.fF)&&(!O||W.OA&&W.OA.equals(Y.OA))?(N+=Y.character,Y.$Wa&&(aa=!0)):ia=!0:ia=!0;if(ia){W=new S.a(null,W.source,W.jj,W.nf,W.runId,W.EJ,N,W.Zxb,!0,aa,
W.Kka,W.wKa,W.K7b,W.fF,W.OA);M.add(W);break}}}}m.a.instance.Ba(17044302,1,3,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",M.Go());return M}static L8j(I,O=!1){const M=new n.a;let R=0;for(;R<I.length;){var W=I.J(R);if(1===W.type||4===W.type||2===W.type)M.add(W),R++;else if(3===W.type){let N=W.character.toString();R++;let aa=W.$Wa;for(;R<I.length;R++){var Y=I.J(R);if(3===Y.type&&L.Uxm(W,Y,O))N+=Y.character,Y.$Wa&&(aa=!0);else break}W=new S.a(null,W.source,W.jj,W.nf,
W.runId,W.EJ,N,W.Zxb,!0,aa,W.Kka,W.wKa,W.K7b,W.fF,W.OA);M.add(W)}}m.a.instance.Ba(50931345,1,3,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",M.Go());return M}static Uxm(I,O,M){return I.runId===O.runId&&I.EJ.equals(O.EJ)&&(I.Kka===O.Kka||I.wKa===O.wKa)&&I.fF.jz(O.fF)&&(!M||!!I.OA&&I.OA.equals(O.OA))}static ntm(I,O,M,R,W,Y,N,aa,ia,ea,la,xa,Ha,ua,Ra,ab){I.setPropertyString(M.tj,f.a.ml,W);I.setPropertyUint32(M.tj,c.a.Gb,R);I.setPropertyUint32s(M.tj,c.a.tm,Y);I.setPropertyUint32s(M.tj,
c.a.po,N);I.setPropertyObjectIds(M.tj,f.a.BC,ia);I.hasProperty(M.tj,c.a.Og)&&I.setPropertyUint32(M.tj,c.a.Og,L.IEk());O&&O(20)&&I.setPropertyObjectIds(M.tj,c.a.Ir,ab);R=!1;for(W=0;W<ea.length;W++)if(ea.J(W)){R=!0;break}R&&I.setPropertyBools(M.tj,c.a.a8f,ea);L.H0j(O,I,M,la,xa,Ha,ua);L.I0j(I,M,Ra);M.JB(f.a.ml);M.JB(c.a.Gb);M.JB(c.a.tm);M.JB(c.a.po);M.JB(f.a.BC);M.JB(c.a.a8f);M.JB(f.a.hA);M.JB(f.a.cva);M.JB(c.a.mQ);M.JB(c.a.fO);M.JB(f.a.$N);M.JB(c.a.Ir);I.hasProperty(M.tj,c.a.Og)&&M.JB(c.a.Og);0<aa.length?
I.setPropertyUint32s(M.tj,f.a.hA,aa):M.tj.removeProperty(f.a.hA)}static H0j(I,O,M,R,W,Y,N){if(I(164)){I=R.contains(!0,(aa,ia)=>ia);L.Qug(O,M,f.a.$N,I?R:null);L.Qug(O,M,f.a.cva,L.PJi(R,W));L.Qug(O,M,c.a.mQ,L.PJi(R,Y));R=!1;for(W=0;W<N.length;W++)N.J(W)&&(R=!0);R?O.setPropertyUint32s(M.tj,c.a.fO,N):M.tj.removeProperty(c.a.fO)}}static I0j(I,O,M){const R=N=>N;var W=Object(t.a)(I,I.setPropertyBools,"setPropertyBools");L.ZTa(O,M.Jub,R,W,c.a.HWa);L.ZTa(O,M.Iqb,R,W,c.a.Sya);L.ZTa(O,M.pfb,R,W,c.a.DYa);W=N=>
0<N.length;var Y=Object(t.a)(I,I.setPropertyStrings,"setPropertyStrings");L.ZTa(O,M.Iub,W,Y,c.a.IWa);L.ZTa(O,M.Hqb,W,Y,c.a.IUa);L.ZTa(O,M.hzb,W,Y,c.a.W_a);W=N=>!!N;Y=Object(t.a)(I,I.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");L.ZTa(O,M.Kub,W,Y,c.a.JWa);L.ZTa(O,M.w9a,W,Y,c.a.JUa);L.ZTa(O,M.jzb,W,Y,c.a.X_a);M.pfb.any(R)?L.ZTa(O,M.izb,()=>!0,Object(t.a)(I,I.setPropertyObjectIds,"setPropertyObjectIds"),c.a.oPa):O.tj.removeProperty(c.a.oPa)}static PJi(I,O){const M=new n.a;let R=!1;for(let W=
0;W<I.length;W++){const Y=O.J(W)&&!I.J(W);M.add(Y);R=Y||R}return R?M:null}static Qug(I,O,M,R){R?I.setPropertyBools(O.tj,M,R):O.tj.removeProperty(M)}static IEk(){return x.a.vz()}static MXh(I,O){return I.runtime.Aw.gz(O,I.runtime.pj.J(O)||I.runtime.wp.get(O))}static wcd(I,O,M,R,W){let Y;Y=new n.a;const N=!!M&&M(20);if(I.runtime.Qa.isFeatureEnabled(126)){var aa=L.L8j(R,N);var ia=L.txh(R,N);aa.length!==ia.length&&I.runtime.Qa.us(126)}else aa=L.txh(R,N);ia=0;let ea="",la=new n.a,xa=new n.a,Ha=new n.a,
ua=new n.a,Ra=new n.a,ab=new n.a,Ba=new n.a,Ga=new n.a,ja=new n.a;const X=new P.a;let fa=new n.a;var pa=aa.J(aa.length-1);if(2!==pa.type&&4!==pa.type)return m.a.instance.Ba(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",pa.type),I.ma.uf(Object.assign(new G.a,{Mh:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",pa.type)})),{returnValue:!1,Ioe:Y};var Ia=0;for(pa=
0;pa<aa.length;pa++){var ta=aa.J(pa),oa=null;if(1===ta.type||3===ta.type)oa=ta,ea+=oa.text;else if(4===ta.type){ta=L.MXh(I,ta.jj);ta=new K.a(ta);Y.add(ta);continue}oa?(la.add(oa.runId),xa.add(oa.nf),Ia+=oa.text.length,Ha.add(Ia),ua.add(oa.EJ),Ra.add(oa.Zxb),ab.add(oa.$Wa),Ba.add(oa.Kka),Ga.add(oa.wKa),ja.add(oa.K7b),X.Jub.add(oa.fF.A9k),X.Iqb.add(oa.fF.k9k),X.pfb.add(oa.fF.R9k),X.Iub.add(oa.fF.insertion.author),X.Hqb.add(oa.fF.deletion.author),X.hzb.add(oa.fF.ANa.author),X.Kub.add(oa.fF.insertion.Hnd),
X.w9a.add(oa.fF.deletion.Hnd),X.jzb.add(oa.fF.ANa.Hnd),X.izb.add(oa.fF.ANa.Yfg),N&&fa.add(oa.OA)):la.length||(la.add(0),xa.add(0),Ha.add(0),ua.add(y.a.nil),Ra.add(!1),ab.add(!1),Ba.add(!1),Ga.add(!1),ja.add(0),X.Jub.add(!1),X.Iqb.add(!1),X.pfb.add(!1),X.Iub.add(""),X.Hqb.add(""),X.hzb.add(""),X.Kub.add(0),X.w9a.add(0),X.jzb.add(0),X.izb.add(y.a.nil));if(2===ta.type){Ia=ta;ta=Ia.Gb;Ha.WB(Ha.length-1);oa=W.J(ia);if(!oa)return m.a.instance.Ba(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
ia,W.length,R.length,pa,aa.length),I.ma.uf(Object.assign(new G.a,{Mh:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),m.a.instance.mna(17044308,1,3,"GetMergeableObjectsFromMergeBlocks Paragraphs",W.Go()),m.a.instance.mna(17044309,1,3,"GetMergeableObjectsFromMergeBlocks MergeBlocks",R.Go()),m.a.instance.mna(17044310,1,3,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",aa.Go()),{returnValue:!1,Ioe:Y};if(oa=L.MXh(I,oa))oa=new K.a(oa.yH()),L.ntm(O,M,oa,Ia.Gb,
ea,la,xa,Ha,ua,Ra,ab,Ba,Ga,ja,X,fa),Y.add(oa);m.a.instance.Ba(17044312,1,3,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Ia.jj,ta,la.Go(),xa.Go(),Ha.Go(),ab.Go(),Ba.Go(),Ga.Go(),ua.Go(),"",ja.Go());ia++;ea="";la=new n.a;xa=new n.a;Ha=new n.a;ua=new n.a;Ra=new n.a;ab=new n.a;Ba=new n.a;Ga=new n.a;ja=new n.a;X.reset();Ia=0;fa=new n.a}}return{returnValue:!0,
Ioe:Y}}static Rhm(I,O){const M=I.runtime.Fl.J(A.a.lR),R=O.getPropertyObjectIds(M.tj,c.a.m8);for(let W=0;W<R.length;W++)I.runtime.Fl.remove(R.J(W));O.setPropertyObjectIds(M.tj,c.a.m8,new n.a);O.setPropertyString(M.tj,c.a.k0a,y.a.nil.toString());M.JB(c.a.m8);M.JB(c.a.k0a)}static pfl(I,O){if(I.runtime.Fl.Pa(A.a.lR))return null;const M=new K.a(I.runtime.pj.J(A.a.lR).yH());O.setPropertyString(M.tj,c.a.k0a,I.output.cK.last().id.toString());O.setPropertyObjectIds(M.tj,c.a.m8,new n.a);M.JB(c.a.m8);M.JB(c.a.k0a);
I.runtime.Fl.W(A.a.lR,M);return M}static GJf(I){const O=new n.a;I.forEach(M=>{O.add(M.id);return!0});return O}static zwc(I,O,M,R){let W=0;M.forEach(Y=>{E.a(Y,O+W++,1);393230===Y.Kb&&I.getPropertyObjectIds(Y,f.a.BC).forEach(N=>{R.add(N);return!0});return!0})}static kzl(I,O){const M=new v.a;let R=0;O.forEach(W=>{if(M.contains(W))return!0;M.add(W);if(({index:R}=L.j3f("BaseFormatting_",R,W,Y=>I.runtime.pj.J(Y))).returnValue||({index:R}=L.j3f("FavoredFormatting_",R,W,Y=>I.runtime.Aw.J(Y))).returnValue||
({index:R}=L.j3f("ConflictingFormatting_",R,W,Y=>I.runtime.wp.J(Y))).returnValue)return!0;R++;return!0})}static j3f(I,O,M,R){if(M=R(M))if(E.a(M,I+O,1),1179649===M.Kb)return O++,{returnValue:!0,index:O};return{returnValue:!1,index:O}}static xxf(I){return!!I.runtime.pj.J(A.a.lR)}static ZTa(I,O,M,R,W){O.any(M)?(R(I.tj,W,O),I.JB(W)):I.tj.removeProperty(W)}static jRi(I,O){const M=new n.a;M.add(0);const R=I?I.length:0;for(let W=0;W<R;W++)M.insert(W+1,I.Ve(W));M.insert(M.length,O);return M}}Object(z.a)(L,
"ParagraphMergeUtils",null,[])},1230:function(z,H,b){b.d(H,"a",function(){return c});z=b(0);var f=b(151);class c{constructor(n,m,x){this.Vl=null;this.Jk=n;this.source=m;this.jj=x}get type(){return this.Jk}get Shb(){return!1}get vml(){return 1===(this.source&1)}get wml(){return 2===(this.source&2)}get yml(){return 4===(this.source&4)}b2(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",this.KHk(),this.Qqc())}KHk(){let n="";this.vml&&(n+="Base");this.wml&&(n+="FavoredUpdate");this.yml&&
(n+="UnfavoredUpdate");return n}Qqc(){return""}jz(n){return this.type===n.type}xzd(){const n=new f.a;n.add(this);return n}get length(){return 0}}Object(z.a)(c,"AMergeBlock",null,[41,42])},1231:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1230);class f extends b.a{constructor(c,n,m){super(2,c,n);this.Gb=m}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),this.Gb,this.jj)}Qqc(){return"Eop"}clone(){return new f(this.source,this.jj,this.Gb)}jz(c,n,m,
x=!1,y=!0){return super.jz(c,n,m,x)?y?c.Gb===this.Gb:c.jj===this.jj&&c.Gb===this.Gb:!1}get length(){return 1}}Object(z.a)(f,"EopMergeBlock",b.a,[])},1232:function(z,H,b){b.d(H,"a",function(){return c});z=b(0);var f=b(282);class c{constructor(){this.detail=new f.a}}Object(z.a)(c,"AMergeFailureDetail",null,[1844])},1233:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1161);class f extends b.a{constructor(){super()}get Fra(){return"ParagraphMerge"}}Object(z.a)(f,"ParagraphMergeFailureDetail",
b.a,[])},1234:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1161);class f extends b.a{constructor(){super()}get Fra(){return"RdOpLcs"}}Object(z.a)(f,"ReducedOpsLcsFailureDetail",b.a,[])},1235:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1161);class f extends b.a{constructor(){super()}get Fra(){return"TableMerge"}}Object(z.a)(f,"TableMergeFailureDetail",b.a,[])},1239:function(z,H,b){z=b(0);class f{constructor(){this.mBd=this.Ugd=null;this.J5f=this.score=this.ond=0}Odg(F,
E,P){this.score=F.J(E);++E;this.Ugd=F.J(E)?P.Xra(F.J(E)):null;++E;this.mBd=F.J(E)?P.Xra(F.J(E)):null;++E;this.ond=F.J(E);++E;this.J5f=F.J(E);++E;return E}}Object(z.a)(f,"TokenStringGeneratorInit",null,[]);class c{constructor(F,E,P,G,K){this.Frb=F;this.count=E;this.w7d=P;this.VP=G;this.depth=K}}Object(z.a)(c,"ErrorTolerantTrieMatch",null,[]);var n=b(1309),m=b(1419);class x{constructor(F=null,E=0,P=0,G=0){this.uFj=F||new m.a;this.iza=E;this.VP=P;this.depth=G}get j8(){return this.uFj}getKey(){return this.j8.qx.toString()+
":"+this.iza.toString()}}Object(z.a)(x,"TrieBookmark",null,[]);class y{constructor(F,E){this.KXa=F;this.D4f=E}FBl(F){if(null==F)throw Error.argumentNull("prefix");let E={};var P=E[""]=new x;this.Mce(P,E);for(P=0;P<F.length;++P){const G=F.charCodeAt(P),K={};for(let S in E)this.QPj(G,E[S],K);E=K}return this.aMm(E)}Mce(F,E){if(!(F.VP>=this.D4f)&&(F=new x(n.a.pnf(F.j8),F.iza,F.VP+1,F.depth),F.j8.lF&n.a.ujb&&(F.iza+=1),this.KXa.Xbc(F.j8))){F.depth+=1;let P=!0;for(;P;)y.WAe(F,E),this.Mce(F,E),F.iza+=this.KXa.erc(F.j8,
!0)+(F.j8.lF&n.a.ujb?1:0),P=this.KXa.HBd(F.j8)}}QPj(F,E,P){E.VP+1<=this.D4f&&(E.VP+=1,y.WAe(E,P),--E.VP);E.j8.lF&n.a.ujb&&(E.iza+=1);if(this.KXa.Xbc(E.j8)){E.depth+=1;let G=!0;for(;G;)E.j8.Tcc===F?(y.WAe(E,P),this.Mce(E,P)):E.VP+1<=this.D4f&&(E.VP+=1,y.WAe(E,P),this.Mce(E,P),--E.VP),E.iza+=this.KXa.erc(E.j8,!0)+(E.j8.lF&n.a.ujb?1:0),G=this.KXa.HBd(E.j8)}}aMm(F){const E=[];for(var P in F){const G=F[P];if(!G.j8.qx)continue;const K=!!(G.j8.lF&n.a.ujb),S=this.KXa.erc(G.j8,!1)+(K?1:0);Array.add(E,new c(G.iza,
S,K,G.VP,G.depth))}E.sort((G,K)=>{let S=G.Frb-K.Frb;return S||(S=-(G.count-K.count))?S:S=G.depth-K.depth});if(2>E.length)return E;F=[];for(P=0;P<E.length;)P+=y.l1i(P,E,F);return F}static WAe(F,E){const P=F.getKey();P in E?(E=E[P],E.VP=Math.min(E.VP,F.VP)):E[P]=new x(n.a.pnf(F.j8),F.iza,F.VP,F.depth)}static l1i(F,E,P){const G=E[F];let K=G.Frb;const S=K+G.count;let L=1,I=G.w7d;for(;F+L<E.length&&E[F+L].Frb<S;){const O=E[F+L];O.Frb>K&&(Array.add(P,new c(K,O.Frb-K,I,G.VP,G.depth)),I=!1);L+=y.l1i(F+L,
E,P);K=O.Frb+O.count}K<S&&Array.add(P,new c(K,S-K,I,G.VP,G.depth));return L}}Object(z.a)(y,"ErrorTolerantTrieLookupEngine",null,[1502]);class v extends f{constructor(F,E,P){super();this.w7h=this.Vwi=!1;this.KKh=null;if(F){var G=0;try{G=this.Odg(F,G,E);this.Vwi=1===F.J(G);++G;this.w7h=1===F.J(G);++G;const K=F.J(G);this.KKh=this.jXl(P,K)}catch(K){throw Error.argument("initData");}}}jXl(F,E){return new y(F,E)}}Object(z.a)(v,"FuzzyMatchTokenStringGeneratorInit",f,[]);class t extends f{constructor(F,E){super();
this.query=this.name=null;if(F){this.Je=E.Je;var P=0;try{P=this.Odg(F,P,E),this.name=E.KE(F.J(P)),++P,this.query=E.EL(F.J(P))}catch(G){throw Error.argument("initData");}}}}Object(z.a)(t,"QueryTokenStringGeneratorInit",f,[]);class A extends f{constructor(F,E){super();if(F)try{this.Odg(F,0,E)}catch(P){throw Error.argument("initData");}}}Object(z.a)(A,"SurfaceStringTokenStringGeneratorInit",f,[]);var D=b(1144);b.d(H,"a",function(){return U});class U{constructor(F){this.u4f=F}get Ugd(){return this.u4f.Ugd}get mBd(){return this.u4f.mBd}get ond(){return this.u4f.ond}static create(F,
E,P){const {SurfaceStringTokenStringGenerator:G}=b(1593),{QueryTokenStringGenerator:K}=b(1594),{FuzzyMatchTokenStringGenerator:S}=b(1595);let L=0;try{if(F.J(L)!==U.WPb)throw Error.argument("initData","Input does not represent a token string generator");++L;const I=F.J(L);++L;const O=new D.a;O.Prb(F,L,F.count-L);switch(I){case G.K1c:return new G(new A(O,E));case K.K1c:return new K(new t(O,E));case S.K1c:return new S(new v(O,E,P));default:throw Error.argument("initData");}}catch(I){throw Error.argument("initData");
}}static Hjh(F,E,P,G,K,S){F=F.aLm.getId(E,null);if(0>F)return++S,S;U.Ijh(F,P,G,K);return S}static Ijh(F,E,P,G){Array.add(G.UAg,F);Array.add(G.iYi,E);++G.pFc[P]}}U.WPb=1099767983;Object(z.a)(U,"TokenStringGenerator",null,[1478])},1291:function(z,H,b){b.d(H,"a",function(){return n});z=b(0);var f=b(151);H=b(1230);var c=b(1175);class n extends H.a{constructor(m,x,y){super(m,x,y)}$Dm(m){let x;x=null;if(!this.text||!this.Shb||0>=m||m>=this.length)return{returnValue:!1,kXi:x};x=new f.a;const y=this.clone();
y.eyd(c.a.PBb(this.text,0,m));const v=this.clone();v.eyd(c.a.PBb(this.text,m,this.length-m));x.add(y);x.add(v);return{returnValue:!0,kXi:x}}b2(){return!0}get length(){return this.text.length}}Object(z.a)(n,"ATextMergeBlock",H.a,[])},1292:function(z,H,b){b.d(H,"a",function(){return c});z=b(0);var f=b(111);class c{zff(n,m){return n+("[Block: "+m+"] ")}static dLk(n,m,x,y,v,t,A){const {ParagraphMergeBlockCreator:D}=b(1646),{TableMergeBlockCreator:U}=b(1650);if(393230===m.Kb)return new D(n,m,x,v,t,y(20),
A);if(393250===m.Kb)return new U(m,x);f.a.instance.Ba(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",m.Kb);return null}}Object(z.a)(c,"MergeBlockCreator",null,[])},1293:function(z,H,b){b.d(H,"a",function(){return m});z=b(0);var f=b(4),c=b(48);H=b(1291);var n=b(1176);class m extends H.a{constructor(x,y,v,t,A,D,U,F,E,P,G,K,S,L){super(y,v,t);this.nf=A;this.runId=D;this.Zxb=F;this.Cnj=U;this.eHe=x;this.$Wa=E;this.Kka=P;this.wKa=G;this.K7b=K;this.fF=S;this.OA=L}get f0c(){return this.eHe}get EJ(){return this.Cnj}get Krb(){return this.f0c(this.EJ)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",
super.toString(),this.nf,this.runId,this.Zxb,this.jj,this.EJ.toString(),this.OA?this.OA.toString():"NULL")}jz(x,y,v,t=!1){if(!super.jz(x,y,v,t))return!1;if(t)return!0;if(!this.fF.jz(x.fF)||this.OA&&!this.OA.equals(x.OA))return!1;if(this.EJ.equals(x.EJ)||this.EJ.equals(c.a.nil)||x.EJ.equals(c.a.nil))return!0;x=new n.a(this.Krb,x.Krb);y=y.QBh(this.Krb);return x.eid(y.nsd)?!1:!0}get Vil(){return this.b2()&&"\ufffc"===this.text&&this.Krb?this.Krb.hasProperty(f.a.tq)||1179725!==this.Krb.Kb?!0:!1:!1}}Object(z.a)(m,
"AUserRunMergeBlock",H.a,[])},1294:function(z,H,b){b.d(H,"a",function(){return c});var f=b(111);const c=(n,m,x=4)=>{n?f.a.instance.mna(4273285,x,3,m,n.rCb()):f.a.instance.Ba(4293845,x,1,m,"{0}: Node was null.",m)}},1295:function(z,H,b){b.d(H,"e",function(){return y});b.d(H,"a",function(){return v});b.d(H,"d",function(){return t});b.d(H,"b",function(){return A});b.d(H,"c",function(){return D});var f=b(4),c=b(15),n=b(48),m=b(828),x=b(1197);const y=(E,P,G)=>{const K=new m.a;let S=n.a.nil;P=K.getPropertyObjectId(P,
f.a.bCb);P.equals(n.a.nil)||(E=E.runtime.pj.J(P),G&&(E=G.gz(P,E)),E&&(S=K.getPropertyObjectId(E,f.a.bCb)));return S},v=(E,P,G,K,S)=>{const L=new m.a;let I=null;var O=L.getPropertyObjectId(G,f.a.bCb);O!==n.a.nil&&(I=E.runtime.pj.J(O),P&&(I=P.gz(O,I)));if(I){O=L.getPropertyObjectIds(I,c.a.$e);for(S=0;S<O.length&&!O.J(S).equals(G.id);S++);S===O.length&&(S=-1)}G=y(E,G,P);if(!G.equals(n.a.nil)&&(E=E.runtime.pj.J(G),P&&(E=P.gz(G,E)),E)){P=L.getPropertyObjectIds(E,c.a.$e);for(K=0;K<P.length&&!P.J(K).equals(I.id);K++);
K===P.length&&(K=-1)}return{rowIndex:K,jnc:S}},t=(E,P,G,K,S)=>{var L=new m.a;let I=null;var O=E.runtime.pj.J(G);P&&(O=P.gz(G,O));if(!O)return null;O=L.getPropertyObjectIds(O,c.a.$e);G=null;K<O.length&&(K=O.J(K),G=E.runtime.pj.J(K),P&&(G=P.gz(K,G)));G&&(L=L.getPropertyObjectIds(G,c.a.$e),S<L.length&&(S=L.J(S),I=E.runtime.pj.J(S),P&&(I=P.gz(S,I))));return I},A=(E,P,G)=>{let K,S;S=K=-1;const L=(new m.a).getPropertyObjectId(G,f.a.bCb);var I=y(E,G,P);if(I.equals(n.a.nil)||L.equals(n.a.nil))return{rowIndex:K,
jnc:S};P=E.runtime.VBg;var O=P.J(I);if(!O){O=U(E,I);if(!O)return{rowIndex:K,jnc:S};P.W(I,O)}for(I=0;I<O.length;I++)if(O.J(I).equals(L)){K=I;break}O=P.J(L);if(!O){O=F(E,L);if(!O)return{rowIndex:K,jnc:S};P.W(L,O)}for(E=0;E<O.length;E++)if(O.J(E).equals(G.id)){S=E;break}return{rowIndex:K,jnc:S}},D=(E,P,G,K)=>{if(0>G||0>K)return n.a.nil;new m.a;const S=E.runtime.VBg;let L=S.J(P);if(!L){L=U(E,P);if(!L)return n.a.nil;S.W(P,L)}if(G<L.length)P=L.J(G);else return n.a.nil;G=S.J(P);if(!G){G=F(E,P);if(!G)return n.a.nil;
S.W(P,G)}if(K<G.length)E=G.J(K);else return n.a.nil;return E},U=(E,P)=>{var G=new m.a;const K=E.runtime.pj.J(P);if(K){var S=E.runtime.Aw.gz(P,K);E=E.runtime.wp.gz(P,K);P=G.getPropertyObjectIds(K,c.a.$e);S=G.getPropertyObjectIds(S,c.a.$e);G=G.getPropertyObjectIds(E,c.a.$e);return P.An(S,(L,I)=>L.equals(I))?G:P.An(G,(L,I)=>L.equals(I))?S:x.a(P,S,G,(L,I)=>L.equals(I))}return(S=E.runtime.Aw.J(P))?G.getPropertyObjectIds(S,c.a.$e):(S=E.runtime.wp.J(P))?G.getPropertyObjectIds(S,c.a.$e):null},F=(E,P)=>{var G=
new m.a;const K=E.runtime.pj.J(P);if(K){var S=E.runtime.Aw.gz(P,K);E=E.runtime.wp.gz(P,K);P=G.getPropertyObjectIds(K,c.a.$e);S=G.getPropertyObjectIds(S,c.a.$e);G=G.getPropertyObjectIds(E,c.a.$e);return P.An(S,(L,I)=>L.equals(I))?G:P.An(G,(L,I)=>L.equals(I))?S:null}return(S=E.runtime.Aw.J(P))?G.getPropertyObjectIds(S,c.a.$e):(S=E.runtime.wp.J(P))?G.getPropertyObjectIds(S,c.a.$e):null}},1297:function(z,H,b){b.d(H,"a",function(){return c});z=b(0);var f=b(1111);b=b(2);class c{static Nsl(){return!f.a.jXf()&&
!f.a.Fge()&&c.isFeatureEnabled(0)}static hfi(){return c.isFeatureEnabled(1)}static pol(){return c.isFeatureEnabled(2)}static isFeatureEnabled(n){return!!(c.Hmj&1<<n)}}c.Hmj=b.AFrameworkApplication.K?b.AFrameworkApplication.K.zb("TellMeFeatureConfigValue",0):0;Object(z.a)(c,"TellMeFeatureAvailability",null,[])},1298:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1128);class f extends b.a{constructor(c,n,m,x=null){super(c,n,x);this.id=m}}Object(z.a)(f,"TryQueryResultBinding",b.a,[])},1299:function(z,
H,b){b.d(H,"a",function(){return f});z=b(0);class f{constructor(c){this.Sa=c}get neb(){return this.Sa.neb}get VGm(){return 4!==this.Sa.style}get XGm(){return!0}get trie(){return this.Sa.trie}getId(c,n){if(!this.VGm)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Sa.style){case 0:return this.bQk(c,n);default:throw Error.notImplemented();}}KE(c){if(!this.XGm)throw Error.invalidOperation("String lookup not supported on this string table");if(0>c||c>=this.neb)throw Error.argumentOutOfRange("id",
"Invalid string ID");switch(this.Sa.style){case 0:return this.v0k(c);case 4:return this.u0k(c);default:throw Error.notImplemented();}}bQk(c,n){c=this.Sa.trie.Pli(c,0,c.length,n);if(!c.succeeded)return-1;if(0>c.xFc||c.xFc>=this.Sa.neb)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Sa.IBd?this.Sa.otd.uy(this.Sa.IBd+4*c.xFc,4):c.xFc}v0k(c){if(this.Sa.IBd){let n=0;for(;n<this.Sa.neb&&this.Sa.otd.uy(this.Sa.IBd+4*n,4)!==c;++n);if(n>=this.Sa.neb)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");
return this.Sa.trie.a0h(n)}return this.Sa.trie.a0h(c)}u0k(c){const n=this.Sa.otd.uy(this.Sa.fYi+4*c,4);c=this.Sa.otd.uy(this.Sa.gYi+4*c,4);if(0>c||0>n)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const m=Array(n);for(let x=0;x<n;++x)m[x]=({jbl:c}=this.S6l(c)).returnValue;return String.fromCharCode.apply(null,m)}S6l(c){let n=0;for(let m=0;3>m;++m){const x=this.Sa.otd.J(this.Sa.Kuh+c)^182;++c;n|=(x&127)<<7*m;if(!(x&128))break}return{returnValue:n,jbl:c}}}Object(z.a)(f,
"StringTable",null,[1463])},1300:function(z,H,b){b.d(H,"a",function(){return c});z=b(0);var f=b(1309);class c{constructor(n){this.trie=null;this.Kuh=this.fYi=this.gYi=this.IBd=0;if(n){this.otd=n;var m=0;if(n.uy(m,4)!==c.WPb)throw Error.argument("bytes","Input does not represent a string table");m+=4;this.neb=n.uy(m,4);m+=4;this.style=n.uy(m,4);m+=4;switch(this.style){case 0:const x=1===n.uy(m,4);m+=4;x||(this.IBd=m,m+=4*this.neb);n.uy(m,4);this.trie=this.FXl(n,m+4);break;case 4:this.gYi=m;this.fYi=
m+=4*this.neb;m+=4*this.neb;n.uy(m,4);this.Kuh=m+4;break;default:throw Error.argument("bytes");}}}FXl(n,m){return new f.a(n,m)}}c.WPb=1025118440;Object(z.a)(c,"StringTableInit",null,[])},1305:function(z,H,b){z=b(0);var f=b(4),c=b(505),n=b(111),m=b(151),x=b(48),y=b(282),v=b(55),t;(function(Da){Da[Da.none=0]="none";Da[Da.mergeConflict=1]="mergeConflict";Da[Da.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";Da[Da.failedToApplyHints=3]="failedToApplyHints";Da[Da.validateUpdateHintsAreComplete=
4]="validateUpdateHintsAreComplete";Da[Da.other=5]="other"})(t||(t={}));Object(z.b)("ParagraphMergeUsingHintsFailureReason",t);var A=b(828),D=b(158),U=b(520);const F=Da=>{const La=new m.a;Da.forEach(Ta=>{La.add(Ta);return!0});return La};var E=b(1231),P=b(1197),G=b(1234);const K=(Da,La)=>{if(Da.length!==La.length)return!1;for(let Ta=0;Ta<Da.length;Ta++)Da.J(Ta).Vl=La.J(Ta),La.J(Ta).Vl=Da.J(Ta);return!0},S=(Da,La,Ta)=>{let Sa,Hb,Oa;Sa=0;Hb=!1;Oa=0;var za;if(!({NKa:za}=R(Da,La)).returnValue)return n.a.instance.Ba(18969440,
1,4,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",La,Da.Go()),{returnValue:!1,Wed:Sa,Vxb:Hb,mod:Oa};if(!Ta&&2===Da.J(za).type)return{returnValue:!0,Wed:za,Vxb:Hb,mod:Oa};if(!Da.J(za).b2())return n.a.instance.Ba(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",za,Ta,Da.Go()),{returnValue:!1,Wed:Sa,Vxb:Hb,mod:Oa};let $a=!1,Xb=0;for(;za<Da.length&&Da.J(za).jj.equals(La);za++){if(Ta===
Xb){$a=!0;break}if(Ta>Xb&&Ta<Xb+Da.J(za).length){Hb=$a=!0;Oa=Ta-Xb;break}Xb+=Da.J(za).length}$a||Ta!==Xb||($a=!0);$a&&(Sa=za);return{returnValue:$a,Wed:Sa,Vxb:Hb,mod:Oa}},L=(Da,La,Ta)=>{let Sa,Hb,Oa;Oa=Hb=0;Sa=!1;let za=0,$a=!1;for(;Hb<Da.length;Hb++){if(La===za){$a=!0;break}if(La>za&&La<za+Da.J(Hb).length){Sa=$a=!0;Oa=La-za;break}za+=Da.J(Hb).length}$a||La!==za||($a=!0);$a||(Da=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Da.length,za,La),n.a.instance.Ba(573178201,
1,2,Da),Ta.uf(Object.assign(new G.a,{eventId:"8k6fz",info:Da})));return{returnValue:$a,Vxb:Sa,jqh:Hb,iqh:Oa}},I=(Da,La,Ta)=>{let Sa;if(Da.J(La).b2()&&({kXi:Sa}=Da.J(La).$Dm(Ta)).returnValue)return Da.my(La+1,Sa),Da.WB(La),!0;n.a.instance.Ba(18969441,1,4,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",La,Ta,Da.Go());return!1},O=(Da,La,Ta)=>{let Sa,Hb;if(!({Wed:Ta,Vxb:Hb,mod:Sa}=S(Da,La,Ta)).returnValue)return{returnValue:!1,index:0};if(!Hb)return{returnValue:!0,
index:Ta};if(I(Da,Ta,Sa))return{returnValue:!0,index:Ta+1};n.a.instance.Ba(18969442,1,4,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",La,Sa,Da.Go());return{returnValue:!1,index:0}},M=(Da,La,Ta)=>{let Sa;if(!({Vxb:Sa,jqh:La,iqh:Ta}=L(Da,La,Ta)).returnValue)return{returnValue:!1,index:0};if(!Sa)return{returnValue:!0,index:La};if(I(Da,La,Ta))return{returnValue:!0,index:La+1};n.a.instance.Ba(574433311,1,4,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",
Ta,Da.Go());return{returnValue:!1,index:0}},R=(Da,La)=>{let Ta;Ta=0;for(let Sa=0;Sa<Da.length;Sa++)if(Da.J(Sa).jj.equals(La))return Ta=Sa,{returnValue:!0,NKa:Ta};n.a.instance.Ba(18969443,1,4,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",La,Da.Go());return{returnValue:!1,NKa:Ta}},W=(Da,La)=>{let Ta;Ta=-1;for(let Sa=La;Sa<Da.length;Sa++)if(2===Da.J(Sa).type)return Ta=Sa,{returnValue:!0,hka:Ta};n.a.instance.Ba(18969472,1,4,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",
La,Da.Go());return{returnValue:!1,hka:Ta}},Y=(Da,La,Ta)=>{let Sa;Sa=-1;for(let Hb=Ta;Hb<Da.length;Hb++)if(2===Da.J(Hb).type&&Da.J(Hb).jj.equals(La))return Sa=Hb,{returnValue:!0,hka:Sa};n.a.instance.Ba(18969473,1,4,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",La,Ta,Da.Go());return{returnValue:!1,hka:Sa}},N=(Da,La)=>{let Ta;Ta=0;var Sa;if(!({NKa:Sa}=R(Da,La)).returnValue)return n.a.instance.Ba(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",
La,Da),{returnValue:!1,length:Ta};for(;Sa<Da.length;Sa++)if(6!==Da.J(Sa).type){if(2===Da.J(Sa).type)return{returnValue:!0,length:Ta};n.a.instance.shipAssertTag(17342617,1,Da.J(Sa).b2(),"We found something other than text with type "+Da.J(Sa).type);n.a.instance.shipAssertTag(17877021,1,Da.J(Sa).jj.equals(La),"Unexpected GraphNodeId {0} for ParaId {1}",Da.J(Sa).jj,La);Ta+=Da.J(Sa).length}n.a.instance.Ba(18969474,1,4,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",La,Da);return{returnValue:!1,
length:Ta}},aa=Da=>{const La=new m.a;for(let Ta=0;Ta<Da.length;Ta++)La.add(Da.J(Ta).clone());return La};var ia=b(1233),ea=b(1175);class la{constructor(Da,La,Ta=null,Sa=null){this.jj=Da;this.type=La;this.text=Ta;this.Gb=Sa}isEqual(Da){return Da.jj.equals(this.jj)&&this.type===Da.type&&this.Gb===Da.Gb&&ea.a.Xnh(this.text,Da.text)}toString(){let Da=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.jj,this.Gb,this.type);this.text&&(Da+=String.format(" [TextLength: {0}]",this.text.length));
return Da}}Object(z.a)(la,"MergeBlockValidationState",null,[]);var xa=b(201),Ha=b(567),ua=b(488),Ra=b(434),ab=b(391),Ba=b(566),Ga=b(487),ja=b(1161),X=b(1409),fa;(function(Da){Da[Da.base=1]="base";Da[Da.favoredUpdate=2]="favoredUpdate";Da[Da.unfavoredUpdate=4]="unfavoredUpdate";Da[Da.min=1]="min";Da[Da.max=7]="max"})(fa||(fa={}));Object(z.b)("MergeBlockSource",fa);class pa{constructor(Da,La,Ta,Sa){this.nf=Da;this.cp=La;this.GZd=Ta;this.mDd=Sa}}Object(z.a)(pa,"MergedListBlocksWithUpdatedFormattingIds",
null,[]);var Ia=b(1230);class ta extends Ia.a{constructor(Da,La){super(6,Da,La);this.Gb=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.jj)}Qqc(){return"Selection"}clone(){return new ta(this.source,this.jj)}jz(){return!1}get length(){return 0}}Object(z.a)(ta,"SelectionMergeBlock",Ia.a,[]);var oa;(function(Da){Da[Da.success=0]="success";Da[Da.selfSplit=1]="selfSplit";Da[Da.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Da[Da.unexpected=3]="unexpected"})(oa||(oa=
{}));Object(z.b)("SplitTwinListResult",oa);var va=b(1291);class Fa extends va.a{constructor(Da,La,Ta,Sa){super(5,Da,La);this._text=null;this.eyd(Ta);this.PFj=Sa}get text(){return this._text}eyd(Da){this._text=Da}get ICd(){return this.PFj}clone(){return new Fa(this.source,this.jj,this.text,this.ICd)}get Shb(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(z.a)(Fa,"UpdateHintTextMergeBlock",va.a,[]);class cb{constructor(Da,La,Ta,Sa){this.w4=
!1;this.snb=new y.a;this.Qc=Da;this.xfh=Sa;this.iPg=Ta;this._base=La;this.tMe=aa(La);if(!K(this.base,this.Wd))throw n.a.instance.Ba(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Da.ma.uf(Object.assign(new ja.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Wd(){return this.tMe}get mergeConflict(){return this.w4}Fgf(Da,La){switch(Da.type){case 1:return this.BSj(Da,La);case 2:return this.Sff(Da,La);case 3:return this.eTj(Da,
La);case 4:return this.MSj(Da);case 5:return this.cSj(Da,La);case 6:return this.Qff(Da);default:return!1}}Egf(Da,La){switch(Da.type){case 1:return this.$ff(Da,La);case 2:return this.Rff(Da,La);case 3:return this.dTj(Da,La);case 4:return this.LSj(Da);case 5:return this.bSj(Da,La);case 6:return this.Pff(Da);default:return{returnValue:!1,tt:null}}}BSj(Da,La){let Ta;const Sa=({Wka:Ta}=this.LOa(Da.nf,La,!1,Da.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(Sa&&1!==Sa)return 3!==Sa&&(n.a.instance.Ba(590202197,
1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",fa[La],oa[Sa]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.w4=!1;La=new Fa(La,Da.nf,Da.text,Da.id);this.HTf(Da,Ta,La);return!0}Sff(Da,La){let Ta,Sa=({Wka:Ta}=this.LOa(Da.nf,La,!1,Da.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(Sa&&1!==Sa)return 3!==Sa&&(n.a.instance.Ba(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",
fa[La],oa[Sa]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Hb;({Wka:Hb,returnValue:Sa}=this.LOa(Da.nf,La,!1,Da.cp+Da.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(Sa&&1!==Sa)return 3!==Sa&&(n.a.instance.Ba(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",fa[La],oa[Sa]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),
!1;this.w4=!1;this.hvf(Da,Ta,Hb);return!0}eTj(Da,La){let Ta;const Sa=({ARf:Ta}=this.PVh(Da,La,!1)).returnValue;if(Sa&&1!==Sa)return 3!==Sa&&(n.a.instance.Ba(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",fa[La],oa[Sa]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.w4=!1;La=new E.a(La,Da.Zr,Da.$xa);this.HTf(Da,Ta,La);return!0}MSj(Da){let La;if(!({Sce:La}=this.QVh(Da,this.Wd,
"Derived")).returnValue)return!1;this.hvf(Da,La,La+1);return!0}cSj(Da,La){let Ta;if(!({e6f:La,zRf:Ta}=this.bXh(Da,!1,La)).returnValue)return!1;this.HTf(Da,Ta,La);return!0}Qff(Da){let La;if(!({Rce:La}=this.KVh(Da,this.Wd,"Derived")).returnValue)return!1;this.hvf(Da,La,La+1);return!0}unh(Da,La,Ta){const Sa=({Wka:La}=this.LOa(Da,Ta,!1,La,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(Sa&&1!==Sa)return 3!==Sa&&(n.a.instance.Ba(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",
fa[Ta],oa[Sa]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.w4=!1;Da=new ta(Ta,Da);this.Wd.insert(La,Da);return!0}$ff(Da,La){var Ta=null;if(cb.rbi(Da.text.length))return{returnValue:!1,tt:Ta};let Sa,Hb,Oa;var za=({Wka:Sa,eAa:Hb,Pja:Oa}=this.LOa(Da.nf,La,!0,Da.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(za&&2!==za)return 3!==za&&(n.a.instance.Ba(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",
fa[La],oa[za]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,tt:Ta};this.w4=!1;({hka:za}=W(this.Wd,Hb));za=this.Wd.J(za).jj;Ta=new Fa(La,Da.nf,Da.text,Da.id);La=new Fa(La,za,Da.text,Da.id);Ta.Vl=La;La.Vl=Ta;this.base.insert(Sa,Ta);this.Wd.insert(Hb,La);Ta=new m.a;Ta.add(new ab.a(za,Oa,Da.text,Da.id,Da.Nt));return{returnValue:!0,tt:Ta}}Rff(Da,La){let Ta;Ta=null;if(cb.rbi(Da.text.length))return{returnValue:!1,tt:Ta};let Sa;var Hb,Oa=({Wka:Sa,
eAa:za,Pja:Hb}=this.LOa(Da.nf,La,!0,Da.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(Oa){if(2!==Oa)return 3!==Oa&&(n.a.instance.Ba(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",fa[La],oa[Oa]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,tt:Ta};var za=0;for({NKa:Hb}=R(this.base,Da.nf);Hb<this.base.length&&za<Da.cp;Hb++)za+=this.base.J(Hb).length;
za-=this.base.J(Hb-1).length;({eAa:za,Pja:Hb,returnValue:Oa}=this.LOa(Da.nf,La,!0,za,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(Oa)return 3!==Oa&&(n.a.instance.Ba(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",fa[La],oa[Oa]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,tt:Ta};this.w4=!1}var $a,Xb;({Wka:$a,eAa:Xb,Pja:Eb,returnValue:Oa}=
this.LOa(Da.nf,La,!0,Da.cp+Da.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(Oa){if(2!==Oa)return 3!==Oa&&(n.a.instance.Ba(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",fa[La],oa[Oa]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,tt:Ta};var Eb=0;for({NKa:Xb}=R(this.base,Da.nf);Xb<this.base.length&&Eb<Da.cp+Da.text.length;Xb++)Eb+=this.base.J(Xb).length;
({eAa:Xb,Pja:Eb,returnValue:Oa}=this.LOa(Da.nf,La,!0,Eb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(Oa)return 3!==Oa&&(n.a.instance.Ba(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",fa[La],oa[Oa]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,tt:Ta};this.w4=!1}La="";Ta=new m.a;for(--Xb;Xb>=za;Xb--)if(6!==this.Wd.J(Xb).type)if(this.Wd.J(Xb).Vl)La=
this.Wd.J(Xb).text+La,this.Wd.WB(Xb);else{if(5===this.Wd.J(Xb).type)Oa=Eb-La.length;else if(2===this.Wd.J(Xb).type){if(Oa=0,!({length:Eb}=N(this.Wd,this.Wd.J(Xb).jj)).returnValue)return n.a.instance.Ba(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,tt:Ta}}else return n.a.instance.Ba(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),
this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,tt:Ta};if(!({hka:ob}=W(this.Wd,Xb+1)).returnValue)return n.a.instance.Ba(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,tt:Ta};var ob=this.Wd.J(ob).jj;Ta.add(new Ra.DeleteTextUpdateHint(ob,Oa,La));La=""}for(--$a;$a>=Sa;$a--)this.base.WB($a);if(!({hka:ob}=
W(this.Wd,za)).returnValue)return n.a.instance.Ba(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,tt:Ta};ob=this.Wd.J(ob).jj;La&&La.length&&Ta.add(new Ra.DeleteTextUpdateHint(ob,Hb,La,Da.id,Da.Nt));return{returnValue:!0,tt:Ta}}dTj(Da,La){var Ta=null;let Sa,Hb,Oa;var za=({ARf:Sa,U6h:Hb,Pja:Oa}=this.PVh(Da,La,!0)).returnValue;if(za)return 3!==za&&(n.a.instance.Ba(590202207,
1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",fa[La],oa[za]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,tt:Ta};var $a;if(!({hka:$a}=W(this.Wd,Hb)).returnValue)return n.a.instance.Ba(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,tt:Ta};za=this.Wd.J($a).jj;const Xb=this.Wd.J($a).Gb;let Eb,ob,
tb;({Zr:$a,H9:Eb,$xa:ob,Bda:tb}=this.UTk(Da,$a));this.Fuh(this.Wd,$a,Eb,tb,Hb);Ta=new E.a(La,Da.Zr,Da.$xa);La=new E.a(La,$a,ob);Ta.Vl=La;La.Vl=Ta;this.base.insert(Sa,Ta);this.Wd.insert(Hb,La);Ta=new m.a;Ta.add(new Ga.a(za,Xb,Oa,$a,ob,Eb,tb,Da.id,Da.Nt));return{returnValue:!0,tt:Ta}}LSj(Da){let La;La=null;let Ta,Sa;var Hb;if(!({Sce:Ta}=this.QVh(Da,this.base,"Base")).returnValue)return{returnValue:!1,tt:La};if(!this.base.J(Ta).Vl||!({hka:Sa}=Y(this.Wd,this.base.J(Ta).Vl.jj,0)).returnValue)return n.a.instance.Ba(17342619,
1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.w4=!0,{returnValue:!1,tt:La};if(!({hka:Hb}=W(this.Wd,Sa+1)).returnValue)return n.a.instance.Ba(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",
eventId:"bckc2"})),this.w4=!0,{returnValue:!1,tt:La};let Oa,za,$a,Xb,Eb,ob;({Wdb:Hb,Xdb:$a,U7f:Oa,rIl:Xb,$Hl:za,aIl:Eb}=this.uLk(Da,Sa,Hb));if(!({length:ob}=N(this.Wd,Hb)).returnValue)return{returnValue:!1,tt:La};this.Euh(this.Wd,Hb,$a,Sa);this.Wd.WB(Sa);this.base.WB(Ta);La=new m.a;La.add(new Ba.MergeParagraphUpdateHint(Oa,Xb,ob,za,Eb,Hb,$a,Da.id,Da.Nt));return{returnValue:!0,tt:La}}bSj(Da,La){var Ta=null;let Sa,Hb,Oa;if(!({e6f:Oa,zRf:Sa}=this.bXh(Da,!0,La)).returnValue)return{returnValue:!1,tt:Ta};
if(!({rub:Hb}=this.Ybd(this.base,this.Wd,Sa,!0)).returnValue)return n.a.instance.Ba(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,tt:Ta};if(0<Hb&&2!==this.Wd.J(Hb-1).type)return n.a.instance.Ba(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.w4=!0,{returnValue:!1,
tt:Ta};let za;if(!({Zr:za}=this.eQh(Hb)).returnValue)return{returnValue:!1,tt:Ta};La=new E.a(La,Da.nf,Da.Gb);Ta=Oa;Ta.Vl=La;La.Vl=Ta;this.base.insert(Sa,Oa);this.Wd.insert(Hb,La);Ta=new m.a;Ta.add(new Ha.AddParagraphUpdateHint(Da.nf,Da.Gb,za,Da.id,Da.Nt));return{returnValue:!0,tt:Ta}}Pff(Da){let La;La=null;let Ta;var Sa;if(!({Rce:Sa}=this.KVh(Da,this.base,"Base")).returnValue)return{returnValue:!1,tt:La};if(!this.base.J(Sa).Vl||!this.base.J(Sa).Vl.jj.equals(Da.nf))return n.a.instance.Ba(17135243,
1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.w4=!0,{returnValue:!1,tt:La};if(!({rub:Ta}=this.Ybd(this.base,this.Wd,Sa,!0)).returnValue)return n.a.instance.Ba(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,tt:La};if(0<Ta&&2!==this.Wd.J(Ta).type)return n.a.instance.Ba(17135245,
1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.w4=!0,{returnValue:!1,tt:La};const Hb=this.Wd.J(Ta).jj,Oa=this.Wd.J(Ta).Gb;this.Wd.WB(Ta);this.base.WB(Sa);({Zr:Sa}=this.eQh(Ta));0<Ta&&6===this.Wd.J(Ta-1).type&&this.i_l(Ta-1,Sa);La=new m.a;La.add(new ua.a(Hb,Oa,Sa,Da.id,Da.Nt));return{returnValue:!0,tt:La}}tnh(Da,La,Ta){let Sa;var Hb=({Wka:La,eAa:Sa}=this.LOa(Da,
Ta,!0,La,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(Hb)return 3!==Hb&&(n.a.instance.Ba(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",fa[Ta],oa[Hb]),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({hka:Hb}=W(this.Wd,Sa));Hb=this.Wd.J(Hb).jj;Da=new ta(Ta,Da);Ta=new ta(Ta,Hb);Da.Vl=Ta;Ta.Vl=Da;this.base.insert(La,Da);this.Wd.insert(Sa,Ta);return!0}uLk(Da,
La,Ta){let Sa,Hb,Oa;Sa=Da.Wdb.equals(Da.nf)?this.Wd.J(La).jj:this.Wd.J(Ta).jj;Da=Da.Xdb===Da.Gb?this.Wd.J(La).Gb:this.Wd.J(Ta).Gb;Hb=this.Wd.J(La).jj;La=this.Wd.J(La).Gb;Oa=this.Wd.J(Ta).jj;Ta=this.Wd.J(Ta).Gb;return{Wdb:Sa,Xdb:Da,U7f:Hb,rIl:La,$Hl:Oa,aIl:Ta}}UTk(Da,La){let Ta;var Sa=Da.nf.equals(Da.Zr)?Da.H9:Da.Zr;const Hb=Da.Gb===Da.$xa?Da.Bda:Da.$xa;Da.nf.equals(Da.Zr)?Ta=this.Wd.J(La).jj:(Ta=Sa,Sa=this.Wd.J(La).jj);Da.Gb===Da.$xa?(Da=this.Wd.J(La).Gb,La=Hb):(Da=Hb,La=this.Wd.J(La).Gb);return{Zr:Ta,
H9:Sa,$xa:Da,Bda:La}}Guh(Da,La,Ta,Sa){for(;Sa<Da.length;Sa++){if(!Da.J(Sa).b2()&&6!==Da.J(Sa).type&&2!==Da.J(Sa).type){n.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Da.J(Sa).type);break}Da.J(Sa).jj=La;if(2===Da.J(Sa).type){Da.J(Sa).Gb=Ta;break}}}Fuh(Da,La,Ta,Sa,Hb){this.Guh(Da,Ta,Sa,Hb);cb.Huh(Da,La,Hb)}Euh(Da,La,Ta,Sa){this.Guh(Da,La,Ta,Sa+1);cb.Huh(Da,La,Sa)}QVh(Da,La,Ta){let Sa,Hb=-1;if(!({hka:Sa}=Y(La,Da.nf,0)).returnValue)return n.a.instance.Ba(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+
Ta+"for GraphNodeId "+Da.nf),{returnValue:!1,Sce:Sa};if(!({hka:Hb}=W(La,Sa+1)).returnValue||!La.J(Hb).jj.equals(Da.H9))return n.a.instance.Ba(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+Sa+1+" in "+Ta+" of length "+La.length),{returnValue:!1,Sce:Sa};this.Euh(La,Da.Wdb,Da.Xdb,Sa);return{returnValue:!0,Sce:Sa}}PVh(Da,La,Ta){let Sa;const Hb=Ta?this.base:this.Wd,Oa=Ta?"Base":"Derived",za=({Wka:La,eAa:Ta,Pja:Sa}=this.LOa(Da.nf,La,Ta,Da.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;
if(3===za||2===za)return n.a.instance.Ba(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Oa),{returnValue:za,ARf:La,U6h:Ta,Pja:Sa};this.Fuh(Hb,Da.Zr,Da.H9,Da.Bda,La);return{returnValue:za,ARf:La,U6h:Ta,Pja:Sa}}KVh(Da,La,Ta){return({NKa:Da}=R(La,Da.nf)).returnValue?2!==La.J(Da).type?(n.a.instance.Ba(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+Ta),{returnValue:!1,Rce:-1}):{returnValue:!0,Rce:Da}:(n.a.instance.Ba(17156033,
1,2,"GetIndexForDeletePara: Failed to find the para in "+Ta),{returnValue:!1,Rce:-1})}i_l(Da,La){var Ta=this.Wd.J(Da);if(La){let Sa;({hka:Sa}=Y(this.Wd,La,0));Ta=Ta.clone();Ta.jj=La;this.Wd.WB(Da);this.Wd.insert(Sa,Ta)}else this.Wd.length>Da&&(this.Wd.J(Da+1).b2()||2===this.Wd.J(Da+1).type)&&(Ta.jj=this.Wd.J(Da+1).jj)}bXh(Da,La,Ta){var Sa=La?this.base:this.Wd;La=La?"Base":"Derived";Ta=new E.a(Ta,Da.nf,Da.Gb);if(Da.Zr){if(!({hka:Sa}=Y(Sa,Da.Zr,0)).returnValue)return n.a.instance.Ba(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",
Da.Zr,La),{returnValue:!1,e6f:Ta,zRf:Sa};Sa+=1}else Sa=0;return{returnValue:!0,e6f:Ta,zRf:Sa}}eQh(Da){let La;La=null;let Ta=Da-1;if(-1===Ta)return{returnValue:!0,Zr:La};6===this.Wd.J(Ta).type&&Ta--;if(2===this.Wd.J(Ta).type||4===this.Wd.J(Ta).type)return La=this.Wd.J(Ta).jj,{returnValue:!0,Zr:La};n.a.instance.Ba(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.Wd.J(Da-1).type);return{returnValue:!1,Zr:La}}Ybd(Da,La,Ta,Sa){let Hb,Oa=!0;Hb=-1;if(Ta>Da.length)return n.a.instance.Ba(17146334,
1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,rub:Hb};if(Ta<Da.length){if(-1<Ta&&Ta<Da.length&&!Da.J(Ta).Vl){Oa=!1;for(var za=Ta+1;za<Da.length;za++)if(Da.J(za).Vl){Ta=za;Oa=!0;break}}if(!Oa)return{returnValue:!1,rub:Hb};Oa=!1;for(za=0;Da.J(Ta)&&za<La.length;za++)if(La.J(za).Vl===Da.J(Ta)){Hb=za;Oa=!0;break}if(!Oa)return{returnValue:!1,rub:Hb}}else Hb=La.length;if(0<Hb&&Sa&&!La.J(Hb-1).Vl){for(Da=Hb-1;0<=Da&&!La.J(Da).Vl;Da--);Hb=Da+1;6===La.J(Hb).type&&
5!==this.Qc.input.source&&Hb++}return{returnValue:!0,rub:Hb}}LOa(Da,La,Ta,Sa,Hb,Oa){let za;var $a;let Xb;var Eb=this.base;let ob=this.Wd,tb=!1;Ta||(Eb=this.Wd,ob=this.base);Xb=$a=za=0;let yb,lb,Cc=0;if(!({Wed:Sa,Vxb:yb,mod:lb}=S(Eb,Da,Sa)).returnValue)return n.a.instance.Ba(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,Wka:za,eAa:$a,Pja:Xb};0<=Sa&&Sa<Eb.length&&!Eb.J(Sa).Vl&&
yb&&!Hb&&(n.a.instance.Ba(17044296,1,3,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",Oa),this.w4=!0,Cc=La===Eb.J(Sa).source?1:2,tb=!0);Hb&&!Eb.J(Sa)&&Sa--;Hb&&yb&&!Eb.J(Sa).Vl&&(yb=!1,lb=0);if(!Ta&&!({NKa:Da}=R(ob,Da)).returnValue&&!yb)return{returnValue:0,Wka:Sa,eAa:$a,Pja:Xb};if(!({rub:Da}=this.Ybd(Eb,ob,Sa,Ta&&!yb)).returnValue&&!tb&&(La=!1,1===this.xfh&&0<Sa&&!lb&&(Sa--,{rub:Da,returnValue:La}=this.Ybd(Eb,
ob,Sa,Ta&&!yb),La&&(Sa++,Da<ob.length-1?Da++:La=!1)),!La))return n.a.instance.Ba(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.Qc.ma.uf(Object.assign(new X.a,{Mh:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.w4=!0,{returnValue:3,Wka:za,eAa:$a,Pja:Xb};if(yb&&(!I(Eb,Sa,lb)||!tb&&!I(ob,Da,lb)))return n.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),
{returnValue:3,Wka:za,eAa:$a,Pja:Xb};za=Sa;$a=Da;yb&&(za=Sa+1,tb||($a=Eb.J(Sa),Ta=ob.J(Da),$a.Vl=Ta,Ta.Vl=$a,Eb=Eb.J(Sa+1),$a=ob.J(Da+1),Eb.Vl=$a,$a.Vl=Eb,$a=Da+1));if($a>=ob.length)return n.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+$a+" secondaryList length was "+ob.length),{returnValue:3,Wka:za,eAa:$a,Pja:Xb};for(Eb=0;Eb<$a;Eb++)ob.J(Eb).jj.equals(ob.J($a).jj)&&(Xb+=ob.J(Eb).length);return{returnValue:Cc,Wka:za,eAa:$a,Pja:Xb}}hvf(Da,
La,Ta){this.iPg.contains(Da.id)&&this.snb.W(Da.id,new m.a);for(--Ta;Ta>=La;Ta--)this.iPg.contains(Da.id)?this.snb.J(Da.id).insert(this.snb.J(Da.id).length,this.Wd.J(Ta)):this.Wd.J(Ta).Vl&&(this.Wd.J(Ta).Vl.Vl=null),this.Wd.WB(Ta)}HTf(Da,La,Ta){if(this.snb.Pa(Da.Nt)){const Sa=this.snb.J(Da.Nt);for(let Hb=0;Hb<Sa.length;Hb++)Sa.J(Hb).jj=Ta.jj,Object(xa.a)(E.a,Ta)&&Object(xa.a)(E.a,Sa.J(Hb))&&(Sa.J(Hb).Gb=Ta.Gb);this.Wd.my(La,this.snb.J(Da.Nt));this.snb.remove(Da.Nt)}else this.Wd.insert(La,Ta)}$2k(Da){let La,
Ta;Ta=La=-1;if(!Da.Vl)return{returnValue:!1,Roc:La,wvf:Ta};var Sa;let Hb=0,Oa=!1;if(!({NKa:Sa}=R(this.Wd,Da.Vl.jj)).returnValue)return{returnValue:!1,Roc:La,wvf:Ta};for(;Sa<this.Wd.length;Sa++){if(Da.Vl===this.Wd.J(Sa)){La=Sa;Ta=Hb;Oa=!0;break}Hb+=this.Wd.J(Sa).length}return{returnValue:Oa,Roc:La,wvf:Ta}}QBf(Da){let La;La=new m.a;let Ta=0,Sa=0;for(;Ta<Da.length;){if(Sa>=this.base.length)return n.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),
{returnValue:!1,QFc:La};if(Da.J(Ta).length>this.base.J(Sa).length){if(!I(Da,Ta,this.base.J(Sa).length))return n.a.instance.Ba(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Ta,this.base.J(Sa).length),{returnValue:!1,QFc:La}}else if(Da.J(Ta).length<this.base.J(Sa).length){var Hb=!!this.base.J(Sa).Vl,Oa=0;if(Hb&&!({rub:Oa}=this.Ybd(this.base,this.Wd,Sa,!1)).returnValue)return n.a.instance.shipAssertTag(17335390,
1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Sa),{returnValue:!1,QFc:La};if(!I(this.base,Sa,Da.J(Ta).length)||Hb&&!I(this.Wd,Oa,Da.J(Ta).length))return n.a.instance.Ba(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),{returnValue:!1,QFc:La};if(Hb){Hb=this.base.J(Sa);var za=this.Wd.J(Oa);Hb.Vl=za;za.Vl=Hb;Hb=this.base.J(Sa+1);Oa=this.Wd.J(Oa+1);
Hb.Vl=Oa;Oa.Vl=Hb}}if(this.base.J(Sa).Vl&&5!==this.base.J(Sa).type&&this.base.J(Sa).b2()&&(Oa=this.base.J(Sa),Hb=Da.J(Ta),!Oa.EJ.equals(Hb.EJ)||!Oa.fF.jz(Hb.fF))){let $a;if(!({Roc:za,wvf:$a}=this.$2k(this.base.J(Sa))).returnValue)return{returnValue:!1,QFc:La};La.add(new pa(this.Wd.J(za).jj,$a,Oa,Hb))}Ta++;Sa++}return{returnValue:!0,QFc:La}}static Huh(Da,La,Ta){for(--Ta;0<=Ta;Ta--){if(!Da.J(Ta).b2()&&6!==Da.J(Ta).type){n.a.instance.shipAssertTag(17311187,1,2===Da.J(Ta).type||4===Da.J(Ta).type,"Found merge block of type "+
Da.J(Ta).type);break}Da.J(Ta).jj=La}}static rbi(Da){return Da?!1:(n.a.instance.Ba(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(z.a)(cb,"ParagraphMergeUsingHintsTwinList",null,[1845]);var Za=b(1407),gb=b(1408),Ya=b(1404),fb=b(1406),ib=b(1405);class hb{constructor(Da,La,Ta,Sa){this.cp=Da;this.length=La;this.GZd=Ta;this.mDd=Sa}}Object(z.a)(hb,"UpdateFormattingIdsPosInfo",null,[]);class db{constructor(Da,La,Ta){this.w4=!1;
this.snb=new y.a;this.Qc=Da;this.xfh=Ta;Da.runtime.Qa&&Da.runtime.Qa.isFeatureEnabled(109);this._base=La;this.tMe=aa(La);if(!K(this.base,this.Wd))throw n.a.instance.Ba(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Da.ma.uf(Object.assign(new G.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Wd(){return this.tMe}get mergeConflict(){return this.w4}Fgf(Da,La){switch(Da.type){case 11:return this.zSj(Da,La);case 8:return this.Sff(Da,
La);case 10:return this.Qff(Da);default:return!1}}Egf(Da,La){switch(Da.type){case 11:return this.ySj(Da,La);case 8:return this.Rff(Da,La);case 10:return this.Pff(Da);default:return{returnValue:!1,tt:null}}}unh(){n.a.instance.Ba(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}tnh(){n.a.instance.Ba(574433296,1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");
this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}QBf(Da){let La;La=new m.a;let Ta=0,Sa=0,Hb=0;for(;Ta<Da.length;){if(Sa>=this.base.length)return n.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),{returnValue:!1,lDd:La};if(Da.J(Ta).length>this.base.J(Sa).length){if(!I(Da,
Ta,this.base.J(Sa).length))return n.a.instance.Ba(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,lDd:La}}else if(Da.J(Ta).length<this.base.J(Sa).length&&!this.Ihb(Hb+Da.J(Ta).length,!0).returnValue)return n.a.instance.Ba(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.Qc.ma.uf(Object.assign(new G.a,
{Mh:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,lDd:La};if(this.base.J(Sa).Vl&&5!==this.base.J(Sa).type&&this.base.J(Sa).b2()){const Oa=this.base.J(Sa),za=Da.J(Ta);if(!Oa.EJ.equals(za.EJ)||!Oa.fF.jz(za.fF)){let $a,Xb;if(({Roc:$a,yFh:Xb}=this.a3k(this.base.J(Sa))).returnValue)La.add(new hb(Xb,this.Wd.J($a).length,Oa,za));else return n.a.instance.Ba(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),
this.Qc.ma.uf(Object.assign(new G.a,{Mh:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,lDd:La}}}Hb+=this.base.J(Sa).length;Ta++;Sa++}return{returnValue:!0,lDd:La}}zSj(Da,La){let Ta;if(!({XIa:Ta}=this.Ihb(Da.cp,!0)).returnValue)return n.a.instance.Ba(574433300,1,2,"ApplyInsertTextHintToDerived"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let Hb=0;Hb<Da.O1.length;Hb++)switch(Da.O1.J(Hb).type){case 7:var Sa=
Da.O1.J(Hb);this.Wd.insert(Ta,new Fa(La,null,Sa.text,Sa.id));break;case 9:Sa=Da.O1.J(Hb);this.Wd.insert(Ta,new E.a(La,Sa.nf,Sa.Gb));break;default:return n.a.instance.Ba(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}Sff(Da,La){let Ta,Sa;if(!({XIa:Ta}=this.Ihb(Da.cp,!0)).returnValue||!({XIa:Sa}=this.Ihb(Da.cp+Da.text.length,!1)).returnValue)return n.a.instance.Ba(575706433,1,2,"ApplyDeleteTextHintToDerived"),
this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Da=Sa;Da>=Ta;Da--)this.Wd.J(Da).source!==La&&this.V3d(this.Wd,Da);return!0}Qff(Da){let La;if(!({XIa:La}=this.Ihb(Da.cp,!0)).returnValue)return n.a.instance.Ba(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.lvf(this.Wd,Da,La);return!0}ySj(Da,La){let Ta;Ta=null;let Sa,Hb;if(!({dPb:Sa,XIa:Hb}=this.Ihb(Da.cp,!0)).returnValue)return n.a.instance.Ba(574433303,
1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,tt:Ta};var Oa=this.JGf(this.Wd,Hb-1);Oa=new ib.a(Oa);for(let za=0;za<Da.O1.length;za++)switch(Da.O1.J(za).type){case 7:Oa.O1.add(this.$ff(Da.O1.J(za),La,Sa,Hb));break;case 9:Oa.O1.add(this.ASj(Da.O1.J(za),La,Sa,Hb));break;default:return n.a.instance.Ba(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.Qc.ma.uf(Object.assign(new G.a,
{Mh:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,tt:Ta}}Ta=new m.a;Ta.add(Oa);return{returnValue:!0,tt:Ta}}$ff(Da,La,Ta,Sa){const Hb=new Fa(La,Da.nf,Da.text,Da.id);La=new Fa(La,Da.nf,Da.text,Da.id);Hb.Vl=La;La.Vl=Hb;this.base.insert(Ta,Hb);this.Wd.insert(Sa,La);Ta=new fb.a(Da.nf,Da.text);Ta.id=Da.id;return Ta}ASj(Da,La,Ta,Sa){const Hb=new E.a(La,Da.nf,Da.Gb);La=new E.a(La,Da.nf,Da.Gb);Hb.Vl=La;La.Vl=Hb;this.base.insert(Ta,Hb);this.Wd.insert(Sa,La);return new Ya.a(Da.nf,Da.Gb)}Rff(Da){let La;
La=new m.a;let Ta;var Sa;let Hb;if(!({dPb:Ta,XIa:Sa}=this.Ihb(Da.cp,!0)).returnValue||!({dPb:Hb,XIa:Oa}=this.Ihb(Da.cp+Da.text.length,!1)).returnValue)return n.a.instance.Ba(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,tt:La};for(Da=Oa;Da>=Sa;Da--)if(this.Wd.J(Da).Vl){var Oa=Da;La.add(({hIl:Da}=this.Ryk(Da,Sa)).returnValue);this.V3d(this.Wd,Da,Oa)}for(Sa=Hb;Sa>=Ta;Sa--)this.V3d(this.base,
Sa);return{returnValue:!0,tt:La}}Pff(Da){let La;La=null;let Ta,Sa;if(!({dPb:Ta,XIa:Sa}=this.Ihb(Da.cp,!0)).returnValue)return n.a.instance.Ba(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,tt:La};if(!this.lvf(this.base,Da,Ta))return n.a.instance.Ba(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ApplyDeleteParaHintToBaseAndDerived",
eventId:"8ps60"})),{returnValue:!1,tt:La};this.lvf(this.Wd,Da,Sa)&&(La=new m.a,La.add(new Za.a(this.JGf(this.Wd,Sa-1),Da.nf,Da.Gb)));return{returnValue:!0,tt:La}}Ihb(Da,La){var Ta;var Sa=Ta=-1;let Hb,Oa;if(!({Vxb:Oa,jqh:Da,iqh:Hb}=L(this.base,Da,this.Qc.ma)).returnValue)return{returnValue:!1,dPb:Ta,XIa:Sa};const za=Da>=this.base.length;za&&Da--;if(this.base.J(Da).Vl){const $a=this.$zk(this.Wd,this.base.J(Da));if(Oa){if(0>$a||!I(this.base,Da,Hb)||!I(this.Wd,$a,Hb))return n.a.instance.Ba(575706444,
1,2,"SplitTwinListAndFindIdx"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,dPb:Ta,XIa:Sa};Ta=this.base.J(Da);Sa=this.Wd.J($a);Ta.Vl=Sa;Sa.Vl=Ta;Ta=this.base.J(Da+1);Sa=this.Wd.J($a+1);Ta.Vl=Sa;Sa.Vl=Ta;Ta=La?Da+1:Da;Sa=La?$a+1:$a}else La?(Ta=za?Da+1:Da,Sa=za?$a+1:$a):(Ta=za?Da:Da-1,Sa=za?$a:$a-1)}else if(Oa){if(I(this.base,Da,Hb))Ta=La?Da+1:Da;else return n.a.instance.Ba(575706445,1,2,"SplitTwinListAndFindIdx"),this.Qc.ma.uf(Object.assign(new G.a,
{Mh:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,dPb:Ta,XIa:Sa};La?(Sa=({TXb:Sa}=this.jqc(this.base,this.Wd,Da,!1)).returnValue?Sa+1:0,Sa=Sa>=this.Wd.length?this.Wd.length-1:Sa):(Sa=({TXb:Sa}=this.jqc(this.base,this.Wd,Da,!0)).returnValue?Sa-1:this.Wd.length-1,Sa=0>Sa?0:Sa)}else La?(({TXb:Sa}=this.jqc(this.base,this.Wd,Da,!0)).returnValue||(({TXb:Sa}=this.jqc(this.base,this.Wd,Da,!1)).returnValue?Sa+=1:(Sa=za?this.Wd.length-1:0,Sa=0>Sa?0:Sa)),Ta=za?Da+1:Da):(({TXb:Sa}=this.jqc(this.base,
this.Wd,Da,!1)).returnValue||(({TXb:Sa}=this.jqc(this.base,this.Wd,Da,!0)).returnValue?--Sa:(Sa=Da?this.Wd.length-1:0,Sa=0>Sa?0:Sa)),Ta=za?Da:Da-1);return{returnValue:!0,dPb:Ta,XIa:Sa}}jqc(Da,La,Ta,Sa){let Hb=null;if(Sa)for(;Ta<Da.length;Ta++){if(Da.J(Ta).Vl){Hb=Da.J(Ta).Vl;break}}else for(;0<=Ta;Ta--)if(Da.J(Ta).Vl){Hb=Da.J(Ta).Vl;break}if(Hb)for(Da=0;Da<La.length;Da++)if(La.J(Da)===Hb)return La=Da,{returnValue:!0,TXb:La};return{returnValue:!1,TXb:-1}}$zk(Da,La){for(let Ta=0;Ta<Da.length;Ta++)if(Da.J(Ta).Vl===
La)return Ta;return-1}V3d(Da,La,Ta=-1){for(Ta=0>Ta?La:Ta;Ta>=La;Ta--)Da.J(Ta).Vl&&(Da.J(Ta).Vl.Vl=null),Da.WB(Ta)}JGf(Da,La){let Ta=0;for(;0<=La;La--)Ta+=Da.J(La).length;return Ta}U1k(Da){Da=Object(v.a)(va.a,Da);Da||(n.a.instance.Ba(575706448,1,2,"GetTextBlock"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"GetTextBlock",eventId:"8ujvq"})));return Da}Ryk(Da,La){let Ta="";for(;Da>=La&&this.Wd.J(Da).Vl&&2!==this.Wd.J(Da).type;)Ta=this.U1k(this.Wd.J(Da)).text+Ta,Da--;La=0>Da?0:this.JGf(this.Wd,Da);Da+=1;
return{returnValue:new gb.a(La,Ta),hIl:Da}}a3k(Da){let La,Ta,Sa=!1;Ta=La=0;if(!Da.Vl)return{returnValue:!1,Roc:La,yFh:Ta};for(La=0;La<this.Wd.length;La++){if(this.Wd.J(La).Vl===Da){Sa=!0;break}Ta+=this.Wd.J(La).length}return{returnValue:Sa,Roc:La,yFh:Ta}}lvf(Da,La,Ta){Ta=Ta===Da.length?--Ta:Ta;Ta>Da.length-1&&(n.a.instance.Ba(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"DeleteEopInList",eventId:"8ffwf"})));if(2===Da.J(Ta).type){const Sa=Da.J(Ta);if(Sa.jj!==
La.nf||Sa.Gb!==La.Gb)return!1;this.V3d(Da,Ta);return!0}return!1}}Object(z.a)(db,"ParagraphMergeUsingHintsTwinListLcs",null,[1845]);var da=b(1208),Wa=b(1162),mb=b(1403);b.d(H,"a",function(){return Tb});class Tb{constructor(Da,La,Ta,Sa,Hb,Oa,za=null,$a=null,Xb=null){this.FR=this.cqa=this.iEa=this.Uha=null;this._initialized=!1;this.Qc=Da;this.JC=La;this.Uxa=Sa;this.Bwa=Ta;this.xM=Hb;this.fIe=new c.a;for(La=0;La<this.JC.length;La++)this.fIe.add(this.JC.J(La).id);this.MUg=new c.a;for(La=0;La<this.Bwa.length;La++)this.MUg.add(this.Bwa.J(La).id);
this.ifh=new c.a;for(La=0;La<this.Uxa.length;La++)this.ifh.add(this.Uxa.J(La).id);this.Wf=Oa;this.S$e=za||U.a.instance;this.NO=$a;this.t9=Xb;Da=!!Da.runtime.Qa&&Da.runtime.Qa.isFeatureEnabled(109);this.zIb=1===(this.NO&&this.t9&&1===this.NO.BPa&&1===this.t9.BPa?1:0)&&Da;this.h0=0}get ate(){return 1!==this.h0}ofl(){var Da=!0;if(this.NO&&this.t9)return Da;if(this.NO||this.t9)return n.a.instance.Ba(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.Qc.runtime.Aw.Pa(D.a.lR)&&(Da=this.Qc.runtime.Aw.J(D.a.lR),Da=this.qJg(Da,this.Qc.runtime.yIa.id,"favored")&&({updateHints:this.NO}=this.v8h(Da,this.fIe,this.MUg,this.Qc.runtime.Aw,"favored")).returnValue);Da&&this.Qc.runtime.wp.Pa(D.a.lR)&&(Da=this.Qc.runtime.wp.J(D.a.lR),Da=this.qJg(Da,this.Qc.runtime.yIa.id,"unfavored")&&({updateHints:this.t9}=this.v8h(Da,this.fIe,this.ifh,this.Qc.runtime.wp,"unfavored")).returnValue);Da&&this.Qc.input.atc&&(Da=this.Qc.input.f8.last().Aka(D.a.lR),Da=this.qJg(Da,
this.Qc.input.f8.last().NY.id,"alreadyMerged"));return Da}Mdl(){const Da=new c.a;if(this.zIb)return Da;const La=this.NO?this.NO.updateHints.Q7():new m.a;let Ta=0;for(;Ta<La.length-1;){const Sa=La.J(Ta);let Hb,Oa=!1;for(Hb=Ta+1;Hb<La.length;Hb++){const za=La.J(Hb);if(Sa.rci(za)){Da.add(Sa.id);La.WB(Hb);La.WB(Ta);Oa=!0;break}}Oa||Ta++}return Da}qJg(Da,La,Ta){Da=this.Wf.getPropertyString(Da,f.a.k0a);Da=x.a.pe(Da);return La.equals(Da)?!0:(this.wxd(2),n.a.instance.Ba(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",
this.Qc.runtime.yIa.id,Da,Ta),!1)}v8h(Da,La,Ta,Sa,Hb){let Oa;Oa=new mb.a(new m.a,0);Da=this.Wf.getPropertyObjectIds(Da,f.a.m8).Q7();for(let $a=0;$a<Da.length;$a++){if(!Sa.Pa(Da.J($a)))return n.a.instance.Ba(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",Da.J($a),Hb),{returnValue:!1,updateHints:Oa};const Xb=Sa.J(Da.J($a));var za=x.a.pe(this.Wf.getPropertyString(Xb,f.a.Eva));if(La.contains(za)||Ta.contains(za)){za=
this.S$e.ved(Xb);if(!za)return n.a.instance.Ba(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",Xb.id,Hb),{returnValue:!1,updateHints:Oa};Oa.updateHints.add(za)}}0<Da.length&&n.a.instance.Ba(17162308,1,4,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",Hb,Da.Go(),Oa.updateHints.Go());return{returnValue:!0,
updateHints:Oa}}Cel(){return({rL:this.Uha,D9c:this.iEa,kCd:this.cqa}=da.a.jCh(this.Qc,this.Wf,this.JC,this.Bwa,this.Uxa,this.xM,!0,!0)).returnValue?!0:!1}lfl(Da){const La=da.a.T2d(this.Wf,Ta=>this.Qc.runtime.pj.J(Ta),this.JC,1,this.xM,!0,!0).returnValue;if(!La)return n.a.instance.Ba(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.FR=this.zIb?new db(this.Qc,La,1):new cb(this.Qc,La,Da,this.NO?this.NO.BPa:0);return!0}initialize(){if(this._initialized)return!1;
this._initialized=!0;if(!this.ofl()||!this.Cel())return!1;const Da=this.Mdl();return this.lfl(Da)?!0:!1}dXh(Da){const La=new m.a;let Ta="";for(let Sa=0;Sa<Da.length;Sa++){const Hb=Da.J(Sa);Hb.b2()?Ta+=Da.J(Sa).text:2===Hb.type?(La.add(new la(Hb.jj,Hb.type,Ta,Hb.Gb)),Ta=""):4===Hb.type&&(La.add(new la(Hb.jj,Hb.type)),Ta="")}return La}validateUpdateHintsAreComplete(Da,La,Ta){La=this.dXh(La);Da=this.dXh(Da);let Sa=La.length===Da.length;if(Sa)for(let Hb=0;Hb<La.length;Hb++)if(!La.J(Hb).isEqual(Da.J(Hb))){Sa=
!1;break}Sa||(this.wxd(4),n.a.instance.Ba(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Ta,Da.Go(),La.Go()));return Sa}Mnh(Da,La,Ta){(La=({Kib:Da}=this.wTj(Da,La,Ta)).returnValue)||this.wxd(this.FR.mergeConflict?1:3);return{returnValue:La,Kib:Da}}wTj(Da,La,Ta){let Sa;Sa=new m.a;let Hb=!0;var Oa=0;let za=null,$a=this.NO?this.NO.updateHints.length:0;for(var Xb=0;Xb<$a&&Hb;Xb++)za=
this.NO.updateHints.J(Xb),Oa<this.t9.updateHints.length&&za.id.equals(this.t9.updateHints.J(Oa).id)&&5!==this.Qc.input.source?({returnValue:Hb}=this.FR.Egf(za,2),Oa++):Hb=this.FR.Fgf(za,2);if(!Hb)return n.a.instance.Ba(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",za.toString()),{returnValue:!1,Kib:Sa};if(!this.validateUpdateHintsAreComplete(this.FR.Wd,this.iEa,"Favored"))return{returnValue:!1,Kib:Sa};if(Da&&1===this.Qc.input.g2&&!this.FR.unh(La,Ta,2))return n.a.instance.Ba(17409920,
1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",La,Ta),{returnValue:!1,Kib:Sa};Hb=!0;Xb=new m.a;for($a=this.t9?this.t9.updateHints.length:0;Oa<$a&&Hb;Oa++){za=this.t9.updateHints.J(Oa);let Eb;({tt:Eb,returnValue:Hb}=this.FR.Egf(za,4));Hb&&Eb&&Xb.my(Xb.length,Eb)}return Hb?this.validateUpdateHintsAreComplete(this.FR.base,this.cqa,"Unfavored")?Da&&2===this.Qc.input.g2&&!this.FR.tnh(La,Ta,4)?(n.a.instance.Ba(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
La,Ta),{returnValue:!1,Kib:Sa}):{returnValue:!0,Kib:Xb}:{returnValue:!1,Kib:Sa}:(n.a.instance.Ba(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",za.id,za.type),{returnValue:!1,Kib:Sa})}RSk(){let Da,La=0;let Ta=0,Sa=x.a.nil;for(Da=new y.a;Ta<this.FR.base.length;){const za=this.FR.base.J(Ta);Sa.equals(za.jj)||(La=0,Sa=za.jj);if(5===za.type){var Hb=La+za.length;var Oa=void 0;let $a;const Xb=aa(this.cqa);if(!({index:Oa}=O(Xb,za.jj,La)).returnValue||!({index:$a}=
O(Xb,za.jj,Hb)).returnValue)return n.a.instance.Ba(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",za.ICd),{returnValue:!1,doi:Da};for(Hb=new m.a;Oa<$a;Oa++)Hb.add(Xb.J(Oa));Da.W(za.ICd,Hb)}La+=za.length;Ta++}return{returnValue:!0,doi:Da}}SSk(){let Da;Da=new y.a;let La=0;for(let Sa=0;Sa<this.FR.base.length;Sa++){const Hb=this.FR.base.J(Sa);if(5===Hb.type){var Ta=void 0;let Oa;const za=aa(this.cqa);
if(!({index:Ta}=M(za,La,this.Qc.ma)).returnValue||!({index:Oa}=M(za,La+Hb.length,this.Qc.ma)).returnValue)return n.a.instance.Ba(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,eoi:Da};const $a=new m.a;for(;Ta<Oa;Ta++)$a.add(za.J(Ta));Da.W(Hb.ICd,$a)}La+=Hb.length}return{returnValue:!0,eoi:Da}}NSj(Da){let La;La=new m.a;let Ta;if(this.zIb){if(!({eoi:Ta}=this.SSk()).returnValue)return{returnValue:!1,Fnd:La}}else if(!({doi:Ta}=this.RSk()).returnValue)return{returnValue:!1,
Fnd:La};let Sa;Sa=this.zIb?new db(this.Qc,aa(this.iEa),1):new cb(this.Qc,aa(this.iEa),new c.a,this.NO?this.NO.BPa:0);for(var Hb=0;Hb<Da.length;Hb++)if(!Sa.Fgf(Da.J(Hb),4))return{returnValue:!1,Fnd:La};for(Da=Sa.Wd.length-1;0<=Da;Da--)5===Sa.Wd.J(Da).type&&(Hb=Sa.Wd.J(Da).ICd,Sa.Wd.WB(Da),Sa.Wd.my(Da,Ta.J(Hb)));this.zIb&&(this.hEh(Sa.Wd),this.hEh(this.FR.Wd));if(!this.validateUpdateHintsAreComplete(this.FR.Wd,Sa.Wd,"Merged"))return{returnValue:!1,Fnd:La};La=Sa.Wd;return{returnValue:!0,Fnd:La}}hEh(Da){const La=
new y.a;for(let Ta=Da.length-1;0<=Ta;Ta--){const Sa=Object(v.a)(E.a,Da.J(Ta));Sa&&(La.Pa(Sa.Gb)?La.J(Sa.Gb).source!==Sa.source&&Da.WB(Ta):La.add(Sa.Gb,Sa))}}vTj(Da){let La;if(!({lDd:La}=this.FR.QBf(aa(this.cqa))).returnValue)return!1;for(let Sa=0;Sa<La.length;Sa++){const Hb=La.J(Sa);let Oa,za;if(!({index:Oa}=M(Da,Hb.cp,this.Qc.ma)).returnValue||!({index:za}=M(Da,Hb.cp+Hb.length,this.Qc.ma)).returnValue)return n.a.instance.Ba(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.Qc.ma.uf(Object.assign(new G.a,
{Mh:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Ta=!1;for(let $a=Oa;$a<za&&!Ta;$a++)Ta=!Hb.GZd.EJ.equals(Da.J($a).EJ);if(!Ta){for(Ta=Oa;Ta<za;Ta++)Da.WB(Oa);Da.insert(Oa,Hb.mDd)}}return!0}uTj(Da){let La;if(!({QFc:La}=this.FR.QBf(aa(this.cqa))).returnValue)return!1;for(let Hb=0;Hb<La.length;Hb++){var Ta=La.J(Hb);let Oa,za;if(({index:Oa}=O(Da,Ta.nf,Ta.cp)).returnValue&&({index:za}=O(Da,Ta.nf,Ta.cp+Ta.mDd.length)).returnValue){var Sa=!1;for(let $a=Oa;$a<za&&!Sa;$a++)Sa=!Ta.GZd.EJ.equals(Da.J($a).EJ)||
!Ta.GZd.fF.jz(Da.J($a).fF);if(Sa){if(this.NO&&1===this.NO.BPa||this.t9&&1===this.t9.BPa)return!1}else{for(Sa=Oa;Sa<za;Sa++)Da.WB(Oa);Da.insert(Oa,Ta.mDd)}}else if(Ta=Ta.mDd.Vil,n.a.instance.Ba(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",Ta),Ta||this.NO&&1===this.NO.BPa||this.t9&&1===this.t9.BPa)return!1}return!0}GWk(Da){let La,Ta;Ta=new m.a;La=this.Qc.runtime.Fl.J(D.a.lR);let Sa;({r6f:Sa}=Tb.zQh(this.Qc,
this.Wf));const Hb=new m.a;for(let za=0;za<Da.length;za++){if(Sa.contains(Da.J(za).id,(Xb,Eb)=>Xb.equals(Eb)))continue;if(this.Qc.runtime.Fl.Pa(Da.J(za).id))return n.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Da.J(za).id),{returnValue:!1,Koe:La,Joe:Ta};Hb.add(Da.J(za).id);var Oa=Da.J(za).uab();const $a=new Wa.a(Oa);Oa=Oa.Fn();for(const Xb of Oa)$a.JB(Xb);Ta.add($a)}Da=this.Wf.getPropertyObjectIds(La.tj,f.a.m8);Da.my(Da.length,Hb);this.Wf.setPropertyObjectIds(La.tj,
f.a.m8,Da);return{returnValue:!0,Koe:La,Joe:Ta}}G9d(Da){return String.format("Name: {0}, Message: {1}, Stack: {2}",Da.name,Da.message,Da.stack)}wxd(Da){this.h0||(this.h0=Da)}DFc(){let Da;Da=null;let La,Ta;var Sa;try{if({Fl:Da,Koe:La,Joe:Ta,returnValue:Sa}=this.GMm(),Sa){if(La&&Ta){this.Qc.runtime.Fl.W(La.tj.id,La);for(Sa=0;Sa<Ta.length;Sa++){const $a=Ta.J(Sa);this.Qc.runtime.Fl.W($a.tj.id,$a)}const Hb=La.tj,Oa=this.Wf.getPropertyObjectIds(Hb,f.a.m8),za=this.Wf.getPropertyString(Hb,f.a.k0a);n.a.instance.Ba(17162312,
1,4,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Oa.Go(),za)}else n.a.instance.Ba(593826831,1,4,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Fl:Da}}}catch(Hb){n.a.instance.Ba(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.G9d(Hb))}this.wxd(5);n.a.instance.Ba(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.h0,this.ate);this.txb();this.NO&&1===this.NO.BPa&&this.Qc.ma.uf(Object.assign(new ia.a,{eventId:"bc04c",Mh:"ParagraphMergeUsingHints.TryDoMerge",info:t[this.h0]+"/LCS"}));return{returnValue:!1,Fl:Da}}GMm(){let Da,La,Ta;Ta=La=Da=null;let Sa;Sa=this.initialize();this.Qc.ma.UL("PMUH Initialize");let Hb=null;Sa=Sa&&({Kib:Hb}=this.Mnh(!1,x.a.nil,0)).returnValue;this.Qc.ma.UL("PMUH ApplyUpdateHints");let Oa=new m.a;Sa=Sa&&({Fnd:Oa}=this.NSj(Hb)).returnValue;this.Qc.ma.UL("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");
Sa=this.zIb?Sa&&this.vTj(Oa):Sa&&this.uTj(Oa);this.Qc.ma.UL("PMUH ApplyUnfavoredFormattingChanges");this.zIb&&!this.fjm(Oa)&&(n.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Qc.ma.uf(Object.assign(new G.a,{Mh:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Sa=!1);const za=this.X$d(Oa);Sa=Sa&&({Ioe:Da}=da.a.wcd(this.Qc,this.Wf,this.xM,Oa,za)).returnValue;this.Qc.ma.UL("PMUH GetMergeableObjectsFromMergeBlocks");this.NO&&1===this.NO.BPa&&this.t9&&1===this.t9.BPa||(Sa=Sa&&({Koe:La,
Joe:Ta}=this.GWk(F(Hb))).returnValue,this.Qc.ma.UL("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Sa,mergeConflict:!!this.FR&&this.FR.mergeConflict,Fl:Da,Koe:La,Joe:Ta}}X$d(Da){const La=new m.a;for(let Ta=0;Ta<Da.length;Ta++)2===Da.J(Ta).type&&La.add(Da.J(Ta).jj);return La}zHf(Da){const La=new m.a;for(let Ta=0;Ta<Da.length;Ta++)2===Da.J(Ta).type&&La.add(Da.J(Ta));return La}fjm(Da){var La=this.zHf(this.Uha),Ta=this.zHf(this.iEa),Sa=this.zHf(this.cqa),Hb=this.X$d(La),Oa=this.X$d(Ta),
za=this.X$d(Sa);Oa=P.b(Hb,Oa,za);Hb=new m.a;for(za=0;za<Oa.length;za++)Hb.my(Hb.length,Oa.J(za).bAk());Oa=this.gAk(Da);La=this.cAk(Oa,Hb,La,Ta,Sa);Ta=0;Sa=new c.a;for(Hb=0;Hb<Da.length;Hb++)if(Oa=Da.J(Hb),2===Oa.type)if(Sa.contains(Oa.jj))if(Ta<La.length)Da.WB(Hb),Da.insert(Hb,La.J(Ta)),Ta++;else return!1;else Sa.add(Oa.jj);0<Da.length&&2!==Da.J(Da.length-1).type&&Ta<La.length&&Da.insert(Da.length,La.J(Ta));return!0}gAk(Da){const La=new c.a;for(let Ta=0;Ta<Da.length;Ta++)2===Da.J(Ta).type&&La.add(Da.J(Ta).jj);
return La}cAk(Da,La,Ta,Sa,Hb){const Oa=new m.a;for(let za=0;za<La.length;za++){const $a=La.J(za);if(!Da.contains($a)){let Xb;(({block:Xb}=this.EBf(Sa,$a)).returnValue||({block:Xb}=this.EBf(Hb,$a)).returnValue||({block:Xb}=this.EBf(Ta,$a)).returnValue)&&Xb&&Oa.add(Xb)}}return Oa}EBf(Da,La){for(let Ta=0;Ta<Da.length;Ta++)if(2===Da.J(Ta).type&&Da.J(Ta).jj===La)return Da=Da.J(Ta),{returnValue:!0,block:Da};return{returnValue:!1,block:null}}txb(){const Da=new m.a;da.a.zwc(this.Wf,"BaseObjects_",this.JC,
Da);da.a.zwc(this.Wf,"FavoredObjects_",this.Bwa,Da);da.a.zwc(this.Wf,"ConflictObjects_",this.Uxa,Da)}m1j(){let Da,La;Da=x.a.nil;La=-1;let Ta=0;for(let Sa=0;Sa<this.FR.Wd.length;Sa++){const Hb=this.FR.Wd.J(Sa);if(Hb.b2())Ta+=Hb.length;else if(6!==Hb.type)Ta=0;else return Da=Hb.jj,La=Ta,{returnValue:!0,objectId:Da,cp:La}}n.a.instance.Ba(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Da,cp:La}}CCd(Da,La){let Ta,Sa;Sa=La;Ta=Da;try{let Hb=
this.initialize();if(Hb=(Hb=Hb&&this.Mnh(!0,Da,La).returnValue)&&({objectId:Ta,cp:Sa}=this.m1j()).returnValue)return n.a.instance.Ba(17409924,1,4,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",Ta,Sa),{returnValue:!0,mgb:Ta,xua:Sa}}catch(Hb){n.a.instance.Ba(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.G9d(Hb))}this.wxd(5);n.a.instance.Ba(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.h0,this.ate);this.txb();return{returnValue:!1,mgb:Ta,xua:Sa}}static zQh(Da,La){let Ta;Ta=new m.a;if(!Da.input.atc)return{returnValue:!0,r6f:Ta};Da=Da.input.f8.last().Aka(D.a.lR);Ta=La.getPropertyObjectIds(Da,f.a.m8);return{returnValue:!0,r6f:Ta}}static H_l(Da){if(!da.a.xxf(Da))return!0;const La=new A.a;Da.runtime.Fl.W(D.a.lR,da.a.pfl(Da,La));return!0}static r_l(Da){if(!Da.runtime.Fl.Pa(D.a.lR)||!Da.runtime.wp.Pa(D.a.lR))return!0;const La=new A.a,Ta=Da.runtime.Fl.J(D.a.lR);var Sa=La.getPropertyString(Ta.tj,
f.a.k0a);if(x.a.pe(Sa).equals(x.a.nil))return!0;Sa=La.getPropertyObjectIds(Ta.tj,f.a.m8);const Hb=La.getPropertyObjectIds(Da.runtime.wp.J(D.a.lR),f.a.m8);let Oa;({r6f:Oa}=Tb.zQh(Da,La));for(let za=0;za<Hb.length;za++)Sa.contains(Hb.J(za),($a,Xb)=>$a.equals(Xb))||Oa.contains(Hb.J(za),($a,Xb)=>$a.equals(Xb))||(Sa.add(Hb.J(za)),Da.runtime.Fl.W(Hb.J(za),new Wa.a(Da.runtime.wp.J(Hb.J(za)).yH())));La.setPropertyObjectIds(Ta.tj,f.a.m8,Sa);return!0}}Object(z.a)(Tb,"ParagraphMergeUsingHints",null,[1790])},
1309:function(z,H,b){z=b(0);class f{constructor(v){this.Eqi=v;this.succeeded=!1;this.xFc=v?v.xFc:0;this.Hsl=!1;this.length=this.oIm=0}}Object(z.a)(f,"TrieResult",null,[]);class c{constructor(v,t,A){this.xxb=new f(null);this.YBl=v;this.Ymd=t;this.qmi=t+A-1}get result(){return this.xxb}pXh(){let v;return this.Ymd<=this.qmi?(v=this.YBl.charAt(this.Ymd),++this.Ymd,{returnValue:!0,ch:v}):{returnValue:!1,ch:"\x00"}}tlg(v,t,A){v&&(this.xxb.Hsl=!0,this.xxb.oIm=t);this.xxb.length=this.Ymd;this.xxb.succeeded=
!0;this.xxb.xFc=A;this.Ymd!==this.qmi+1&&(this.xxb=new f(this.xxb))}}Object(z.a)(c,"LookUpStringVisitor",null,[1476]);var n=b(1419);class m{constructor(){this.ouh=this.rsh=this.tsh=this.qsh=this.ssh=this.Ijf=this.Hjf=this.Kjf=this.Gjf=0}}Object(z.a)(m,"TRIESTATS",null,[]);class x{constructor(){this.symbol=this.Jod=0}}Object(z.a)(x,"TrieSymbol",null,[]);b.d(H,"a",function(){return y});class y{constructor(v,t){this.Q6=null;this.Yie=this.Emi=this.Cmi=this.Gmi=this.ymi=this.Fmi=this.Dmi=this.Hmi=this.zmi=
0;this.bK=v;if(v.uy(t,4)!==y.WPb)throw Error.argument("Input does not represent a trie");t+=4;this.smi=1===v.uy(t,4);t+=4;this.VBl=1===v.uy(t,4);t+=4;this.SBl=v.uy(t,4);t+=4;if(v.uy(t,4)){v=t+4;this.Q6=this.X6l(v);this.zmi=t=v+y.e0j;this.Hmi=t+=y.r_d*(this.Q6.Gjf+(this.Q6.Gjf%2?1:0));this.Dmi=t+=y.r_d*(this.Q6.Kjf+(this.Q6.Kjf%2?1:0));this.Fmi=t+=y.r_d*(this.Q6.Hjf+(this.Q6.Hjf%2?1:0));this.ymi=t+=y.r_d*(this.Q6.Ijf+(this.Q6.Ijf%2?1:0));this.Gmi=t+=y.Mjf*this.Q6.qsh;this.Cmi=t+=y.Njf*this.Q6.tsh;
this.Emi=t+=y.Njf*this.Q6.rsh;t+=y.Njf*this.Q6.ssh;if(t!==v+this.Q6.ouh)throw Error.argument("Corrupted trie binary");this.Yie=t}else this.Q6=null}Pli(v,t,A,D){v=new c(v,t,A);this.t8i(v,D);return v.result}a0h(v){if(this.smi)if(v)--v;else return"";if(!this.Q6)throw Error.argument("Invalid trieID");const t=new n.a;t.lF=0;this.Xbc(t);const A=[];for(;;){if(t.lF&y.ujb)if(v)--v;else return Array.add(A,t.Tcc),String.fromCharCode.apply(null,A);const D=!!(t.lF&y.cFe),U=this.erc(t,!0);if(D||v<U){if(Array.add(A,
t.Tcc),!this.Xbc(t))throw Error.argument("Invalid trieID");}else if(v-=U,!this.HBd(t))throw Error.argument("Invalid trieID");}}t8i(v,t){let A=0;this.smi&&(v.tlg(this.VBl,this.SBl,0),++A);if(this.Q6){var D=new n.a;D.lF=0;if(this.Xbc(D))for(;;){var U=void 0;if(!({ch:U}=v.pXh()).returnValue)break;t&&(U=t(U));U=U.toString().charCodeAt(0);let F=!1;for(;!F;){const E=!!(D.lF&y.ujb);if(D.Tcc===U){if(F=!0,E&&v.tlg(!!(D.lF&y.MLg),D.Hye,A),!this.Xbc(D))return}else if(A+=this.erc(D,!0),!this.HBd(D))return;E&&
++A}}}}Xbc(v){if(!v.lF)return this.pEg(v),!0;if(!(v.lF&y.bFe))return!1;v.sWa=0;v.qx=v.qub;this.pEg(v);return!0}HBd(v){if(v.lF&y.cFe)return!1;this.pEg(v);return!0}erc(v,t){return v.lF&y.LLg?v.q_d:v.lF&y.bFe?!t&&v.lF&y.cFe?this.UKk(v):1:0}UKk(v){v=y.pnf(v);if(!this.Xbc(v))return 0;let t=0;do v.lF&y.ujb&&++t,t+=this.erc(v,!1);while(this.HBd(v));return t}pEg(v){v.lF||(v.sWa=0,v.qx=this.Yie);var t=this.F3d(this.zmi,v.qx),A=t.symbol;v.qx+=t.Jod;t=this.bK.uy(this.ymi+y.Mjf*A,y.Mjf);v.Tcc=t&65535;v.lF=t>>
16;v.lF&y.LLg&&(v.q_d=this.pkk(v));v.lF&y.MLg&&(t=this.F3d(this.Hmi,v.qx),A=t.symbol,v.qx+=t.Jod,v.Hye=this.bK.uy(this.Gmi+4*A,4));v.lF&y.Edj?(v.qub=this.Yie+((this.bK.J(v.qx)<<8|this.bK.J(v.qx+1))<<8|this.bK.J(v.qx+2)),v.qx+=3):v.lF&y.Fdj?(v.qub=v.qx,v.sWa=v.qub):v.lF&y.Gdj?(t=this.F3d(this.Dmi,v.qx),A=t.symbol,v.qx+=t.Jod,v.qub=this.Yie+this.bK.uy(this.Cmi+4*A,4)):v.lF&y.bFe&&(t=this.F3d(this.Fmi,v.qx),A=t.symbol,v.qx+=t.Jod,v.sWa||(v.sWa=v.qx),v.sWa+=this.bK.uy(this.Emi+4*A,4),v.qub=v.sWa)}F3d(v,
t){const A=new x;let D=0;for(;;){D+=this.bK.J(t);++t;++A.Jod;const U=this.bK.uy(v,2);if(D<U)break;A.symbol+=U;D-=U;v+=2;D<<=8}A.symbol+=D;return A}pkk(v){let t=this.bK.J(v.qx);192<=t?(t=(t&63)<<15|(this.bK.J(v.qx+1)&127)<<8,t|=this.bK.J(v.qx+2),v.qx+=3):128<=t?(t=(t&127)<<8|this.bK.J(v.qx+1),v.qx+=2):v.qx+=1;return t}X6l(v){const t=new m;t.Gjf=this.bK.uy(v+12,2);t.Kjf=this.bK.uy(v+14,2);t.Hjf=this.bK.uy(v+16,2);t.Ijf=this.bK.uy(v+18,2);t.ssh=this.bK.uy(v+24,4);t.qsh=this.bK.uy(v+28,4);t.tsh=this.bK.uy(v+
32,4);t.rsh=this.bK.uy(v+36,4);t.ouh=this.bK.uy(v+40,4);return t}static pnf(v){const t=new n.a;t.Tcc=v.Tcc;t.lF=v.lF;t.q_d=v.q_d;t.qx=v.qx;t.qub=v.qub;t.sWa=v.sWa;t.Hye=v.Hye;return t}}y.WPb=1654263084;y.e0j=48;y.r_d=2;y.Njf=4;y.Mjf=4;y.ujb=1;y.cFe=2;y.LLg=4;y.MLg=8;y.bFe=16;y.Fdj=64;y.Gdj=128;y.Edj=256;Object(z.a)(y,"Trie",null,[1477])},1399:function(z,H,b){b.d(H,"a",function(){return c});z=b(0);var f=b(151);class c{constructor(){this.izb=this.jzb=this.w9a=this.Kub=this.hzb=this.Hqb=this.Iub=this.pfb=
this.Iqb=this.Jub=null;this.reset()}reset(){this.Jub=new f.a;this.Iqb=new f.a;this.pfb=new f.a;this.Iub=new f.a;this.Hqb=new f.a;this.hzb=new f.a;this.Kub=new f.a;this.w9a=new f.a;this.w9a=new f.a;this.jzb=new f.a;this.izb=new f.a}vWm(n){return this.lWa(this.Jub,n)&&this.lWa(this.Iqb,n)&&this.lWa(this.pfb,n)&&this.lWa(this.Iub,n)&&this.lWa(this.Hqb,n)&&this.lWa(this.hzb,n)&&this.lWa(this.Kub,n)&&this.lWa(this.w9a,n)&&this.lWa(this.jzb,n)&&this.lWa(this.izb,n)}lWa(n,m){return!n||!n.length||n.length===
m}}Object(z.a)(c,"MergeableTrackedChangesProperties",null,[])},1400:function(z,H,b){b.d(H,"a",function(){return m});z=b(0);var f=b(701),c=b(195),n=b(40);class m{constructor(x,y,v){this.gzj=x;this.Ovj=y;this.gvj=v;this.QTe=new c.a(Object(n.a)(this,this.B4j,"checkIfDifferent"))}get nzb(){return this.gzj}get oldValue(){return this.Ovj}get newValue(){return this.gvj}get gLa(){return!(void 0===this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===
this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get qT(){return this.gLa||this.isDeleted||this.QTe.value}B4j(){return this.gLa||this.isDeleted?!0:!f.a.coh(this.nzb,this.oldValue,this.newValue)}}Object(z.a)(m,"PropertyDiff",null,[])},1401:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1232);class f extends b.a{constructor(){super();this.pxc=this.Dnd=this.Bn=null;this.msd=0}get Fra(){return"Property"}GVb(){this.detail.W("Type",this.Fra);this.detail.W("ComplexMerger",
null!=this.Bn?this.Bn:-1);this.detail.W("Strategy",null!=this.Dnd?this.Dnd:-1);this.detail.W("ClassId",null!=this.pxc?this.pxc:-1);this.detail.W("PropId",this.msd);return this.detail}}Object(z.a)(f,"PropertyMergeFailureDetail",b.a,[])},1402:function(z,H,b){b.d(H,"a",function(){return n});z=b(0);var f=b(151),c=b(505);class n{constructor(){this.jQa=new f.a;this.ZQa=new f.a;this.iTa=new f.a}get cPb(){return this.jQa}get ZAf(){return this.ZQa}get LCb(){return this.iTa}get isEmpty(){return!this.jQa.length&&
!this.ZQa.length&&!this.iTa.length}get H5f(){return Math.max(Math.max(this.jQa.length,this.ZQa.length),this.iTa.length)}get qGl(){return Math.min(Math.min(this.jQa.length,this.ZQa.length),this.iTa.length)}OYd(m){this.jQa.add(m)}QYd(m){this.ZQa.add(m)}VYd(m){this.iTa.add(m)}bAk(){const m=new c.a,x=new f.a;let y=0;for(;y<this.jQa.length||y<this.ZQa.length||y<this.iTa.length;)y<this.jQa.length&&!m.contains(this.jQa.J(y))&&(x.add(this.jQa.J(y)),m.add(this.jQa.J(y))),y<this.ZQa.length&&!m.contains(this.ZQa.J(y))&&
(x.add(this.ZQa.J(y)),m.add(this.ZQa.J(y))),y<this.iTa.length&&!m.contains(this.iTa.J(y))&&(x.add(this.iTa.J(y)),m.add(this.iTa.J(y))),y++;return x}}Object(z.a)(n,"ObjectCollection",null,[])},1403:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{constructor(c,n){this.BPa=n;this.updateHints=c}}Object(z.a)(f,"UpdateHintCollection",null,[])},1404:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1198);class f extends b.a{constructor(c,n){super();this.nf=c;this.Gb=n}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.nf,this.Gb)}}Object(z.a)(f,"LcsInsertParaUpdateHint",b.a,[])},1405:function(z,H,b){b.d(H,"a",function(){return c});z=b(0);var f=b(151);b=b(1198);class c extends b.a{constructor(n){super();this.O1=new f.a;this.cp=n}get type(){return 11}toString(){let n="";for(let m=0;m<this.O1.length;m++)n+=String.format("({0}), ",this.O1.J(m).toString());return String.format("[Cp:{0}] {1}",this.cp,n)}}Object(z.a)(c,"LcsInsertUpdateHint",b.a,[])},1406:function(z,H,b){b.d(H,"a",function(){return f});
z=b(0);b=b(1198);class f extends b.a{constructor(c,n){super();this.text=n;this.nf=c}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.nf,this.text)}}Object(z.a)(f,"LcsInsertTextUpdateHint",b.a,[])},1407:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1198);class f extends b.a{constructor(c,n,m){super();this.cp=c;this.nf=n;this.Gb=m}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.nf,this.Gb)}}Object(z.a)(f,"LcsDeleteParaUpdateHint",b.a,[])},1408:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1198);class f extends b.a{constructor(c,n){super();this.cp=c;this.text=n}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(z.a)(f,"LcsDeleteTextUpdateHint",b.a,[])},1409:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);b=b(1161);class f extends b.a{constructor(){super()}get Fra(){return"Conflict"}}
Object(z.a)(f,"ConflictMergeFailureDetail",b.a,[])},1411:function(z,H,b){b.r(H);b.d(H,"InsightsMenuItemFactory",function(){return m});z=b(0);var f=b(1111),c=b(301),n=b(16);class m{constructor(x=null){this.nqj=x||CommonUIStrings.l_InsightsButtonText}get AZa(){return 10}H5(x){var y=x.bF;x=f.a.fXa()?f.a.vqb(y,1):f.a.eoc(y);y=String.format(this.nqj,y);return this.BEk(x,y)}BEk(x,y){return c.a(m.j9h,f.a.fXa()?"1914896509":"3317204163",n.a.ve(y),f.a.kUf,null,n.a.ve(x),n.a.ve(y),null,null)}}m.j9h="bInsights";
Object(z.a)(m,"InsightsMenuItemFactory",null,[1332])},1412:function(z,H,b){b.d(H,"a",function(){return n});z=b(0);var f=b(301),c=b(16);class n{constructor(m,x,y,v,t){this.C5e=m;this.B5e=x;this.zEj=y;this.ipj=v;this.jYg=t}get AZa(){return 4}H5(m,x=null){x=x.sessionId+"|"+x.hla+"|"+m.bF;if(this.jYg||this.ipj){let y=this.jYg||c.a.fw(CommonUIStrings.l_HelpTooltip)===c.a.fw(m.bF.trim());if(this.zEj&&2<m.bF.length){const v=m.bF;";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&v.substring(1,v.length-1)===
n.CQf&&(y=!0)}m=y?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.bF);return this.TPh(x,c.a.ve(m),y)}return this.TPh(x,c.a.ve(String.format(CommonUIStrings.l_TextWithQuotation,m.bF)),!1)}TPh(m,x,y){return f.a(n.CQf,y?this.B5e:this.C5e,x,"OfficeAssistant_16x16x32","A0",c.a.ve(m),x,null,null)}}n.CQf="bSearchHelp";Object(z.a)(n,"AssistanceMenuItemFactory",null,[1332])},1413:function(z,H,b){b.d(H,"a",function(){return x});z=b(0);var f=b(2),c=b(301),n=
b(93),m=b(16);class x{get AZa(){return 13}H5(){return x.BYj()}static BYj(){return c.b(x.ENh,"798637440",m.a.ve(CommonUIStrings.l_LookupFirstRunExperienceTitle),f.AFrameworkApplication.Hp,n.getImageClass("Info_32x32x32"),null,null,m.a.ve(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,m.a.ve(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}x.ENh="bTellMeFirstRun";Object(z.a)(x,"FirstRunMenuItemFactory",null,[1332])},1414:function(z,H,b){b.d(H,"a",function(){return m});
z=b(0);var f=b(2),c=b(301),n=b(16);class m{constructor(x=null,y=null){this.J4g=x;this.mvj=y||CommonUIStrings.l_LookupNoResultsDescription}get AZa(){return 14}H5(x){x=String.format(this.mvj,x.bF);return this.xZj(x)}xZj(x){return c.b(m.Kqi,"798637440",n.a.ve(CommonUIStrings.l_LookupNoResultsTitle),this.J4g?f.AFrameworkApplication.Hp:null,this.J4g,null,null,n.a.ve(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,n.a.ve(x),null,null)}}m.Kqi="lookupNoResults";Object(z.a)(m,"NoCommandsFoundMenuItemFactory",
null,[1332])},1415:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{constructor(c,n){this.FontWeight=0;this.Text=null;this.FontWeight=c;this.Text=n}}Object(z.a)(f,"LabelFormatted",null,[])},1416:function(z,H,b){b.d(H,"a",function(){return M});z=b(0);var f=b(74),c=b(1116),n=b(1285),m=b(1178),x=b(1155),y=b(1200),v=b(1417),t=b(1163),A=b(1179),D=b(1128),U=b(1143),F=b(1133),E=b(1435),P=b(1199),G=b(1115),K=b(1111),S=b(2),L=b(1196),I=b(31),O=b(130);class M{constructor(R,W,Y){this.eXc=this.FTd=
this.GTd=this.ETd=!1;this.GR=null;this.S3=-1;this.fNb=this.QXc=null;this.lYc="";this.RIb=0;this.tc=R;const N=K.a.fXa();this.Xkb=W||[];this.Be=S.AFrameworkApplication.he;this.Rbh=R.kcg;this.HTd=R.jcg;this.J6e=N&&this.lac();this.L6e=N&&this.nac();this.yCj=N&&this.oac();this.M6e=this.pac();this.Tbh=this.Fyd();R.gBg&&K.a.Kwg(R)&&(this.QXc=new E.a(R),this.ETd=R.MAd,this.GTd=R.OAd,this.FTd=R.Vcb,this.eXc=this.ETd&&this.$J("File")||this.GTd&&this.$J("People")||this.FTd&&this.$J("Notes"));this.DTd=this.Gym();
this.KTd=R.fqd;this.z8=this.P1k();this.GNg=new v.a(R);this.NVc=Y;this.G5e=new n.a;this.KTd&&(this.GNg=new v.a(R))}$J(R){return Array.contains(this.Xkb,R)?!0:!1}C$(){return"TellMeService"}hsa(){return this.tc.IL?1===this.tc.IL?1:this.$J("Command")||this.$J("Recommended")?2:3:0}M1k(R){let W="";if(!R&&this.$J("Command")&&this.tc.EYf){W+="MultiLingualCommandWAC,";var Y=this.tc.l_i;0<Y.length&&(W+=Y+",")}R&&this.$J("Recommended")&&this.HTd&&(Y=this.tc.m_i,0<Y.length&&(W+=Y+","));!R&&this.$J("Help")&&(R=
this.tc.k_i,0<R.length&&(W+=R+","));0<W.length&&(W=W.substr(0,W.length-1));return W}H6(R,W,Y,N=c.a.tellMe,aa=null){const ia=new F.a(R);Y=K.a.lAa(R);if(this.eXc&&(!this.RIb||window.performance.now()-this.RIb>=K.a.pze)){var ea=this.G5e.Q1k();if(ea)this.RIb=window.performance.now(),ea.then(ua=>{this.lYc=ua},ua=>{G.TellMeActor.instance.rf.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+ua)});else if(G.TellMeActor.instance.rf)G.TellMeActor.instance.rf.onError("TellMeServiceProvider:IssueQuery",
"undefined token promise")}var la=this.eXc&&!!this.lYc;ea=la||Y&&this.$J("Recommended")&&this.HTd;la=la||!Y&&(this.Rbh&&this.$J("Command")||this.J6e&&this.$J("Answer")||this.L6e&&this.$J("Definition")||this.Tbh&&this.$J("Image")||this.KTd&&this.$J("Help")||this.M6e&&this.$J("WolframAnswer"));if(ea||la)if(this.fNb=N,N={"Content-Type":"application/json",Accept:"application/json"},N["X-Office-Version"]=S.AFrameworkApplication.buildVersion,N["X-Office-Application"]=S.AFrameworkApplication.K.Oa("Application"),
N["X-Office-Platform"]="WAC",N["X-TellMe-SqmUserId"]=S.AFrameworkApplication.K.Oa("LoggableUserId")||"",N["X-TellMe-SessionId"]=G.TellMeActor.instance.$ae(),this.lYc&&(N.Authorization="Bearer "+this.lYc),ea=this.M1k(Y),0<ea.length&&(N["X-TellMe-Flights"]=ea),ea=[],!Y&&this.$J("Answer")&&this.J6e&&(aa?Array.contains(aa,8):1)&&Array.add(ea,"Answer"),!Y&&this.$J("Command")&&this.Rbh&&!t.isCommandHookQuery(R.Oh)&&(aa?Array.contains(aa,16):1)&&Array.add(ea,"Command"),!Y&&this.$J("Definition")&&this.L6e&&
(aa?Array.contains(aa,9):1)&&Array.add(ea,"Definition"),!Y&&this.$J("Help")&&this.KTd&&(aa?Array.contains(aa,7):1)&&Array.add(ea,"Help"),!Y&&this.$J("WolframAnswer")&&this.M6e&&(aa?Array.contains(aa,11):1)&&Array.add(ea,"WolframAnswer"),Y&&this.$J("Recommended")&&this.HTd&&!G.TellMeActor.instance.FDd&&(aa?Array.contains(aa,17):1)&&Array.add(ea,"Recommended"),!Y&&this.$J("Image")&&this.Tbh&&(aa?Array.contains(aa,18):1)&&Array.add(ea,"Image"),this.lYc&&this.eXc&&(aa?Array.contains(aa,13)||Array.contains(aa,
14)||Array.contains(aa,19):1)&&(this.QXc.Mse(),this.ETd&&this.$J("File")&&Array.add(ea,"File"),this.GTd&&this.$J("People")&&Array.add(ea,"People"),this.FTd&&this.$J("Notes")&&Array.add(ea,"Notes")),ea.length){N["X-TellMe-SuggestionTypes"]=ea.join(",");N["X-TellMe-Culture"]=S.AFrameworkApplication.uiCulture;N["X-TellMe-ProcessSessionId"]=S.AFrameworkApplication.userSessionId;var xa=this.GR=O.a.create().toString();N["Client-Request-Id"]=xa;var Ha=window.performance.now();this.oIa();this.S3=window.setTimeout(()=>
{if(xa===this.GR){this.GR="";this.S3=-1;W.resultsUpdated(ia);const ua={};ua[m.a.provider]=this.C$();ua[m.a.Fzc]=R.O7b;G.TellMeActor.instance.rf.wG(x.a.timedOut,this.NVc,ua)}},this.NVc);this.Be.Hi(this.z8,2,this.O1k(R.Oh),N,!1,0,ua=>{this.z6b(ua,R,W,xa,Ha,aa)},ua=>{this.e6b(ua,R,W,xa,Ha)},null,null,!1,4E3,6E3)}else G.TellMeActor.instance.rf.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),W.resultsUpdated(ia);else W.resultsUpdated(ia)}oIa(){-1!==this.S3&&(window.clearTimeout(this.S3),
this.S3=-1)}z6b(R,W,Y,N,aa,ia){const ea=new F.a(W);if(N===this.GR){this.oIa();G.TellMeActor.instance.rf.taa(W.Oh.length,this.Xkb.join(","),R.data.ff.toString(),Math.round(window.performance.now()-aa),P.a.tellMe,!0,y.a.rWa);N=R.data.od;R=null;try{R=I.b(N)}catch(Ba){G.TellMeActor.instance.rf.onError("OnSuccessCallBack","Exception occured while deserializing response:"+Ba);return}N=K.a.lAa(W);if("Groups"in R&&R.Groups){var la=R.Groups;for(var xa of la)if("GroupType"in xa&&"Suggestions"in xa&&xa.Suggestions)if("Commands"===
xa.GroupType&&(ia?Array.contains(ia,16):1)||"Recommended"===xa.GroupType&&(ia?Array.contains(ia,17):1)){var Ha=(la="Recommended"===xa.GroupType)?"DLIS":"NaiveBayes";"Source"in xa&&xa.Source&&(Ha=xa.Source);var ua=xa.Suggestions;new f.a;var Ra=[];for(var ab of ua)this.ytl(ab)&&(ua=ab.Type,("Command"===ua||la&&"Recommended"===ua)&&Ra.push(new A.a(ab.CommandId,ab.Score)));t.logCommandSuggestions(Ra,!W.Oh.trim().length,xa.GroupType,Ha);Ha=G.TellMeActor.instance.tca;ua=[];for(const Ba of Ra)la&&Ha&&Ha.qpf(Ba.commandId)||
ua.push(Ba);Ra=t.getResultGroup(W,ua,this.tc,null,null,null,la?17:16);0<Ra.results.length&&(this.fNb!==c.a.contextMenu&&(Ra.displayName=la?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ea.NF(Ra))}else if("Answer"===xa.GroupType){ua=xa.Suggestions;la=null;Ra=2147483647;Ha="";for(const Ba of ua)if(this.xtl(Ba))if(Ha=Ba.Type,ua=this.CWb(Ha),"Answer"===Ha&&this.J6e){la=this.FCh(Ha,Ba,W.Oh);break}else ua&&ua<Ra&&(Ra=ua,la=this.FCh(Ha,Ba,W.Oh));Ra=K.a.Him(W.Oh,Ha);
la&&(ia?Array.contains(ia,la.type):1)&&(Ha=[],this.DTd?(Ha.push(appChrome.actions.setControlLabel(la.value,la.bF)),Ha.push(appChrome.actions.updateCompoundButtonDescription(la.value,la.description)),Ha.push(appChrome.actions.setCompoundButtonCommandValueId(la.value,Ra))):(Ha.push(appChrome.actions.setControlLabel(la.value,la.bF+" - "+la.description)),Ha.push(appChrome.actions.setButtonCommandValueId(la.value,Ra))),appChrome.api.dispatch(Ha),Ra=this.SCh(la.type),Ra.eJ(la),ea.NF(Ra))}else"Help"===xa.GroupType&&
xa.Suggestions.length&&(ia?Array.contains(ia,7):1)?this.KTd&&(la=this.GNg.e8k(W,xa.Suggestions))&&0<la.results.length&&ea.NF(la):"Substrate"===xa.GroupType&&this.eXc&&"Type"in xa&&("File"===xa.Type&&this.ETd&&(ia?Array.contains(ia,14):1)?(la=this.QXc.iUh(xa.Suggestions,N,this.fNb))&&0<la.results.length&&ea.NF(la):"People"===xa.Type&&this.GTd&&(ia?Array.contains(ia,13):1)?(la=this.QXc.MYh(xa.Suggestions,this.fNb))&&0<la.results.length&&ea.NF(la):"Notes"===xa.Type&&this.FTd&&(ia?Array.contains(ia,13):
1)&&(la=this.QXc.HXh(xa.Suggestions,N,W))&&0<la.results.length&&ea.NF(la));else G.TellMeActor.instance.rf.onError("OnSuccessCallBack","GroupType"in xa?"Invalid group suggestions found for "+xa.GroupType:"Invalid group found")}if(R.Intents){xa=R.Intents;for(const Ba of xa)this.Ktl(Ba)&&"Image"===Ba.GroupType&&Ba.ConfidenceScore>Ba.ConfidenceThreshold&&(ia?Array.contains(ia,18):1)&&(xa=[],G.TellMeActor.instance.kZ()&&G.TellMeActor.instance.kZ().Ucb?(ab=this.tc.I_f?K.a.cIf(W.Oh,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):
W.Oh+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.tc.qwe||xa.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):ab=W.Oh+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader,xa.push(appChrome.actions.setControlLabel("ImageForSearch",ab)),ab=K.a.vqb(W.Oh,9,Object.assign(new L.a,{landingTab:"Image"})),xa.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",ab)),appChrome.api.dispatch(xa),xa=new D.a("ImageForSearch",12),
xa.score=Ba.ConfidenceScore,ab=this.SCh(xa.type),ab.eJ(xa),ea.NF(ab))}Y.resultsUpdated(ea);G.TellMeActor.instance.rf.taa(W.Oh.length,this.Xkb.join(","),"",Math.round(window.performance.now()-aa),"",!0,y.a.provider)}}e6b(R,W,Y,N,aa){const ia=new F.a(W);N===this.GR&&(this.oIa(),G.TellMeActor.instance.rf.taa(W.Oh.length,this.Xkb.join(","),R.data.ff.toString(),Math.round(window.performance.now()-aa),P.a.tellMe,!1,y.a.rWa));Y.resultsUpdated(ia)}CWb(R){switch(R){case "Entity":return this.yCj?3:0;case "Definition":return this.L6e?
5:0;case "WolframAnswer":return this.M6e?2:0;default:return 0}}FCh(R,W,Y){switch(R){case "Answer":return new D.a(this.DTd?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===W.Title?Y:W.Title,W.Description);case "Entity":return new D.a(this.DTd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===W.Title?Y:W.Title,W.Description);case "Definition":return new D.a(this.DTd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===W.Title?Y:W.Title,W.Description);case "WolframAnswer":return new D.a("WolframForSearch",
3,""===W.Title?Y:W.Title,W.Description);default:return null}}SCh(R){switch(R){case 0:return new U.a(8,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new U.a(10,CommonUIStrings.l_TellMeEntityTitle);case 1:return new U.a(9,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new U.a(11,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new U.a(18,CommonUIStrings.l_TellMeImageTitle);default:return null}}xtl(R){return"Type"in R&&!!R.Type&&""!==R.Type&&"Description"in R&&!!R.Description&&""!==
R.Description}ytl(R){return"Type"in R&&!!R.Type&&""!==R.Type&&"CommandId"in R&&!!R.CommandId&&""!==R.CommandId&&"Score"in R&&!!R.Score}Ktl(R){if("GroupType"in R&&R.GroupType&&"ConfidenceScore"in R&&R.ConfidenceScore&&"ConfidenceThreshold"in R&&R.ConfidenceThreshold)return!0;G.TellMeActor.instance.rf.onError("IsValidIntentGroup","Invalid intents found");return!1}O1k(R){const W=K.a.lfi(R),Y={};Y.Query=R;W&&this.HTd&&(Y.CommandClickedEvents=G.TellMeActor.instance.nKe,Y.CommandActionEvents=G.TellMeActor.instance.kQg,
Y.TellMeCommandClickMruEvents=G.TellMeActor.instance.k4g,Y.ContentType=G.TellMeActor.instance.v3d);return I.c(Y)}lac(){return!!this.tc&&this.tc.lac||!!S.AFrameworkApplication.pa&&S.AFrameworkApplication.pa.mb.lac}nac(){return!!this.tc&&this.tc.nac||!!S.AFrameworkApplication.pa&&S.AFrameworkApplication.pa.mb.nac}oac(){return!!this.tc&&this.tc.oac||!!S.AFrameworkApplication.pa&&S.AFrameworkApplication.pa.mb.oac}pac(){return!!this.tc&&this.tc.pac||!!S.AFrameworkApplication.pa&&S.AFrameworkApplication.pa.mb.pac}Fyd(){return!!this.tc&&
this.tc.Fyd}Gym(){return!!this.tc&&!this.tc.Ucb}Lfi(){return!!S.AFrameworkApplication.pa&&S.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}Mfi(){return!!S.AFrameworkApplication.pa&&S.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}P1k(){if(S.AFrameworkApplication.K){if(this.Mfi())return S.AFrameworkApplication.K.Oa("TellMeServiceProdEndpointForSearch");if(this.Lfi())return S.AFrameworkApplication.K.Oa("TellMeServiceEdogEndpointForSearch");
if(K.a.nWf())return S.AFrameworkApplication.K.Oa("TellMeServiceIntEndpointForSearch")}return S.AFrameworkApplication.j_i}static bDh(R,W){if(W)return new M(R,["Command","Recommended"],R.JNk);W=K.a.fXa()?"Answer Definition Help WolframAnswer Image File People Notes".split(" "):["Help","WolframAnswer","File","People","Notes"];return new M(R,W,R.O_h)}}Object(z.a)(M,"TellMeServiceProvider",null,[1334])},1417:function(z,H,b){b.d(H,"a",function(){return y});z=b(0);b(1116);var f=b(1128),c=b(1143),n=b(1133),
m=b(1111),x=b(16);class y{constructor(v){this.tc=v}C$(){return"Assistance"}hsa(){return this.tc.IL?1===this.tc.IL?1:this.tc.fqd?3:2:0}H6(v,t,A=!1,D,U=null){D=new n.a(v);if((!U||Array.contains(U,7))&&!m.a.lAa(v)){U=new c.a(7);if(A){A=x.a.fw(CommonUIStrings.l_HelpTooltip)===x.a.fw(v.Oh.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,v.Oh);const F=[];this.tc.Ucb&&(this.tc.qwe||F.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),
A=this.CXh(v.Oh));const E="||"+v.Oh;F.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",A));F.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",E));appChrome.api.dispatch(F);v=new f.a("GetHelpFromTellMe",4,v.Oh)}else v=new f.a("bSearchHelp",4,v.Oh);U.eJ(v);U.displayName=CommonUIStrings.l_HelpButtonTitle;D.NF(U)}t.resultsUpdated(D)}e8k(v,t=null){const A=new c.a(7),D=x.a.fw(CommonUIStrings.l_HelpTooltip)===x.a.fw(v.Oh.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
v.Oh);for(let F=0;F<t.length&&2>F;F++){var U=void 0;U=[];let E="GetHelpWithDescriptionFromTellMe"+(F+1).toString(),P=4;if(this.tc.vyd)U.push(appChrome.actions.setControlLabel(E,D)),U.push(appChrome.actions.setCompoundButtonCommandValueId(E,v.Oh)),U.push(appChrome.actions.updateCompoundButtonDescription(E,this.kNf(t.length)));else if(this.tc.wyd){let G=this.z1h(t[F]);E="GetHelpFromTellMe"+(F+1).toString();this.tc.Ucb&&(G=this.CXh(G));P=9;U.push(appChrome.actions.setControlLabel(E,G));U.push(appChrome.actions.setButtonCommandValueId(E,
this.H2k(t[F])))}appChrome.api.dispatch(U);U=new f.a(E,P);U.label=this.z1h(t[F]);U.description=this.G2k(t[F]);A.eJ(U);if(this.tc.wyd)break}A.displayName=CommonUIStrings.l_HelpButtonTitle;return A}kNf(v){return 1===v?String.format(CommonUIStrings.l_SearchResultText,v):String.format(CommonUIStrings.l_SearchResultsText,v)}CXh(v){return this.tc.I_f?m.a.cIf(v,CommonUIStrings.l_HelpScopedButtonText):v+CommonUIStrings.l_HelpScopedButtonText}z1h(v){return v.name?v.name:""}G2k(v){return v.description?v.description:
""}H2k(v){return v.id?"AssetID="+v.id:""}}Object(z.a)(y,"AssistanceResultsProvider",null,[1334])},1418:function(z,H,b){b.d(H,"a",function(){return D});z=b(0);b(1116);var f=b(1163),c=b(1128),n=b(1143),m=b(1133),x=b(1298),y=b(1115),v=b(1111),t=b(2),A=b(16);class D{constructor(U,F,E,P){this.tca=U;this.nob=F;this.Zeh=P;this.fnj=E;this.tc=y.TellMeActor.instance.kZ();this.lCj=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDisabledMRUCommands",
!1)}C$(){return"EmptyQuery"}hsa(){return 1===this.tc.IL?1:0}H6(U,F,E=!1,P,G=null){P=new m.a(U);if((!G||Array.contains(G,4)||Array.contains(G,5)||Array.contains(G,3))&&v.a.lAa(U)){this.tca.Xad().length||!this.fnj||this.Zeh||(U=new n.a(5),G=new c.a(null,13),U.eJ(G),P.NF(U));U=new n.a(3);if(0<this.tca.Xad().length){U.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;G=this.tca.Xad();var K=[];for(var S of G)K.push(S.Id);f.updateCommandsState(K,this.tc);for(var L of G)if(!this.lCj||f.isCommandEnabled(L.Id))"Find"===
L.Id&&this.tc&&this.tc.shb||U.eJ(new c.a(L.Id,5));P.NF(U)}if(this.Zeh&&0<this.nob.length&&this.tca.Xad().length<D.Hni){S=new n.a(4);S.displayName=CommonUIStrings.l_TellMeTryQueryTitle;L=D.Hni-U.results.length;U=[];for(G=0;G<this.nob.length&&G<L;++G){if(E){K=v.a.lFg+(G+1);const I=this.nob[G].key,O=A.a.replaceAll(I,'"',"");U.push(appChrome.actions.setControlLabel(K,I));U.push(appChrome.actions.setButtonCommandValueId(K,O));K=new x.a(I,7,O,K)}else K=new x.a(this.nob[G].key,7,this.nob[G].value);S.eJ(K)}0<
U.length&&appChrome.api.dispatch(U);P.NF(S)}}F.resultsUpdated(P)}}D.Hni=5;Object(z.a)(D,"EmptyQueryResultsProvider",null,[1334])},1419:function(z,H,b){b.d(H,"a",function(){return f});z=b(0);class f{constructor(){this.Hye=this.sWa=this.qub=this.qx=this.q_d=this.lF=this.Tcc=0}}Object(z.a)(f,"TRIESCAN",null,[])},1428:function(z,H,b){b.r(H);var f=b(0),c=b(1116),n=b(1178),m=b(1155);class x{constructor(Xa,vb){this.XCa=Xa;this.$h=vb}resultsUpdated(Xa){this.XCa.Etm(this.$h,Xa)}}Object(f.a)(x,"AggregatorResultsProviderCallback",
null,[1336]);var y=b(1143),v=b(1133);class t{constructor(Xa){this.Vva=null;this.tc=Xa;this.tc.n7a&&(this.Vva=this.tc.y8d())}C$(){return"AppsForOffice"}hsa(){return this.tc.IL?1===this.tc.IL?1:2:0}H6(Xa,vb,Pb,oc,zc=null){Pb=new v.a(Xa);if(!zc||Array.contains(zc,1))zc=new y.a(1),this.Vva.eMj(zc,Xa.Oh),Pb.NF(zc);vb.resultsUpdated(Pb)}}Object(f.a)(t,"AppsForOfficeRecommendationResultsProvider",null,[1334]);var A=b(1417),D=b(1103),U=b(1124),F=b(201);class E{constructor(Xa,vb){this.Sa=Xa;this.UBl=vb}isMatch(Xa,
vb){if(!Object(F.a)(1431,Xa))throw Error.argument("objToTest","Expected feature bundle");let Pb;return({value:Pb}=Xa.Kp(this.Sa.nya)).returnValue?this.Sa.tJg.isMatch(Pb,vb):this.UBl}}Object(f.a)(E,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1464]);class P{constructor(Xa,vb){this.Sa=Xa;this.B4f=vb}isMatch(Xa){if(!Object(F.a)(1431,Xa))throw Error.argument("objToTest","Expected feature bundle");return!!(this.B4f^Xa.Kp(this.Sa.nya).returnValue)}}Object(f.a)(P,"AnnotatedWithAnnotationFilter",
null,[1464]);class G{constructor(Xa){this.Sa=Xa}isMatch(Xa,vb){if(!Object(F.a)(1435,Xa))throw Error.argument("objToTest","Expected struct value");return this.Sa.tJg.isMatch(Xa.isb(this.Sa.lVa),vb)}}Object(f.a)(G,"FieldValueMatchesStructFilter",null,[1464]);class K{constructor(Xa,vb){Xa&&(this.lVa=Xa.J(0),this.tJg=vb.Xra(Xa.J(1)))}}Object(f.a)(K,"FieldValueMatchesStructFilterInit",null,[]);class S{constructor(Xa){this.B4f=Xa}isMatch(Xa){if(!Object(F.a)(1431,Xa))throw Error.argument("objToTest","Expected feature bundle");
return!!(this.B4f^Xa.HPf)}}Object(f.a)(S,"HasAnnotationsAnnotationFilter",null,[1464]);class L{constructor(Xa,vb){this.Sa=Xa;this.kaa=vb}isMatch(Xa,vb){if(!Object(F.a)(1434,Xa))throw Error.argument("objToTest","Expected list value");switch(this.kaa){case 0:for(const Pb of Xa.items)if(this.Sa.filter.isMatch(Pb,vb))return!0;return!1;case 1:for(const Pb of Xa.items)if(!this.Sa.filter.isMatch(Pb,vb))return!1;return!0;default:throw Error.notImplemented();}}}Object(f.a)(L,"ItemTestListFilter",null,[1464]);
class I{constructor(Xa){this.Sa=Xa}isMatch(Xa,vb){if(!Object(F.a)(1434,Xa))throw Error.argument("objToTest","Expected list value");return this.Sa.filter.isMatch(Xa.items.length,vb)}}Object(f.a)(I,"LengthMatchesListFilter",null,[1464]);class O{constructor(Xa,vb){this.Sa=Xa;this.kaa=vb}isMatch(Xa,vb,Pb=null){let oc=!this.kaa;for(const zc of this.Sa.svh)if((oc=zc.isMatch(Xa,vb,Pb))?1===this.kaa:!this.kaa)return oc;2===this.kaa&&(oc=!oc);return oc}}Object(f.a)(O,"NonterminalFilter",null,[1464]);class M{constructor(Xa,
vb){if(Xa){var Pb=Xa.J(0);this.svh=Array(Pb);for(let oc=0;oc<Pb;++oc)this.svh[oc]=vb.Xra(Xa.J(1+oc))}}}Object(f.a)(M,"NonterminalFilterInit",null,[]);class R{constructor(Xa,vb){this.Sa=Xa;this.kaa=vb}isMatch(Xa,vb){if("number"!==typeof Xa)throw Error.argument("objToTest","Expected number value");let Pb=this.Sa.number;if(this.Sa.query){vb=this.Sa.query.ss(null,vb);if("number"!==typeof vb)throw Error.invalidOperation("Query did not return number");Pb+=vb}switch(this.kaa){case 0:return Xa===Pb;case 1:return Xa<
Pb;case 2:return Xa<=Pb;case 3:return Xa>Pb;case 4:return Xa>=Pb;default:throw Error.notImplemented();}}}Object(f.a)(R,"NumberFilter",null,[1464]);class W{constructor(Xa,vb){Xa&&(this.number=Xa.J(0),this.query=Xa.J(1)?vb.EL(Xa.J(1)):null)}}Object(f.a)(W,"NumberFilterInit",null,[]);class Y{constructor(Xa,vb,Pb){this.K9d=this.KNk;this.$Bl=Xa;this.wmi=vb;this.vmi=Pb}zlf(Xa){this.wmi=Xa}KNk(Xa){if(!Xa)throw Error.argument("name","Invalid named feature bundle reference");const vb=Xa.substr(1);return 1===
Xa.charCodeAt(0)&&vb===this.$Bl?this.wmi:this.vmi?this.vmi.K9d(Xa):null}}Object(f.a)(Y,"SimpleNamedFeatureBundleResolver",null,[1485]);class N{constructor(Xa){this.Sa=Xa}isMatch(Xa,vb){if(!Object(F.a)(1431,Xa))throw Error.argument("objToTest","Expected feature bundle");Xa=this.Sa.query.ss(null,new Y(this.Sa.GBe,Xa,vb));if("boolean"!==typeof Xa)throw Error.invalidOperation("Query did not return bool");return Xa}}Object(f.a)(N,"PredicateAnnotationFilter",null,[1464]);class aa{constructor(Xa,vb){Xa&&
(this.GBe=vb.KE(Xa.J(0)),this.query=vb.EL(Xa.J(1)))}}Object(f.a)(aa,"PredicateAnnotationFilterInit",null,[]);class ia{constructor(Xa){this.Sa=Xa}isMatch(Xa,vb){if("boolean"!==typeof Xa)throw Error.argument("objToTest","Expected bool value");vb=this.Sa.query.ss(null,vb);if("boolean"!==typeof vb)throw Error.invalidOperation("Query did not return bool");return Xa===vb}}Object(f.a)(ia,"QueryBooleanFilter",null,[1464]);class ea{constructor(Xa,vb){this.Sa=Xa;this.kaa=vb}isMatch(Xa,vb){if("number"!==typeof Xa)throw Error.argument("objToTest",
"Expected integer");vb=this.Sa.query.ss(null,vb);if("number"!==typeof vb)throw Error.invalidOperation("Query did not return an enum value");switch(this.kaa){case 0:return Xa===vb;case 1:return 0!==(Xa&vb);case 2:return Xa===(Xa&vb);case 3:return vb===(Xa&vb);default:throw Error.notImplemented();}}}Object(f.a)(ea,"QueryEnumFilter",null,[1464]);class la{constructor(Xa,vb){Xa&&(this.Ofe=1===Xa.J(0),this.query=vb.EL(Xa.J(1)))}}Object(f.a)(la,"QueryEnumFilterInit",null,[]);class xa{constructor(Xa,vb){this.Sa=
Xa;this.kaa=vb}isMatch(Xa,vb){if(!Object(F.a)(1434,Xa))throw Error.argument("objToTest","Expected list value");vb=this.Sa.query.ss(null,vb);if(!Object(F.a)(1434,vb))throw Error.invalidOperation("Query did not return list value");if(Xa.U6!==vb.U6)return!1;switch(this.kaa){case 0:return D.Annotations.cDb(D.Annotations.tSk(Xa.U6),Xa,vb);case 1:for(const Pb of Xa.items)for(const oc of vb.items)if(D.Annotations.cDb(Xa.U6,Pb,oc))return!0;return!1;case 2:for(const Pb of Xa.items)for(const oc of vb.items)if(!D.Annotations.cDb(Xa.U6,
Pb,oc))return!1;return!0;case 3:for(const Pb of vb.items)for(const oc of Xa.items)if(!D.Annotations.cDb(Xa.U6,Pb,oc))return!1;return!0;default:throw Error.notImplemented();}}}Object(f.a)(xa,"QueryListFilter",null,[1464]);class Ha{constructor(Xa,vb){this.Sa=Xa;this.kaa=vb}isMatch(Xa,vb){if("string"!==typeof Xa)throw Error.argument("objToTest","Expected string");vb=this.Sa.query.ss(null,vb);if("string"!==typeof vb)throw Error.invalidOperation("Query did not return string");this.Sa.tVf&&(Xa=Xa.toUpperCase(),
vb=vb.toUpperCase());switch(this.kaa){case 0:return Xa===vb;case 1:return 0<=Xa.indexOf(vb);case 2:return Xa.startsWith(vb);case 3:return Xa.endsWith(vb);case 4:return 0<=vb.indexOf(Xa);case 5:return vb.startsWith(Xa);case 6:return vb.endsWith(Xa);default:throw Error.notImplemented();}}}Object(f.a)(Ha,"QueryStringFilter",null,[1464]);class ua{constructor(Xa,vb){Xa&&(this.query=vb.EL(Xa.J(0)),this.tVf=1===Xa.J(1))}}Object(f.a)(ua,"QueryStringFilterInit",null,[]);class Ra{constructor(Xa){this.Sa=Xa}isMatch(Xa,
vb){if(!Object(F.a)(1435,Xa))throw Error.argument("objToTest","Expected struct value");vb=this.Sa.query.ss(null,vb);if(!Object(F.a)(1435,vb))throw Error.invalidOperation("Query did not return struct value");return Xa.isEqual(Xa)}}Object(f.a)(Ra,"QueryStructFilter",null,[1464]);class ab{constructor(Xa){this.Sa=Xa}isMatch(Xa,vb){Xa=this.Sa.query.ss(null,vb);if("boolean"!==typeof Xa)throw Error.invalidOperation("Query did not return bool");return Xa}}Object(f.a)(ab,"QueryWhereConstraintFilter",null,
[1464]);class Ba{constructor(Xa){this.Sa=Xa}isMatch(Xa){if("string"!==typeof Xa)throw Error.argument("objToTest","Expected string");return this.Sa.rkg.test(Xa)}}Object(f.a)(Ba,"RegexStringFilter",null,[1464]);class Ga{constructor(Xa,vb){Xa&&(this.rkg=vb.Fsb(Xa.J(0)))}}Object(f.a)(Ga,"RegexStringFilterInit",null,[]);class ja{constructor(Xa,vb){Xa&&(this.filter=vb.Xra(Xa.J(0)))}}Object(f.a)(ja,"SingleFilterFilterInit",null,[]);class X{constructor(Xa,vb){Xa&&(this.query=vb.EL(Xa.J(0)))}}Object(f.a)(X,
"SingleQueryFilterInit",null,[]);class fa{constructor(Xa){this.Sa=Xa}isMatch(Xa){if("boolean"!==typeof Xa)throw Error.argument("objToTest","Expected bool value");return Xa===this.Sa.value}}Object(f.a)(fa,"StoredValueBooleanFilter",null,[1464]);class pa{constructor(Xa){Xa&&(this.value=1===Xa.J(0))}}Object(f.a)(pa,"StoredValueBooleanFilterInit",null,[]);class Ia{constructor(Xa,vb){this.Sa=Xa;this.kaa=vb}isMatch(Xa){if("number"!==typeof Xa)throw Error.argument("objToTest","Expected integer");switch(this.kaa){case 0:return this.Sa.Ofe?
this.Sa.value?!!(Xa&this.Sa.value):!Xa:Xa===this.Sa.value;case 1:return this.Sa.Ofe?(Xa&this.Sa.value)===this.Sa.value:32>Xa&&(1<<Xa&this.Sa.value)===this.Sa.value;case 2:return this.Sa.Ofe?!!(Xa&this.Sa.value):32>Xa&&!!(1<<Xa&this.Sa.value);default:throw Error.notImplemented();}}}Object(f.a)(Ia,"StoredValueEnumFilter",null,[1464]);class ta{constructor(Xa){Xa&&(this.Ofe=1===Xa.J(0),this.value=Xa.J(1))}}Object(f.a)(ta,"StoredValueEnumFilterInit",null,[]);class oa{constructor(){this.XWl=null;this.Ljf=
this.RXb=0}}Object(f.a)(oa,"WHEREConstraintData",null,[]);class va{constructor(Xa){this.Sa=Xa}isMatch(Xa,vb){if(!Object(F.a)(oa,Xa))throw Error.argument("objToTest","Expected WHERE constraint data");let Pb=-1,oc=-1;const zc=Xa.XWl;switch(this.Sa.Vkf){case 4:Pb=zc.m$c;oc=zc.yzg;break;case 5:Pb=Xa.RXb;oc=zc.m$c-Xa.RXb;break;case 6:Pb=zc.m$c+zc.yzg;oc=Xa.RXb+Xa.Ljf-Pb;break;case 1:case 2:case 3:let Kc=!1;for(let Sc=zc.S_m;Sc;Sc=Sc.next)if(this.Sa.tVm===Sc.name){Kc=!0;1===this.Sa.Vkf?(Pb=Sc.m$c,oc=Sc.yzg):
2===this.Sa.Vkf?(Pb=Xa.RXb,oc=Sc.m$c-Xa.RXb):(Pb=Sc.m$c+Sc.yzg,oc=Xa.RXb+Xa.Ljf-Pb);break}if(!Kc)return!1;break;case 7:Pb=Xa.RXb;oc=Xa.Ljf;break;default:throw Error.notImplemented();}return null!==this.Sa.vEm.d2m(zc.k7m,Pb,oc,Pb,!0,2,vb)}}Object(f.a)(va,"SubSreWhereConstraintFilter",null,[1464]);class Fa{constructor(Xa,vb){if(Xa){var Pb=vb.KE(Xa.J(0));this.Vkf=Pb.charCodeAt(0);this.tVm=Pb.substr(1);this.vEm=vb.HZk(Xa.J(1))}}}Object(f.a)(Fa,"SubSreWhereConstraintFilterInit",null,[]);class cb{constructor(Xa){this.Sa=
Xa}isMatch(Xa,vb,Pb=null){if(!Object(F.a)(1431,Xa))throw Error.argument("objToTest","Expected feature bundle");if(null==Pb)throw Error.argumentNull("parentTextForSpan");if(this.Sa.cmh&&!this.Sa.cmh.isMatch(Xa,vb))return!1;if(this.Sa.OCg){let oc;if(({value:oc}=Xa.Kp(this.Sa.FDm)).returnValue){if(!this.Sa.OCg.isMatch(oc,vb))return!1}else{let zc,Kc;if(!({value:zc}=Xa.Kp(this.Sa.PWi)).returnValue||!({value:Kc}=Xa.Kp(this.Sa.OWi)).returnValue||0>zc||0>Kc||zc+Kc>Pb.length||!this.Sa.OCg.isMatch(Pb.substr(zc,
Kc),vb))return!1}}if(this.Sa.AXi){let oc;if(!({value:oc}=Xa.Kp(this.Sa.PWi)).returnValue||!this.Sa.AXi.isMatch(oc,vb))return!1}if(this.Sa.Shi){let oc;if(!({value:oc}=Xa.Kp(this.Sa.OWi)).returnValue||!this.Sa.Shi.isMatch(oc,vb))return!1}return!0}}Object(f.a)(cb,"TextSpanFilter",null,[1464]);class Za{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.PWi=Xa.J(0),this.OWi=Xa.J(1),this.FDm=Xa.J(2),this.OCg=Xa.J(3)?vb.Xra(Xa.J(3)):null,this.cmh=Xa.J(4)?vb.Xra(Xa.J(4)):null,this.AXi=Xa.J(5)?vb.Xra(Xa.J(5)):null,
this.Shi=Xa.J(6)?vb.Xra(Xa.J(6)):null)}}Object(f.a)(Za,"TextSpanFilterInit",null,[]);class gb{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.nya=Xa.J(0),this.tJg=Xa.J(1)?vb.Xra(Xa.J(1)):null)}}Object(f.a)(gb,"ValueFilterAnnotationFilterInit",null,[]);var Ya=b(1144);class fb{Xra(Xa,vb){const Pb=Xa.J(0),oc=new Ya.a;oc.Prb(Xa,1,Xa.count-1);switch(Pb){case 1:return new O(new M(oc,vb),0);case 2:return new O(new M(oc,vb),1);case 3:return new O(new M(oc,vb),2);case 101:return new Ba(new Ga(oc,vb));case 103:return new Ha(new ua(oc,
vb),0);case 104:return new Ha(new ua(oc,vb),1);case 105:return new Ha(new ua(oc,vb),2);case 106:return new Ha(new ua(oc,vb),3);case 107:return new Ha(new ua(oc,vb),4);case 108:return new Ha(new ua(oc,vb),5);case 109:return new Ha(new ua(oc,vb),6);case 201:return new fa(new pa(oc));case 202:return new ia(new X(oc,vb));case 301:return new R(new W(oc,vb),0);case 302:return new R(new W(oc,vb),1);case 303:return new R(new W(oc,vb),2);case 304:return new R(new W(oc,vb),3);case 305:return new R(new W(oc,
vb),4);case 401:return new Ia(new ta(oc),0);case 402:return new Ia(new ta(oc),1);case 403:return new Ia(new ta(oc),2);case 404:return new ea(new la(oc,vb),0);case 405:return new ea(new la(oc,vb),1);case 406:return new ea(new la(oc,vb),2);case 407:return new ea(new la(oc,vb),3);case 501:return new G(new K(oc,vb));case 502:return new Ra(new X(oc,vb));case 601:return new L(new ja(oc,vb),0);case 602:return new L(new ja(oc,vb),1);case 603:return new I(new ja(oc,vb));case 604:return new xa(new X(oc,vb),
0);case 605:return new xa(new X(oc,vb),1);case 606:return new xa(new X(oc,vb),2);case 607:return new xa(new X(oc,vb),3);case 701:return new S(!1);case 702:return new S(!0);case 703:return new P(new gb(oc,vb),!1);case 704:return new P(new gb(oc,vb),!0);case 705:return new E(new gb(oc,vb),!1);case 706:return new E(new gb(oc,vb),!0);case 707:return new N(new aa(oc,vb));case 901:return new cb(new Za(oc,vb));case 1002:return new ab(new X(oc,vb));case 1001:return new va(new Fa(oc,vb));default:throw Error.argument("initData");
}}}Object(f.a)(fb,"FilterFactory",null,[1430]);var ib=b(1109);class hb{constructor(Xa){this.Sa=Xa}get vD(){return this.Sa.vD}get G7(){return this.Sa.G7}get iye(){return this.Sa.iye}get Fee(){return this.Sa.Fee}load(Xa,vb){return this.ss(Xa,Xa?new Y("root",Xa,vb):vb)}store(Xa,vb,Pb){this.$Dc(Xa,vb,Xa?new Y("root",Xa,Pb):Pb,null)}ss(Xa,vb){if(!this.Fee&&!this.Sa.Je.Quc(this.vD,Xa))throw Error.argument("input","Input value not of expected type");let Pb=this.Sa.KNh;for(;Pb;)Xa=Pb.load(Xa,vb),Pb=Pb.next;
return Xa}$Dc(Xa,vb,Pb,oc){if(!this.iye)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.Fee&&!this.Sa.Je.Quc(this.vD,Xa))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Sa.Je.Quc(this.G7,vb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Sa.KNh.store(Xa,vb,Pb,oc)}static jxh(Xa,vb,Pb,oc){if(Pb===oc)return vb;if(D.Annotations.vI(Pb)&&D.Annotations.vI(oc)){Pb=D.Annotations.pab(Pb);oc=D.Annotations.pab(oc);
const zc=new ib.a(Xa,oc);for(const Kc of vb.items)Array.add(zc.items,hb.jxh(Xa,Kc,Pb,oc));return zc}if(Pb===D.Annotations.uPa){if(oc===D.Annotations.zva)return vb;if(oc===D.Annotations.eba)return vb.toString()}else if(Pb===D.Annotations.zva){if(oc===D.Annotations.uPa)return Math.floor(vb);if(oc===D.Annotations.eba)return vb.toString()}else if(Pb===D.Annotations.eba){if(oc===D.Annotations.uPa)return parseInt(vb);if(oc===D.Annotations.zva)return parseFloat(vb)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(f.a)(hb,"AnnotationQuery",null,[1469]);class db{constructor(){this.G7=this.vD=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}sab(Xa){if(this.next)return{returnValue:this.next,OOa:Xa};if(Xa){const vb=Xa.Wzh;Xa=Xa.VAi;return{returnValue:vb,OOa:Xa}}return{returnValue:null,OOa:Xa}}}Object(f.a)(db,"AnnotationQueryStep",null,[1496]);class da extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){vb=this.Sa.query.ss(Xa,vb);if(D.Annotations.vI(this.vD)){var Pb=D.Annotations.pab(this.vD);
let zc=new ib.a(this.Sa.Je,Pb);if(D.Annotations.vI(this.Sa.query.G7)){if(Xa.items.length!==vb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let Kc=0,Sc=Xa.items.length;Kc<Sc;++Kc)Array.add(zc.items,this.x_d(Xa.items[Kc],vb.items[Kc],Pb===D.Annotations.zva))}else for(var oc of Xa.items)Array.add(zc.items,this.x_d(oc,vb,Pb===D.Annotations.zva));return zc}if(D.Annotations.vI(this.Sa.query.G7)){oc=new ib.a(this.Sa.Je,this.vD);for(Pb of vb.items)Array.add(oc.items,
this.x_d(Xa,Pb,this.vD===D.Annotations.zva));return oc}return this.x_d(Xa,vb,this.vD===D.Annotations.zva)}x_d(Xa,vb,Pb){Xa=this.Imc(Xa,vb);return Pb?Xa:Math.floor(Xa)}}Object(f.a)(da,"NumericAnnotationQueryStep",db,[]);class Wa extends da{constructor(Xa){super(Xa)}Imc(Xa,vb){return Xa+vb}}Object(f.a)(Wa,"AddAnnotationQueryStep",da,[]);class mb extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){if(this.vD===D.Annotations.uCa&&this.Sa.query.G7===D.Annotations.uCa){let zc;if(({result:zc}=this.Hth(Xa)).returnValue)return zc}if(D.Annotations.vI(this.vD)){var Pb=
new ib.a(this.Sa.Je,D.Annotations.uCa);vb=this.Sa.query.ss(Xa,vb);if(D.Annotations.vI(this.Sa.query.G7)){if(Xa.items.length!==vb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let zc=0,Kc=Xa.items.length;zc<Kc;++zc)Array.add(Pb.items,this.Q3c(vb.items[zc],Xa.items[zc]))}else for(var oc of Xa.items)Array.add(Pb.items,this.Q3c(vb,oc));return Pb}oc=this.Sa.query.ss(Xa,vb);if(D.Annotations.vI(this.Sa.query.G7)){vb=new ib.a(this.Sa.Je,D.Annotations.uCa);
for(Pb of oc.items)Array.add(vb.items,this.Q3c(Pb,Xa));return vb}return this.Q3c(oc,Xa)}}Object(f.a)(mb,"BinaryBooleanAnnotationQueryStep",db,[]);class Tb extends mb{constructor(Xa){super(Xa)}Hth(Xa){return{returnValue:!Xa,result:!1}}Q3c(Xa,vb){return Xa&&vb}}Object(f.a)(Tb,"AndAnnotationQueryStep",mb,[]);class Da{constructor(Xa){Xa&&(this.Je=Xa)}}Object(f.a)(Da,"AnnotationsOnlyQueryStepInit",null,[]);class La extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){vb=this.Sa.query.ss(Xa,vb);Xa=
Xa.clone();D.Annotations.vI(this.Sa.query.G7)?Array.addRange(Xa.items,vb.items):Array.add(Xa.items,vb);return Xa}}Object(f.a)(La,"AppendAnnotationQueryStep",db,[]);class Ta extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){if(this.vD===D.Annotations.kX)return this.q9c(Xa,vb);const Pb=new ib.a(this.Sa.Je,D.Annotations.kX);for(const oc of Xa.items)Array.add(Pb.items,this.q9c(oc,vb));return Pb}q9c(Xa,vb){const Pb=new U.a(this.Sa.Je);Pb.P8a(Xa);Xa=new U.a(this.Sa.Je);this.Sa.script.cVa(null,new Y("Input",
Pb,new Y("Output",Xa,vb)));return Xa}}Object(f.a)(Ta,"ApplyAnnotationQueryStep",db,[]);class Sa extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){if(this.vD===D.Annotations.kX)return vb=this.q9c(Xa,vb),vb.Kp(this.Sa.bmh).returnValue||new ib.a(this.Sa.Je,D.Annotations.kX),vb;const Pb=new ib.a(this.Sa.Je,D.Annotations.kX);for(const oc of Xa.items)if(Xa=this.q9c(oc,vb),({value:Xa}=Xa.Kp(this.Sa.bmh)).returnValue)for(const zc of Xa.items)Array.add(Pb.items,zc);return Pb}q9c(Xa,vb){const Pb=new U.a(this.Sa.Je);
Pb.P8a(Xa);Xa=new U.a(this.Sa.Je);this.Sa.script.cVa(null,new Y("Input",Pb,new Y("Output",Xa,vb)));return Xa}}Object(f.a)(Sa,"ApplyExpandAnnotationQueryStep",db,[]);class Hb{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.script=vb.TUb(Xa.J(0)),this.bmh=Xa.J(1))}}Object(f.a)(Hb,"ApplyExpandQueryStepInit",null,[]);class Oa{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.script=vb.TUb(Xa.J(0)))}}Object(f.a)(Oa,"ApplyQueryStepInit",null,[]);class za extends db{constructor(Xa){super();this.Sa=Xa}load(Xa){if(this.vD===
D.Annotations.kX)return this.nie(Xa);const vb=new ib.a(this.Sa.Je,this.Sa.Je.getAttributeType(this.Sa.nya));for(const Pb of Xa.items)Array.add(vb.items,this.nie(Pb));return vb}store(Xa,vb,Pb,oc){if(this.vD===D.Annotations.kX){var zc=vb,Kc=({OOa:oc}=this.sab(oc)).returnValue;Kc&&(zc=Kc.store(D.Annotations.KV(this.nie(Xa)),vb,Pb,oc));Xa.vy(this.Sa.nya,zc)}else{var Sc=vb;if(zc=({OOa:oc}=this.sab(oc)).returnValue){Sc=new ib.a(this.Sa.Je,this.Sa.Je.getAttributeType(this.Sa.nya));for(Kc of Xa.items)Array.add(Sc.items,
this.nie(Kc));Sc=zc.store(Sc,vb,Pb,oc)}vb=Sc;if(vb.items.length!==Xa.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let ae=0,Bd=Xa.items.length;ae<Bd;++ae)Pb=Xa.items[ae],Pb.isReadOnly&&(Pb=Pb.clone(),Xa.items[ae]=Pb),Pb.vy(this.Sa.nya,vb.items[ae])}return Xa}nie(Xa){({value:Xa}=Xa.Kp(this.Sa.nya)).returnValue||(Xa=this.Sa.Je.dHk(this.Sa.nya));return Xa}}Object(f.a)(za,"AttrAnnotationQueryStep",db,[]);class $a{constructor(Xa,vb){Xa&&(this.Je=
vb,this.nya=Xa.J(0))}}Object(f.a)($a,"AttrQueryStepInit",null,[]);class Xb extends db{constructor(Xa){super();this.Sa=Xa}load(Xa){const vb=new U.a(this.Sa.Je);vb.P8a(Xa);return this.Sa.module.execute(vb)}}Object(f.a)(Xb,"CallModuleAnnotationQueryStep",db,[]);class Eb{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.module=vb.OJf(Xa.J(0)))}}Object(f.a)(Eb,"CallModuleQueryStepInit",null,[]);class ob extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){if(D.Annotations.vI(this.vD)){var Pb=this.Sa.query.ss(Xa,
vb);vb=new ib.a(this.Sa.Je,D.Annotations.eba);let Kc="string"===typeof Pb;for(var oc of Xa.items)if(Kc)Array.add(vb.items,oc+Pb);else for(var zc of Pb.items)Array.add(vb.items,oc+zc);return vb}oc=this.Sa.query.ss(Xa,vb);if("string"===typeof oc)return Xa+oc;zc=new ib.a(this.Sa.Je,D.Annotations.eba);for(Pb of oc.items)Array.add(zc.items,Xa+Pb);return zc}}Object(f.a)(ob,"ConcatAnnotationQueryStep",db,[]);class tb extends db{constructor(Xa){super();this.Sa=Xa}load(Xa){return hb.jxh(this.Sa.Je,Xa,this.vD,
this.G7)}}Object(f.a)(tb,"ConvertAnnotationQueryStep",db,[]);class yb extends db{constructor(){super()}load(Xa){return Xa.items.length}}Object(f.a)(yb,"CountAnnotationQueryStep",db,[]);class lb extends da{constructor(Xa){super(Xa)}Imc(Xa,vb){return Xa/vb}}Object(f.a)(lb,"DivideAnnotationQueryStep",da,[]);class Cc extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){vb=new Y(this.Sa.GBe,null,vb);for(const Pb of Xa.items)if(vb.zlf(Pb),this.Sa.query.ss(Pb,vb))return!0;return!1}}Object(f.a)(Cc,"ExistsAnnotationQueryStep",
db,[]);class Hc extends da{constructor(Xa){super(Xa)}Imc(Xa,vb){return Math.pow(Xa,vb)}}Object(f.a)(Hc,"ExpAnnotationQueryStep",da,[]);class Jc{constructor(Xa,vb){Xa&&(this.kVa=vb.KE(Xa.J(0)))}}Object(f.a)(Jc,"FeatureBundleNameQueryStepInit",null,[]);class Ib extends db{constructor(Xa){super();this.Sa=Xa}load(Xa){if(D.Annotations.vI(this.vD)){const vb=new ib.a(this.Sa.Je,this.Sa.Je.PWb(D.Annotations.pab(this.vD),this.Sa.lVa));for(const Pb of Xa.items)Array.add(vb.items,Pb.isb(this.Sa.lVa));return vb}return Xa.isb(this.Sa.lVa)}store(Xa,
vb,Pb,oc){if(D.Annotations.vI(this.vD)){var zc=vb,Kc=({OOa:oc}=this.sab(oc)).returnValue;if(Kc){zc=new ib.a(this.Sa.Je,this.Sa.Je.PWb(D.Annotations.pab(this.vD),this.Sa.lVa));for(var Sc of Xa.items)Array.add(zc.items,Sc.isb(this.Sa.lVa));zc=Kc.store(zc,vb,Pb,oc)}vb=zc;if(vb.items.length!==Xa.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let ae=0,Bd=Xa.items.length;ae<Bd;++ae)Pb=Xa.items[ae],Pb.isReadOnly&&(Pb=Pb.clone(),Xa.items[ae]=Pb),Pb.xtg(this.Sa.lVa,
vb.items[ae])}else Kc=vb,(Sc=({OOa:oc}=this.sab(oc)).returnValue)&&(Kc=Sc.store(D.Annotations.KV(Xa.isb(this.Sa.lVa)),vb,Pb,oc)),Xa.xtg(this.Sa.lVa,Kc);return Xa}}Object(f.a)(Ib,"FieldAnnotationQueryStep",db,[]);class nc{constructor(Xa,vb){Xa&&(this.Je=vb,this.lVa=Xa.J(0))}}Object(f.a)(nc,"FieldQueryStepInit",null,[]);class Gc extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){for(const Pb of Xa.items)if(this.Sa.filter.isMatch(Pb,vb))return Pb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");
}store(Xa,vb,Pb,oc){let zc=vb,Kc=-1;for(let ae=0,Bd=Xa.items.length;ae<Bd;ae++)if(this.Sa.filter.isMatch(Xa.items[ae],Pb)){Kc=ae;break}if(0>Kc)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Sc=({OOa:oc}=this.sab(oc)).returnValue;Sc&&(zc=Sc.store(D.Annotations.KV(Xa.items[Kc]),vb,Pb,oc));Xa.items[Kc]=zc;return Xa}}Object(f.a)(Gc,"FirstItemMatchingAnnotationQueryStep",db,[]);class tc extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){vb=new Y(this.Sa.GBe,
null,vb);for(const Pb of Xa.items)if(vb.zlf(Pb),!this.Sa.query.ss(Pb,vb))return!1;return!0}}Object(f.a)(tc,"ForAllAnnotationQueryStep",db,[]);class fc extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){Xa=vb?vb.K9d(this.Sa.kVa):null;if(!Xa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Sa.kVa+'"');return Xa}store(Xa,vb,Pb,oc){Xa=Pb?Pb.K9d(this.Sa.kVa):null;if(!Xa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Sa.kVa+'"');let zc=vb;const Kc=
({OOa:oc}=this.sab(oc)).returnValue;Kc&&(zc=Kc.store(Xa,vb,Pb,oc));Xa!==zc&&Xa.P8a(zc);return Xa}}Object(f.a)(fc,"GetAnnotationQueryStep",db,[]);class kc{constructor(Xa,vb){this.Cjj=Xa;this.Oyj=vb}get Wzh(){return this.Cjj}get VAi(){return this.Oyj}}Object(f.a)(kc,"AnnotationQueryStoreContinuation",null,[1497]);class Bb extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){return this.Sa.Vye.ss(Xa,vb)?this.Sa.P1i.ss(Xa,vb):this.Sa.F6d?this.Sa.F6d.ss(Xa,vb):Xa}store(Xa,vb,Pb,oc){var zc=this.Sa.Vye.ss(Xa,
Pb);this.next&&(oc=new kc(this.next,oc));if(zc)return this.Sa.P1i.$Dc(Xa,vb,Pb,oc);if(this.Sa.F6d)return this.Sa.F6d.$Dc(Xa,vb,Pb,oc);zc=vb;let Kc=null;oc&&(Kc=oc.Wzh,oc=oc.VAi);Kc&&(zc=Kc.store(D.Annotations.KV(Xa),vb,Pb,oc));return zc}}Object(f.a)(Bb,"IfAnnotationQueryStep",db,[]);class Wb{constructor(Xa,vb){Xa&&(this.Vye=vb.EL(Xa.J(0)),this.P1i=vb.EL(Xa.J(1)),this.F6d=Xa.J(2)?vb.EL(Xa.J(2)):null)}}Object(f.a)(Wb,"IfQueryStepInit",null,[]);class zb{constructor(Xa,vb){Xa&&(this.Hcl=vb.EL(Xa.J(0)),
this.Dgi=vb.EL(Xa.J(1)))}}Object(f.a)(zb,"IndexAndItemQueryStepInit",null,[]);class Gb extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){const Pb=this.Sa.Hcl.ss(Xa,vb);vb=this.Sa.Dgi.ss(Xa,vb);Xa=Xa.clone();if(0>Pb||Pb>Xa.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(D.Annotations.vI(this.Sa.Dgi.G7))for(let oc=0;oc<vb.items.length;++oc)Array.insert(Xa.items,Pb+oc,vb.items[oc]);else Array.insert(Xa.items,Pb,vb);return Xa}}Object(f.a)(Gb,"InsertAtAnnotationQueryStep",
db,[]);class gc extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){return!(!vb||!vb.K9d(this.Sa.kVa))}}Object(f.a)(gc,"IsDefinedAnnotationQueryStep",db,[]);class jc extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){vb=this.yN(Xa,vb);return Xa.items[vb]}store(Xa,vb,Pb,oc){const zc=this.yN(Xa,Pb);let Kc=vb;const Sc=({OOa:oc}=this.sab(oc)).returnValue;Sc&&(Kc=Sc.store(D.Annotations.KV(Xa.items[zc]),vb,Pb,oc));Xa.items[zc]=Kc;return Xa}yN(Xa,vb){vb=this.Sa.query.ss(Xa,vb);if(0>vb||vb>=
Xa.items.length)throw Error.invalidOperation("Index out of range in Item store step");return vb}}Object(f.a)(jc,"ItemAnnotationQueryStep",db,[]);class Rb extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){const Pb=new ib.a(this.Sa.Je,D.Annotations.pab(this.vD));for(const oc of Xa.items)this.Sa.filter.isMatch(oc,vb)&&Array.add(Pb.items,oc);return Pb}}Object(f.a)(Rb,"ItemsMatchingAnnotationQueryStep",db,[]);class rd extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){vb=this.yN(Xa,vb);
return Xa.items[Xa.items.length-vb-1]}store(Xa,vb,Pb,oc){const zc=this.yN(Xa,Pb);let Kc=vb;const Sc=({OOa:oc}=this.sab(oc)).returnValue;Sc&&(Kc=Sc.store(D.Annotations.KV(Xa.items[Xa.items.length-zc-1]),vb,Pb,oc));Xa.items[Xa.items.length-zc-1]=Kc;return Xa}yN(Xa,vb){vb=this.Sa.query?this.Sa.query.ss(Xa,vb):0;if(0>vb||vb>=Xa.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return vb}}Object(f.a)(rd,"LastItemAnnotationQueryStep",db,[]);class sd extends db{constructor(Xa){super();
this.Sa=Xa}load(Xa){if(D.Annotations.vI(this.vD)){const vb=new ib.a(this.Sa.Je,D.Annotations.uPa);for(const Pb of Xa.items)Array.add(vb.items,Pb.length);return vb}return Xa.length}}Object(f.a)(sd,"LengthAnnotationQueryStep",db,[]);class Id extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){if(D.Annotations.vI(this.vD)){const Pb=new ib.a(this.Sa.Je,D.Annotations.uCa);for(const oc of Xa.items)Array.add(Pb.items,this.Sa.filter.isMatch(oc,vb));return Pb}return this.Sa.filter.isMatch(Xa,vb)}}Object(f.a)(Id,
"MatchesAnnotationQueryStep",db,[]);class me extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){return this.Sa.filter.isMatch(Xa,vb)}}Object(f.a)(me,"MatchesAsListAnnotationQueryStep",db,[]);class we extends da{constructor(Xa){super(Xa)}Imc(Xa,vb){return Xa%vb}}Object(f.a)(we,"ModuloAnnotationQueryStep",da,[]);class Me extends da{constructor(Xa){super(Xa)}Imc(Xa,vb){return Xa*vb}}Object(f.a)(Me,"MultiplyAnnotationQueryStep",da,[]);class ld extends db{constructor(Xa){super();this.Sa=Xa}load(Xa){if(D.Annotations.vI(this.vD)){const vb=
new ib.a(this.Sa.Je,D.Annotations.uCa);for(const Pb of Xa.items)Array.add(vb.items,!Pb);return vb}return!Xa}}Object(f.a)(ld,"NotAnnotationQueryStep",db,[]);class Kg extends mb{constructor(Xa){super(Xa)}Hth(Xa){return{returnValue:Xa,result:!0}}Q3c(Xa,vb){return Xa||vb}}Object(f.a)(Kg,"OrAnnotationQueryStep",mb,[]);class Vg extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){const Pb=this.Sa.AAg.ss(Xa,vb);Xa=this.Sa.T4c.ss(Xa,vb);vb=new ib.a(this.Sa.Je,D.Annotations.uPa);for(let oc=0;oc<Xa;++oc)Array.add(vb.items,
Pb+oc);return vb}}Object(f.a)(Vg,"RangeAnnotationQueryStep",db,[]);class ad{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.filter=vb.Xra(Xa.J(0)))}}Object(f.a)(ad,"SingleFilterQueryStepInit",null,[]);class uc{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.query=Xa.J(0)?vb.EL(Xa.J(0)):null)}}Object(f.a)(uc,"SingleOptionalQueryQueryStepInit",null,[]);class Yc{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.query=vb.EL(Xa.J(0)))}}Object(f.a)(Yc,"SingleQueryQueryStepInit",null,[]);class wd{constructor(Xa,vb){Xa&&
(this.Je=vb.Je,this.AAg=vb.EL(Xa.J(0)),this.T4c=Xa.J(1)?vb.EL(Xa.J(1)):null)}}Object(f.a)(wd,"StartAndCountOrLengthQueryStepInit",null,[]);class ee extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){let Pb;({startIndex:vb,length:Pb}=this.Lae(Xa,vb));const oc=new ib.a(this.Sa.Je,Xa.U6);for(let zc=0;zc<Pb;++zc)Array.add(oc.items,Xa.items[vb+zc]);return oc}store(Xa,vb,Pb,oc){let zc,Kc;({startIndex:zc,length:Kc}=this.Lae(Xa,Pb));var Sc=vb;const ae=({OOa:oc}=this.sab(oc)).returnValue;if(ae){Sc=
new ib.a(this.Sa.Je,Xa.U6);for(let Bd=0;Bd<Kc;++Bd)Array.add(Sc.items,Xa.items[zc+Bd]);Sc=ae.store(Sc,vb,Pb,oc)}vb=Sc;for(Pb=0;Pb<Kc;++Pb)Array.removeAt(Xa.items,zc);for(let Bd=0,Rf=vb.items.length;Bd<Rf;++Bd)Array.insert(Xa.items,zc+Bd,vb.items[Bd]);return Xa}Lae(Xa,vb){let Pb;Pb=this.Sa.AAg.ss(Xa,vb);if(0>Pb)throw Error.invalidOperation("Invalid start index in Sublist() query step");vb=this.Sa.T4c?this.Sa.T4c.ss(Xa,vb):Xa.items.length-Pb;if(0>vb||Pb+vb>Xa.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");
return{startIndex:Pb,length:vb}}}Object(f.a)(ee,"SublistAnnotationQueryStep",db,[]);class te extends db{constructor(Xa){super();this.Sa=Xa}load(Xa,vb){if(D.Annotations.vI(this.vD)){const Pb=new ib.a(this.Sa.Je,D.Annotations.eba);for(let oc=0,zc=Xa.items.length;oc<zc;++oc)Array.add(Pb.items,this.l0h(Xa.items[oc],vb));return Pb}return this.l0h(Xa,vb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}l0h(Xa,vb){let Pb;({startIndex:vb,length:Pb}=this.Lae(Xa,vb));
return Xa.substr(vb,Pb)}Lae(Xa,vb){let Pb;Pb=this.Sa.AAg.ss(Xa,vb);if(0>Pb)throw Error.invalidOperation("Invalid start index in Substring() query step");vb=this.Sa.T4c?this.Sa.T4c.ss(Xa,vb):Xa.length-Pb;if(0>vb||Pb+vb>Xa.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:Pb,length:vb}}}Object(f.a)(te,"SubstringAnnotationQueryStep",db,[]);class wf extends da{constructor(Xa){super(Xa)}Imc(Xa,vb){return Xa-vb}}Object(f.a)(wf,"SubtractAnnotationQueryStep",
da,[]);class cf extends db{constructor(Xa){super();this.Sa=Xa}load(Xa){const vb=new ib.a(this.Sa.Je,D.Annotations.eba);for(let Pb=0;Pb<Xa.length;++Pb)Array.add(vb.items,Xa.charAt(Pb).toString());return vb}}Object(f.a)(cf,"ToCharListAnnotationQueryStep",db,[]);class xb extends db{constructor(Xa){super();this.Sa=Xa}load(Xa){const vb=new ib.a(this.Sa.Je,this.vD);Array.add(vb.items,Xa);return vb}}Object(f.a)(xb,"ToListAnnotationQueryStep",db,[]);class Mb extends db{constructor(Xa){super();this.Sa=Xa}load(){return this.Sa.value}}
Object(f.a)(Mb,"ValueAnnotationQueryStep",db,[]);class Ec{constructor(Xa,vb){if(Xa){var Pb=Xa.J(0),oc=1;this.value=({Qka:oc}=vb.LUa(Pb,Xa,oc,null,null,null)).returnValue;D.Annotations.r0b(this.value)}}}Object(f.a)(Ec,"ValueQueryStepInit",null,[]);class ud{constructor(Xa,vb){Xa&&(this.GBe=vb.KE(Xa.J(0)),this.query=vb.EL(Xa.J(1)))}}Object(f.a)(ud,"VarNameAndQueryQueryStepInit",null,[]);class ge{constructor(Xa,vb){this.xVg=null;if(Xa){this.Je=vb.Je;var Pb=0;this.vD=Xa.J(Pb);++Pb;this.G7=Xa.J(Pb);++Pb;
this.iye=1===Xa.J(Pb);++Pb;this.Fee=1===Xa.J(Pb);++Pb;var oc=Xa.J(Pb);++Pb;if(oc){var zc=Pb,Kc=Pb+oc,Sc=Pb+2*oc;Pb+=3*oc;var ae=Xa.count-Pb,Bd=null;for(let Ad=0;Ad<oc;++Ad){var Rf=Pb+Xa.J(Sc+Ad);const Yd=(Ad===oc-1?ae:Xa.J(Sc+Ad+1))-Xa.J(Sc+Ad),Sd=new Ya.a;Sd.Prb(Xa,Rf,Yd);Rf=ge.WTk(Xa.J(Kc+Ad),Sd,vb);Rf.vD=Xa.J(zc+Ad);Rf.G7=Ad===oc-1?this.G7:Xa.J(zc+Ad+1);Bd?Bd.next=Rf:this.xVg=Rf;Bd=Rf}}}}get KNh(){return this.xVg}static WTk(Xa,vb,Pb){switch(Xa){case 1:return new fc(new Jc(vb,Pb));case 2:return new gc(new Jc(vb,
Pb));case 3:return new za(new $a(vb,Pb.Je));case 4:return new Ib(new nc(vb,Pb.Je));case 5:return new Bb(new Wb(vb,Pb));case 6:return new Id(new ad(vb,Pb));case 43:return new me(new ad(vb,Pb));case 45:return new Ta(new Oa(vb,Pb));case 49:return new Sa(new Hb(vb,Pb));case 46:return new Mb(new Ec(vb,Pb.Je));case 51:return new Xb(new Eb(vb,Pb));case 52:return new Vg(new wd(vb,Pb));case 53:return new tb(new Da(Pb.Je));case 13:return new jc(new Yc(vb,Pb));case 14:return new rd(new uc(vb,Pb));case 15:return new yb;
case 18:return new Gc(new ad(vb,Pb));case 16:return new tc(new ud(vb,Pb));case 17:return new Cc(new ud(vb,Pb));case 22:return new Gb(new zb(vb,Pb));case 24:return new La(new Yc(vb,Pb));case 26:return new ee(new wd(vb,Pb));case 27:return new Rb(new ad(vb,Pb));case 30:return new xb(new Da(Pb.Je));case 31:return new te(new wd(vb,Pb));case 32:return new ob(new Yc(vb,Pb));case 47:return new sd(new Da(Pb.Je));case 48:return new cf(new Da(Pb.Je));case 34:return new Wa(new Yc(vb,Pb));case 35:return new wf(new Yc(vb,
Pb));case 36:return new Me(new Yc(vb,Pb));case 37:return new lb(new Yc(vb,Pb));case 38:return new we(new Yc(vb,Pb));case 39:return new Hc(new Yc(vb,Pb));case 40:return new Tb(new Yc(vb,Pb));case 41:return new Kg(new Yc(vb,Pb));case 42:return new ld(new Da(Pb.Je));default:throw Error.argument("currStepInitData");}}}Object(f.a)(ge,"AnnotationQueryInit",null,[]);class Le{constructor(Xa){this.Sa=Xa}execute(Xa,vb){this.cVa(Xa,Xa?new Y("root",Xa,vb):vb)}cVa(Xa,vb){for(const Pb of this.Sa.commands)vb=Pb.execute(Xa,
vb)}}Object(f.a)(Le,"AnnotationScript",null,[1468]);class de{constructor(Xa){this.Sa=Xa}execute(Xa,vb){const Pb=this.Sa.Dfl.ss(Xa,vb),oc=this.Sa.DVl.ss(Xa,vb);this.Sa.script.cVa(Xa,new Y("Input",Pb,new Y("Output",oc,vb)));return vb}}Object(f.a)(de,"ApplyAnnotationScriptCommand",null,[1491]);class kf{constructor(Xa,vb){Xa&&(this.Dfl=vb.EL(Xa.J(0)),this.DVl=vb.EL(Xa.J(1)),this.script=vb.TUb(Xa.J(2)))}}Object(f.a)(kf,"ApplyScriptCommandInit",null,[]);class mg{constructor(Xa){this.Sa=Xa}execute(Xa,vb){const Pb=
this.Sa.Gqg.ss(Xa,vb);this.Sa.Pie.$Dc(Xa,Pb,vb,null);return vb}}Object(f.a)(mg,"AssignAnnotationScriptCommand",null,[1491]);class Fd{constructor(Xa){this.Sa=Xa}execute(Xa,vb){const Pb=this.Sa.Pie.ss(Xa,vb);Xa=this.Sa.Gqg.ss(Xa,vb);Pb!==Xa&&Pb.P8a(Xa);return vb}}Object(f.a)(Fd,"CopyAnnotationScriptCommand",null,[1491]);class xf{constructor(Xa){this.Sa=Xa}execute(Xa,vb){let Pb=this.Sa.t2f.ss(Xa,vb);if(this.Sa.t2f.iye){Pb=D.Annotations.KV(Pb);var oc=new Y(this.Sa.kVa,null,vb);for(let Kc=0,Sc=Pb.items.length;Kc<
Sc;++Kc){var zc=this.iLh(Xa,Pb.items[Kc],oc);if(0>this.Sa.Use)Pb.items[Kc]=zc;else if(({value:zc}=zc.Kp(this.Sa.Use)).returnValue)Pb.items[Kc]=zc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Sa.t2f.$Dc(Xa,Pb,vb,null)}else{oc=new Y(this.Sa.kVa,null,vb);for(let Kc=0,Sc=Pb.items.length;Kc<Sc;++Kc)this.iLh(Xa,Pb.items[Kc],oc)}return vb}iLh(Xa,vb,Pb){let oc;0>this.Sa.Use?oc=D.Annotations.KV(vb):(oc=new U.a(this.Sa.Je),oc.vy(this.Sa.Use,vb));
Pb.zlf(oc);this.Sa.FWj.cVa(Xa,Pb);return oc}}Object(f.a)(xf,"EnumerateAnnotationScriptCommand",null,[1491]);class He{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.kVa=vb.KE(Xa.J(0)),this.t2f=vb.EL(Xa.J(1)),this.FWj=vb.TUb(Xa.J(2)),this.Use=Xa.J(3))}}Object(f.a)(He,"EnumerateScriptCommandInit",null,[]);class vd{constructor(Xa){this.Sa=Xa}execute(Xa,vb){this.Sa.Vye.ss(Xa,vb)?this.Sa.uMm.cVa(Xa,vb):this.Sa.aMh&&this.Sa.aMh.cVa(Xa,vb);return vb}}Object(f.a)(vd,"IfAnnotationScriptCommand",null,[1491]);class Eg{constructor(Xa,
vb){Xa&&(this.Vye=vb.EL(Xa.J(0)),this.uMm=vb.TUb(Xa.J(1)),this.aMh=Xa.J(2)?vb.TUb(Xa.J(2)):null)}}Object(f.a)(Eg,"IfScriptCommandInit",null,[]);class Xg{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.Pie=vb.EL(Xa.J(0)),this.Gqg=vb.EL(Xa.J(1)))}}Object(f.a)(Xg,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class zh{constructor(Xa){this.Sa=Xa}execute(Xa,vb){const Pb=this.Sa.Gqg.ss(this.Sa.Pie.ss(Xa,vb),vb);this.Sa.Pie.$Dc(Xa,Pb,vb,null);return vb}}Object(f.a)(zh,"ModifyAnnotationScriptCommand",null,[1491]);
class bd{constructor(Xa){this.Sa=Xa}execute(Xa,vb){const Pb=new U.a(this.Sa.Je);this.Sa.query&&Pb.P8a(this.Sa.query.ss(Xa,vb));return vb=new Y(this.Sa.kVa,Pb,vb)}}Object(f.a)(bd,"NewAnnotationScriptCommand",null,[1491]);class qf{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.kVa=vb.KE(Xa.J(0)),this.query=Xa.J(1)?vb.EL(Xa.J(1)):null)}}Object(f.a)(qf,"NewScriptCommandInit",null,[]);class Ci{constructor(Xa){this.Sa=Xa}execute(Xa,vb){Xa=this.Sa.query.ss(Xa,vb);if(this.Sa.query.G7===D.Annotations.kX)Xa.VNa(this.Sa.nya);
else for(const Pb of Xa.items)Pb.VNa(this.Sa.nya);return vb}}Object(f.a)(Ci,"RemoveAnnotationScriptCommand",null,[1491]);class Og{constructor(Xa,vb){Xa&&(this.Je=vb.Je,this.query=vb.EL(Xa.J(0)),this.nya=Xa.J(1))}}Object(f.a)(Og,"RemoveScriptCommandInit",null,[]);class Zh{constructor(Xa,vb){if(Xa){var Pb=0,oc=Xa.J(Pb);++Pb;if(oc){var zc=Pb,Kc=Pb+oc;Pb+=2*oc;var Sc=Xa.count-Pb;this.commands=Array(oc);for(let ae=0;ae<oc;++ae){const Bd=Pb+Xa.J(Kc+ae),Rf=(ae===oc-1?Sc:Xa.J(Kc+ae+1))-Xa.J(Kc+ae),Ad=new Ya.a;
Ad.Prb(Xa,Bd,Rf);this.commands[ae]=Zh.NTk(Xa.J(zc+ae),Ad,vb)}}}}static NTk(Xa,vb,Pb){switch(Xa){case 1:return new mg(new Xg(vb,Pb));case 2:return new zh(new Xg(vb,Pb));case 3:return new Ci(new Og(vb,Pb));case 6:return new bd(new qf(vb,Pb));case 7:return new xf(new He(vb,Pb));case 8:return new vd(new Eg(vb,Pb));case 9:return new Fd(new Xg(vb,Pb));case 10:return new de(new kf(vb,Pb));default:throw Error.argument("initData");}}}Object(f.a)(Zh,"AnnotationScriptInit",null,[]);var ug=b(1309);class sh{constructor(Xa){this.oR=
Xa;this.pA=0}Haa(){const Xa=this.oR.uy(this.pA,4);this.pA+=4;return Xa}get N0c(){return this.oR}get offset(){return this.pA}set offset(Xa){this.pA=Xa}}Object(f.a)(sh,"ByteArrayReader",null,[]);class Xd{constructor(){this.bK=null;this.Ami=this.Xfa=0}J(Xa){if(0>Xa||Xa>=this.Xfa)throw Error.argumentOutOfRange("index");return this.bK.uy(this.Ami+4*Xa,4)}get count(){return this.Xfa}static Rek(Xa,vb,Pb){const oc=new Xd;oc.bK=Xa;oc.Ami=vb;oc.Xfa=Pb;return oc}}Object(f.a)(Xd,"ReadOnlyListOverByteArray",null,
[1460]);class bi{constructor(Xa,vb){this.umi=this.tmi=!1;this.Wv=this.KXa=this.p4f=this.xmi=null;try{this.Wv=vb.Je;const Pb=vb.asb(Xa.J(0)),oc=new sh(Pb);if(-914743053!==oc.Haa())throw Error.argument("Input does not represent a flat lexicon");this.tmi=1===oc.Haa();this.umi=1===oc.Haa();const zc=oc.Haa();oc.offset+=zc;const Kc=oc.Haa();this.p4f=bi.aXl(oc,Kc,this.Wv);const Sc=oc.Haa();this.xmi=bi.lXl(oc,Sc);const ae=oc.Haa();this.KXa=new ug.a(oc.N0c,oc.offset);oc.offset+=ae}catch(Pb){throw Error.argument("initData");
}}get trie(){return this.KXa}EIk(Xa){return"i"===Xa&&this.umi?"\u0130":Xa.toUpperCase()}tVf(){return this.tmi}zGk(Xa){let vb;vb=new ib.a(this.Wv,D.Annotations.kX);if(1!==Xa)if(0===Xa)Xa=new U.a(this.Wv),Array.add(vb.items,Xa);else if(Xa&1073741824){Xa=this.xmi[Xa&-1073741825];for(let oc=0;oc<Xa.length;++oc){var Pb=Xa[oc];Pb=0===Pb?new U.a(this.Wv):this.p4f[Pb-2];Array.add(vb.items,Pb)}}else Array.add(vb.items,this.p4f[Xa-2]);return{returnValue:!0,Wwl:vb}}static aXl(Xa,vb,Pb){if(vb%4)throw Error.argument("reader");
const oc=Xd.Rek(Xa.N0c,Xa.offset,vb/4);Xa.offset+=vb;Xa=[];for(vb=0;vb<oc.count;){const zc=({Qka:vb}=Pb.LUa(D.Annotations.kX,oc,vb,null,null,null)).returnValue;Array.add(Xa,zc)}return Xa}static lXl(Xa,vb){vb=Xa.offset+vb;const Pb=[];for(;Xa.offset<vb;){const oc=Xa.Haa(),zc=Array(oc);for(let Kc=0;Kc<oc;++Kc){const Sc=Xa.Haa();zc[Kc]=Sc}Array.add(Pb,zc)}return Pb}}Object(f.a)(bi,"RawFlatLexicon",null,[1466]);var kg=b(1299),jf=b(1300);class vf{constructor(Xa){if(null==Xa)throw Error.argumentNull("base64String");
const vb=Xa.length;if(vb%4)throw Error.argument("base64String's length must be a multiple of 4");this.Xfa=.75*vb;this.P2b=Array(Math.ceil(this.Xfa/4));Xa.endsWith("==")?this.Xfa-=2:Xa.endsWith("=")&&--this.Xfa;let Pb=0;for(let oc=0;oc<vb;oc+=4){const zc=vf.Hte[Xa.charCodeAt(oc)-43]<<18|vf.Hte[Xa.charCodeAt(oc+1)-43]<<12|vf.Hte[Xa.charCodeAt(oc+2)-43]<<6|vf.Hte[Xa.charCodeAt(oc+3)-43];let Kc=zc>>16&255;this.P2b[Math.floor(Pb/4)]|=Kc<<Pb%4*8;++Pb;Kc=zc>>8&255;this.P2b[Math.floor(Pb/4)]|=Kc<<Pb%4*8;
++Pb;Kc=zc&255;this.P2b[Math.floor(Pb/4)]|=Kc<<Pb%4*8;++Pb}}get length(){return this.Xfa}J(Xa){if(0>Xa||Xa>=this.Xfa)throw Error.argumentOutOfRange("i");return this.DRh(Xa)}uy(Xa,vb){if(0>Xa||0>vb||Xa+vb>this.Xfa)throw Error.argument("Bad range");let Pb=0;for(let oc=0;oc<vb;++oc)Pb|=this.DRh(Xa+oc)<<8*oc;return Pb}Z6l(Xa,vb){let Pb=0,oc=0,zc=Math.floor(Xa/8);for(Xa%=8;oc<vb;){const Kc=8-Xa>vb-oc?vb-oc:8-Xa,Sc=this.J(zc);Pb|=(Sc>>Xa&~(255<<Kc))<<oc;oc+=Kc;++zc;Xa=0}return Pb}DRh(Xa){return this.P2b[Math.floor(Xa/
4)]>>Xa%4*8&255}}vf.Hte=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(f.a)(vf,"ByteArray",null,[]);class gg{constructor(Xa,vb,Pb){this.FD=Xa;this.WBl=vb;this.ZBl=Pb;this.Imi=Array(Xa.b?Xa.b.length:0);this.K4f=new kg.a(new jf.a(this.asb(this.FD.s)));this.jaa=Array(Xa.t.length);this.pF=new D.Annotations(this.$rb(0),this)}get Je(){return this.pF}get krk(){return this.FD.d}qTk(){if(!(""in
this.FD.m))throw Error.argument("name","Unrecognized module");return this.OJf(this.FD.m[""])}asb(Xa){if(0>Xa||!this.FD.b||Xa>=this.FD.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.Imi[Xa]||(this.Imi[Xa]=new vf(this.FD.b[Xa]))}KE(Xa){if(1>Xa||Xa>=this.FD.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.FD.t[Xa])throw Error.argument("blobID","Requested blob is not a string");if(null==this.jaa[Xa]){const vb=this.$rb(Xa).J(0);this.jaa[Xa]=this.K4f.KE(vb)}return this.jaa[Xa]}Fsb(Xa){if(1>
Xa||Xa>=this.FD.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.FD.t[Xa])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.jaa[Xa]){var vb=this.$rb(Xa);const Pb=this.KE(vb.J(0));vb=1===vb.J(1);this.jaa[Xa]=new RegExp(Pb,vb?"i":"")}return this.jaa[Xa]}HZk(Xa){if(1>Xa||Xa>=this.FD.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.FD.t[Xa])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}OJf(Xa){if(1>Xa||Xa>=this.FD.t.length)throw Error.argumentOutOfRange("blobID");
if(4!==this.FD.t[Xa])throw Error.argument("blobID","Requested blob is not an NL module");return this.jaa[Xa]||(this.jaa[Xa]=this.ZBl.FTk(this.$rb(Xa),this))}EL(Xa){if(1>Xa||Xa>=this.FD.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.FD.t[Xa])throw Error.argument("blobID","Requested blob is not an annotation query");return this.jaa[Xa]||(this.jaa[Xa]=new hb(new ge(this.$rb(Xa),this)))}TUb(Xa){if(1>Xa||Xa>=this.FD.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.FD.t[Xa])throw Error.argument("blobID",
"Requested blob is not an annotation script");return this.jaa[Xa]||(this.jaa[Xa]=new Le(new Zh(this.$rb(Xa),this)))}Xra(Xa){if(1>Xa||Xa>=this.FD.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.FD.t[Xa])throw Error.argument("blobID","Requested blob is not a filter");return this.jaa[Xa]||(this.jaa[Xa]=this.WBl.Xra(this.$rb(Xa),this))}mYk(Xa){if(1>Xa||Xa>=this.FD.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.FD.t[Xa])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");
return this.jaa[Xa]||(this.jaa[Xa]=new bi(this.$rb(Xa),this))}$rb(Xa){const vb=this.FD.n[Xa];Xa=(Xa<this.FD.t.length-1?this.FD.n[Xa+1]:this.FD.n.length)-vb;if(0>vb||0>Xa||vb+Xa>this.FD.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+vb+","+Xa+")");const Pb=new Ya.a;Pb.WDf(this.FD.n,vb,Xa);return Pb}}Object(f.a)(gg,"ObjectFetcher",null,[1429]);class gd{constructor(Xa,vb,Pb){if(!Xa)throw Error.argumentNull("prediction");if(!vb)throw Error.argumentNull("fieldNames");
if(!Pb)throw Error.argumentNull("values");if(vb.length!==Pb.length)throw Error.argument("values","fieldNames and values do not have same length");this.Cyj=Xa;this.Q2b=vb;this.bnd=Pb}get prediction(){return this.Cyj}get lMh(){return this.Q2b.length}MHf(Xa){return 0<=Xa&&Xa<this.Q2b.length?this.Q2b[Xa]:null}getValue(Xa){return 0<=Xa&&Xa<this.bnd.length?this.bnd[Xa]:null}}Object(f.a)(gd,"PredictionData",null,[]);class Dh{constructor(Xa,vb){if(!Xa)throw Error.argumentNull("predictions");if(!vb)throw Error.argumentNull("tokenAttributes");
this.bCl=Xa;this.gCl=vb}fLf(){return this.bCl}xQh(){return this.gCl}}Object(f.a)(Dh,"PredictionDataWithTokenAttributes",null,[]);class Lh{constructor(Xa,vb){this.prediction=null;this.score=0;this.prediction=Xa;this.score=vb}}Object(f.a)(Lh,"PredictionWithScore",null,[]);class Fj{constructor(Xa,vb){if(!Xa)throw Error.argumentNull("predictions");if(!vb)throw Error.argumentNull("attributes");this.Dyj=Xa;this.Cgj=vb}fLf(){return this.Dyj}xQh(){return this.Cgj}}Object(f.a)(Fj,"PredictionsWithTokenAttributes",
null,[]);class Ag{constructor(Xa,vb,Pb){if(!Xa)throw Error.argumentNull("attributeName");if(!vb)throw Error.argumentNull("fieldNames");if(!Pb)throw Error.argumentNull("values");if(vb.length!==Pb.length)throw Error.argument("values","fieldNames and values do not have same length");this.Bgj=Xa;this.Q2b=vb;this.bnd=Pb}get attributeName(){return this.Bgj}get lMh(){return this.Q2b.length}MHf(Xa){return 0<=Xa&&Xa<this.Q2b.length?this.Q2b[Xa]:null}getValue(Xa){return 0<=Xa&&Xa<this.bnd.length?this.bnd[Xa]:
null}}Object(f.a)(Ag,"TokenAttributes",null,[]);var lg=b(40),mf=b(528);class $g{constructor(Xa,vb,Pb,oc,zc){this.REd=0;this.jLg=null;this.SEd=this.QGc=0;this.lCe=this.jdc=this.Tva=this.RGc=null;this.kLg=0;this.IZe=this.xB=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.uU=Xa;this.Aaj=this.Eaj=vb;this.zaj=this.Caj=Pb;this.PEd=this.Baj=oc;this.QEd=this.Daj=zc}Faj(){this.SEd=0;return this.hLg}hLg(){if(!(this.SEd<this.PEd))return this.iLg;
this.RGc=this.Aaj.items[this.SEd+this.zaj];this.Tva=new U.a(this.uU.Sa.Je);1!==this.PEd&&this.uU.Sa.Rhd||this.Tva.P8a(this.RGc);if(0<=this.uU.Sa.wke){({value:this.jdc}=this.Tva.Kp(this.uU.Sa.wke)).returnValue?this.jdc=this.jdc.KV():this.jdc=new ib.a(this.uU.Sa.Je,D.Annotations.kX);this.lCe=this.QEd.items;this.kLg=this.lCe.length;for(this.REd=0;this.REd<this.kLg;++this.REd)this.jLg=this.lCe[this.REd],Array.add(this.jdc.items,this.jLg);this.Tva.vy(this.uU.Sa.wke,this.jdc)}else 0<=this.uU.Sa.Yyg?this.Tva.vy(this.uU.Sa.Yyg,
this.QEd.items[0]):0<=this.uU.Sa.vif?this.Tva.vy(this.uU.Sa.vif,!0):this.uU.Sa.Idi?this.QEd.items[0].M7d((Xa,vb)=>this.Tva.vy(Xa,vb)):(this.Tva.P8a(this.QEd.items[0]),1!==this.PEd&&this.uU.Sa.Rhd||(({value:this.QGc}=this.RGc.Kp(this.uU.Sa.r5)).returnValue&&this.Tva.vy(this.uU.Sa.r5,this.QGc),({value:this.QGc}=this.RGc.Kp(this.uU.Sa.F9)).returnValue&&this.Tva.vy(this.uU.Sa.F9,this.QGc),this.RGc.Kp(this.uU.Sa.Uob).returnValue&&this.Tva.vy(this.uU.Sa.Uob,this.QGc)));this.xB=this.Tva;this._state=2;return this.Haj}iLg(){this._state=
3}Gaj(){this.SEd++;return this.hLg}Haj(){return 1<this.PEd&&this.uU.Sa.Rhd?this.iLg:this.Gaj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new $g(this.uU,this.Eaj,this.Caj,this.Baj,this.Daj)).getEnumerator()}[Symbol.iterator](){return Object(mf.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.IZe=this.Faj());for(;1===this._state;)this.IZe=this.IZe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");
}get_current(){return this.xB}}Object(f.a)($g,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[13,34,35]);class Be{constructor(Xa,vb,Pb){this.Zmd=this.Bmi=0;this.Fwc=null;this.L4f=this.v4f=this.Dwc=this.Wie=this.y4f=0;this.Xie=!1;this.G4f=Xa;this.N4f=vb;this.aCl=Pb}pXh(){null===this.Fwc&&({z_i:this.Fwc,P6h:this.y4f,length:this.Wie,axk:Xa}=this.G4f.x1h(this.N4f.items[this.Zmd],this.aCl),this.Xie=Xa||this.Xie);if(this.Dwc<
this.Wie){var Xa=this.Fwc.charAt(this.y4f+this.Dwc);++this.Dwc;return{returnValue:!0,ch:Xa}}if(this.Zmd===this.N4f.items.length-1)return{returnValue:!1,ch:"\x00"};++this.Zmd;this.Dwc=0;this.Fwc=null;return{returnValue:!0,ch:" "}}tlg(Xa,vb){this.Dwc===this.Wie&&this.Fwc&&(this.L4f=vb,this.v4f=this.Zmd-this.Bmi+1)}Ohm(Xa){if(0>Xa||Xa>=this.N4f.items.length)throw Error.argumentOutOfRange("iToken");this.Zmd=this.Bmi=Xa;this.Fwc=null;this.v4f=this.Dwc=this.Wie=this.y4f=0;this.L4f=-1;this.Xie=!1}DSk(){return{c0j:this.v4f,
ivl:this.L4f,$wk:this.Xie}}}Object(f.a)(Be,"TriePrefixVisitor",null,[1476]);class lf{constructor(Xa){this.Sa=Xa}execute(Xa){if(!({value:Pb}=Xa.Kp(this.Sa.QTa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let vb;({value:vb}=Xa.Kp(this.Sa.r7a)).returnValue||(vb=null);var Pb=this.SFk(Pb,vb);Xa=D.Annotations.KV(Xa);Xa.vy(this.Sa.QTa,Pb);return Xa}SFk(Xa,vb){let Pb=null;const oc=this.Sa.flatLexicon.trie,zc=new Be(this,Xa,vb);let Kc=null;this.Sa.flatLexicon.tVf()&&
(Kc=Object(lg.a)(this.Sa.flatLexicon,this.Sa.flatLexicon.EIk,"getCaseInsensitiveForm"));let Sc=0,ae;var Bd;let Rf;for(;Sc<Xa.items.length;){const Ad=Xa.items[Sc];zc.Ohm(Sc);oc.t8i(zc,Kc);({c0j:ae,ivl:Bd,$wk:Rf}=zc.DSk());if(0<ae){({Wwl:Bd}=this.Sa.flatLexicon.zGk(Bd));for(let Yd of this.zgk(Xa,Sc,ae,Bd)){1<ae&&this.Sa.Rhd&&this.ahk(Xa,vb,Sc,Ad,ae,Rf,Yd);if(!Pb)for(Pb=new ib.a(this.Sa.Je,D.Annotations.kX),Bd=0;Bd<Sc;++Bd)Array.add(Pb.items,Xa.items[Bd]);Array.add(Pb.items,Yd)}Sc+=ae}else Pb&&Array.add(Pb.items,
Ad),++Sc}return Pb||Xa}ahk(Xa,vb,Pb,oc,zc,Kc,Sc){if(Kc)Kc=!0;else if(this.Sa.rdi){Kc=!1;var ae=-1;for(var Bd=0;Bd<zc;Bd++){var Rf=Xa.items[Pb+Bd];let Jf;var Ad=void 0;if(!({value:Jf}=Rf.Kp(this.Sa.r5)).returnValue||!({value:Ad}=Rf.Kp(this.Sa.F9)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<Bd){if(Jf>ae+1){Kc=!0;break}if(0>ae||null===vb||ae>=vb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==vb.charAt(ae)){Kc=!0;break}}ae=Jf+Ad}}else Kc=!1;if(Kc){Ad=new Sys.StringBuilder;for(Kc=0;Kc<zc;++Kc)({z_i:ae,P6h:Bd,length:Rf}=this.x1h(Xa.items[Pb+Kc],vb)),0<Kc&&Ad.append(" "),Ad.append(ae.substr(Bd,Rf));Sc.vy(this.Sa.Uob,Ad.toString())}Xa=Xa.items[Pb+zc-1];let Yd,Sd;({value:oc}=oc.Kp(this.Sa.r5)).returnValue&&({value:Yd}=Xa.Kp(this.Sa.r5)).returnValue&&({value:Sd}=Xa.Kp(this.Sa.F9)).returnValue?(Sc.vy(this.Sa.r5,oc),Sc.vy(this.Sa.F9,Yd+Sd-oc)):(Sc.VNa(this.Sa.r5),Sc.VNa(this.Sa.F9))}zgk(Xa,
vb,Pb,oc){return new $g(this,Xa,vb,Pb,oc)}x1h(Xa,vb){let Pb,oc;if(({value:Pb}=Xa.Kp(this.Sa.Uob)).returnValue)oc=!0,vb=0,Xa=Pb.length;else{oc=!1;if(null===vb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Pb=vb;if(!({value:vb}=Xa.Kp(this.Sa.r5)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!({value:Xa}=Xa.Kp(this.Sa.F9)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");
if(0>vb||0>Xa||vb+Xa>Pb.length)throw Error.argument("Token start/length values out of range","token");}return{z_i:Pb,P6h:vb,length:Xa,axk:oc}}}Object(f.a)(lf,"FlatLexiconNLModule",null,[1459]);class ci{constructor(Xa,vb){this.vif=this.wke=this.Yyg=this.Uob=this.F9=this.r5=this.r7a=this.QTa=0;this.Idi=this.rdi=this.Rhd=!1;this.flatLexicon=null;this.Je=vb.Je;let Pb=0;try{this.QTa=Xa.J(Pb),++Pb,this.r7a=Xa.J(Pb),++Pb,this.r5=Xa.J(Pb),++Pb,this.F9=Xa.J(Pb),++Pb,this.Uob=Xa.J(Pb),++Pb,this.Yyg=Xa.J(Pb),
++Pb,this.wke=Xa.J(Pb),++Pb,this.vif=Xa.J(Pb),++Pb,this.Rhd=1===Xa.J(Pb),++Pb,this.rdi=1===Xa.J(Pb),++Pb,this.Idi=1===Xa.J(Pb),++Pb,this.flatLexicon=vb.mYk(Xa.J(Pb))}catch(oc){throw Error.argument("initData");}}}Object(f.a)(ci,"FlatLexiconNLModuleInit",null,[]);class Ji{constructor(){this.ggd=0;this.yBf=null;this.nwd=0}}Object(f.a)(Ji,"FeatureGenStackRec",null,[]);class Fe{constructor(Xa){this.zDg=Array(Xa);this.pFc=Array(Xa);this.UAg=[];this.iYi=[]}}Object(f.a)(Fe,"TokenStringLattice",null,[]);const yf=
(Xa,vb,Pb)=>{for(let oc=0;oc<Xa.length;oc++)Pb=vb(Pb,Xa[oc]);return Pb},Nc=(Xa,vb)=>{const Pb=Array(Xa.length);for(let oc=0;oc<Xa.length;oc++)Pb[oc]=vb(Xa[oc]);return Pb},vg=(Xa,vb)=>{vb=Array(Math.min(vb,Xa.length));for(let Pb=0;Pb<vb.length;Pb++)vb[Pb]=Xa[Pb];return vb},Rh=(Xa,vb)=>{const Pb=[];for(const oc of Xa)vb(oc)&&Array.add(Pb,oc);return Pb};class Fk{constructor(Xa,vb){this.key=Xa;this.value=vb}}Object(f.a)(Fk,"KeyValuePair",null,[]);const il=(Xa,vb)=>({returnValue:vb in Xa,value:Xa[vb]}),
cj=Xa=>{const vb=[];for(let Pb in Xa){const oc=new Fk(Pb,Xa[Pb]);Array.add(vb,oc)}return vb};class Si{constructor(Xa){this.w1h=this.y2k;this.Sa=Xa;this.Zie=this.E4f=this.F4f=0;for(const vb of this.Sa.K6d)this.F4f=Math.max(this.F4f,vb.ufg),this.E4f=Math.max(this.E4f,vb.ofg),this.Zie=Math.max(this.Zie,vb.HBb.length)}get yyk(){return this.Sa.qze.trie}execute(Xa){if(!Xa)throw Error.argumentNull("input");let vb,Pb;({vha:vb,Uvl:Pb}=this.z2k(Xa));let oc=null,zc=null,Kc={};if(this.Sa.yid){vb=D.Annotations.KV(vb);
for(var Sc=0;Sc<vb.items.length;++Sc)vb.items[Sc]=D.Annotations.KV(vb.items[Sc])}else({fMh:zc,returnValue:oc}=this.bYh(Xa,Kc));Sc=Array(this.Zie);const ae=Array(this.Zie);for(var Bd=0;Bd<ae.length;++Bd)ae[Bd]=new Ji;for(Bd=-this.F4f;Bd<vb.items.length+this.E4f;++Bd){let Rf=null;this.Sa.yid&&(Rf=vb.items[Bd],Kc={},{fMh:zc,returnValue:oc}=this.bYh(Rf,Kc));for(const Ad of this.Sa.K6d){if(0>Bd&&-Bd>Ad.ufg||Bd>=vb.items.length&&Bd-vb.items.length+1>Ad.ofg)continue;let Yd=!0;for(let Sd=0;Sd<Ad.HBb.length;++Sd){const Jf=
Bd+Ad.HBb[Sd];Sc[Sd]=Jf;if(0>Jf?0>this.Sa.vfg:Jf>=vb.items.length?0>this.Sa.pfg:!Pb.pFc[Jf]){Yd=!1;break}}Yd&&({zjk:oc,Ajk:zc}=this.xhl(Ad,Pb,oc,zc,Kc,ae,Sc))}this.Sa.yid&&(Rf.vy(this.Sa.pcb?this.Sa.lmc:this.Sa.jmc,oc),this.Sa.pcb&&Rf.vy(this.Sa.kmc,zc))}Xa=D.Annotations.KV(Xa);this.Sa.yid?Xa.vy(this.Sa.QTa,vb):(Xa.vy(this.Sa.pcb?this.Sa.lmc:this.Sa.jmc,oc),this.Sa.pcb&&Xa.vy(this.Sa.kmc,zc));return Xa}z2k(Xa){let vb,Pb;if(!Xa||!({value:vb}=Xa.Kp(this.Sa.QTa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let oc;({value:oc}=Xa.Kp(this.Sa.r7a)).returnValue||(oc="");Pb=new Fe(vb.items.length);const zc=Rh(this.Sa.CDg,Kc=>!Kc.Ugd||Kc.Ugd.isMatch(Xa,null));for(let Kc=0;Kc<vb.items.length;++Kc){const Sc=vb.items[Kc];let ae=null;Pb.zDg[Kc]=Pb.UAg.length;let Bd=Pb.pFc[Kc]=0;for(const Rf of zc)0<Rf.ond&&Pb.pFc[Kc]+Bd>=Rf.ond||Rf.mBd&&!Rf.mBd.isMatch(Sc,null)||({nBd:ae,J1c:Bd}=Rf.apply(this,Sc,Kc,Pb,oc,ae,Bd))}return{vha:vb,Uvl:Pb}}xhl(Xa,vb,Pb,oc,zc,Kc,Sc){let ae=0;Kc[0].ggd=-1;for(Kc[0].yBf=Xa.cLi;;){var Bd=
Sc[ae],Rf=0>Bd||Bd>=vb.pFc.length?1:vb.pFc[Bd];let Sd=!1;for(;Kc[ae].ggd<Rf-1;){++Kc[ae].ggd;var Ad=void 0,Yd=void 0;0>Bd?(Ad=this.Sa.vfg,Yd=1):Bd>=vb.zDg.length?(Ad=this.Sa.pfg,Yd=1):(Yd=vb.zDg[Bd]+Kc[ae].ggd,Ad=vb.UAg[Yd],Yd=vb.iYi[Yd]);Kc[ae].nwd=Yd*(ae?Kc[ae-1].nwd:Xa.score);if(({value:Ad}=il(Kc[ae].yBf,Ad.toString())).returnValue){ae===Xa.HBb.length-1?(Bd=Ad,Kc[ae].nwd&&(({value:Rf}=il(zc,Bd.toString())).returnValue||(Rf=-1),0>Rf&&(Pb=D.Annotations.KV(Pb),Array.add(Pb.items,Bd)),this.Sa.pcb&&
(oc=D.Annotations.KV(oc),0>Rf?Array.add(oc.items,Kc[ae].nwd):oc.items[Rf]+=Kc[ae].nwd),0>Rf&&(this.Sa.cgi||this.Sa.pcb)&&(zc[Bd.toString()]=Pb.items.length-1))):(++ae,Kc[ae].ggd=-1,Kc[ae].yBf=Ad);Sd=!0;break}}if(!Sd&&(--ae,0>ae))break}return{zjk:Pb,Ajk:oc}}bYh(Xa,vb){let Pb;if(({value:Pb}=Xa.Kp(this.Sa.pcb?this.Sa.lmc:this.Sa.jmc)).returnValue)for(let oc=0;oc<Pb.items.length;++oc)vb[Pb.items[oc].toString()]=oc;else Pb=new ib.a(this.Sa.Je,D.Annotations.uPa);if(this.Sa.pcb){if(({value:vb}=Xa.Kp(this.Sa.kmc)).returnValue||
(vb=new ib.a(this.Sa.Je,D.Annotations.zva)),vb.items.length!==Pb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Sa.Je.Gha(D.Annotations.kX,Xa));}else vb=null;return{returnValue:Pb,fMh:vb}}get aLm(){return this.Sa.qze}y2k(Xa,vb){var Pb;if(({value:Pb}=vb.Kp(this.Sa.Uob)).returnValue)Xa=Pb;else{if(!({value:Pb}=vb.Kp(this.Sa.r5)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:vb}=
vb.Kp(this.Sa.F9)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Pb||0>vb||Pb+vb>Xa.length)throw Error.argument("Token indices are out of range");Xa=Xa.substr(Pb,vb)}return Xa}}Object(f.a)(Si,"NGramNLModule",null,[1459,1462]);class ch{constructor(Xa){this.HBb=null;this.score=this.ofg=this.ufg=0;this.cLi=null;if(Xa){var vb=0;try{if(Xa.J(vb)!==ch.WPb)throw Error.argument("initData","Input does not represent a feature template");++vb;const Pb=Xa.J(vb);++vb;this.HBb=Array(Pb);
for(let oc=0;oc<Pb;++oc)this.HBb[oc]=Xa.J(vb),++vb;this.ufg=Xa.J(vb);++vb;this.ofg=Xa.J(vb);++vb;this.score=Xa.J(vb);++vb;this.cLi=({L6h:vb}=ch.YDi(Xa,vb)).returnValue}catch(Pb){throw Error.argument("initData");}}}static YDi(Xa,vb){const Pb=Xa.J(vb);++vb;const oc={};for(let zc=0;zc<Pb;++zc){const Kc=Xa.J(vb);++vb;Xa.J(vb)?oc[Kc.toString()]=({L6h:vb}=ch.YDi(Xa,vb)).returnValue:(++vb,oc[Kc.toString()]=Xa.J(vb),++vb)}return{returnValue:oc,L6h:vb}}}ch.WPb=240803228;Object(f.a)(ch,"FeatureTemplate",null,
[1479]);var $e=b(1239);class Gf{constructor(Xa,vb){this.pcb=this.cgi=this.yid=!1;this.Uob=this.F9=this.r5=this.QTa=this.r7a=this.kmc=this.lmc=this.jmc=0;this.qze=null;this.pfg=this.vfg=0;this.K6d=this.CDg=null;if(Xa){this.Je=vb.Je;var Pb=0;try{this.yid=1===Xa.J(Pb);++Pb;this.cgi=1===Xa.J(Pb);++Pb;this.pcb=1===Xa.J(Pb);++Pb;this.jmc=Xa.J(Pb);++Pb;this.lmc=Xa.J(Pb);++Pb;this.kmc=Xa.J(Pb);++Pb;this.r7a=Xa.J(Pb);++Pb;this.QTa=Xa.J(Pb);++Pb;this.r5=Xa.J(Pb);++Pb;this.F9=Xa.J(Pb);++Pb;this.Uob=Xa.J(Pb);
++Pb;this.qze=this.BXl(vb.asb(Xa.J(Pb)));++Pb;this.vfg=Xa.J(Pb);++Pb;this.pfg=Xa.J(Pb);++Pb;const oc=Xa.J(Pb);++Pb;this.CDg=Array(oc);for(let Kc=0;Kc<oc;++Kc){const Sc=Xa.J(Pb);++Pb;const ae=this.qze.trie,Bd=new Ya.a;Bd.Prb(Xa,Pb,Sc);this.CDg[Kc]=this.EXl(Bd,vb,ae);Pb+=Sc}const zc=Xa.J(Pb);++Pb;this.K6d=Array(zc);for(vb=0;vb<zc;++vb){const Kc=Xa.J(Pb);++Pb;const Sc=new Ya.a;Sc.Prb(Xa,Pb,Kc);this.K6d[vb]=this.mXl(Sc);Pb+=Kc}}catch(oc){throw Error.argument("initData");}}}BXl(Xa){return new kg.a(new jf.a(Xa))}EXl(Xa,
vb,Pb){return $e.a.create(Xa,vb,Pb)}mXl(Xa){return new ch(Xa)}}Object(f.a)(Gf,"NGramNLModuleInit",null,[]);class xg{constructor(Xa){this.Sa=Xa}execute(Xa){if(!Xa)throw Error.argumentNull("input");Xa=Xa.clone();this.Sa.script.execute(Xa,null);return Xa}}Object(f.a)(xg,"ScriptNLModule",null,[1459]);class di{constructor(Xa,vb){Xa&&(this.script=vb.TUb(Xa.J(0)))}}Object(f.a)(di,"ScriptNLModuleInit",null,[]);const cn=Xa=>{Xa=Nc(Xa,vb=>vb*vb);return Math.sqrt(yf(Xa,(vb,Pb)=>vb+Pb,0))},Nm=Xa=>yf(Xa,(vb,Pb)=>
vb>Pb?vb:Pb,Xa[0]);class Lf{constructor(Xa){this.Sa=Xa}execute(Xa){if(!Xa)throw Error.argumentNull("input");var vb=[],Pb=[];this.q8j(Xa,vb,Pb);this.tPj(vb,Pb);const oc={};for(let Kc=0;Kc<vb.length;++Kc){var zc=vb[Kc];const Sc=this.Sa.N9h.J(zc);zc=this.Sa.O9h.J(zc);for(let ae=0;ae<zc;++ae){const Bd=this.Sa.a1.J(this.Sa.Cvh.J(Sc+ae)),Rf=this.Sa.Dvh.J(Sc+ae);let Ad;({value:Ad}=il(oc,Bd)).returnValue||(Ad=0);oc[Bd]=Ad+Pb[Kc]*Rf}}Pb=cj(oc);Pb.sort((Kc,Sc)=>{var ae=Kc.value,Bd=Sc.value;(ae=-(ae>Bd?1:ae<
Bd?-1:0))||(ae=Kc.key.localeCompare(Sc.key));return ae});vb=new ib.a(this.Sa.Je,D.Annotations.kX);for(const Kc of vg(Pb,this.Sa.SDl))Pb=new U.a(this.Sa.Je),Pb.vy(this.Sa.SUj,Kc.key),Pb.vy(this.Sa.UUj,Kc.value),Array.add(vb.items,Pb);Xa.vy(this.Sa.TUj,vb);return Xa}q8j(Xa,vb,Pb){if(({value:Xa}=Xa.Kp(this.Sa.RUj)).returnValue){let oc;if(({value:oc}=Xa.Kp(this.Sa.lmc)).returnValue){let zc;if(!({value:zc}=Xa.Kp(this.Sa.kmc)).returnValue||oc.items.length!==zc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");
this.d1d(oc,zc,vb,Pb)}if(({value:oc}=Xa.Kp(this.Sa.WUj)).returnValue){let zc;if(!({value:zc}=Xa.Kp(this.Sa.XUj)).returnValue||oc.items.length!==zc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.d1d(oc,zc,vb,Pb)}({value:oc}=Xa.Kp(this.Sa.jmc)).returnValue&&this.d1d(oc,null,vb,Pb);({value:oc}=Xa.Kp(this.Sa.VUj)).returnValue&&this.d1d(oc,null,vb,Pb)}}d1d(Xa,vb,Pb,oc){for(let Kc=0;Kc<Xa.items.length;++Kc){var zc=void 0;Xa.U6===
D.Annotations.eba?({value:zc}=il(this.Sa.iIh,Xa.items[Kc])).returnValue||(zc=-1):(zc=Xa.items[Kc],zc=zc>=this.Sa.I6f&&zc<=this.Sa.sEl?this.Sa.p8f?this.Sa.p8f.J(zc-this.Sa.I6f)-1:zc-this.Sa.I6f:-1);if(0<=zc){let Sc;Sc=vb?vb.items[Kc]:1;0<Sc&&(Array.add(Pb,zc),Array.add(oc,Sc))}}}tPj(Xa,vb){if(Xa.length){switch(this.Sa.a4l){case 0:break;case 1:for(var Pb=0;Pb<vb.length;++Pb)vb[Pb]=1+Math.log(vb[Pb]);break;case 2:Pb=Nm(vb);for(let oc=0;oc<vb.length;++oc)vb[oc]=.5+vb[oc]/Pb*.5;break;case 3:for(Pb=0;Pb<
vb.length;++Pb)vb[Pb]=1;break;default:throw Error.notImplemented();}if(this.Sa.Rde)for(Pb=0;Pb<vb.length;++Pb)vb[Pb]*=this.Sa.Rde.J(Xa[Pb]);Xa=cn(vb);for(Pb=0;Pb<vb.length;++Pb)vb[Pb]/=Xa}}}Object(f.a)(Lf,"TfIdfRankerNLModule",null,[1459]);class dj{constructor(Xa,vb=0){if(!Xa)throw Error.argumentNull("byteArray");this.$ie=vb;if(604662927!==Xa.uy(this.$ie+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Eh=Xa.uy(this.$ie+4,4);this.lmi=Xa.uy(this.$ie+8,4);this.QBl=
Xa}J(Xa){if(0>Xa||Xa>=this.count)throw Error.argumentOutOfRange("index");return this.QBl.Z6l(8*this.$ie+96+Xa*this.lmi,this.lmi)}get count(){return this.Eh}}Object(f.a)(dj,"CompactIntArray",null,[1460]);const ue=(Xa,vb)=>{vb=Array(vb);for(let Kc=0;Kc<vb.length;Kc++){var Pb=Kc,oc=Xa.Haa(),zc=1===(oc>>31&1)?-1:1;const Sc=oc&8388607;oc=oc>>23&255;256===oc+1?zc=Sc?Number.NaN:1===zc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:oc?(oc-=127,zc=zc*Ce(Sc,1)*Math.pow(2,oc)):zc=zc*Ce(Sc,0)*Math.pow(2,-126);
vb[Pb]=zc}return vb},Ce=(Xa,vb)=>{let Pb=0;for(let oc=0;23>oc;oc++)Pb+=(Xa>>22-oc&1)/Math.pow(2,oc+1);return vb+Pb};class ij{constructor(Xa,vb){this.p8f=null;this.tri=0;this.O9h=this.N9h=this.Rde=null;this.sri=0;this.Dvh=this.Cvh=null;this.Je=vb.Je;let Pb=0;this.VUj=Xa.J(Pb);++Pb;this.jmc=Xa.J(Pb);++Pb;this.WUj=Xa.J(Pb);++Pb;this.XUj=Xa.J(Pb);++Pb;this.lmc=Xa.J(Pb);++Pb;this.kmc=Xa.J(Pb);++Pb;this.RUj=Xa.J(Pb);++Pb;this.TUj=Xa.J(Pb);++Pb;this.SUj=Xa.J(Pb);++Pb;this.UUj=Xa.J(Pb);++Pb;var oc=Xa.J(Pb);
++Pb;var zc=Array(oc);for(var Kc=0;Kc<oc;++Kc)zc[Kc]=vb.KE(Xa.J(Pb)),++Pb;this.a1=Ya.a.Nsf(zc);this.SDl=Xa.J(Pb);++Pb;this.a4l=Xa.J(Pb);++Pb;oc=Xa.J(Pb);++Pb;this.iIh={};for(zc=0;zc<oc;++zc){Kc=vb.KE(Xa.J(Pb));++Pb;const Sc=Xa.J(Pb);++Pb;this.iIh[Kc]=Sc}this.I6f=Xa.J(Pb);++Pb;this.sEl=Xa.J(Pb);++Pb;oc=Xa.J(Pb);++Pb;0<oc&&(oc=vb.asb(Xa.J(Pb)),++Pb,this.p8f=this.Doe(new sh(oc)));++Pb;Xa=vb.asb(Xa.J(Pb));this.rXl(Xa)}Doe(Xa){return new dj(Xa.N0c,Xa.offset)}rXl(Xa){try{const vb=new sh(Xa);this.tri=vb.Haa();
1===vb.Haa()?this.Rde=Ya.a.Nsf(ue(vb,this.tri)):this.Rde=null;const Pb=vb.Haa();this.N9h=this.Doe(vb);vb.offset+=Pb;const oc=vb.Haa();this.O9h=this.Doe(vb);vb.offset+=oc;this.sri=vb.Haa();const zc=vb.Haa();this.Cvh=this.Doe(vb);vb.offset+=zc;this.Dvh=Ya.a.Nsf(ue(vb,this.sri))}catch(vb){throw Error.argument("byteReader");}}}Object(f.a)(ij,"TfIdfRankerNLModuleInit",null,[]);class uk{constructor(Xa,vb,Pb,oc){this.Idg=Xa;this.xNh=Pb;this.vha=oc;this.ira=vb;this.kCc=-1;this.nue=0}}Object(f.a)(uk,"TokenizerData",
null,[]);class Gj{constructor(Xa){this.Sa=Xa}execute(Xa){if(!Xa)throw Error.argumentNull("input");if(!({value:oc}=Xa.Kp(this.Sa.r7a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let vb;({value:vb}=Xa.Kp(this.Sa.r5)).returnValue||(vb=0);let Pb;({value:Pb}=Xa.Kp(this.Sa.F9)).returnValue||(Pb=oc.length-vb);if(0>vb||vb>oc.length)throw Error.argument("input","Start index out of range");if(0>Pb||Pb>oc.length)throw Error.argument("input","Length out of range");
if(vb+Pb>oc.length)throw Error.argument("input","Bad start-length range");var oc=new uk(oc,vb,vb+Pb,new ib.a(this.Sa.Je,D.Annotations.kX));this.bLm(oc);Xa=Xa.isReadOnly?Xa.clone():Xa;Xa.vy(this.Sa.QTa,oc.vha);return Xa}bLm(Xa){for(;Xa.ira<Xa.xNh;){if(this.Sa.zOf){var vb=this.Sa.zOf.Pli(Xa.Idg,Xa.ira,Xa.xNh-Xa.ira,null);!vb.succeeded&&vb.Eqi&&(vb=vb.Eqi);if(vb.succeeded){this.Pui(Xa,vb.length,this.Sa.p3h);Xa.ira+=vb.length;continue}}vb=Xa.Idg.substr(Xa.ira);let Pb=-1,oc=-1,zc=-1;for(let Kc=0;Kc<this.Sa.yte.length;++Kc){const Sc=
this.Sa.yte[Kc].exec(vb);Sc&&0<Sc[1].length&&(0>Pb||Sc[0].length>oc)&&(Pb=Kc,oc=Sc[0].length,zc=Sc[1].length)}0<=Pb?(this.Pui(Xa,zc,this.Sa.zqg[Pb]),Xa.ira+=zc):Xa.ira+=1}}Pui(Xa,vb,Pb){if(this.Sa.$ei)Pb!==Gj.l0j&&(0>Xa.kCc&&(Xa.kCc=Xa.ira),Xa.nue=Xa.ira+vb-Xa.kCc,Pb===Gj.k0j&&(0<=Xa.kCc&&0<Xa.nue&&(vb=new U.a(this.Sa.Je),vb.vy(this.Sa.r5,Xa.kCc),vb.vy(this.Sa.F9,Xa.nue),vb.vy(this.Sa.rhf,Gj.m0j),vb.vy(this.Sa.r7a,Xa.Idg),Array.add(Xa.vha.items,vb)),Xa.kCc=-1,Xa.nue=0));else{let oc=new U.a(this.Sa.Je);
oc.vy(this.Sa.r5,Xa.ira);oc.vy(this.Sa.F9,vb);oc.vy(this.Sa.rhf,Pb);Array.add(Xa.vha.items,oc)}}}Gj.l0j="GAP";Gj.k0j="EOS_CHUNK";Gj.m0j="SENTENCE";Object(f.a)(Gj,"TokenizerNLModule",null,[1459]);class xj{constructor(Xa,vb){this.F9=this.r5=this.rhf=this.QTa=this.r7a=0;this.$ei=!1;this.zqg=this.yte=this.p3h=this.zOf=null;if(Xa){this.Je=vb.Je;var Pb=0;try{this.r7a=Xa.J(Pb);++Pb;this.QTa=Xa.J(Pb);++Pb;this.rhf=Xa.J(Pb);++Pb;this.r5=Xa.J(Pb);++Pb;this.F9=Xa.J(Pb);++Pb;this.$ei=1===Xa.J(Pb);++Pb;var oc=
Xa.J(Pb);++Pb;0<oc&&(this.zOf=vb.OJf(oc).yyk);this.p3h=Xa.J(Pb)?vb.KE(Xa.J(Pb)):"";++Pb;const zc=Xa.J(Pb);++Pb;this.yte=Array(zc);this.zqg=Array(zc);for(oc=0;oc<zc;++oc)this.yte[oc]=new RegExp(vb.KE(Xa.J(Pb))),++Pb,this.zqg[oc]=vb.KE(Xa.J(Pb)),++Pb}catch(zc){throw Error.argument("initData");}}}}Object(f.a)(xj,"TokenizerNLModuleInit",null,[]);class Em{constructor(Xa){this.Sa=Xa}execute(Xa){if(!Xa)throw Error.argumentNull("input");let vb;if(!({value:vb}=Xa.Kp(this.Sa.Toh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");
for(const Pb of this.Sa.iAg)vb=Pb.apply(vb);Xa=D.Annotations.KV(Xa);Xa.vy(this.Sa.Uoh,vb);return Xa}static Dgf(Xa,vb){const Pb=new Sys.StringBuilder;for(let oc=0;oc<Xa.length;++oc)Pb.append(vb(Xa.substr(oc,1)));return Pb.toString()}}Object(f.a)(Em,"TransliteratorNLModule",null,[1459]);class Ti{constructor(Xa){Xa&&(this.style=Xa.J(0))}apply(Xa){return Em.Dgf(Xa,vb=>Ti.v3j(vb,this.style))}static v3j(Xa,vb){switch(vb){case 0:return Xa.toLowerCase();case 1:return"I"===Xa?"\u0131":Xa.toLowerCase();case 2:return Xa.toUpperCase();
case 3:return"i"===Xa?"\u0130":Xa.toUpperCase();default:throw Error.invalidOperation();}}}Ti.XPb=0;Object(f.a)(Ti,"ChangeCaseTransliterationStage",null,[1472]);class wl{apply(Xa){return Em.Dgf(Xa,wl.VLm)}static VLm(Xa){const vb=Xa.charCodeAt(0);return 65281<=vb&&65374>=vb?String.fromCharCode(vb-65248):Xa}}wl.XPb=4;Object(f.a)(wl,"LatinFullWidthToHalfWidthTransliterationStage",null,[1472]);class ke{constructor(Xa,vb){Xa&&(this.rkg=vb.Fsb(Xa.J(0)),this.ggm=vb.KE(Xa.J(1)))}apply(Xa){return Xa.replace(this.rkg,
this.ggm)}}ke.XPb=1;Object(f.a)(ke,"RegexReplaceTransliterationStage",null,[1472]);class Ui{constructor(Xa,vb){if(Xa){var Pb=Xa.J(0),oc=vb.KE(Xa.J(1)),zc=new dj(vb.asb(Xa.J(2)));Xa=0>Xa.J(3)?null:new dj(vb.asb(Xa.J(3)));this.eBg={};for(vb=0;vb<Pb;++vb)this.eBg[oc.charAt(vb).toString()]=oc.substr(zc.J(vb),Xa?Xa.J(vb):1)}}apply(Xa){return Em.Dgf(Xa,vb=>vb in this.eBg?this.eBg[vb]:vb)}}Ui.XPb=2;Object(f.a)(Ui,"SingleCharSubstitutionsTransliterationStage",null,[1472]);class hg{constructor(Xa,vb){this.Uoh=
this.Toh=0;this.iAg=null;if(Xa){this.Je=vb.Je;var Pb=0;try{this.Toh=Xa.J(Pb);++Pb;this.Uoh=Xa.J(Pb);++Pb;const oc=Xa.J(Pb);++Pb;this.iAg=Array(oc);for(let zc=0;zc<oc;++zc){const Kc=Xa.J(Pb);++Pb;const Sc=Xa.J(Pb);++Pb;const ae=new Ya.a;ae.Prb(Xa,Pb,Sc);Pb+=Sc;this.iAg[zc]=this.AXl(Kc,ae,vb)}}catch(oc){throw Error.argument("initData");}}}AXl(Xa,vb,Pb){switch(Xa){case Ti.XPb:return new Ti(vb);case ke.XPb:return new ke(vb,Pb);case Ui.XPb:return new Ui(vb,Pb);case wl.XPb:return new wl;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");
}}}Object(f.a)(hg,"TransliteratorNLModuleInit",null,[]);class cc{FTk(Xa,vb){const Pb=Xa.J(0),oc=new Ya.a;oc.Prb(Xa,1,Xa.count-1);switch(Pb){case 0:return new xg(new di(oc,vb));case 2:return new Gj(new xj(oc,vb));case 3:return new Si(new Gf(oc,vb));case 5:return new lf(new ci(oc,vb));case 9:return new Em(new hg(oc,vb));case 10:return new Lf(new ij(oc,vb));default:throw Error.notImplemented();}}}Object(f.a)(cc,"NLModuleFactory",null,[1437]);class xl{constructor(Xa){this.i0j=";";if(!Xa)throw Error.argumentNull("resource");
this.Tla=new gg(Xa,new fb,new cc);this.G4f=this.Tla.qTk();this.kmi=this.Tla.Je.had("Text.Text");this.imi=this.Tla.Je.had("Classification.Predictions");this.t4f=this.Tla.Je.had("Classification.PredictionString");this.jmi=this.Tla.Je.had("Classification.Probability");this.PBl=this.Tla.Je.had("NLMod.Tokens");if(0>this.kmi||0>this.imi||0>this.t4f||0>this.jmi)throw Error.argument("resourceObj","Resource does not represent a ranker");}wHk(){const Xa=[];this.lAf(void 0,this.jRh(Xa),null);return Xa}yHk(Xa,
vb){const Pb=[],oc=[];this.lAf(Xa,this.jRh(Pb),(zc,Kc)=>{const Sc=this.Tla.Je.ZQh(zc),ae=[],Bd=[];vb&&vb.length&&-1===Array.indexOf(vb,Sc)||(zc=this.Tla.Je.getAttributeType(zc),this.gAi(zc,Kc,ae,Bd),Kc=new Ag(Sc,ae,Bd),Array.add(oc,Kc))});return new Fj(Pb,oc)}xHk(Xa){const vb=[];this.lAf(Xa,Pb=>{let oc;if(({value:oc}=Pb.Kp(this.t4f)).returnValue){let zc;({value:zc}=Pb.Kp(this.jmi)).returnValue&&Array.add(vb,new Lh(oc,zc))}},null);return vb}lAf(Xa,vb,Pb){var oc=new U.a(this.Tla.Je);oc.vy(this.kmi,
Xa);Xa=this.G4f.execute(oc);if(({value:oc}=Xa.Kp(this.imi)).returnValue)for(const zc of oc.items)vb(zc);if(Pb&&({value:vb}=Xa.Kp(this.PBl)).returnValue)for(const zc of vb.items)zc.M7d(Pb)}gAi(Xa,vb,Pb,oc){if(D.Annotations.vI(Xa))for(var zc of vb.items)this.gAi(vb.U6,zc,Pb,oc);else if(D.Annotations.g3i(Xa)){zc=this.Tla.Je.IXh(Xa);for(let Kc=0;Kc<zc;Kc++)Array.add(Pb,this.Tla.Je.c0h(Xa,Kc)),Array.add(oc,this.Tla.Je.Gha(this.Tla.Je.PWb(Xa,Kc),vb.isb(Kc)))}else Array.add(Pb,"VALUE"),Array.add(oc,this.Tla.Je.Gha(Xa,
vb))}jRh(Xa){return vb=>{let Pb;({value:Pb}=vb.Kp(this.t4f)).returnValue&&Array.add(Xa,this.gXk(Pb))}}gXk(Xa){const vb=Xa.indexOf(this.i0j);return 0>vb?Xa:Xa.substring(0,vb)}}Object(f.a)(xl,"Ranker",null,[]);var Ne=b(1163),gh=b(1179),Mh=b(1128),sf=b(1115),qd=b(1111),Eh=b(2);class qi{constructor(Xa,vb){this.G1g="";this.d3e=null;this.e3e=!1;this.Vva=null;this.Egj=["TellMe.TellMeParamCollection"];this.tc=Xa;this.D4a=vb;this.tc.n7a&&(this.Vva=this.tc.y8d())}get hqe(){if(!this.d3e&&!this.e3e){let Xa=null;
try{Xa=window.TellMeModel}catch(vb){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("QueryRanker","TellMeModel not found. Exception: "+vb)}if(Xa){try{this.d3e=new xl(Xa)}catch(vb){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+vb)}this.e3e=!0}else if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("QueryRanker","Classifier model not found")}return this.d3e}C$(){return"Command"}hsa(){return this.tc.IL?
1===this.tc.IL?1:2:0}H6(Xa,vb,Pb=!1,oc=c.a.tellMe,zc=null){const Kc=new v.a(Xa);if((!zc||Array.contains(zc,0))&&!qd.a.lAa(Xa)){if(!this.hqe&&this.e3e){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.tc.n7a&&this.Vva&&this.Vva.initialize();if(Ne.isCommandHookQuery(Xa.Oh)&&(zc=Ne.getCommandsFromQuery(Xa.Oh),0<zc.results.length)){zc.displayName=
"Classifier Debug";Kc.NF(zc);vb.resultsUpdated(Kc);return}zc=Xa?this.G1g=Xa.Oh:this.G1g;if(Eh.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){zc=this.iXk(zc);var Sc=this.W8d(zc.fLf());zc=zc.xQh()}else zc=this.hXk(zc),Sc=this.DJk(zc),zc=[];Ne.logCommandSuggestions(Sc,!1,"Classifier","TFIDF");Sc=Ne.getResultGroup(Xa,Sc,this.tc,this.Vva,this.D4a,zc,0);0<Sc.results.length&&oc!==c.a.contextMenu&&(Sc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Pb||Sc.results.length||this.tc.LN||
this.tc.t_a||(Xa=new Mh.a("lookupNoResults",14,Xa.Oh),Sc.eJ(Xa));0<Sc.results.length&&Kc.NF(Sc);Kc.attributes=zc}vb.resultsUpdated(Kc)}fLf(){let Xa=[];try{Xa=this.hqe.wHk()}catch(vb){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("GetPredictions","Exception: "+vb)}return Xa}hXk(Xa){let vb=[];try{vb=this.hqe.xHk(Xa)}catch(Pb){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("GetPredictionsWithScore","Exception: "+Pb)}return vb}iXk(Xa){try{return this.hqe.yHk(Xa,this.Egj)}catch(vb){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("GetPredictionsWithTokenAttributes",
"Exception: "+vb)}return new Fj([],[])}W8d(Xa){const vb=[];if(Xa)for(const Pb of Xa)vb.push(new gh.a(Pb,-99999));return vb}DJk(Xa){const vb=[];if(Xa)for(const Pb of Xa)vb.push(new gh.a(Pb.prediction,Pb.score));return vb}}Object(f.a)(qi,"CommandResultsProvider",null,[1334]);var bf=b(1418);class he{constructor(Xa,vb,Pb,oc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Xa;this.CommandId=vb;this.CommandValueId=Pb;this.InputText=oc}}Object(f.a)(he,"FindInDocumentProp",null,
[]);var dk=b(1196),Cf=b(16);class Xj{constructor(Xa){this.l3g=3;this.LJb=[];this.Dmb=[];this.tc=Xa;Xj.kqc=Xa.OBf;Xj.WMh="FindInDocumentSuggestion";Xj.Dzi="FindInDocumentSuggestion3";this.LNd=Object.assign(new dk.a,{landingTab:"Indoc",data:null});this.OBj=this.tc.i_a||!!Eh.AFrameworkApplication.pa&&Eh.AFrameworkApplication.pa.mb.i_a}C$(){return"FindInDocument"}hsa(){return this.tc.IL?1===this.tc.IL?1:2:0}H6(Xa,vb,Pb=!1,oc,zc=null){oc=new v.a(Xa);if(!zc||Array.contains(zc,2))if(Array.clear(this.LJb),
qd.a.lAa(Xa)){if(Pb&&this.shb()){Xa=new y.a(2);Xa.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;if(0<this.Dmb.length){Pb=1;for(var Kc of this.Dmb)this.j6i(Xa,Kc.Label,Kc.CommandValueId,Xj.WMh+Pb,Kc.InputText),Pb++}Kc=qd.a.vqb("",15,this.LNd);this.j6i(Xa,CommonUIStrings.l_TellMeOpenFindPaneText,Kc,Xj.Dzi,"");oc.NF(Xa)}}else Pb&&(Pb=this.OBj?qd.a.vqb(Xa.Oh,15,this.LNd):Cf.a.ve(Xa.Oh),zc=[],this.tc.Ucb?(this.tc.qwe&&zc.push(appChrome.actions.setControlIconSet(Xj.kqc,{"default":"FindInDocument_20"})),
Kc=this.tc.I_f?qd.a.cIf(Xa.Oh,CommonUIStrings.l_FindInDocumentScopedButtonText):Xa.Oh+CommonUIStrings.l_FindInDocumentScopedButtonText):Kc=String.format(CommonUIStrings.l_TextWithQuotation,Xa.Oh),zc.push(appChrome.actions.setControlLabel(Xj.kqc,Kc)),zc.push(appChrome.actions.setButtonCommandValueId(Xj.kqc,Pb)),appChrome.api.dispatch(zc),this.AQi(Kc,Xj.kqc,Pb,Xa.Oh)),Xa=new Mh.a(Xj.kqc,8,Xa.Oh),Kc=new y.a(2),Kc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,Kc.eJ(Xa),oc.NF(Kc);vb.resultsUpdated(oc)}shb(){return!!this.tc&&
this.tc.shb}j6i(Xa,vb,Pb,oc,zc=null){const Kc=[];vb&&Kc.push(appChrome.actions.setControlLabel(oc,vb));Kc.push(appChrome.actions.setButtonCommandValueId(oc,Pb));appChrome.api.dispatch(Kc);this.AQi(vb,oc,Pb,"");Xa.eJ(new Mh.a(oc,8,zc,null,-99999))}AQi(Xa,vb,Pb,oc){this.shb()&&this.LJb.length<this.l3g&&(Xa=new he(Xa,vb,Pb,oc),Array.add(this.LJb,Xa))}msm(Xa){for(let vb=0;vb<this.LJb.length;vb++)if(this.LJb[vb].CommandId===Xa){const Pb=this.LJb[vb].Label;let oc=!1;if(0<this.Dmb.length){let zc=0;for(const Kc of this.Dmb){if(Kc.Label===
Pb){Array.removeAt(this.Dmb,zc);oc=!0;break}zc++}}!oc&&this.Dmb.length>=this.l3g-1&&Array.removeAt(this.Dmb,1);Array.insert(this.Dmb,0,this.LJb[vb])}}}Xj.kqc=null;Xj.WMh=null;Xj.Dzi=null;Object(f.a)(Xj,"FindInDocumentResultsProvider",null,[1334]);class Oi{constructor(Xa){this.tc=Xa}C$(){return"Insights"}hsa(){return this.tc.IL?1===this.tc.IL?1:2:0}H6(Xa,vb,Pb=!1,oc,zc=null){oc=new v.a(Xa);if(!zc||Array.contains(zc,12))if(this.Mym()||!qd.a.lAa(Xa)){zc=new y.a(12);var Kc=new Mh.a("SmartLookupFromTellMe",
10,Xa.Oh);if(Pb){let Sc=null;qd.a.fXa()?""===Xa.Oh.trim()?Pb=this.tc.Nym?CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:(Pb=String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Xa.Oh),Sc=qd.a.vqb(Xa.Oh,1)):(Pb=String.format(CommonUIStrings.l_InsightsButtonText,Xa.Oh),Sc=qd.a.eoc(Xa.Oh));const ae=[];Sc?(ae.push(appChrome.actions.setControlLabel("SmartLookupFromTellMe",Pb)),ae.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
Sc))):(ae.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeZeroTerm",Pb)),Kc=new Mh.a("SmartLookupFromTellMeZeroTerm",10,Xa.Oh));Kc.label=Pb;appChrome.api.dispatch(ae)}zc.eJ(Kc);oc.NF(zc)}vb.resultsUpdated(oc)}Mym(){return qd.a.fXa()&&this.tc.PIm}}Object(f.a)(Oi,"InsightsResultsProvider",null,[1334]);var Mj=b(1415);class aj{constructor(Xa){this.tc=Xa}C$(){return"Learning"}hsa(){return this.tc.IL?1===this.tc.IL?1:2:0}H6(Xa,vb,Pb,oc,zc=null){Pb=new v.a(Xa);zc&&!Array.contains(zc,20)||!qd.a.lAa(Xa)||
(zc=[],oc=this.tc.Mhi,zc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",oc)),oc=aj.MOk(oc),zc.push(appChrome.actions.setControlLabel("LearningForSearch",oc)),appChrome.api.dispatch(zc),Xa=new Mh.a("LearningForSearch",22,Xa.Oh),zc=new y.a(20),zc.eJ(Xa),Pb.NF(zc));vb.resultsUpdated(Pb)}static MOk(Xa){const vb=[];Array.add(vb,new Mj.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(vb,new Mj.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(vb,new Mj.a(600,
Xa));Array.add(vb,new Mj.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Xa={};Xa.parts=vb;return JSON.stringify(Xa)}}Object(f.a)(aj,"LearningProvider",null,[1334]);var ek=b(424);class ui{constructor(Xa){this.mhc=this.Skc=this.fnb=this.JOd=null;this.qu=!1;(this.Shc=Xa)&&this.PLh(Xa)}bAe(){this.Shc.bAe()&&this.PLh(this.Shc)}T0k(Xa){let vb=[];var Pb=[];Xa=ui.cJl(Xa);var oc="";Array.clear(Pb);for(let zc=0;zc<Xa.length;zc++){const Kc=Xa.charAt(zc);-1!==" ".indexOf(Kc)?(oc.length&&Array.add(Pb,
oc),oc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Kc)?(oc.length&&Array.add(Pb,oc),oc=Kc,Array.add(Pb,oc),oc=""):oc+=Kc}oc.length&&Array.add(Pb,oc);for(Xa=0;Xa<Pb.length;Xa++)oc=this.CJk(Pb[Xa]),oc=this.Cbk(oc),vb=ui.hFl(vb,oc);return vb=this.NKj(vb)}BYf(){this.qu||this.bAe();return this.qu}E3d(Xa){return this.JOd[Xa.toString()]}NKj(Xa){for(let vb=0;vb<Xa.length;vb++){const Pb=this.fnb[vb];if(Xa[vb].commandId!==this.E3d(Pb[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let oc;(oc=Xa[vb]).score=oc.score+Pb[1]}return Xa}Cbk(Xa){const vb=[];for(var Pb=0;Pb<this.fnb.length;Pb++)vb.push(new gh.a(this.E3d(this.fnb[Pb][0]),-5));Pb=new ek.a;for(var oc=0;oc<Xa.length;oc++)Pb.add(this.E3d(Xa[oc][0]));for(oc=0;oc<vb.length;oc++){const Kc=vb[oc];for(let Sc=0;Sc<Xa.length;Sc++){var zc=Xa[Sc];const ae=this.E3d(zc[0]);zc=zc[1];if(ae===Kc.commandId){Kc.score=zc;Pb.remove(ae);break}}if(!Pb.count)break}return vb}CJk(Xa){const vb=1>Xa.length;for(let Sc=0;2>=Sc;Sc++){const ae=this.mhc;
for(let Bd in ae){var Pb=ae[Bd],oc=Xa,zc=Bd;const Rf=zc.length+1,Ad=Array((oc.length+1)*Rf);for(var Kc=0;Kc<=oc.length;Kc++)Ad[Kc*Rf]=Kc;for(Kc=0;Kc<=zc.length;Kc++)Ad[Kc]=Kc;for(Kc=0;Kc<zc.length;Kc++)for(let Yd=0;Yd<oc.length;Yd++)Ad[(Yd+1)*Rf+(Kc+1)]=oc.charAt(Yd)===zc.charAt(Kc)?Ad[Yd*Rf+Kc]:Math.min(Math.min(Ad[Yd*Rf+(Kc+1)]+1,Ad[(Yd+1)*Rf+Kc]+1),Ad[Yd*Rf+Kc]+1);oc=Ad[oc.length*Rf+zc.length];if((!oc||!vb)&&oc<=Sc)return Pb}}return this.Skc}PLh(Xa){this.JOd=Xa.LJf();this.fnb=Xa.OXk();this.Skc=
Xa.l3k();this.mhc=Xa.oRk();if(this.qu=!!this.JOd&&!!this.fnb&&!!this.mhc&&!!this.Skc)this.qu=0<this.fnb.length&&ui.jVf(this.fnb);this.qu&&(this.qu=0<this.Skc.length&&ui.jVf(this.Skc));this.qu&&(this.mhc=ui.U3k(this.mhc));this.qu||(this.mhc=this.Skc=this.fnb=this.JOd=null)}I2k(Xa){Xa=this.T0k(Xa);return this.oyk(Xa)}oyk(Xa){let vb=[];for(let Pb=0;Pb<Xa.length;Pb++)-3.9<=Xa[Pb].score&&vb.push(Xa[Pb]);vb.sort((Pb,oc)=>Pb.score<oc.score?1:Pb.score>oc.score?-1:0);0<vb.length-10&&(vb=vb.slice(0,10));return vb}static hFl(Xa,
vb){if(!Xa.length)return vb;if(Xa.length!==vb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Pb=0;Pb<Xa.length;Pb++){if(Xa[Pb].commandId!==vb[Pb].commandId)throw Error.create("Incorrect CommandId");let oc;(oc=Xa[Pb]).score=oc.score+vb[Pb].score}return Xa}static cJl(Xa){return Cf.a.vf(Xa)}static jVf(Xa){for(let vb=0;vb<Xa.length;vb++)if(2!==Xa[vb].length)return!1;return!0}static U3k(Xa){const vb={};for(let zc in Xa){var Pb=zc,oc=Xa[zc];
const Kc=oc;Kc.length&&ui.jVf(Kc)&&(vb[Pb]=oc)}return vb}}Object(f.a)(ui,"NaiveBayesClassifierModel",null,[]);class Sh{constructor(Xa,vb){this.Vva=null;this.tc=Xa;this.jSc=new ui(vb);this.tc.n7a&&(this.Vva=this.tc.y8d())}C$(){return"NBCommand"}hsa(){return this.tc.IL?1===this.tc.IL?1:2:0}H6(Xa,vb,Pb=!1,oc=c.a.tellMe,zc=null){const Kc=new v.a(Xa);if((!zc||Array.contains(zc,0))&&!qd.a.lAa(Xa)){if(Ne.isCommandHookQuery(Xa.Oh)&&(zc=Ne.getCommandsFromQuery(Xa.Oh),0<zc.results.length)){zc.displayName="Classifier Debug";
Kc.NF(zc);vb.resultsUpdated(Kc);return}if(!this.jSc.BYf()){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.tc.n7a&&this.Vva&&this.Vva.initialize();zc=this.jSc.I2k(Xa.Oh);Ne.logCommandSuggestions(zc,!1,"Classifier","NaiveBayesian");zc=Ne.getResultGroup(Xa,zc,this.tc,this.Vva,null,null,0);0<zc.results.length&&oc!==c.a.contextMenu&&(zc.displayName=
CommonUIStrings.l_TellMeCommandProviderTitle);Pb||zc.results.length||this.tc.LN||this.tc.t_a||(Xa=new Mh.a("lookupNoResults",14,Xa.Oh),zc.eJ(Xa));0<zc.results.length&&Kc.NF(zc)}vb.resultsUpdated(Kc)}}Object(f.a)(Sh,"NaiveBayesCommandProvider",null,[1334]);class Fg{constructor(){this.GJb=null;this.qu=!1;this.bAe()}bAe(){this.qu||(this.GJb=window.NBCRM)&&4===this.GJb.length&&(this.qu=!0);return this.qu}OXk(){return this.qu?this.GJb[1]:null}l3k(){return this.qu?this.GJb[2]:null}oRk(){return this.qu?
this.GJb[3][0]:null}LJf(){return this.qu?this.GJb[0][0]:null}}Object(f.a)(Fg,"NaiveBayesModelAdapter",null,[1362]);var cd=b(74),Zc=b(292),pj=b(1200),Qb=b(1177),vk=b(1199),Di=b(31),nk=b(130),Hj=b(1099);class Sl{constructor(Xa){this.GR=null;this.S3=-1;this.K5f=14;this.N5f=12;this.attributes=this.query=null;this.mvc=!1;this.mSd=[];this.Be=Eh.AFrameworkApplication.he;Eh.AFrameworkApplication.K&&(this.K5f=Eh.AFrameworkApplication.K.zb("TellMeMaxTermedResults",this.K5f),this.N5f=Eh.AFrameworkApplication.K.zb("TellMeMaxZeroTermResults",
this.N5f));this.P6=Xa}get Hw(){return this.mSd}NF(Xa){let vb=!1;for(let Pb=0;Pb<this.Hw.length;Pb++)if(21!==this.Hw[Pb].groupType&&this.Hw[Pb].groupType===Xa.groupType){this.fLj(this.Hw[Pb],Xa);vb=!0;break}vb||this.Hw.push(Xa)}fLj(Xa,vb){for(let Pb=0;Pb<vb.results.length;Pb++)Xa.eJ(vb.results[Pb])}cHi(Xa){const vb=[];for(const Pb of this.Hw)Pb.groupType!==Xa&&vb.push(Pb);this.Hw.length!==vb.length&&(this.mSd=vb)}adm(Xa){let vb=null,Pb=null,oc=null;for(let zc=0;zc<Xa.length;zc++){const Kc=Xa[zc];if(Kc&&
Kc.Hw&&Kc.Hw.length)for(const Sc of Kc.Hw)16===Sc.groupType||17===Sc.groupType?vb=Sc:Sc.groupType&&15!==Sc.groupType||(Pb=Sc,oc=Kc)}vb&&Pb&&(16===vb.groupType&&({wcf:Pb,ndf:vb}=Ne.addHighConfidenceResultsFromLocalMLProvider(Pb,vb,this.P6.kZ()?this.P6.kZ().mJk:-.6)),oc.cHi(Pb.groupType))}oDm(){new cd.a;this.rzg(this.P6.Mmi)}gkd(Xa,vb){return this.P6.kZ()&&this.P6.kZ().fei&&this.query.Oh.length>this.P6.kZ().zZh&&this.gql(Xa,vb)||this.P6.kZ()&&this.P6.kZ().qfi&&this.query.Oh.length>this.P6.kZ().AZh&&
this.gsl(Xa,vb)?!0:!1}gsl(Xa,vb){return Xa&&Xa.length&&vb&&vb.length?-1===vb.toLowerCase().indexOf(Xa.toLowerCase())?!1:!0:!1}gql(Xa,vb){return Xa&&Xa.length&&vb&&vb.length?vb.toLowerCase().startsWith(Xa.toLowerCase()):!1}xyk(Xa){const vb=[];for(const Pb of this.Hw)Xa.contains(Pb.groupType)||vb.push(Pb);this.mSd=vb}ATm(Xa,vb){const Pb=[];for(const oc of this.Hw){const zc=oc;if(12!==zc.groupType){const Kc=Xa[Qb.a[zc.groupType].toLowerCase()];let Sc="False";Kc<vb&&(Sc="True");zc.displayName=zc.displayName+
" ("+Sc+": "+Kc+")"}Pb.push(zc)}this.mSd=Pb}rzg(Xa){const vb=new cd.a;for(;this.Hw.length;){var Pb=this.Hw.pop();const oc=Qb.a[Pb.groupType].toLowerCase(),zc=Xa[oc];if(Hj.c(zc))throw Error.create("GroupId "+oc+" missed from group SortingOrder");vb.add(new Zc.a(zc,Pb))}vb.Sc((oc,zc)=>oc.key<zc.key?-1:1);for(Xa=0;Xa<vb.count;Xa++)Pb=vb.J(Xa).value,this.Hw.push(Pb)}pDm(){var Xa=!1;let vb=!1,Pb=!1;for(let zc=0;zc<this.Hw.length;zc++){var oc=this.Hw[zc];const Kc=oc.groupType;if(7===Kc||14===Kc||13===Kc){oc=
oc.results;for(let Sc=0;Sc<oc.length;Sc++){if(7===Kc&&this.gkd(this.query.Oh,oc[Sc].label)){Xa=!0;break}if(14===Kc&&this.gkd(this.query.Oh,oc[Sc].label)){vb=!0;break}if(13===Kc){if(this.gkd(this.query.Oh,oc[Sc].label)||this.gkd(this.query.Oh,oc[Sc].description)){Pb=!0;break}const ae=oc[Sc].label.split(" ");for(const Bd of ae)if(this.gkd(this.query.Oh,Bd)){Pb=!0;break}}}}}Xa=this.P6.CZk(Xa,vb,Pb);this.rzg(Xa)}z6b(Xa,vb,Pb,oc,zc,Kc){if(zc===this.GR){zc=Xa.data.od;var Sc=null;try{Sc=Di.b(zc)}catch(Yd){sf.TellMeActor.instance.rf.onError("OnSuccessCallBack",
"Exception occured while deserializing ranker inference response:"+Yd);return}if("RankerResults"in Sc&&Sc.RankerResults){this.oIa();var ae=Sc.RankerResults;Sc=new cd.a;zc=new cd.a;var Bd=0;for(var Rf of ae){ae=Rf.ProviderId;var Ad=Rf.Score;Bd+=Ad;Sc.add(new Zc.a(ae,Ad))}Sc.Sc((Sd,Jf)=>Sd.value>Jf.value?-1:1);Rf=Kc?Kc.I_k:1E-6;ae={};Ad={};let Yd=0;for(let Sd=0;Sd<Sc.count;Sd++){let Jf=parseInt(Sc.J(Sd).key),Fi=Sc.J(Sd).value/Bd;1===Jf&&(Ad.answer=Yd++,Ad.entity=Yd++,Ad.definition=Yd++,Ad.wolframanswer=
Yd++,Fi<Rf&&(zc.add(8),zc.add(10),zc.add(9),zc.add(11)),ae.answer=Fi,ae.entity=Fi,ae.definition=Fi,ae.wolframanswer=Fi);2===Jf&&(Ad.assistance=Yd++,Fi<Rf&&zc.add(7),ae.assistance=Fi);3===Jf&&(Ad.classifier=Yd++,Ad.serviceclassifier=Yd++,Fi<Rf&&(zc.add(0),zc.add(16)),ae.classifier=Fi,ae.serviceclassifier=Fi);4===Jf&&(Ad.people=Yd++,Fi<Rf&&zc.add(13),ae.people=Fi);5===Jf&&(Ad.document=Yd++,Fi<Rf&&zc.add(14),ae.document=Fi);6===Jf&&(Ad.findindocument=Yd++,Fi<Rf&&zc.add(2),ae.findindocument=Fi);7===Jf&&
(Ad.notes=Yd++,Fi<Rf&&zc.add(19),ae.notes=Fi);8===Jf&&(Ad.image=Yd++,Fi<Rf&&zc.add(18),ae.image=Fi)}Sc=new cd.a;Sc.add("classifier");Sc.add("serviceclassifier");Sc.add("appsforoffice");Sc.add("findindocument");Sc.add("assistance");Sc.add("document");Sc.add("people");Sc.add("answer");Sc.add("wolframanswer");Sc.add("definition");Sc.add("entity");Sc.add("image");for(Bd=0;Bd<Sc.count;Bd++)Sc.J(Bd)in Ad||(Ad[Sc.J(Bd)]=Yd++);Ad.learning=Yd++;Ad.insights=Yd++;this.rzg(Ad);Kc&&Kc.Zci&&this.ATm(ae,Rf);Kc&&
Kc.$ci&&this.xyk(zc);oc.resultsUpdated(this);oc=sf.TellMeActor.instance.rf;this.mvc&&oc&&(zc=this.query.O7b,Sc=oc.ZHd,Kc.Rge&&zc>Sc&&(oc.E3f(this.query.Oh),oc.ltg(zc)));oc.taa(vb.length,"RankerInference",Xa.data.ff.toString(),Math.round(window.performance.now()-Pb),vk.a.h_i,!0,pj.a.rWa)}}}e6b(Xa,vb,Pb,oc){oc===this.GR&&(this.oIa(),sf.TellMeActor.instance.rf.taa(vb.length,"RankerInference",Xa.data.ff.toString(),Math.round(window.performance.now()-Pb),vk.a.h_i,!1,pj.a.rWa))}oIa(){-1!==this.S3&&(window.clearTimeout(this.S3),
this.S3=-1)}qDm(Xa){const vb=sf.TellMeActor.instance.rf.n0h(this.Hw,this.query.Oh);var Pb=this.P6.kZ().$Lf;""!==Pb&&(Pb="_"+Pb);Pb=sf.TellMeActor.instance.rf.Z0h("RankerInference"+Pb);const oc=this.GR=nk.a.create().toString();Pb["Client-Request-Id"]=oc;const zc=window.performance.now(),Kc=this.P6.kZ()?this.P6.kZ().C_h:1E3;this.oIa();this.S3=window.setTimeout(()=>{if(oc===this.GR){this.GR="";this.S3=-1;Xa.resultsUpdated(this);const Sc={};Sc[n.a.provider]="Ranker";Sc[n.a.Fzc]=this.query.O7b;sf.TellMeActor.instance.rf.wG(m.a.timedOut,
Kc,Sc)}},Kc);this.Be.Hi(sf.TellMeActor.instance.rf.$0h(),2,vb,Pb,!1,0,Sc=>{this.z6b(Sc,this.query.Oh,zc,Xa,oc,this.P6.kZ())},Sc=>{this.e6b(Sc,this.query.Oh,zc,oc)},null,null,!1,4E3,6E3)}pMm(){var Xa=0,vb=new cd.a,Pb=this.P6.Kmi,oc=this.P6.Lmi;for(var zc=0;zc<this.Hw.length;zc++){var Kc=this.Hw[zc],Sc=Qb.a[Kc.groupType].toLowerCase(),ae=Pb[Sc];Xa+=Kc.results.length;Kc.results.length>ae&&(Sc=oc[Sc],Hj.c(Sc)||vb.add(new Zc.a(Sc,Kc)))}oc=!this.query||""===this.query.Oh.trim();zc=Xa-(oc?this.N5f:this.K5f);
if(!(0>=zc)){oc=window.performance.now();Xa=Xa.toString()+" total,"+zc.toString()+" to remove.";if(0<vb.count)for(vb.Sc((Bd,Rf)=>Bd.key>Rf.key?-1:1),Kc=0;Kc<vb.count&&0<zc;Kc++){Sc=vb.J(Kc).value;ae=Qb.a[Sc.groupType].toLowerCase();let Bd=Sc.results.length-Pb[ae];Bd>zc&&(Bd=zc);0<Bd&&(Sc.zmg(Bd),Xa+=ae+": "+Bd.toString()+" results removed.",zc-=Bd)}if(0<zc){Xa+=zc.toString()+" results left after trimming.";vb=new cd.a;Pb=this.P6.Nmi;for(Kc=0;Kc<this.Hw.length;Kc++)Sc=this.Hw[Kc],ae=Pb[Qb.a[Sc.groupType].toLowerCase()],
Hj.c(ae)||vb.add(new Zc.a(ae,Sc));vb.Sc((Bd,Rf)=>Bd.key<Rf.key?-1:1);for(Pb=0;0<zc;)Kc=vb.J(Pb++).value,zc>=Kc.results.length?(Array.remove(this.Hw,Kc),Xa+=Qb.a[Kc.groupType]+": "+Kc.results.length.toString()+" results force removed.",zc-=Kc.results.length):(Kc.zmg(zc),Xa+=Qb.a[Kc.groupType]+": "+zc.toString()+" results force removed.",zc=0)}sf.TellMeActor.instance.rf&&(vb={},vb[n.a.message]=Xa,sf.TellMeActor.instance.rf.wG("ShowOptimal",window.performance.now()-oc,vb))}}}Object(f.a)(Sl,"CombineResultsUpdatedEventArgs",
null,[1310]);var tj=b(1297);class lc{constructor(Xa,vb,Pb,oc=!1,zc=""){this.G1e=this.z4e=!1;this.yr=Xa;this.uLb=[];this.k9g=vb.length;this.tc=sf.TellMeActor.instance.kZ();this.gNd=oc;this.fNb=zc;this.WXc={};for(Xa=0;Xa<vb.length;++Xa)this.WXc[Xa.toString()]=Pb?0:vb[Xa].hsa()}Etm(Xa,vb){vb&&vb.query&&vb.query.O7b<sf.TellMeActor.instance.vxa||(this.uLb[Xa]=vb,this.G1e?this.z4e=!0:this.NWa())}$Xl(){this.G1e=!0}bPm(){this.G1e=!1;this.z4e&&(this.z4e=!1,this.NWa())}jok(){if(this.uLb.length<this.k9g)return!1;
for(let Xa=0;Xa<this.k9g;++Xa)if(!this.uLb[Xa])return!1;return!0}NWa(){var Xa=this.jok();const vb=window.performance.now(),Pb=new Sl(sf.TellMeActor.instance.SWg);Pb.adm(this.uLb);for(var oc=0;oc<this.uLb.length;++oc){var zc=this.uLb[oc];if(zc&&zc.Hw&&zc.Hw.length&&(Pb.query=zc.query,zc.attributes&&0<zc.attributes.length&&(Pb.attributes=zc.attributes),zc&&zc.Hw&&(Xa||this.e5j(oc,this.uLb))))for(const Kc of zc.Hw)Pb.NF(Kc)}Pb.Hw&&Pb.Hw.length&&(Pb.mvc=Xa,this.tc&&this.tc.Lze&&Pb.pMm(),tj.a.hfi()&&(this.tc&&
this.tc.Kei&&Pb.query.Oh&&0<Pb.query.Oh.length?Pb.pDm():Pb.oDm()),this.yr.resultsUpdated(Pb),tj.a.hfi()&&this.tc&&this.tc.AYf&&this.gNd&&Pb.query.Oh&&0<Pb.query.Oh.length&&Pb.mvc&&this.fNb!==c.a.contextMenu&&Pb.qDm(this.yr),Xa=sf.TellMeActor.instance.rf,Pb.mvc&&Xa&&(oc=Pb.query.O7b,zc=Xa.ZHd,Pb.query.Oh&&0<Pb.query.Oh.length&&this.gNd&&this.tc.Rge&&this.fNb!==c.a.contextMenu&&oc>zc&&!this.tc.AYf&&(Xa.E3f(Pb.query.Oh),Xa.ltg(oc)),Xa.wG(m.a.Jim,window.performance.now()-vb)))}e5j(Xa,vb){if(!(this.WXc&&
Xa.toString()in this.WXc)||vb.length<=Xa||!vb[Xa])return!1;if(!vb[Xa].Hw.length)return!0;const Pb=this.WXc[Xa.toString()];if(!Pb)return!0;const oc=this.WXc;for(let Kc in oc){var zc=oc[Kc];const Sc=Number.parseInvariant(Kc);if(Sc!==Xa&&zc===Pb&&!(vb.length>Sc&&vb[Sc]))return!1}return!0}}Object(f.a)(lc,"ResultsAggregator",null,[]);var Nk=b(1435);class Mf{constructor(){this.eFc=this.fFc=this.dFc=this.logCount=this.logRank=this.invertedRank=0}zJj(Xa,vb){switch(Xa){case 1:this.invertedRank=vb;break;case 3:this.logRank=
vb;break;case 2:this.logCount=vb;break;case 5:this.dFc=vb;break;case 4:this.fFc=vb;break;case 6:this.eFc=vb}}}Object(f.a)(Mf,"CommandFeatures",null,[]);class jn{constructor(Xa){this.QUg=0;this.Kuj=Xa;this.Kij={}}get modelId(){return this.Kuj}get featureIntercept(){return this.QUg}get u3c(){return this.Kij}SIj(Xa,vb,Pb){vb?(this.u3c[Xa]||(this.u3c[Xa]=new Mf),this.u3c[Xa].zJj(vb,Pb)):this.QUg=Pb}}Object(f.a)(jn,"CoefficientsModel",null,[]);const Ja=(Xa,vb)=>Math.pow(10,-vb/(60*Math.LN10/Math.LN2*Xa));
class sb{constructor(Xa,vb){this.Eh=1;this.zJd=new Mf;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=Xa?1/Xa:0;this.features.logRank=2/Math.pow(2,Xa);this.features.dFc=Ja(10,vb);this.features.fFc=Ja(2,vb);this.features.eFc=Ja(1,vb)}get count(){return this.Eh}get features(){return this.zJd}ltc(){this.Eh=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}tTm(Xa){const vb=2/Math.pow(2,Xa);this.features.invertedRank=Math.max(this.features.invertedRank,
Xa?1/Xa:0);this.features.logRank=Math.max(this.features.logRank,vb)}vUm(Xa){const vb=Ja(10,Xa),Pb=Ja(2,Xa);Xa=Ja(1,Xa);this.features.dFc=Math.max(this.features.dFc,vb);this.features.fFc=Math.max(this.features.fFc,Pb);this.features.eFc=Math.max(this.features.eFc,Xa)}}Object(f.a)(sb,"CommandModel",null,[]);class Yb{constructor(Xa){this.DJc=null;if(!Xa&&sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("PredictionEngine","IModelAdapter can't be null");this.Shc=Xa;this.IOd=this.D2f()}D2f(){const Xa=
this.Shc.mTk(),vb=this.Shc.LJf();if(void 0===Xa||null===Xa||void 0===vb||null===vb)return!1;try{window.performance.now();this.DJc={};for(let Pb=0;Pb<Xa.length;Pb++){const oc=Xa[Pb],zc=vb[oc[0].toString()].trim(),Kc=oc[1],Sc=Kc?vb[oc[2].toString()].trim():"",ae=oc[3];zc in this.DJc||(this.DJc[zc]=new jn(zc));this.DJc[zc].SIj(Sc,Kc,ae)}}catch(Pb){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("LoadModelData","Error Loading Suggestions Model: "+Pb);return!1}return!0}AEk(){const Xa=
this.Shc.PQk(),vb={};if(!Xa)return vb;let Pb=1;for(let oc=0;oc<Xa.length;oc++){const zc=Xa[oc];zc.Id in vb?(vb[zc.Id].ltc(),vb[zc.Id].tTm(Pb),vb[zc.Id].vUm(zc.TimeElapsedSinceClick)):vb[zc.Id]=new sb(Pb,zc.TimeElapsedSinceClick);Pb++}return vb}BYf(){this.IOd||(this.IOd=this.D2f());return this.IOd}fXk(){let Xa=[];if(!this.IOd){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("GetPredictedCommands","IModelAdapter returned no data");return Xa}const vb=this.AEk(),Pb=this.DJc;for(let zc in Pb){const Kc=
Pb[zc],Sc=Kc.modelId;let ae=0;for(let Bd in vb){var oc=Bd;const Rf=vb[Bd].features;(oc=oc in Kc.u3c?Kc.u3c[oc]:null)&&(ae+=Rf.invertedRank*oc.invertedRank+Rf.logRank*oc.logRank+Rf.logCount*oc.logCount+Rf.dFc*oc.dFc+Rf.fFc*oc.fFc+Rf.eFc*oc.eFc)}ae+=Kc.featureIntercept;Xa.push(new gh.a(Sc,ae))}Xa.sort((zc,Kc)=>zc.score<Kc.score?1:zc.score>Kc.score?-1:0);0<Xa.length-10&&(Xa=Xa.slice(0,10));return Xa}}Object(f.a)(Yb,"PredictionEngine",null,[]);class vc{constructor(){this.Pah={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}W8d(Xa,vb){return vb&&"word"===vb.application.toLowerCase()&&
Xa in this.Pah?this.Pah[Xa]:[]}}Object(f.a)(vc,"SuggestionResultsUtility",null,[]);class $c{constructor(Xa,vb,Pb){this.tc=vb;this.jSc=new Yb(Xa);this.tca=Pb;this.fdh=new vc}C$(){return"Suggestion"}hsa(){return this.tc.IL?1===this.tc.IL?1:2:0}H6(Xa,vb,Pb,oc=c.a.tellMe,zc=null){Pb=new v.a(Xa);sf.TellMeActor.instance.FDd=!1;if((!zc||Array.contains(zc,15))&&qd.a.lAa(Xa)){if(!this.jSc.BYf()){if(sf.TellMeActor.instance.rf)sf.TellMeActor.instance.rf.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.vge()&&0<this.fdh.W8d(sf.TellMeActor.instance.v3d,this.tc).length){const Sc=this.fdh.W8d(sf.TellMeActor.instance.v3d,this.tc);zc=[];for(var Kc of Sc)this.tc.shb&&"Find"===Kc||zc.push(new gh.a(Kc,0));sf.TellMeActor.instance.FDd=!0}else zc=this.jSc.fXk();Ne.logCommandSuggestions(zc,!0,"Recommended","LRE");Kc=[];for(const Sc of zc)this.tca&&this.tca.qpf(Sc.commandId)||Kc.push(Sc);Xa=Ne.getResultGroup(Xa,Kc,this.tc,
null,null,null,15);0<Xa.results.length&&oc!==c.a.contextMenu&&(Xa.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<Xa.results.length&&Pb.NF(Xa)}vb.resultsUpdated(Pb)}vge(){return!!this.tc&&this.tc.vge}}Object(f.a)($c,"SuggestionResultsProvider",null,[1334]);class Md{PQk(){return sf.TellMeActor.instance.nKe}mTk(){return window.TellMeSuggestionModel}LJf(){return window.CoefficientModelIdMap}}Object(f.a)(Md,"SuggestionsModelAdapter",null,[1361]);var Re=b(1416);b.d(H,"AggregatorResultsProvider",
function(){return Qf});class Qf{constructor(Xa=!1){this.ejc={};this.ejc[c.a.tellMe]=[];this.ejc[c.a.contextMenu]=[];this.gNd=Xa}Cgi(Xa,vb,Pb,oc,zc=null){let Kc;var Sc=!1;switch(oc){case c.a.contextMenu:Kc=this.ejc[c.a.contextMenu];Sc=!0;break;default:Kc=this.ejc[c.a.tellMe]}vb=new lc(vb,Kc,Sc,this.gNd,oc);vb.$Xl();for(Sc=0;Sc<Kc.length;++Sc){const Bd=window.performance.now();var ae=new x(vb,Sc);Kc[Sc].H6(Xa,ae,Pb,oc,zc);sf.TellMeActor.instance.rf&&(ae={},ae[n.a.provider]=Kc[Sc].C$(),ae[n.a.Fzc]=Xa.O7b,
sf.TellMeActor.instance.rf.wG(m.a.H6,window.performance.now()-Bd,ae))}vb.bPm()}C$(){return"Aggregator"}hsa(){return 0}H6(Xa,vb,Pb=!1,oc=c.a.tellMe,zc=null){if(sf.TellMeActor.instance.AGl)this.Cgi(Xa,vb,Pb,oc,zc);else{const Kc=window.performance.now();sf.TellMeActor.instance.sXm.then(()=>{sf.TellMeActor.instance.rf&&sf.TellMeActor.instance.rf.wG(m.a.BGl,window.performance.now()-Kc);this.Cgi(Xa,vb,Pb,oc,zc);return!0})}}L0(Xa,vb){this.ejc[vb].push(Xa)}$Jj(Xa){switch(Xa){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const vb=
this.ejc[c.a.tellMe];for(const Pb of vb)if("FindInDocument"===Pb.C$()){Pb.msm(Xa);break}}}static createInstance(Xa,vb,Pb,oc){const zc=oc&&qd.a.Lwg(vb);var Kc=zc&&vb.jcg;const Sc=new Qf(zc);if(vb.sUi){var ae=new aj(vb);Sc.L0(ae,c.a.tellMe)}ae=vb.Eo?Eh.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):Eh.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const Bd=!ae&&Eh.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");Sc.L0(new bf.a(Xa,vb.HNm,Bd,!1),c.a.tellMe);
ae&&Sc.L0(new $c(new Md,vb,Xa),c.a.tellMe);Xa=Eh.AFrameworkApplication.pa.mb.X_f?new Sh(vb,new Fg):new qi(vb,Pb);Sc.L0(Xa,c.a.contextMenu);(zc&&vb.kcg||Kc)&&Sc.L0(Re.a.bDh(vb,!0),c.a.tellMe);Sc.L0(Xa,c.a.tellMe);!vb.UMh||"Word"===vb.application&&vb.a7d||Sc.L0(new Xj(vb),c.a.tellMe);vb.n7a&&(Kc=new t(vb),Sc.L0(Kc,c.a.tellMe),Sc.L0(Kc,c.a.contextMenu));!vb.TOb||vb.wyd||vb.vyd||Sc.L0(new A.a(vb),c.a.tellMe);oc&&(vb.LN||qd.a.fXa())&&(Kc=new Oi(vb),Sc.L0(Kc,c.a.tellMe),Sc.L0(Kc,c.a.contextMenu));zc&&Sc.L0(Re.a.bDh(vb,
!1),c.a.tellMe);oc&&!vb.gBg&&qd.a.Kwg(vb)&&(Sc.L0(new Nk.a(vb),c.a.tellMe),vb.LYi&&Sc.L0(new Nk.a(vb),c.a.contextMenu));return Sc}}Object(f.a)(Qf,"AggregatorResultsProvider",null,[1334])},1430:function(z,H,b){z=b(0);var f=b(15),c=b(4),n=b(111),m=b(151),x=b(282),y=b(505),v=b(48),t=b(55),A=b(567),D=b(488),U=b(434),F=b(391),E=b(1407),P=b(1408),G=b(1404),K=b(1406),S=b(1405),L=b(566),I=b(487);class O{constructor(Ba,Ga,ja){this.uPh=Ba;this.Hph=Ga;this.Juh=ja}}Object(z.a)(O,"BacktraceAndMakeUpdateHintsInput",
null,[]);var M=b(1175),R;(function(Ba){Ba[Ba.EOP=0]="EOP";Ba[Ba.character=1]="character";Ba[Ba.embeddedMarker=2]="embeddedMarker"})(R||(R={}));Object(z.b)("LCSBlockType",R);class W{toString(){return String.format("[Type: {0}]",R[this.type])}}Object(z.a)(W,"ALCSBlock",null,[]);class Y extends W{constructor(Ba,Ga){super();this.uJe=Ga;this.m1e=Ba}get type(){return 1}get character(){return this.uJe}get Hl(){return this.m1e}jz(Ba){return 1===Ba.type&&M.a.Ynh(Ba.character,this.character)}toString(){return String.format("{0} [Char: {1}]",
super.toString(),this.character)}}Object(z.a)(Y,"CharacterLCSBlock",W,[]);class N{constructor(Ba){this.LW=0;this.Hl=null;this.Gb=0;this.JTa=Ba}}Object(z.a)(N,"CurrentParagraphState",null,[]);class aa extends W{constructor(Ba,Ga,ja,X){super();this.m1e=Ba;this.qP=Ga;this.nFa=ja;this.Fzj=X}get type(){return 0}get Gb(){return this.qP}get length(){return this.nFa}get Hl(){return this.m1e}jz(Ba){return Ba.type?!1:this.Fzj?Ba.Hl===this.Hl&&Ba.Gb===this.Gb:Ba.Gb===this.Gb}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",
super.toString(),this.Hl.toString(),this.Gb,this.length)}}Object(z.a)(aa,"EOPLCSBlock",W,[]);class ia extends Y{constructor(Ba,Ga,ja){super(Ba,"\ufffc");this.AYe=Ga;this.dKd=ja}get type(){return 2}get Io(){return this.AYe}get Eg(){return this.dKd}jz(Ba){return 2!==Ba.type?!1:Ba.Io===this.Io&&this.Eg.equals(Ba.Eg)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),this.Io,this.Eg)}}Object(z.a)(ia,"EmbeddedMarkerLCSBlock",Y,[]);class ea{constructor(Ba,Ga){this.x=Ba;this.y=
Ga}equals(Ba){return Ba.x===this.x&&Ba.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(z.a)(ea,"IntPair",null,[533]);var la=b(1233),xa=b(1208);class Ha{constructor(){this.block=null;this.Dqf=0}}Object(z.a)(Ha,"ParagraphToSkip",null,[]);var ua=b(1234),Ra=b(1403);b.d(H,"a",function(){return ab});class ab{constructor(Ba,Ga){this.Wf=Ba;this.Qc=Ga;this.qtj=Ga.runtime.Qa?Ga.runtime.Qa.isFeatureEnabled(109):!1}gDh(Ba,Ga,ja,X,fa,pa,Ia){let ta;ta=null;({f9c:Ga,returnValue:Ba}=this.Drc(Ba,Ga));
if(!Ba)return n.a.instance.Ba(593826840,1,2,"Failed to get LCS blocks from objects for base"),this.Qc.ma.UL("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ta};({f9c:X,returnValue:ja}=this.Drc(ja,X));if(!ja)return n.a.instance.Ba(593826839,1,2,"Failed to get LCS blocks from objects for changed"),this.Qc.ma.UL("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ta};this.Qc.ma.UL("GetLCSBlocksFromObject");ta=this.Rik(Ba,ja,Ga,X,fa,pa,Ia);return ta?{returnValue:!0,updateHints:ta}:(n.a.instance.Ba(593826838,
1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ta})}hDh(Ba,Ga,ja,X,fa,pa,Ia){let ta;ta=null;({returnValue:Ba}=this.Drc(Ba,Ga));if(!Ba)return n.a.instance.Ba(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.Qc.ma.UL("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ta};({returnValue:ja}=this.Drc(ja,X));if(!ja)return n.a.instance.Ba(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Qc.ma.UL("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ta};
this.Qc.ma.UL("GetLCSBlocksFromObject");ta=this.Sik(Ba,ja,fa,pa,Ia);return ta?{returnValue:!0,updateHints:ta}:(n.a.instance.Ba(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ta})}NMh(Ba,Ga,ja,X){({returnValue:Ba}=this.Drc(Ba,Ga));if(!Ba)return-1;({returnValue:ja}=this.Drc(ja,X));if(!ja)return-1;({C3d:ja}=this.KBf(Ba,ja));return ja}Drc(Ba,Ga){let ja;const X=new m.a;ja=new m.a;if(!Ba.length)return n.a.instance.Ba(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),
this.Qc.ma.uf(Object.assign(new la.a,{Mh:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,f9c:ja};for(let Ia=0;Ia<Ba.length;Ia++)if(393230===Ba.J(Ia).Kb){const ta=this.Wf.getPropertyString(Ba.J(Ia),f.a.ml),oa=this.Wf.getPropertyUint32(Ba.J(Ia),c.a.Gb);if(null==oa)return n.a.instance.Ba(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Qc.ma.uf(Object.assign(new la.a,{Mh:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,f9c:ja};let va=this.Wf.getPropertyUint32s(Ba.J(Ia),
f.a.hA);va=xa.a.jRi(va,ta.length);const Fa=this.Wf.getPropertyObjectIds(Ba.J(Ia),f.a.BC);let cb;for(cb=0;cb<va.length-1;cb++){var fa=Ga(Fa.Ve(cb)),pa=void 0;pa=fa?(pa=this.Wf.getPropertyBool(fa,f.a.d3))?pa:!1:!1;if(pa)X.add(this.yek(Ba.J(Ia).id,fa));else for(fa=va.Ve(cb);fa<va.Ve(cb+1);fa++)X.add(new Y(Ba.J(Ia).id,M.a.charAt(ta,fa)))}X.add(new aa(Ba.J(Ia).id,oa,va.J(cb),this.qtj));ja.add(X.length-1)}else return n.a.instance.Ba(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",
Ba.J(Ia).Kb),this.Qc.ma.uf(Object.assign(new la.a,{Mh:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,f9c:ja};this.Qc.runtime.jF("LCS: GetLCSBlocks for base");return{returnValue:X,f9c:ja}}yek(Ba,Ga){const ja=null==this.Wf.getPropertyInt32(Ga,c.a.tq)?0:this.Wf.getPropertyInt32(Ga,c.a.tq);return new ia(Ba,ja,Ga.id)}Rik(Ba,Ga,ja,X,fa,pa,Ia){pa=({C3d:fa}=this.KBf(Ba,Ga,fa,pa,Ia)).returnValue;this.Qc.ma.UL("FindFurthestPaths");Ba=this.CVj(new O(pa,Ba,Ga),ja,X,fa);this.Qc.ma.UL("BacktraceAndMakeUpdateHints");
return Ba}Sik(Ba,Ga,ja,X,fa){X=({C3d:ja}=this.KBf(Ba,Ga,ja,X,fa)).returnValue;this.Qc.ma.UL("FindFurthestPaths");Ba=new O(X,Ba,Ga);Ba=new Ra.a(this.DVj(Ba,ja),1);this.Qc.ma.UL("BacktraceAndMakeUpdateHints");return Ba}KBf(Ba,Ga,ja=-1,X=-1,fa=-1){let pa;if(-1===ja||-1===X||-1===fa)fa=X=ja=-1;pa=-1;const Ia=new x.a;Ia.W(new ea(-1,1),new ea(0,-1));if(-1!==ja){Ia.W(new ea(0,0),new ea(ja,ja));var ta=1}else ta=0,X=Ba.length,fa=Ga.length;for(ja=0;ta<=Ba.length+Ga.length;ta++){let oa=!1;for(let va=-ta;va<=
ta;va+=2){let Fa,cb;va===-ta?(Fa=Ia.J(new ea(ta-1,va+1)).x,cb=Ia.J(new ea(ta-1,va+1)).y+1):va===ta?(Fa=Ia.J(new ea(ta-1,va-1)).x+1,cb=Ia.J(new ea(ta-1,va-1)).y):Ia.J(new ea(ta-1,va-1)).x>=Ia.J(new ea(ta-1,va+1)).x?(Fa=Ia.J(new ea(ta-1,va-1)).x+1,cb=Ia.J(new ea(ta-1,va-1)).y):(Fa=Ia.J(new ea(ta-1,va+1)).x,cb=Ia.J(new ea(ta-1,va+1)).y+1);for(;Fa<X&&cb<fa&&Ba.J(Fa).jz(Ga.J(cb));)Fa++,cb++;Ia.W(new ea(ta,va),new ea(Fa,cb));if(Fa===X&&cb===fa){oa=!0;pa=ta;ja=va;break}}if(oa)break;this.Qc.runtime.jF("LCS FindFurthestPaths")}if(ja!==
X-fa)return{returnValue:null,C3d:pa};Ia.W(new ea(pa,ja),new ea(X+1,fa+1));n.a.instance.Ba(593826837,1,3,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",Ba.length,Ga.length,pa);return{returnValue:Ia,C3d:pa}}CVj(Ba,Ga,ja,X){const fa=Ba.uPh,pa=Ba.Hph;Ba=Ba.Juh;const Ia=new Ra.a(new m.a,1);let ta=ja.length-1,oa=ja.J(ta);const va=Object.assign(new Ha,{block:null,Dqf:-1});var Fa=pa.J(pa.length-1),cb=new y.a;for(var Za=0;Za<Ga.length;Za++)cb.add(pa.J(Ga.J(Za)).Hl);
Fa=Object.assign(new N(cb),{LW:Fa.length,Hl:Fa.Hl,Gb:Fa.Gb});cb=pa.length;for(Za=Ba.length;0<cb||0<Za;){const Ya=cb-1,fb=Za-1;if(Ba.J(oa).type)return n.a.instance.Ba(594124866,1,2,"Abandoning LCS due to unexpected non-EOP block"),this.Qc.ma.uf(Object.assign(new la.a,{Mh:"BacktraceAndMakeUpdateHints",eventId:"900bc"})),null;const ib=Ba.J(oa);if(this.nzi(fa,X,cb,Za)){var gb=Ba.J(fb);if(1===gb.type||2===gb.type)this.IIj(Ia,Fa,gb);else{if(gb.type)return n.a.instance.Ba(594124869,1,2,"Abandoning LCS due to unexpected block to insert of type {0}",
gb.type),this.Qc.ma.uf(Object.assign(new la.a,{Mh:"BacktraceAndMakeUpdateHints",eventId:"900bf"})),null;if(gb===va.block)ab.GCm(va.Dqf,Fa,gb),va.block=null;else if(!va.block&&Za<Ba.length&&0<cb&&Ba.J(Za).type&&pa.J(Ya).type){if(!this.splitPara(Ba,ja,Ia,ta,va,Fa,ib,gb))return n.a.instance.Ba(594060172,1,2,"Abandoning LCS due to inability to find above new EOP"),this.Qc.ma.uf(Object.assign(new la.a,{Mh:"BacktraceAndMakeUpdateHints",eventId:"90kom"})),null}else this.addPara(pa,Ia,va,Fa,Ya,gb)}Za--;X--}else if(this.mzi(fa,
X,cb,Za)){gb=pa.J(Ya);if(1===gb.type||2===gb.type)this.deleteText(Ia,Fa,gb);else{if(gb.type)return n.a.instance.Ba(594124868,1,2,"Abandoning LCS due to unsupported missing block of type {0}",gb.type),this.Qc.ma.uf(Object.assign(new la.a,{Mh:"BacktraceAndMakeUpdateHints",eventId:"900be"})),null;const hb=this.Apl(gb.Hl,Ba,ja);if(hb||gb.length)if(gb.Gb!==Fa.Gb)hb?this.mergePara(Ia,Fa,gb):this.sFl(Ia,Fa,gb,Ya,pa)||(n.a.instance.Ba(591140042,1,2,""),this.Qc.ma.uf(Object.assign(new la.a,{Mh:"MergeParaMoveText",
eventId:""})));else return n.a.instance.Ba(594124867,1,2,"Abandoning LCS due to unexpected missing EOP block"),this.Qc.ma.uf(Object.assign(new la.a,{Mh:"BacktraceAndMakeUpdateHints",eventId:"900bd"})),null;else this.deletePara(Ia,Fa,gb,pa,Ga,Ya)}cb--;X--}else if(cb&&Za&&pa.J(Ya).jz(Ba.J(fb)))cb--,Za--,ab.R1l(pa,Ba,Fa,Ya,fb);else return n.a.instance.Ba(594124870,1,2,"Abandoning LCS due to being unable to find a path"),this.Qc.ma.uf(Object.assign(new la.a,{Mh:"BacktraceAndMakeUpdateHints",eventId:"900bg"})),
null;0<fb&&fb<Ba.length&&!Ba.J(fb).type&&Ba.J(fb)!==ib&&(ta--,oa=fb)}this.Qc.runtime.jF("LCS: CreateUpdateHintsFromLCSBlocks");return Ia}DVj(Ba,Ga){const ja=Ba.uPh,X=Ba.Hph;Ba=Ba.Juh;const fa=new m.a;let pa=X.length,Ia=Ba.length;for(;0<pa||0<Ia;){var ta=pa-1,oa=Ia-1;if(this.nzi(ja,Ga,pa,Ia)){ta=Ba.J(oa);if(1===ta.type||2===ta.type)this.jhl(fa,pa,ta);else{if(ta.type)return n.a.instance.Ba(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ta.type),this.Qc.ma.uf(Object.assign(new ua.a,
{Mh:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;this.Pgl(fa,pa,ta)}Ia--;Ga--}else if(this.mzi(ja,Ga,pa,Ia)){oa=X.J(ta);if(1===oa.type||2===oa.type)this.Bmk(fa,ta,oa);else{if(oa.type)return n.a.instance.Ba(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",oa.type),this.Qc.ma.uf(Object.assign(new ua.a,{Mh:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;this.qmk(fa,ta,oa)}pa--;Ga--}else if(pa&&Ia&&X.J(ta).jz(Ba.J(oa)))pa--,Ia--;else return n.a.instance.Ba(575706454,
1,2,"Abandoning LCS due to being unable to find a path"),this.Qc.ma.uf(Object.assign(new ua.a,{Mh:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.Qc.runtime.jF("LCS: CreateUpdateHintsFromLCSBlocks");return fa}mzi(Ba,Ga,ja,X){Ga=new ea(Ga-1,ja-X-1);return Ba.Pa(Ga)&&Ba.J(Ga).x===ja-1&&Ba.J(Ga).y===X}nzi(Ba,Ga,ja,X){Ga=new ea(Ga-1,ja-X+1);return Ba.Pa(Ga)&&Ba.J(Ga).x===ja&&Ba.J(Ga).y===X-1}addPara(Ba,Ga,ja,X,fa,pa){var Ia=null;ja.block?Ia=ja.block.Hl:0<=fa&&!Ba.J(fa).type&&(Ia=Ba.J(fa).Hl);ja=
Ba=pa.Hl;if(X.JTa.contains(Ba))for(fa=0,Ba=v.a.pe("{00000000-0000-0000-0000-000000000000}{"+fa+"}");X.JTa.contains(Ba);)fa++,Ba=v.a.pe("{00000000-0000-0000-0000-000000000000}{"+fa+"}");Ia=new A.AddParagraphUpdateHint(Ba,pa.Gb,Ia);Ia.$Ul=ja;Ga.updateHints.add(Ia);X.Hl=Ba;X.Gb=pa.Gb;X.JTa.add(Ba);X.LW=0}Pgl(Ba,Ga,ja){ja=new G.a(ja.Hl,ja.Gb);let X=!1;if(0<Ba.length&&11===Ba.Ve(Ba.length-1).type){const fa=Ba.Ve(Ba.length-1);fa.cp===Ga&&(X=!0,fa.O1.add(ja))}X||(Ga=new S.a(Ga),Ga.O1.add(ja),Ba.add(Ga))}splitPara(Ba,
Ga,ja,X,fa,pa,Ia,ta){Ba=this.vzk(pa.Hl,Ba,Ga,X);if(!Ba)return!1;Ga=new I.a(pa.Hl,pa.Gb,pa.LW,Ba.Hl,Ba.Gb,Ia.Hl,Ia.Gb);ja.updateHints.add(Ga);pa.Gb=Ba.Gb;Ba!==ta?(fa.block=Ba,fa.Dqf=pa.LW,fa=new A.AddParagraphUpdateHint(ta.Hl,ta.Gb,Ba.Hl),ja.updateHints.add(fa),pa.Hl=ta.Hl,pa.Gb=ta.Gb,pa.JTa.add(ta.Hl),pa.LW=0):pa.JTa.add(Ia.Hl);return!0}IIj(Ba,Ga,ja){let X=!1;if(0<Ba.updateHints.length&&1===Ba.updateHints.Ve(Ba.updateHints.length-1).type){const fa=Ba.updateHints.Ve(Ba.updateHints.length-1);fa.nf.equals(Ga.Hl)&&
fa.cp===Ga.LW&&(fa.text=ja.character.toString()+fa.text,X=!0)}X||Ba.updateHints.add(new F.a(Ga.Hl,Ga.LW,ja.character.toString()))}jhl(Ba,Ga,ja){var X=!1;if(0<Ba.length&&11===Ba.Ve(Ba.length-1).type){const fa=Ba.Ve(Ba.length-1);fa.cp===Ga&&((X=Object(t.a)(K.a,fa.O1.J(fa.O1.length-1)))?X.text=ja.character.toString()+X.text:fa.O1.add(new K.a(ja.Hl,ja.character.toString())),X=!0)}X||(Ga=new S.a(Ga),Ga.O1.add(new K.a(ja.Hl,ja.character.toString())),Ba.add(Ga))}deletePara(Ba,Ga,ja,X,fa,pa){let Ia=-1;for(let ta=
0;ta<fa.length;ta++)if(fa.J(ta)===pa){0<ta&&(Ia=ta-1);break}pa=null;0<=Ia&&(pa=X.J(fa.J(Ia)));X=new D.a(ja.Hl,ja.Gb,pa?pa.Hl:null);Ba.updateHints.add(X);pa&&Ga.Hl.equals(ja.Hl)&&(Ga.LW=pa.length,Ga.Hl=pa.Hl,Ga.Gb=pa.Gb);Ga.JTa.remove(ja.Hl)}qmk(Ba,Ga,ja){Ga=new E.a(Ga,ja.Hl,ja.Gb);Ba.add(Ga)}mergePara(Ba,Ga,ja){Ba.updateHints.add(new L.MergeParagraphUpdateHint(ja.Hl,ja.Gb,ja.length,Ga.Hl,Ga.Gb,ja.Hl,Ga.Gb));Ga.LW=ja.length;Ga.JTa.remove(Ga.Hl);Ga.Hl=ja.Hl}sFl(Ba,Ga,ja,X,fa){let pa=null;for(var Ia=
X-1;0<=Ia;Ia--)if(!fa.J(Ia).type){pa=fa.J(Ia);break}let ta;if(!({sdg:Ia,xKg:ta}=this.Ezk(Ba,X,ja,fa)).returnValue)return!1;X=this.b2k(X,fa);Ba.updateHints.add(new U.DeleteTextUpdateHint(ja.Hl,0,X));Ba.updateHints.add(new D.a(ja.Hl,ja.Gb,pa?pa.Hl:null));Ba.updateHints.add(new F.a(Ia,0,X));Ga.LW+=X.length;Ga.JTa.remove(ja.Hl);Ga.Hl=Ia;Ga.Gb=ta;return!0}Ezk(Ba,Ga,ja,X){var fa=null;for(Ga+=1;Ga<X.length;Ga++)if(!X.J(Ga).type){fa=X.J(Ga);break}X=null;for(Ga=Ba.updateHints.length-1;0<=Ga&&!(X=Object(t.a)(A.AddParagraphUpdateHint,
Ba.updateHints.J(Ga)));Ga--);return X&&X.Zr===ja.Hl?(Ba=X.nf,fa=X.Gb,{returnValue:!0,sdg:Ba,xKg:fa}):fa?(Ba=fa.Hl,fa=fa.Gb,{returnValue:!0,sdg:Ba,xKg:fa}):{returnValue:!1,sdg:null,xKg:0}}Apl(Ba,Ga,ja){for(let X=0;X<ja.length;X++)if(Ga.J(ja.J(X)).Hl.equals(Ba))return!0;return!1}b2k(Ba,Ga){let ja="";for(--Ba;0<=Ba;Ba--){const X=Object(t.a)(aa,Ga.J(Ba)),fa=Object(t.a)(Y,Ga.J(Ba));if(X)break;else fa&&(ja=fa.character+ja)}return ja}deleteText(Ba,Ga,ja){let X=!1;if(0<Ba.updateHints.length&&2===Ba.updateHints.Ve(Ba.updateHints.length-
1).type){const fa=Ba.updateHints.Ve(Ba.updateHints.length-1);fa.nf.equals(Ga.Hl)&&fa.cp===Ga.LW&&(fa.cp=Ga.LW-1,fa.text=ja.character.toString()+fa.text,X=!0)}X||Ba.updateHints.add(new U.DeleteTextUpdateHint(Ga.Hl,Ga.LW-1,ja.character.toString()));--Ga.LW}Bmk(Ba,Ga,ja){let X=!1;if(0<Ba.length&&8===Ba.Ve(Ba.length-1).type){const fa=Ba.Ve(Ba.length-1);fa.cp===Ga+1&&(fa.text=ja.character.toString()+fa.text,--fa.cp,X=!0)}X||Ba.add(new P.a(Ga,ja.character.toString()))}vzk(Ba,Ga,ja,X){for(;0<=X;){var fa=
Ga.J(ja.J(X));if(fa.type)break;if(fa.Hl.equals(Ba))return fa;X--}return null}static GCm(Ba,Ga,ja){Ga.Hl=ja.Hl;Ga.Gb=ja.Gb;Ga.LW=Ba}static R1l(Ba,Ga,ja,X,fa){Ba.J(X).type?--ja.LW:(Ba=Ba.J(X),ja.Hl=Ba.Hl,ja.Gb=Ba.Gb,ja.LW=Ba.length,Ga=Ga.J(fa),Ga.Hl!==Ba.Hl&&(ja.JTa.remove(Ba.Hl),ja.JTa.add(Ga.Hl)))}}Object(z.a)(ab,"LCSUpdateHintGenerator",null,[])},1434:function(z,H,b){b.r(H);z=b(0);var f=b(15),c=b(4),n=b(111),m=b(282),x=b(505),y=b(151),v=b(48),t=b(40),A=b(1161);class D extends A.a{constructor(){super()}get Fra(){return"ChildNodeListMerge"}}
Object(z.a)(D,"ChildNodeListMergeFailureDetail",A.a,[]);class U{GCb(N,aa,ia){return aa.gz(N,ia.J(N))}m2i(N,aa,ia,ea){let la;return({value:la}=aa.xb(N)).returnValue||({value:la}=ia.xb(N)).returnValue?la:ea.J(N)}}Object(z.a)(U,"ChildNodeListMergeUtils",null,[1834]);var F=b(1197),E=b(1453),P=b(1294);class G{constructor(N,aa){this.classId=N;this.$Nm=aa}}Object(z.a)(G,"NodeChildrenTransformation",null,[]);var K=b(701),S=b(1176);class L{constructor(N,aa,ia){this.sE=N;this.Bva=ia;this.f$=aa}Lpe(N){let aa,
ia;return({XBi:aa}=this.o2i(this.Bva,N)).returnValue&&aa.qT||({XBi:ia}=this.o2i(this.f$,N)).returnValue&&ia.qT}o2i(N,aa){let ia;return{returnValue:({value:ia}=(new S.a(this.sE,N)).Fga.xb(K.a.eb(aa))).returnValue,XBi:ia}}}Object(z.a)(L,"NodeTriplet",null,[]);var I=b(1402);class O{constructor(N,aa,ia){this.Qc=N;this.Wf=aa;this.v9=ia;this.cdh=!0}get Jm(){return this.Qc}get Vc(){return this.Wf}get HCa(){return this.v9}get success(){return this.cdh}FWk(){n.a.instance.Ba(4220310,1,4,"Evaluating ParentObjects");
const N=new m.a;this.ojf(N,aa=>this.Jm.runtime.pj.J(aa));this.ojf(N,aa=>this.HCa.GCb(aa,this.Jm.runtime.Aw,this.Jm.runtime.pj));this.ojf(N,aa=>this.HCa.GCb(aa,this.Jm.runtime.wp,this.Jm.runtime.pj));return N}ojf(N,aa){const ia=aa(b(1434).ChildNodeListMerge.ioe);this.Vc.getPropertyObjectIds(ia,f.a.$e).forEach(ea=>{this.Vc.getPropertyObjectIds(aa(ea),f.a.$e).forEach(la=>{N.Pa(la)&&!ea.equals(N.J(la))&&(this.cdh=!1,n.a.instance.Ba(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
la,ea,N.J(la)));N.W(la,ea);return!0});return!0})}}Object(z.a)(O,"OutlineGroupParentFinder",null,[]);var M=b(1162),R=b(1235),W=b(1295);b.d(H,"ChildNodeListMerge",function(){return Y});class Y{constructor(N,aa=null,ia=null,ea=null,la=null){this.Wf=N;this.LWl=aa||E.a.F2i;this.Tke=ia||this.vUk();this.HCa=ea||new U;this.goi=la||this.USk()}get Vc(){return this.Wf}vUk(){return[new G(393227,Object(t.a)(this,this.XVl,"pageContentNodeThreewayChildMerge")),new G(1073872968,Object(t.a)(this,this.vYm,"wordSectionNodeThreewayChildMerge")),
new G(393241,Object(t.a)(this,this.boe,"outlineElementContainerThreewayChildMerge")),new G(393252,Object(t.a)(this,this.LHm,"tableCellThreewayChildMergev2")),new G(1074135125,Object(t.a)(this,this.boe,"outlineElementContainerThreewayChildMerge")),new G(1074135123,Object(t.a)(this,this.boe,"outlineElementContainerThreewayChildMerge")),new G(1074135127,Object(t.a)(this,this.boe,"outlineElementContainerThreewayChildMerge"))]}USk(){return[Object(t.a)(this,this.f0l,"prepareObjectGroupings"),Object(t.a)(this,
this.z7k,"handleInterOutlineGroupMerge"),Object(t.a)(this,this.uYl,"performThreewayChildMerge")]}gFl(N){let aa=0;for(;aa<this.goi.length;aa++)if(!(0,this.goi[aa])(N))return n.a.instance.Ba(4273296,1,3,"MergeChildNodeLists: Merged failed. [Function: {0}]",aa),N.ma.Die("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",aa),!1;return!0}f0l(N){const aa=new m.a,ia=new m.a,ea=new x.a;N.runtime.Aw.forEach((la,xa)=>Y.Uyi(xa,aa));N.runtime.wp.forEach((la,xa)=>Y.Uyi(xa,ia));for(let la=0;la<this.Tke.length;la++){const xa=
this.Tke[la].classId;N.runtime.cyb.W(xa,new m.a);aa.Pa(xa)&&aa.J(xa).forEach(Ha=>{var ua=N.runtime.pj.J(Ha.id);ua&&(ua=new L(ua,Ha,N.runtime.wp.gz(Ha.id,ua)),N.runtime.cyb.J(xa).add(Ha.id,ua),ea.add(Ha.id));return!0});ia.Pa(xa)&&ia.J(xa).forEach(Ha=>{if(ea.contains(Ha.id))return!0;const ua=N.runtime.pj.J(Ha.id);ua&&N.runtime.cyb.J(xa).add(Ha.id,new L(ua,ua,Ha));return!0})}N.runtime.jF("PrepareObjectGroupings");N.ma.Rla("PrepareObjectGroupings");return!0}uYl(N){let aa=!0;for(let ia=0;aa&&ia<this.Tke.length;ia++){const ea=
this.Tke[ia],la=ea.classId;N.runtime.cyb.J(la).forEach((xa,Ha)=>{N.runtime.fUa.contains(Ha.sE.id)||(aa=ea.$Nm(N,Ha)&&aa);aa||(n.a.instance.Ba(4273297,1,3,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",la,Ha.sE.id),N.ma.uf(Object.assign(new D,{Mh:"PerformThreewayChildMerge",eventId:"aqtsr"})));return aa});N.runtime.jF("PerformThreewayChildMerge"+ia)}N.ma.Rla("PerformThreewayChildMerge");return aa}XVl(N,aa){if(aa.Lpe(f.a.$e)){var ia=this.Vc.getPropertyObjectIds(aa.sE,f.a.$e);
const ea=this.Vc.getPropertyObjectIds(aa.f$,f.a.$e);aa=this.Vc.getPropertyObjectIds(aa.Bva,f.a.$e);ia=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",ia.length,ea.length,aa.length,N.input.source);n.a.instance.Ba(4030551,1,3,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",ia);N.ma.uf(Object.assign(new D,{Mh:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:ia}));return!1}return!0}vYm(N,aa){if(aa.Lpe(f.a.$e)){const Ra=
new x.a,ab=new x.a,Ba=new x.a,Ga=new x.a;var ia=this.Vc.getPropertyObjectIds(aa.sE,f.a.$e),ea=ia.UG(),la,xa=({TAh:la}=this.i8i(aa.f$,ea,Ra,"Favored")).returnValue,Ha=({TAh:ua}=this.i8i(aa.Bva,ea,ab,"Unfavored")).returnValue;if(!xa||!Ha)return ia=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",ea.count,Ra.count,ab.count,la,ua),N.ma.uf(Object.assign(new D,{Mh:"WordSectionNodeThreewayChildMerge",
info:ia})),!1;ia.forEach(ja=>{Ra.contains(ja)||Ba.add(ja);ab.contains(ja)||Ga.add(ja);return!0});aa=aa.sE.yH();ea=new y.a;for(la=0;la<ia.length;la++){var ua=ia.Ve(la);if(Ba.contains(ua)||Ga.contains(ua)){if(N.runtime.fUa.add(ua),ea.length&&(xa=ea.Ve(ea.length-1),xa=N.runtime.cyb.J(393241).J(xa),Ha=N.runtime.cyb.J(393241).J(ua),xa&&Ha))Ba.contains(ua)?Ga.contains(ua)||(xa.sE=xa.sE.yH(),xa.Bva=xa.Bva.yH(),this.PYd(xa.sE,Ha.sE),this.PYd(xa.Bva,Ha.Bva)):(xa.sE=xa.sE.yH(),xa.f$=xa.f$.yH(),this.PYd(xa.sE,
Ha.sE),this.PYd(xa.f$,Ha.f$))}else ea.add(ua)}this.Vc.setPropertyObjectIds(aa,f.a.$e,ea);ia=new M.a(aa);ia.JB(f.a.$e);N.runtime.Fl.W(aa.id,ia)}return!0}PYd(N,aa){const ia=this.Vc.getPropertyObjectIds(N,f.a.$e);aa=this.Vc.getPropertyObjectIds(aa,f.a.$e);const ea=ia.Q7();aa.forEach(la=>{ea.add(la);return!0});this.Vc.setPropertyObjectIds(N,f.a.$e,ea)}i8i(N,aa,ia,ea){let la=0,xa=!0;this.Vc.getPropertyObjectIds(N,f.a.$e).forEach(Ha=>{aa.contains(Ha)?ia.add(Ha):(xa=!1,n.a.instance.Ba(573912977,1,3,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",
ea,Ha),la++);return!0});return{returnValue:xa,TAh:la}}z7k(N){let aa=!0;N.runtime.cyb.J(393241).forEach((ia,ea)=>{if(this.Anl(ea)){n.a.instance.Ba(4220302,1,3,"OutlineGroup {0} requires inter-OG merge.",ea.sE.id);let la;const xa=new O(N,this.Vc,this.HCa);if(({Bxi:ia,U$i:la}=this.SMm(N,xa.FWk(),ea)).returnValue)return n.a.instance.Ba(4220303,1,3,"Merging WordSection {0} as a unit.",la),aa=xa.success&&this.HFl(N,la,ia)&&aa,aa||(n.a.instance.Ba(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",
ea.sE.id,xa.success),N.ma.uf(Object.assign(new D,{Mh:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",xa.success)}))),aa}return!0});return aa}Anl(N){if(!N.Lpe(f.a.$e))return!1;const aa=this.Vc.getPropertyObjectIds(N.sE,f.a.$e).J(0),ia=this.Vc.getPropertyObjectIds(N.f$,f.a.$e);N=this.Vc.getPropertyObjectIds(N.Bva,f.a.$e);return!ia.contains(aa,(ea,la)=>ea.equals(la))||!N.contains(aa,(ea,la)=>ea.equals(la))}SMm(N,aa,ia){aa=aa.J(ia.sE.id);
n.a.instance.Ba(4220304,1,3,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",ia.sE.id,aa);if(N.runtime.fUa.contains(aa))return n.a.instance.Ba(4220305,1,4,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",aa),{returnValue:!1,Bxi:null,U$i:aa};const ea=new I.a;ia=N.runtime.pj.J(aa);this.Vc.getPropertyObjectIds(ia,f.a.$e).forEach(la=>{ea.OYd(la);
return!0});ia=this.HCa.GCb(aa,N.runtime.Aw,N.runtime.pj);this.Vc.getPropertyObjectIds(ia,f.a.$e).forEach(la=>{ea.QYd(la);return!0});N=this.HCa.GCb(aa,N.runtime.wp,N.runtime.pj);this.Vc.getPropertyObjectIds(N,f.a.$e).forEach(la=>{ea.VYd(la);return!0});return{returnValue:!0,Bxi:ea,U$i:aa}}Pfg(N,aa,ia,ea,la){let xa=!0;N.forEach(Ha=>{const ua=aa(Ha);this.Vc.getPropertyObjectIds(ua,f.a.$e).forEach(Ra=>{ia.add(Ra);if(ea.Pa(Ra))return(xa=ea.J(Ra).equals(Ha)&&xa)||n.a.instance.Ba(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",
la,Ra,Ha,ea.J(Ra)),xa;ea.W(Ra,Ha);return!0});return!0});return xa}pVk(N,aa){let ia,ea,la,xa;ia=new y.a;ea=new y.a;la=new y.a;xa=new m.a;const Ha=N.runtime.pj;return this.Pfg(aa.cPb,ua=>Ha.J(ua),ia,xa,"Base")&&this.Pfg(aa.ZAf,ua=>this.HCa.GCb(ua,N.runtime.Aw,Ha),ea,xa,"Favored")&&this.Pfg(aa.LCb,ua=>this.HCa.GCb(ua,N.runtime.wp,Ha),la,xa,"Unfavored")?{returnValue:!0,Jph:ia,cMh:ea,x3i:la,Lri:xa}:{returnValue:!1,Jph:ia,cMh:ea,x3i:la,Lri:xa}}kAk(N,aa,ia,ea){let la=!0;const xa=N.runtime.pj,Ha=N.runtime.Aw,
ua=N.runtime.wp,Ra=N.runtime.Fl,ab=new y.a,Ba=new m.a;ia.forEach(Ga=>{const ja=ea.J(Ga);if(!ja)return n.a.instance.Ba(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",Ga),N.ma.uf(Object.assign(new D,{Mh:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),la=!1;ja.equals(ab.last())||(ab.add(ja),Ba.add(ja,new y.a));Ba.J(ja).add(Ga);N.runtime.fUa.add(Ga);return!0});if(!la)return!1;Ba.forEach((Ga,ja)=>{const X=this.HCa.m2i(Ga,Ha,ua,xa).yH();this.Vc.setPropertyObjectIds(X,
f.a.$e,ja);Ra.W(Ga,new M.a(X));Ra.J(Ga).JB(f.a.$e);N.runtime.fUa.add(Ga);return la});ia=this.HCa.m2i(aa,Ha,ua,xa).yH();this.Vc.setPropertyObjectIds(ia,f.a.$e,ab);Ra.W(aa,new M.a(ia));Ra.J(aa).JB(f.a.$e);N.runtime.fUa.add(aa);return la}HFl(N,aa,ia){let ea,la;if(!({Jph:xa,cMh:ea,x3i:la,Lri:ia}=this.pVk(N,ia)).returnValue)return!1;var xa=F.b(xa,ea,la);xa=this.Lcg(N,xa);return!!xa&&this.kAk(N,aa,xa,ia)}boe(N,aa){return this.xxi(N,aa)}xxi(N,aa){if(aa.Lpe(f.a.$e)){var ia=this.oVk(aa);ia=this.Lcg(N,ia);
if(!ia)return n.a.instance.Ba(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",aa.sE.id),N.ma.uf(Object.assign(new D,{Mh:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),P.a(aa.sE,"OutlineElementContainerThreewayChildMerge_Base",1),P.a(aa.f$,"OutlineElementContainerThreewayChildMerge_Favored",1),P.a(aa.Bva,"OutlineElementContainerThreewayChildMerge_Unfavored",
1),!1;var ea=this.Vc.getPropertyObjectIds(aa.sE,f.a.$e);const la=ia.UG();ea.forEach(xa=>{la.contains(xa)||(xa=this.Vc.getPropertyObjectIds(aa.sE,f.a.Tda),0<xa.length&&N.runtime.tdg.add(xa.J(0)));return!0});ea=aa.f$.yH();this.Vc.setPropertyObjectIds(ea,f.a.$e,ia);N.runtime.Fl.W(ea.id,new M.a(ea));N.runtime.Fl.J(ea.id).JB(f.a.$e)}return!0}v_b(N){if(!N)return n.a.instance.Ba(573957964,1,2,"Feature helper is null"),!1;N.us(181);return N.isFeatureEnabled(181)}LHm(N,aa){if(!this.v_b(N.runtime.Qa))return this.RBg(N,
aa);var ia=aa.sE.id,ea=W.e(N,aa.sE,null);if(ea.equals(v.a.nil))return n.a.instance.Ba(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ia),N.ma.uf(Object.assign(new R.a,{info:"Table node ID could not be found for table cell"})),!1;var la=N.runtime.IQb.J(ea);if(la&&(la=la.J(ia)))if(la.gg)aa=aa.f$.yH(),aa.removeProperty(f.a.$e),this.Vc.setPropertyBool(aa,c.a.ghostCell,!0),null!=la.colSpan?this.Vc.setPropertyUint32(aa,c.a.colSpan,la.colSpan):aa.removeProperty(c.a.colSpan),
N.runtime.Fl.W(aa.id,new M.a(aa)),N.runtime.Fl.J(aa.id).JB(f.a.$e),N.runtime.Fl.J(aa.id).JB(c.a.ghostCell),N.runtime.Fl.J(aa.id).JB(c.a.colSpan);else{let xa,Ha;({EZd:ea,G6d:xa,tAe:Ha}=this.lSk(N,aa,la,ea));if(!xa.length&&!Ha.length)return n.a.instance.Ba(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",ia),N.ma.uf(Object.assign(new R.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;xa.length?Ha.length?(ia=F.b(ea,xa,Ha),ia=this.Lcg(N,
ia)):ia=xa:ia=Ha;if(!ia)return n.a.instance.Ba(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",aa.sE.id),N.ma.uf(Object.assign(new D,{Mh:"TableCellThreewayChildMergev2",eventId:"8n426"})),P.a(aa.sE,"TableCellThreewayChildMergev2_Base",1),P.a(aa.f$,"TableCellThreewayChildMergev2_Favored",1),P.a(aa.Bva,"TableCellThreewayChildMergev2_Unfavored",1),!1;aa=aa.f$.yH();this.Vc.setPropertyObjectIds(aa,
f.a.$e,ia);aa.removeProperty(c.a.ghostCell);ia=la.rowSpan;la=la.colSpan;null!=ia&&null!=la&&(1<ia||1<la)?(this.Vc.setPropertyUint32(aa,c.a.rowSpan,ia),this.Vc.setPropertyUint32(aa,c.a.colSpan,la)):(aa.removeProperty(c.a.rowSpan),aa.removeProperty(c.a.colSpan));N.runtime.Fl.W(aa.id,new M.a(aa));N.runtime.Fl.J(aa.id).JB(f.a.$e);N.runtime.Fl.J(aa.id).JB(c.a.ghostCell);N.runtime.Fl.J(aa.id).JB(c.a.rowSpan);N.runtime.Fl.J(aa.id).JB(c.a.colSpan)}else return this.RBg(N,aa);N.ma.Rla("TableCellThreewayChildMergev2");
return!0}lSk(N,aa,ia,ea){let la,xa;({EZd:aa,G6d:la,tAe:xa}=this.RTh(aa));aa||(aa=new y.a);la||(la=new y.a);xa||(xa=new y.a);var Ha=aa.UG(),ua=la.UG(),Ra=xa.UG(),ab=ia.kle;if(ab)for(var Ba=0;Ba<ab.length;Ba++){var Ga=ab.J(Ba),ja=N.runtime.pj.J(Ga);!Ha.contains(Ga)&&ja&&(Ha.add(Ga),aa.add(Ga));!ua.contains(Ga)&&N.runtime.Aw.gz(Ga,ja)&&(ua.add(Ga),la.add(Ga));!Ra.contains(Ga)&&N.runtime.wp.gz(Ga,ja)&&(Ra.add(Ga),xa.add(Ga))}N.ma.Rla("OENodesAddedToChildrenList");if(ab=ia.mOf)for(Ba=0;Ba<ab.length;Ba++)if(Ga=
ab.J(Ba),ja=N.runtime.pj.J(Ga)){var X=this.Vc.getPropertyObjectIds(ja,f.a.$e);if(X)for(var fa=0;fa<X.length;fa++){var pa=X.J(fa);Ha.contains(pa)||(Ha.add(pa),aa.add(pa))}X=N.runtime.Aw.gz(Ga,ja);if(X=this.Vc.getPropertyObjectIds(X,f.a.$e))for(fa=0;fa<X.length;fa++)pa=X.J(fa),ua.contains(pa)||(ua.add(pa),la.add(pa));Ga=N.runtime.wp.gz(Ga,ja);if(Ga=this.Vc.getPropertyObjectIds(Ga,f.a.$e))for(ja=0;ja<Ga.length;ja++)X=Ga.J(ja),Ra.contains(X)||(Ra.add(X),xa.add(X))}N.ma.Rla("GhostCellOENodesAddedToChildrenList");
if(ia=ia.r8f)for(Ha=0;Ha<ia.length;Ha++)if(ua=ia.J(Ha),ua=N.runtime.IQb.J(ea).J(ua))if(ua=ua.kle){ua=ua.UG();Ra=new y.a;for(ab=0;ab<aa.length;ab++)ua.contains(aa.J(ab))||Ra.add(aa.J(ab));aa=Ra;Ra=new y.a;for(ab=0;ab<la.length;ab++)ua.contains(la.J(ab))||Ra.add(la.J(ab));la=Ra;Ra=new y.a;for(ab=0;ab<xa.length;ab++)ua.contains(xa.J(ab))||Ra.add(xa.J(ab));xa=Ra}N.ma.Rla("NonGhostCellsOENodesRemovedFromChildrenList");return{EZd:aa,G6d:la,tAe:xa}}RBg(N,aa){let ia=aa.f$.hasProperty(f.a.$e),ea=aa.Bva.hasProperty(f.a.$e);
ia&&(ia=!!this.Vc.getPropertyObjectIds(aa.f$,f.a.$e).length);ea&&(ea=!!this.Vc.getPropertyObjectIds(aa.Bva,f.a.$e).length);if(ia!==ea)if(this.usl(N.runtime.Qa))N.ma.Cki(Object.assign(new R.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return N.ma.uf(Object.assign(new R.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.xxi(N,aa)}oVk(N){let aa,ia;({EZd:N,G6d:aa,tAe:ia}=this.RTh(N));return F.b(N,aa,ia)}Lcg(N,aa){n.a.instance.Ba(4220309,
1,4,"Considering {0} OutlineElement collections for merge.",aa.length);const ia=new y.a;let ea=!0;aa.forEach(la=>{if(!la)return n.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),N.ma.uf(Object.assign(new D,{Mh:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ea=!1;if(1===la.qGl&&1===la.H5f){const X=la.cPb.J(0),fa=la.ZAf.J(0),pa=la.LCb.J(0);if(X&&X.equals(fa)&&X.equals(pa))return ia.add(X),!0;if(1!==aa.length)return n.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",
X,fa,pa,aa.length),N.ma.uf(Object.assign(new D,{Mh:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ea=!1}const xa=new m.a,Ha=new y.a,ua=new y.a,Ra=new y.a,ab=new y.a,Ba=new y.a,Ga=new y.a,ja=N.runtime.pj;la.cPb.forEach(X=>ea=this.Mgg(N,X,fa=>ja.J(fa),Ha,ab,xa,"Base"));if(!ea)return n.a.instance.Ba(4285026,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),N.ma.uf(Object.assign(new D,{Mh:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),
!1;la.ZAf.forEach(X=>ea=this.Mgg(N,X,fa=>this.HCa.GCb(fa,N.runtime.Aw,ja),ua,Ba,xa,"Favored"));if(!ea)return n.a.instance.Ba(4285027,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),N.ma.uf(Object.assign(new D,{Mh:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;la.LCb.forEach(X=>ea=this.Mgg(N,X,fa=>this.HCa.GCb(fa,N.runtime.wp,ja),Ra,Ga,xa,"Unfavored"));if(!ea)return n.a.instance.Ba(4285056,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
N.ma.uf(Object.assign(new D,{Mh:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;N.runtime.Qa&&N.runtime.Qa.Vab(1000005)&&(Ba.length&&this.lxk(Ba,N.runtime.Aw)?(this.Gjh(Ba,N,ia,xa),this.MXd(N,xa,Ga)):this.Gjh(Ga,N,ia,xa));if(Ha.length){la=null;if(!({Fl:la}=this.LWl(N,Ha,ua,Ra,la)).returnValue||!la)return ea=!1;la.forEach(X=>{0<X.Kkc.count&&N.runtime.Fl.W(X.tj.id,X);ia.add(xa.J(X.tj.id));return!0})}return!0});return ea?ia:null}lxk(N,aa){for(let ia=0;ia<N.length;ia++)if(aa.get(N.Ve(ia).id))return!0;
return!1}MXd(N,aa,ia){ia.forEach(ea=>{N.runtime.MDc.add(ea.id);N.runtime.MDc.add(aa.J(ea.id));return!0});E.a.MXd(N,this.Vc,ia.J(0))}Gjh(N,aa,ia,ea){N.forEach(la=>{const xa=new M.a(la.yH());aa.runtime.Fl.W(la.id,xa);ia.add(ea.J(la.id));return!0})}Mgg(N,aa,ia,ea,la,xa,Ha){var ua=ia(aa);if(!ua)return n.a.instance.Ba(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",Ha,aa),N.ma.uf(Object.assign(new D,{Mh:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",
Ha)})),!1;const Ra=this.Vc.getPropertyObjectIds(ua,f.a.Tda);if(!Ra||!Ra.length)return n.a.instance.Ba(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",Ha,aa),N.ma.uf(Object.assign(new D,{Mh:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",Ha)})),P.a(ua,"ProcessOutlineElement_"+Ha,1),!1;ua=Ra.Ve(0);ia=ia(ua);if(!ia)return n.a.instance.Ba(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",
Ha,ua,aa),N.ma.uf(Object.assign(new D,{Mh:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",Ha)})),!1;if((Ha=this.Vc.getPropertyString(ia,c.a.iM))&&""!==Ha&&N.runtime.Qa&&(N.runtime.Qa.Jbe(1000005),N.runtime.Qa.Vab(1000005)))return la.add(ia),xa.add(ua,aa),N.runtime.fUa.add(ua),!0;ea.add(ia);xa.add(ua,aa);N.runtime.fUa.add(ua);return!0}RTh(N){let aa,ia;aa=this.Vc.getPropertyObjectIds(N.sE,f.a.$e);ia=this.Vc.getPropertyObjectIds(N.f$,
f.a.$e);N=this.Vc.getPropertyObjectIds(N.Bva,f.a.$e);return{EZd:aa,G6d:ia,tAe:N}}usl(N){if(!N)return n.a.instance.Ba(51422868,1,2,"Feature Helper is null"),!1;N.us(179);return N.isFeatureEnabled(179)}static Uyi(N,aa){aa.Pa(N.Kb)||aa.W(N.Kb,new y.a);aa.J(N.Kb).add(N);return!0}}Y.ioe=v.a.pe("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(z.a)(Y,"ChildNodeListMerge",null,[1793])},1435:function(z,H,b){z=b(0);var f=b(1116),c=b(1285),n=b(1178),m=b(1155),x=b(1200);class y{constructor(N,aa){this.DimensionValue=
this.DimensionName=null;this.DimensionName=N;this.DimensionValue=aa}}Object(z.a)(y,"Dimension",null,[]);class v{constructor(N,aa,ia,ea,la){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=N;this.Query=aa;this.From=ia;this.Size=ea;la&&(this.Filter=la)}}Object(z.a)(v,"EntityRequest",null,[]);class t{constructor(N){this.QueryString=null;this.QueryString=N}}Object(z.a)(t,"Query",null,[]);var A=b(1128);class D{constructor(N,aa){this.Dimensions=this.Name=null;this.Name=
N;this.Dimensions=aa}}Object(z.a)(D,"Scenario",null,[]);var U=b(1143),F=b(1133);class E{constructor(N,aa,ia,ea){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=N;this.TimeZone=aa;this.Cvid=ia;this.Scenario=ea}}Object(z.a)(E,"SubstrateBody",null,[]);var P=b(1199),G=b(1115),K=b(1111),S=b(2),L=b(1382),I=b(1381),O=b(1196),M=b(31),R=b(16),W=b(130);b.d(H,"a",function(){return Y});class Y{constructor(N){this.ATc=this.Fnb=this.hPd=this.GMc=this.yUc=0;this.Q4g=this.m8g=this.GR=
null;this.RIb=0;this.S3=-1;this.RXc="";this.Be=S.AFrameworkApplication.he;this.tc=N;this.Y7e=this.S0k();this.G5e=new c.a;this.o3g=this.tc.Lze?3:2;this.Wdh=this.tc.Lze&&this.tc.zVi?5:3;this.Xgh=this.tc.shb?2:3;this.qOd=this.tc.LXh;this.rch=this.tc.Trl;this.NVc=N.O_h;S.AFrameworkApplication.K&&(this.m8g=S.AFrameworkApplication.K.Oa("AppCatalogUrl")+S.AFrameworkApplication.K.Oa("SearchPersonaPhotoBaseUrl"))}C$(){return"Substrate"}hsa(){return this.tc.IL?1===this.tc.IL?1:3:0}H6(N,aa,ia,ea=f.a.tellMe,
la=null){const xa=new F.a(N);if(!la||Array.contains(la,13)||Array.contains(la,14)||Array.contains(la,19))if(!this.RIb||window.performance.now()-this.RIb>=K.a.pze)if(ia=this.G5e.j0h())this.RIb=window.performance.now(),ia.then(Ha=>{Ha&&""!==Ha?(this.RXc=Ha,""!==this.GR&&this.i0h(N,ea,this.RXc,aa,la)):(G.TellMeActor.instance.rf.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),aa.resultsUpdated(xa))},Ha=>{G.TellMeActor.instance.rf.onError("SubstrateResultsProvider:IssueQuery",
"SubstrateTokenPromise rejected "+Ha);aa.resultsUpdated(xa)});else{if(G.TellMeActor.instance.rf)G.TellMeActor.instance.rf.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");aa.resultsUpdated(xa)}else this.RXc&&""!==this.RXc?this.i0h(N,ea,this.RXc,aa,la):(aa.resultsUpdated(xa),G.TellMeActor.instance.rf.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else aa.resultsUpdated(xa)}Mse(){this.Fnb=this.ATc=this.hPd=this.GMc=this.yUc=0}i0h(N,aa,ia,ea,la){this.Mse();
const xa=new F.a(N),Ha=this.GR=W.a.create().toString();this.oIa();this.S3=window.setTimeout(()=>{if(Ha===this.GR){this.GR="";this.S3=-1;ea.resultsUpdated(xa);const ab={};ab[n.a.provider]=this.C$();ab[n.a.Fzc]=N.O7b;G.TellMeActor.instance.rf.wG(m.a.timedOut,this.NVc,ab)}},this.NVc);const ua={"Content-Type":"application/json",Accept:"application/json"};ua.Authorization="Bearer "+ia;ua["X-Office-Version"]=S.AFrameworkApplication.buildVersion;ua["X-Office-Application"]=S.AFrameworkApplication.K.Oa("Application");
ua["X-Office-Platform"]="WAC";ua["X-TellMe-SessionId"]=G.TellMeActor.instance.$ae();ua["X-TellMe-Culture"]=S.AFrameworkApplication.uiCulture;ua["X-TellMe-ProcessSessionId"]=S.AFrameworkApplication.userSessionId;ua["Client-Request-Id"]=Ha;const Ra=window.performance.now();this.Be.Hi(this.N0k(),2,this.O0k(N.Oh,this.tc.application,G.TellMeActor.instance.$ae(),K.a.lAa(N)),ua,!1,0,ab=>{this.z6b(ab,N,ea,Ha,Ra,aa,la)},ab=>{this.e6b(ab,N,ea,Ha,Ra)},null,null,!1,4E3,6E3)}oIa(){-1!==this.S3&&(window.clearTimeout(this.S3),
this.S3=-1)}z6b(N,aa,ia,ea,la,xa,Ha){G.TellMeActor.instance.rf.taa(aa.Oh.length,this.Y7e.join(","),N.data.ff.toString(),Math.round(window.performance.now()-la),P.a.substrate,!0,x.a.rWa);const ua=K.a.lAa(aa),Ra=new F.a(aa);if(ea===this.GR){this.oIa();N=M.b(N.data.od);if(N.Groups){N=N.Groups;for(const ab of N)"People"===ab.Type&&this.tc.OAd&&(Ha?Array.contains(Ha,13):1)?(N=this.MYh(ab.Suggestions,xa),0<N.results.length&&Ra.NF(N)):"File"===ab.Type&&this.tc.MAd&&(Ha?Array.contains(Ha,14):1)?(N=this.iUh(ab.Suggestions,
ua,xa),0<N.results.length&&Ra.NF(N)):"Notes"===ab.Type&&this.tc.Vcb&&xa!==f.a.contextMenu&&(Ha?Array.contains(Ha,19):1)&&(N=this.HXh(ab.Suggestions,ua,aa),0<N.results.length&&Ra.NF(N))}ia.resultsUpdated(Ra);G.TellMeActor.instance.rf.taa(aa.Oh.length,this.Y7e.join(","),"",Math.round(window.performance.now()-la),"",!0,x.a.provider)}else ia.resultsUpdated(Ra)}HXh(N,aa,ia){const ea=new U.a(19);ea.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const la of N)this.Ntl(la)&&(N=la.NotesType,N=
R.a.vf(N),N=this.EUk(N,la.LastModifiedTime,la.BodyPreview,la.Subject,aa,ia,la))&&(N.groupType=19,ea.eJ(N));return ea}MYh(N,aa){const ia=new U.a(13);ia.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const la of N)if(this.Otl(la)){var ea=la.Id.split("@")[0];N=la.EmailAddresses[0];let xa=la.Type;if(void 0===xa||null===xa)xa="User";if(ea=this.PWk(xa,la.DisplayName,la.JobTitle,N,ea,aa))ea.description=N,N=la.JobTitle,"Department"in la&&"CompanyName"in la&&(N+="@"+la.Department+"@"+la.CompanyName),
ea.nL=N,ia.eJ(ea)}return ia}iUh(N,aa,ia){const ea=new U.a(14);ea.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ha of N)if(this.Ctl(Ha)){var la=Ha.FileName;N=Ha.FileExtension;const ua=la.length>N.length?la.substr(0,la.length-N.length-1):Ha.Title;var xa=void 0;N=0;"DateCreated"in Ha?(N=K.a.eNf(Ha.DateCreated),xa=K.a.o1h(Ha.DateCreated),xa=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ha.Author,xa)):xa=Ha.Author;const Ra=Ha.AccessUrl+"?web=1",ab=R.a.Ece(Ra);la=String.format('<a href="{0}">{1}</a>',
ab,R.a.P1(la));if(ia!==f.a.contextMenu||R.a.AQ(Ra))if(la=this.PNk(ua,ia===f.a.contextMenu?la:Ra,xa,Ha.FileExtension,Ha.Text,aa))la.description=Ha.Author,la.sYd=N,ea.eJ(la)}return ea}e6b(N,aa,ia,ea,la){ea===this.GR&&(this.oIa(),G.TellMeActor.instance.rf.taa(aa.Oh.length,this.Y7e.join(","),N.data.ff.toString(),Math.round(window.performance.now()-la),P.a.substrate,!1,x.a.rWa));N=new F.a(aa);ia.resultsUpdated(N)}PWk(N,aa,ia,ea,la,xa){if(!window.LPC&&!K.a.nWf()||this.yUc===this.o3g)return null;this.yUc+=
1;const Ha="PeopleSuggestion"+this.yUc.toString();var ua=this.m8g+"?size=1&accountName="+ea;N=Object.assign(new L.a,{PersonaType:N,Smtp:ea,ProfilePictureUrl:ua,AadObjectId:la});ua=Object.assign(new I.a,{identifiers:N,displayName:aa});N=[];N.push(appChrome.actions.setPersonaButtonCoauthor(Ha,ua,aa,ia));ia=xa===f.a.contextMenu;xa===f.a.contextMenu&&(la=K.a.Ohk(aa,ea,la),N.push(appChrome.actions.setButtonCommandValueId(Ha,la)));N.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ha,ia));
appChrome.api.dispatch(N);return new A.a(Ha,11,aa,ea)}EUk(N,aa,ia,ea,la,xa,Ha){if(la&&!this.tc.Ofi||this.hPd===this.qOd||this.ATc===this.qOd||this.Fnb===this.qOd)return null;var ua=null;this.hPd+=1;la="";const Ra=[],ab={};Ha.Type="Note";this.Q4g=Object.assign(new O.a,{landingTab:"Notes",data:Ha});xa=K.a.vqb(xa.Oh,31,this.Q4g);if("onenotepagepreviews"===N){if(!("ClickthroughUrl"in Ha&&Ha.ClickthroughUrl)||""===Ha.ClickthroughUrl)return null;this.ATc+=1;la="OnenoteNotesSuggestion"+this.ATc.toString();
ab["default"]="SaveAsonetoc2_20";ua=Ha.ClickthroughUrl;Ra.push(appChrome.actions.setControlIconSet(la,ab));Ra.push(appChrome.actions.setCompoundButtonCommandValueId(la,ua));ua=new A.a(la,19)}else if("stickynote"===N){if(!this.rch)return null;this.Fnb+=1;la="NotesSuggestion"+this.Fnb.toString();ab["default"]="ShowAllNotes_20";Ra.push(appChrome.actions.setControlIconSet(la,ab));Ra.push(appChrome.actions.setCompoundButtonCommandValueId(la,xa));ua=new A.a(la,21)}else if("samsung"===N){if(!this.rch)return null;
this.Fnb+=1;la="NotesSuggestion"+this.Fnb.toString();ab["default"]="CategoryCollapsed_20";Ra.push(appChrome.actions.setControlIconSet(la,ab));Ra.push(appChrome.actions.setCompoundButtonCommandValueId(la,xa));ua=new A.a(la,20)}""!==la&&(N=K.a.o1h(aa),N=String.format(CommonUIStrings.l_LastModifiedString,N),ua.label=ea,ua.sYd=K.a.eNf(aa),Ra.push(appChrome.actions.setControlLabel(la,ea)),Ra.push(appChrome.actions.updateCompoundButtonDescription(la,N)),Ra.push(appChrome.actions.setControlCustomTooltip(la,
ia)),appChrome.api.dispatch(Ra));return ua}PNk(N,aa,ia,ea,la,xa){if(this.GMc===(xa?this.Xgh:this.Wdh))return null;this.GMc+=1;xa="FileSuggestion"+this.GMc.toString();const Ha=[],ua={};ua["default"]=K.a.$Pk(ea);Ha.push(appChrome.actions.setControlLabel(xa,N));Ha.push(appChrome.actions.setControlIconSet(xa,ua));Ha.push(appChrome.actions.updateCompoundButtonDescription(xa,ia));Ha.push(appChrome.actions.setCompoundButtonCommandValueId(xa,aa));Ha.push(appChrome.actions.setControlCustomTooltip(xa,la));
appChrome.api.dispatch(Ha);return new A.a(xa,6,N,ia)}S0k(){const N=[];this.tc.OAd&&Array.add(N,"People");this.tc.MAd&&Array.add(N,"File");this.tc.Vcb&&Array.add(N,"Notes");return N}O0k(N,aa,ia,ea){var la=new t(N);ea=new v("File",la,0,ea?this.Xgh:this.Wdh,null);N=new v("People",la,0,this.o3g,K.a.jYl);la=new v("Notes",la,0,this.qOd,null);aa=new y("app",aa.toLowerCase());var xa=[];Array.add(xa,aa);aa=new D("tellmesearch",xa);xa=[];this.tc.MAd&&Array.add(xa,ea);this.tc.OAd&&Array.add(xa,N);this.tc.Vcb&&
Array.add(xa,la);ia=new E(xa,"UTC",ia,aa);return M.c(ia)}N0k(){let N=this.tc.CGm;this.tc.Vcb&&(N+="?&setflight=NotesFrom3S");""!==this.tc.k0h&&(N=N+"&"+this.tc.k0h);return N}Otl(N){return"DisplayName"in N&&"Id"in N&&"EmailAddresses"in N&&!!N.Id&&!!N.EmailAddresses}Ctl(N){return"FileExtension"in N&&!!N.FileExtension&&"FileName"in N&&!!N.FileName&&""!==N.FileName&&"AccessUrl"in N&&!!N.AccessUrl&&""!==N.AccessUrl}Ntl(N){return"Id"in N&&!!N.Id&&"NotesType"in N&&!!N.NotesType&&"Subject"in N&&!!N.Subject&&
""!==N.Subject}}Object(z.a)(Y,"SubstrateResultsProvider",null,[1334])},1451:function(z,H,b){z=b(0);var f=b(151),c=b(1293),n=b(127),m=b(1175);class x extends c.a{constructor(v,t,A,D,U,F,E,P,G,K,S,L,I,O){super(v,3,t,A,D,U,F,P,G,K,S,L,I,O);this.uJe=E}get character(){return this.uJe}get text(){return this.character.toString()}eyd(){throw n.a.notImplemented();}toString(){return String.format("{0}",super.toString())}Qqc(){return"CharRun"}clone(){return new x(this.f0c,this.source,this.jj,this.nf,this.runId,
this.EJ,this.character,this.Zxb,this.$Wa,this.Kka,this.wKa,this.K7b,this.fF,this.OA)}jz(v,t,A,D=!1){return super.jz(v,t,A,D)?v.character===this.character?!0:m.a.Ynh(v.character,this.character):!1}}Object(z.a)(x,"CharRunMergeBlock",c.a,[]);b.d(H,"a",function(){return y});class y extends c.a{constructor(v,t,A,D,U,F,E,P,G,K,S,L,I,O,M){super(v,1,t,A,D,U,F,P,K,S,L,I,O,M);this._text=E;this.i8e=G}get text(){return this._text}eyd(v){this._text=v}get Shb(){return this.i8e&&this._text&&this._text.length?!0:
!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.i8e)}Qqc(){return"TextRun"}clone(){return new y(this.f0c,this.source,this.jj,this.nf,this.runId,this.EJ,this._text,this.Zxb,this.i8e,this.$Wa,this.Kka,this.wKa,this.K7b,this.fF,this.OA)}jz(v,t,A,D=!1){return super.jz(v,t,A,D)?m.a.Xnh(this._text,v._text):!1}xzd(){const v=new f.a;for(let A=0;A<this.text.length;A++){var t=m.a.charAt(this._text,A);if(m.a.qsl(m.a.tKm(t))){let D="";D+=t;t=m.a.charAt(this._text,++A);D+=t;
t=new y(this.f0c,this.source,this.jj,this.nf,this.runId,this.EJ,D,this.Zxb,!1,this.$Wa,this.Kka,this.wKa,this.K7b,this.fF,this.OA);v.add(t)}else t=new x(this.f0c,this.source,this.jj,this.nf,this.runId,this.EJ,t,this.Zxb,this.$Wa,this.Kka,this.wKa,this.K7b,this.fF,this.OA),v.add(t)}return v}}Object(z.a)(y,"TextRunMergeBlock",c.a,[])},1452:function(z,H,b){z=b(0);var f=b(820),c=b(15),n=b(282),m=b(151),x=b(48);b(701);var y=b(505),v=b(111),t=b(127),A=b(828),D;(function(G){G[G.none=0]="none";G[G.browser=
1]="browser";G[G.serverPutChanges=2]="serverPutChanges";G[G.syncDiff=3]="syncDiff";G[G.docxMerge=4]="docxMerge";G[G.undo=5]="undo"})(D||(D={}));Object(z.b)("GraphMergeSource",D);var U=b(1434),F=b(1197),E=b(1430);b.d(H,"a",function(){return P});class P{constructor(G){this.xA=new A.a;this.DR=new n.a;this.teh=new n.a(0);this.MFd=new m.a;this.JXg=new m.a;this.q4g=new m.a;this.a2g=new m.a;this.G3g="";this.dlb=null;this.ym=this.XWe=0;this.hQd=new n.a(0);this.NOe=this.F7g=this.CNd=0;const {MarkerValidation:K}=
b(1591);this._state=G;this.Ytj=new K}get MXa(){return this.Ytj}vum(G){this.XWe=G}Die(G,K){this.G3g=String.format("{0}-{1}",G,K)}ive(G){this.g6j();this.NOe=G}uug(){this.NOe=0}g6j(){this.dlb&&this.MFd.add(this.dlb);this.dlb=null}uf(G){this.dlb||(this.dlb=G);switch(this.NOe){case 1:this.JXg.add(G);break;case 2:this.q4g.add(G);break;case 3:this.a2g.add(G);break;default:this.dlb&&this.MFd.add(G)}}Cki(G){this.MFd.add(G)}iAl(){this.ym=this.OJa();this.Rla("MergeEnd")}Rla(G){const K=this.OJa();this.teh.W(G,
K-this.XWe);this.XWe=K}Tsm(){this.CNd=this.OJa();this.F7g++}UL(G){const K=this.OJa();let S;({value:S}=this.hQd.xb(G)).returnValue?(S+=K-this.CNd,this.hQd.W(G,S)):this.hQd.W(G,K-this.CNd);this.CNd=K}WSk(){this.DR.W("Id",this._state.input.g3b.toString());this.DR.W("Source",D[this._state.input.source]);this.DR.W("Base",P.RCa(this.pHk()));this.DR.W("Favored",P.RCa(this.$Zh(!0)));this.DR.W("Unfavored",P.RCa(this.$Zh(!1)));this.DR.W("NodesRolledBackIfFailed",P.RCa(this.yUk()));if(!this._state.output.succeeded){let G,
K,S,L,I;({MVj:G,oxk:K,MOm:S,NVj:L,NOm:I}=this.Eyk(this._state.runtime));this.DR.W("CharactersLost",this.UIk(G,K,S));this.DR.W("CharactersLostInComments",this.GJk());this.DR.W("CharactersLostInTables",this.tGk(I,L))}this.DR.W("FuncStep",this.G3g);this.DR.W("FailureDetail",P.RCa(this.GVb()));this.DR.W("FailDetailHints",this.I9d(this.JXg));this.DR.W("FailDetailNaiveMerge",this.I9d(this.q4g));this.DR.W("FailDetailLcs",this.I9d(this.a2g));this.DR.W("ExtraDetails",this.I9d(this.MFd));this.DR.W("Timeline",
P.RCa(this.teh));this.DR.W("ParagraphMergesCount",this.F7g);this.DR.W("ParagraphMergeDurations",P.RCa(this.hQd));this.DR.W("MarkerInfo",P.RCa(this.MXa.ATh()));this.DR.W("Result",P.RCa(this.YSk()));return JSON.stringify(P.RCa(this.DR))}OJa(){return(new Date).getTime()}pHk(){const G=new n.a,K=this._state.input.SCa,S=this._state.runtime.yIa?this._state.runtime.yIa.id:x.a.nil;let L=!1,I=0;for(;I<K.length;I++)if(K.J(I).id.equals(S)){L=!0;break}G.W("LastId",S.toString());G.W("Length",L?I+1:-1);return G}$Zh(G){const K=
new n.a;if(!this._state.input.g2)return null;G=G?2===this._state.input.g2?this._state.input.f8:this._state.input.SCa:2===this._state.input.g2?this._state.input.SCa:this._state.input.f8;K.W("FirstId",G.J(0).id.toString());K.W("LastId",G.length?G.J(G.length-1).id.toString():null);K.W("Length",G.length);return K}yUk(){if(!this._state.runtime.x8h)return null;const G=this._state.runtime.wp,K=new n.a(0);G.forEach((S,L)=>{({value:S}=K.xb(L.Kb.toString()));K.W(L.Kb.toString(),S+1);return!0});return K}UIk(G,
K,S){let L=null,I=null,O=null;const M=this._state.runtime.wp;let R=0;try{O=new E.a(this.xA,this._state);L=F.b(G,K,S);I=new y.a;for(G=0;G<L.length;G++)if(!L.J(G).cPb.An(L.J(G).LCb,(W,Y)=>W.equals(Y))){const W=this.cGh(L.J(G),O);R+=W;I.add(L.J(G))}L&&M.forEach((W,Y)=>{if(393230===Y.Kb){Y=null;for(let N=0;N<L.length;N++)if(!I.contains(L.J(N))&&L.J(N).LCb.contains(W,(aa,ia)=>aa===ia)){Y=L.J(N);break}Y&&(W=this.cGh(Y,O),I.add(Y),R+=W)}return!0});return R}catch(W){return v.a.instance.Ba(579190992,1,2,"Exception in GetCharactersLost: "+
W.toString()),-1}}Eyk(G){let K,S,L,I,O;G.jF=R=>{if(750<this.OJa()-this._state.input.dCa)throw v.a.instance.Ba(579190991,1,2,"Timed out while calculating characters lost: {0}",R),t.a.invalidOperation(R);};K=new m.a;S=new m.a;L=new m.a;I=new m.a;const M=new m.a;O=new m.a;try{if(G.pj){const R=G.pj.J(U.ChildNodeListMerge.ioe);let W,Y;W=G.Aw.J(U.ChildNodeListMerge.ioe)||R;Y=G.wp.J(U.ChildNodeListMerge.ioe)||R;this.CBf(R,N=>G.pj.J(N),K,I);this.CBf(W,N=>G.Aw.J(N)||G.pj.J(N),S,M);this.CBf(Y,N=>G.wp.J(N)||
G.pj.J(N),L,O)}}catch(R){v.a.instance.Ba(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+R.toString())}return{MVj:K,oxk:S,MOm:L,NVj:I,NOm:O}}tGk(G,K){try{let L=0;const I=this._state.runtime;var S=R=>I.wp.J(R)||I.pj.J(R);const O=new y.a,M=this.Yzk(G,I,S,O);for(G=0;G<M.count;G++){let R=M.keys.J(G);const W=M.J(R);if(!O.contains(R)){let Y=this.B0h(I,S,O,R,W);if(-1!==Y)L+=Y;else return v.a.instance.Ba(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(S=
0;S<K.length;S++){let R=K.J(0);if(!O.contains(R)){let W=this.dbe(I.pj.J(R));if(-1===W)return v.a.instance.Ba(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;L+=W}}return L}catch(L){return v.a.instance.Ba(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+L.toString()),-1}}B0h(G,K,S,L,I){G.jF("GetTableCharactersLost");let O=0;I=this.xA.getPropertyObjectIds(I,c.a.$e);for(let N=0;N<I.length;N++){var M=K(I.J(N));M=this.xA.getPropertyObjectIds(M,c.a.$e);for(let aa=
0;aa<M.length;aa++){var R=K(M.J(aa));if(G.pj.J(I.J(N))&&G.pj.J(M.J(aa))){var W=G.pj.J(M.J(aa));if(!W)return v.a.instance.Ba(573089737,1,2,"Base cell unexpectedly null"),-1;R=this.xA.getPropertyObjectIds(W,c.a.$e);var Y=G.Aw.J(M.J(aa))||G.pj.J(M.J(aa));Y=this.xA.getPropertyObjectIds(Y,c.a.$e);W=this.xA.getPropertyObjectIds(W,c.a.$e);R=F.b(R,Y,W);for(W=0;W<R.length;W++){Y=R.J(W);const ia=this.t1k(G,K,S,Y);if(-1===ia)return v.a.instance.Ba(573089738,1,2,"Error getting characters lost for parition {0}",
Y.toString()),-1;O+=ia}}else{W=this.Y1k(K,R,S);if(-1===W)return v.a.instance.Ba(573089736,1,2,"Error getting text length of cell {0}",R.id.toString()),-1;O+=W}}}S.add(L);return O}t1k(G,K,S,L){let I=0;var O=new m.a,M=new m.a;const R=new n.a;new n.a;for(var W=0;W<L.cPb.length;W++){var Y=G.pj.J(L.cPb.J(W));Y=this.xA.getPropertyObjectIds(Y,c.a.Tda);if(1!==Y.length)return v.a.instance.Ba(573089739,1,2,"Unexpected number of ContentNodes: {0}",Y.length),-1;var N=G.pj.J(Y.J(0));393230===N.Kb?O.add(N):393250===
N.Kb&&R.add(Y.J(0),N)}for(W=0;W<L.LCb.length;W++){Y=K(L.LCb.J(W));Y=this.xA.getPropertyObjectIds(Y,c.a.Tda);if(1!==Y.length)return v.a.instance.Ba(573089740,1,2,"Unexpected number of ContentNodes: {0}",Y.length),-1;N=K(Y.J(0));if(393230===N.Kb)M.add(N);else if(393250===N.Kb){N=this.B0h(G,K,S,Y.J(0),N);if(-1===N)return v.a.instance.Ba(573089741,1,2,"Error diffing table {0}",Y.J(0).toString()),-1;I+=N}}W=new E.a(this.xA,this._state);if(0<O.length&&0<M.length){O=W.NMh(O,aa=>G.pj.J(aa),M,aa=>K(aa));if(-1===
O)return v.a.instance.Ba(573089742,1,2,"Problem diffing parition {0} with LCS",L.toString()),-1;I+=O}else if(0<O.length)for(L=0;L<O.length;L++)I+=this.xA.getPropertyString(O.J(L),c.a.ml).length+1;else if(0<M.length)for(L=0;L<M.length;L++)I+=this.xA.getPropertyString(M.J(L),c.a.ml).length+1;for(L=0;L<R.count;L++)if(O=R.keys.J(L),!S.contains(O)){M=this.dbe(R.J(O));if(-1===M)return v.a.instance.Ba(573089743,1,2,"Error getting length of table {0}",O.toString()),-1;I+=M}return I}Y1k(G,K,S){let L=0;K=this.xA.getPropertyObjectIds(K,
c.a.$e);for(let M=0;M<K.length;M++){var I=G(K.J(M));I=this.xA.getPropertyObjectIds(I,c.a.Tda);if(1!==I.length)return v.a.instance.Ba(573089744,1,2,"Unexpected number of ContentNodes: {0}",I.length),-1;var O=G(I.J(0));if(393230===O.Kb)L+=this.xA.getPropertyString(O,c.a.ml).length+1;else if(393250===O.Kb){O=this.dbe(O);if(-1===O)return v.a.instance.Ba(573089745,1,2,"Problem finding text length of table {0}",I.J(0).toString()),-1;L+=O;S.add(I.J(0))}}return L}dbe(G){this._state.runtime.jF("GetTextLengthOfTable");
let K=0;const S=R=>this._state.runtime.wp.J(R)||this._state.runtime.pj.J(R);G=this.xA.getPropertyObjectIds(G,c.a.$e);for(let R=0;R<G.length;R++){var L=S(G.J(R));L=this.xA.getPropertyObjectIds(L,c.a.$e);for(let W=0;W<L.length;W++){var I=S(L.J(W));I=this.xA.getPropertyObjectIds(I,c.a.$e);for(let Y=0;Y<I.length;Y++){var O=S(I.J(Y));O=this.xA.getPropertyObjectIds(O,c.a.Tda);if(1!==O.length)return v.a.instance.Ba(573089746,1,2,"Unexpected number of ContentNodes: {0}",O.length),-1;var M=S(O.J(0));if(393230===
M.Kb)K+=this.xA.getPropertyString(M,c.a.ml).length+1;else if(393250===M.Kb){M=this.dbe(M);if(-1===M)return v.a.instance.Ba(573089747,1,2,"Error finding the text length of table {0}",O.J(0)),-1;K+=M}}}}return K}Yzk(G,K,S,L){const I=new n.a;for(let O=0;O<G.length;O++){let M=!1;K.wp.J(G.J(O))&&(M=!0);const R=S(G.J(O)),W=this.xA.getPropertyObjectIds(R,c.a.$e);if(!M)for(let Y=0;Y<W.length;Y++)if(K.wp.J(W.J(Y))){M=!0;break}M?I.add(G.J(O),R):L.add(G.J(O))}return I}cGh(G,K){return this.bGh(G.cPb,G.LCb,K)}bGh(G,
K,S){const L=new m.a;for(var I=0;I<G.length;I++)L.add(this._state.runtime.pj.J(G.J(I)));G=new m.a;for(I=0;I<K.length;I++)G.add(this._state.runtime.wp.J(K.J(I))||this._state.runtime.pj.J(K.J(I)));return S.NMh(L,O=>this._state.runtime.pj.J(O),G,O=>this._state.runtime.wp.J(O)||this._state.runtime.pj.J(O))}CBf(G,K,S,L){if(393227===G.Kb){G=this.xA.getPropertyObjectIds(G,c.a.$e);for(let I=0;I<G.length;I++){const O=this.xA.getPropertyObjectIds(K(G.J(I)),c.a.$e);for(let M=0;M<O.length;M++){const R=this.xA.getPropertyObjectIds(K(O.J(M)),
c.a.$e);for(let W=0;W<R.length;W++){const Y=this.xA.getPropertyObjectIds(K(R.J(W)),c.a.Tda);if(1!==Y.length)return;const N=K(Y.J(0));393230===N.Kb?S.add(Y.J(0)):393250===N.Kb?L.add(Y.J(0)):v.a.instance.Ba(573089748,1,2,"Unsupported class id in GetCharactersLost: "+f.a[N.Kb])}}}}}DBf(G,K){G=this.xA.getPropertyObjectIds(G,c.a.$e);const S=new m.a;for(let L=0;L<G.length;L++){const I=this.xA.getPropertyObjectIds(K(G.J(L)),c.a.Tda);if(1!==I.length)return null;S.add(I.J(0))}return S}GJk(){let G=0;const K=
this._state.runtime,S=K.wp,L=O=>K.wp.J(O)||K.pj.J(O);let I=null;K.jF=O=>{if(750<this.OJa()-this._state.input.dCa)throw v.a.instance.Ba(573089749,1,2,"Timed out while calculating comment characters lost: {0}",O),t.a.invalidOperation(O);};try{S.forEach((O,M)=>{if(1074135127===M.Kb){O=this.DBf(M,L);var R=K.pj.J(M.id);if(R)R=this.DBf(R,Y=>K.pj.J(Y)),I||(I=new E.a(this.xA,this._state)),G+=this.bGh(R,O,I);else for(R=0;R<O.length;R++)G+=this.xA.getPropertyString(K.wp.J(O.J(R)),c.a.ml).length+1}if(1074135126===
M.Kb&&(O=this.xA.getPropertyObjectIds(M,c.a.$e).UG(),M=K.pj.J(M.id)))for(M=this.xA.getPropertyObjectIds(M,c.a.$e),R=0;R<M.length;R++)if(!O.contains(M.J(R))){var W=K.pj.J(M.J(R));W=this.DBf(W,Y=>K.pj.J(Y));for(let Y=0;Y<W.length;Y++)G+=this.xA.getPropertyString(K.pj.J(W.J(Y)),c.a.ml).length+1}return!0})}catch(O){return v.a.instance.Ba(573089750,1,2,"Exception in GetCommentCharactersLost: "+O.toString()),-1}return G}GVb(){return this.dlb?this.dlb.GVb():null}I9d(G){const K=new m.a;G.forEach(S=>{K.add(P.RCa(S.GVb()));
return!0});return K.toArray()}YSk(){const G=new n.a;G.W("Succeeded",this._state.output.succeeded);G.W("Timeout",this._state.output.timeout);G.W("Crash",this._state.output.crash);G.W("MergedRevisions",this._state.output.cK?this._state.output.cK.length:-1);G.W("Duration",this.ym-this._state.input.dCa);return G}static RCa(G){if(!G)return null;const K={};G.forEach((S,L)=>{K[S.toString()]=L;return!0});return K}}Object(z.a)(P,"MergeLogger",null,[])},1453:function(z,H,b){z=b(0);var f=b(195),c=b(15),n=b(4),
m=b(108),x=b(701),y=b(111),v=b(2),t=b(151),A=b(282),D=b(1104);class U{constructor(P,G,K){this.position=P;this.leader=G;this.val=K}equals(P){return this.position===P.position&&this.leader===P.leader&&this.val===P.val}toString(){return this.position.toString()}}Object(z.a)(U,"TabStop",null,[]);var F=b(1592);b.d(H,"a",function(){return E});class E extends D.a{constructor(){super()}get Bn(){return 20}get nD(){return 0}rk(){const P=super.rk();P.W(x.a.eb(c.a.ml),1);P.W(x.a.eb(c.a.BC),1);P.W(x.a.eb(c.a.hA),
1);P.W(x.a.eb(n.a.po),1);P.W(x.a.eb(n.a.tm),1);P.W(x.a.eb(n.a.Gb),1);P.W(x.a.eb(c.a.cva),1);P.W(x.a.eb(n.a.mQ),1);P.W(x.a.eb(n.a.fO),1);P.W(x.a.eb(c.a.$N),1);P.W(x.a.eb(n.a.HWa),1);P.W(x.a.eb(n.a.Sya),1);P.W(x.a.eb(n.a.IWa),1);P.W(x.a.eb(n.a.IUa),1);P.W(x.a.eb(n.a.JWa),1);P.W(x.a.eb(n.a.JUa),1);P.W(x.a.eb(n.a.DYa),1);P.W(x.a.eb(n.a.W_a),1);P.W(x.a.eb(n.a.X_a),1);P.W(x.a.eb(n.a.oPa),1);P.W(x.a.eb(n.a.Ir),1);P.W(x.a.eb(n.a.zG),1);P.W(x.a.eb(n.a.AG),1);P.W(x.a.eb(n.a.sy),1);P.W(x.a.eb(m.a.oz),6);P.W(x.a.eb(m.a.s3),
6);P.W(x.a.eb(n.a.n8a),7);P.W(x.a.eb(m.a.oz),6);P.W(x.a.eb(n.a.jzg),2);P.W(x.a.eb(m.a.sak),2);P.W(x.a.eb(m.a.BWl),2);P.W(x.a.eb(n.a.rFc),2);P.W(x.a.eb(n.a.Dze),2);P.W(x.a.eb(n.a.Vbc),2);P.W(x.a.eb(n.a.uib),2);P.W(x.a.eb(n.a.sFc),2);P.W(x.a.eb(n.a.tFc),2);P.W(x.a.eb(n.a.lockNotFullySupportedParagraphInBlockContentControl),2);return P}HC(P,G){if(G===x.a.eb(c.a.ml)||G===x.a.eb(c.a.BC)||G===x.a.eb(c.a.hA)||G===x.a.eb(n.a.po)||G===x.a.eb(n.a.tm)||G===x.a.eb(n.a.Gb)||G===x.a.eb(c.a.cva)||G===x.a.eb(n.a.mQ)||
G===x.a.eb(n.a.fO)||G===x.a.eb(c.a.$N)||G===x.a.eb(n.a.HWa)||G===x.a.eb(n.a.Sya)||G===x.a.eb(n.a.IWa)||G===x.a.eb(n.a.IUa)||G===x.a.eb(n.a.JWa)||G===x.a.eb(n.a.JUa)||G===x.a.eb(n.a.DYa)||G===x.a.eb(n.a.W_a)||G===x.a.eb(n.a.X_a)||G===x.a.eb(n.a.oPa)||G===x.a.eb(n.a.Ir)||G===x.a.eb(n.a.iM)){var K=P.Mm.value.at,S=P.Mm.value.He;G=P.Nf.value.He;if(P.Jm.runtime.fUa.contains(K.id))return y.a.instance.Ba(18989579,1,3,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",
K.id),!0;var L=P.Jm.runtime.Qa;v.AFrameworkApplication.qr("Word-TOCMerge;Word-TOCMergecf");if(L.Vab(1000005)&&this.JCm(P,G,S))return P.ll=G.yH(),E.Pih(P),E.MXd(P.Jm,P.Vc,S),!0;L=new t.a;L.add(K);K=new t.a;K.add(S);S=new t.a;S.add(G);if(!({Fl:G}=E.F2i(P.Jm,L,S,K)).returnValue)return P.TJg=!0,P.ll=null,!1;E.Pih(P);P.ll=G.Ve(0).tj;return!0}return G===x.a.eb(n.a.zG)||G===x.a.eb(n.a.AG)||G===x.a.eb(n.a.sy)?(G=P.Jm.runtime.Qa.Vab(1000004),P.Jm.runtime.Qa.Jbe(1000004),G&&this.DMm(P),P.hg.add(x.a.eb(n.a.zG)),
P.hg.add(x.a.eb(n.a.AG)),P.hg.add(x.a.eb(n.a.sy)),!0):!1}JCm(P,G,K){G=P.Vc.getPropertyString(G,n.a.iM);P=P.Vc.getPropertyString(K,n.a.iM);return G||P?!0:!1}DMm(P){const G=P.Vc,K=P.ll;var S=P.Mm.value.He,L=P.Nf.value.He;P=this.VGf(P.Mm.value.at,G);L=this.VGf(L,G);S=this.VGf(S,G);({JFl:S,KFl:P,LFl:L}=this.ZSk(P,L,S));S.length?(G.setPropertyUint32s(K,n.a.sy,S),G.setPropertyUint32s(K,n.a.zG,P),G.setPropertyUint32s(K,n.a.AG,L)):this.vcm(K)}VGf(P,G){const K=G.getPropertyUint32s(P,n.a.sy),S=G.getPropertyUint32s(P,
n.a.zG);P=G.getPropertyUint32s(P,n.a.AG);G=new t.a;if(!K)return G;for(let L=0;L<K.length;++L)G.add(new U(K.J(L),S.J(L),P.J(L)));return G}ZSk(P,G,K){({qxi:G,rxi:O,sxi:I}=this.nTh(P,G));let S,L;({qxi:K,rxi:S,sxi:L}=this.nTh(P,K));P=this.O6k(P,O,I,S,L);var I=this.N6k(P,G,K);P=new t.a;G=new t.a;var O=new t.a;for(K=0;K<I.length;++K)P.add(I.J(K).position),G.add(I.J(K).leader),O.add(I.J(K).val);return{JFl:P,KFl:G,LFl:O}}nTh(P,G){let K,S,L;K=new t.a;S=new A.a;L=new A.a;let I,O;for(I=O=0;I<P.length&&O<G.length;)P.J(I).position===
G.J(O).position?(P.J(I).equals(G.J(O))||L.W(P.J(I).position,G.J(O)),++I,++O):P.J(I).position<G.J(O).position?(S.W(P.J(I).position,P.J(I)),++I):(K.add(G.J(O)),++O);for(;I<P.length;)S.W(P.J(I).position,P.J(I)),++I;for(;O<G.length;)K.add(G.J(O)),++O;return{qxi:K,rxi:S,sxi:L}}O6k(P,G,K,S,L){const I=new t.a;for(let O=0;O<P.length;++O){const M=P.J(O).position;G.Pa(M)||(K.Pa(M)?I.add(K.J(M)):S.Pa(M)||(L.Pa(M)?I.add(L.J(M)):I.add(P.J(O))))}return I}N6k(P,G,K){G=this.poi(G,K);return this.poi(P,G)}poi(P,G){const K=
new t.a;let S,L;for(S=L=0;S<P.length&&L<G.length;)P.J(S).position<=G.J(L).position?(K.add(P.J(S)),P.J(S).position===G.J(L).position&&++L,++S):K.add(G.J(L++));for(;S<P.length;)K.add(P.J(S++));for(;L<G.length;)K.add(G.J(L++));return K}vcm(P){P.removeProperty(n.a.sy);P.removeProperty(n.a.zG);P.removeProperty(n.a.AG)}static ih(){return new E}static get instance(){return E.Ig.value}static Pih(P){P.hg.add(x.a.eb(c.a.ml));P.hg.add(x.a.eb(c.a.BC));P.hg.add(x.a.eb(c.a.hA));P.hg.add(x.a.eb(n.a.po));P.hg.add(x.a.eb(n.a.tm));
P.hg.add(x.a.eb(n.a.Gb));P.hg.add(x.a.eb(c.a.cva));P.hg.add(x.a.eb(n.a.mQ));P.hg.add(x.a.eb(n.a.fO));P.hg.add(x.a.eb(c.a.$N));P.hg.add(x.a.eb(n.a.HWa));P.hg.add(x.a.eb(n.a.Sya));P.hg.add(x.a.eb(n.a.IWa));P.hg.add(x.a.eb(n.a.IUa));P.hg.add(x.a.eb(n.a.JWa));P.hg.add(x.a.eb(n.a.JUa));P.hg.add(x.a.eb(n.a.DYa));P.hg.add(x.a.eb(n.a.W_a));P.hg.add(x.a.eb(n.a.X_a));P.hg.add(x.a.eb(n.a.oPa));P.hg.add(x.a.eb(n.a.Ir));P.hg.add(x.a.eb(n.a.iM))}static F2i(P,G,K,S){return(new F.a(P,G,K,S)).DFc()}static MXd(P,G,
K){K=G.getPropertyObjectIds(K,c.a.BC);for(let L=0;L<K.length;L++){var S=P.runtime.wp.J(K.Ve(L));if(S&&(S=G.getPropertyObjectId(S,n.a.qd))){P.runtime.MDc.add(S);break}}}}E.Ig=new f.a(E.ih);Object(z.a)(E,"ParagraphNodeComplexMerge",D.a,[])},1591:function(z,H,b){b.r(H);b.d(H,"MarkerValidation",function(){return n});z=b(0);var f=b(282),c=b(1452);class n{constructor(){this.Ntc=this.Mtc=this.Ltc=0}ATh(){const m=new f.a(0);m.W("InvalidBookmarks",this.Ltc);m.W("InvalidComments",this.Mtc);m.W("InvalidContentControls",
this.Ntc);return m}O4h(){return 0<this.Ltc||0<this.Mtc||0<this.Ntc?!0:!1}toString(){return JSON.stringify(c.a.RCa(this.ATh()))}}Object(z.a)(n,"MarkerValidation",null,[])},1592:function(z,H,b){b.d(H,"a",function(){return y});z=b(0);var f=b(111),c=b(828),n=b(158),m=b(1305),x=b(1208);class y{constructor(v,t,A,D,U=null,F=null,E=null,P=null){this.Qc=v;this.JC=t;this.Bwa=A;this.Uxa=D;this.vuj=U;this.Gmj=F;this.FFj=E;this.xM=P||this.srf();this.FRd=this.xM(109)}srf(){return v=>!!this.Qc.runtime.Qa&&this.Qc.runtime.Qa.isFeatureEnabled(v)}xxf(){return!!this.Qc.runtime.pj.J(n.a.lR)}KWi(){let v;
if(1===this.Qc.input.source||2===this.Qc.input.source)v=130;else if(4===this.Qc.input.source||3===this.Qc.input.source)v=58;else if(5===this.Qc.input.source)v=208;else return!1;return this.xxf()&&this.xM(v)}eYi(v,...t){return String.format.apply(null,[v].concat(t))}$$d(v){const {ParagraphMerge:t}=b(1642);let A=this.Qc,D=this.Bwa,U=this.Uxa;v||(A=this.vuj||this.Qc,D=this.Gmj||D,U=this.FFj||U);var F=x.a.GJf(this.JC);const E=x.a.GJf(D),P=x.a.GJf(U);F=this.eYi("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
A.input.source,A.runtime.yIa.id,A.runtime.H6d,A.runtime.uAe,F.Go(),E.Go(),P.Go());return v?{returnValue:new m.a(A,this.JC,D,U,this.srf(),new c.a),Go:F}:{returnValue:new t(A,this.JC,D,U,this.srf(),new c.a),Go:F}}DFc(){let v;this.Qc.ma.Tsm();var t=this.KWi();let A=({Go:U}=this.$$d(t)).returnValue;f.a.instance.Ba(18994389,1,3,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",t,U);this.Qc.ma.UL("ParagraphMergeSelector initialization");t?this.Qc.ma.ive(1):this.Qc.ma.ive(2);this.Qc.runtime.Qa.us(109);
let D=({Fl:v}=A.DFc()).returnValue;this.Qc.ma.uug();var U=this.FRd?!D:t&&!D&&A.ate;t=!!this.Qc.runtime.pj.J(n.a.lR)&&(t&&!D||!t);U&&({Go:U,returnValue:A}=this.$$d(!1),{Fl:v,returnValue:D}=A.DFc(),f.a.instance.Ba(18994390,1,D?3:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",D,U));t&&(U=new c.a,x.a.Rhm(this.Qc,U));this.Qc.ma.UL("ParagraphMergeSelector finalization");return{returnValue:D,Fl:v}}CCd(v,t){let A,D,U;const F=this.KWi()&&this.xM(209);let E=({Go:U}=this.$$d(F)).returnValue,
P=({mgb:A,xua:D}=E.CCd(v,t)).returnValue;f.a.instance.Ba(18994391,1,3,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",F,U);F&&!P&&E.ate&&({Go:U,returnValue:E}=this.$$d(!1),{mgb:A,xua:D,returnValue:P}=E.CCd(v,t),f.a.instance.Ba(18994392,1,P?3:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",P,U));return{returnValue:P,mgb:A,xua:D}}}Object(z.a)(y,"ParagraphMergeSelector",null,[1790])},1593:function(z,H,b){b.r(H);b.d(H,"SurfaceStringTokenStringGenerator",
function(){return c});z=b(0);var f=b(1239);class c extends f.a{constructor(n){super(n);this.Sa=n}apply(n,m,x,y,v,t,A){null==t&&(t=n.w1h(v,m));A=f.a.Hjh(n,t,this.Sa.score,x,y,A);return{nBd:t,J1c:A}}}c.K1c=0;Object(z.a)(c,"SurfaceStringTokenStringGenerator",f.a,[])},1594:function(z,H,b){b.r(H);b.d(H,"QueryTokenStringGenerator",function(){return n});z=b(0);var f=b(1239),c=b(1103);class n extends f.a{constructor(m){super(m);this.Sa=m}apply(m,x,y,v,t,A,D){x=this.Sa.query.load(x,null);t=0;let U=null;this.Sa.query.G7===
c.Annotations.uCa?x&&(U=this.Sa.name):((U=this.Sa.name)&&(U+="_"),U+=this.Sa.Je.Gha(this.Sa.query.G7,x));null!=U&&(t=f.a.Hjh(m,U,this.Sa.score,y,v,t));return{nBd:A,J1c:D+t}}}n.K1c=1;Object(z.a)(n,"QueryTokenStringGenerator",f.a,[])},1595:function(z,H,b){b.r(H);b.d(H,"FuzzyMatchTokenStringGenerator",function(){return c});z=b(0);var f=b(1239);class c extends f.a{constructor(n){super(n);this.Sa=n}apply(n,m,x,y,v,t,A){null==t&&(t=n.w1h(v,m));n=this.Sa.KKh.FBl(t);if(this.Sa.Vwi)for(var D of n)if(!D.VP&&
D.w7d)return{nBd:t,J1c:A};D=0;for(const U of n)if(U.VP&&!({Jjf:D}=this.Onh(U,!0,x,y,D)).returnValue)return{nBd:t,J1c:A};if(this.Sa.w7h)for(const U of n)if(!({Jjf:D}=this.Onh(U,!1,x,y,D)).returnValue)break;return{nBd:t,J1c:A}}Onh(n,m,x,y,v){let t;m?(m=0,t=n.w7d?1:0):(m=n.w7d?1:0,t=n.count-m);for(let A=0;A<t;++A)if(f.a.Ijh(n.Frb+m+A,this.Sa.score,x,y),++v,0<this.Sa.J5f&&v>=this.Sa.J5f)return{returnValue:!1,Jjf:v};return{returnValue:!0,Jjf:v}}}c.K1c=2;Object(z.a)(c,"FuzzyMatchTokenStringGenerator",f.a,
[])},1635:function(z,H,b){z=b(0);var f=b(4),c=b(195),n=b(1104);class m extends n.a{constructor(){super()}get Bn(){return 2}get nD(){return 7}static ih(){return new m}static get instance(){return m.Ig.value}}m.Ig=new c.a(m.ih);Object(z.a)(m,"AppBindingNodeComplexMerge",n.a,[]);var x=b(15),y=b(701),v=b(111),t=b(1162);class A extends n.a{constructor(){super()}get Bn(){return 3}get nD(){return 7}rk(){const Ib=super.rk();Ib.W(y.a.eb(x.a.caa),1);return Ib}HC(Ib,nc){if(nc===y.a.eb(x.a.caa)){const tc=Ib.ll;
var Gc=Ib.Vc;v.a.instance.Ba(6633221,1,3,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",tc.id,tc.Kb,nc);nc=Gc.getPropertyMilliseconds(Ib.Nf.value.He,x.a.caa);Gc=Gc.getPropertyMilliseconds(Ib.Mm.value.He,x.a.caa);nc<Gc&&this.YJk(Ib);Ib.hg.add(y.a.eb(x.a.caa));return!0}v.a.instance.Ba(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ib.Nf.value.He.id,nc);return!1}YJk(Ib){this.Jfm(Ib.Mm.value.He,
Ib.ll);this.oGf(Ib,f.a.HYd);this.oGf(Ib,f.a.uff);this.oGf(Ib,f.a.aff)}oGf(Ib,nc){var Gc=Ib.Vc,tc=Ib.ll;if(Gc.hasProperty(tc,nc)&&(nc=Gc.getPropertyObjectIds(tc,nc))&&nc.length)for(Gc=Ib.Jm.runtime.wp,Ib=Ib.Jm.runtime.Fl,tc=0;tc<nc.length;tc++){const fc=nc.J(tc);if(!Gc.Pa(fc))continue;const kc=Gc.J(fc).yH();Ib.add(fc,new t.a(kc,!1))}}static ih(){return new A}static get instance(){return A.Ig.value}}A.Ig=new c.a(A.ih);Object(z.a)(A,"AppNodeComplexMerge",n.a,[]);class D extends n.a{constructor(){super()}get Bn(){return 4}get nD(){return 7}static ih(){return new D}static get instance(){return D.Ig.value}}
D.Ig=new c.a(D.ih);Object(z.a)(D,"AppPropNodeComplexMerge",n.a,[]);class U extends n.a{constructor(){super()}get Bn(){return 5}get nD(){return 7}static ih(){return new U}static get instance(){return U.Ig.value}}U.Ig=new c.a(U.ih);Object(z.a)(U,"AppRefNodeComplexMerge",n.a,[]);var F=b(282),E=b(505),P=b(151),G=b(16);class K{constructor(Ib,nc){this.id=Ib;this.GEm=nc}}Object(z.a)(K,"IdAndTime",null,[]);class S extends n.a{constructor(){super()}get Bn(){return 6}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.KTa),
1);return Ib}HC(Ib,nc){if(nc===y.a.eb(f.a.KTa)){const Gc=Ib.ll,tc=Ib.Vc;v.a.instance.Ba(6633224,1,3,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Gc.id,Gc.Kb,nc);nc=tc.getPropertyObjectIds(Ib.Nf.value.at,f.a.KTa);const fc=tc.getPropertyObjectIds(Ib.Nf.value.He,f.a.KTa),kc=tc.getPropertyObjectIds(Ib.Mm.value.He,f.a.KTa);nc=this.ZEl(Ib,nc,fc,kc);0<nc.length?tc.setPropertyObjectIds(Gc,f.a.KTa,nc):Gc.removeProperty(f.a.KTa);Ib.hg.add(y.a.eb(f.a.KTa));
return!0}v.a.instance.Ba(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ib.Nf.value.He.id,nc);return!1}ZEl(Ib,nc,Gc,tc){const fc=this.SXa(nc,Gc,tc),kc=nc.UG(),Bb=Gc.UG(),Wb=tc.UG();nc=n.a.filter(fc,gc=>!kc.contains(gc)&&Bb.contains(gc));Gc=n.a.filter(fc,gc=>!kc.contains(gc)&&Wb.contains(gc));if(!nc.length||!Gc.length)return fc;const zb=new F.a;nc.forEach(gc=>{const jc=new K(gc,this.VQh(Ib,gc,!1));this.SQh(Ib,gc,!1).forEach(Rb=>
{zb.add(Rb,jc);return!0});return!0});const Gb=new E.a;Gc.forEach(gc=>{const jc=this.VQh(Ib,gc,!0);this.SQh(Ib,gc,!0).forEach(Rb=>zb.Pa(Rb)?(Gb.add(zb.J(Rb).GEm>=jc?gc:zb.J(Rb).id),!1):!0);return!0});return n.a.filter(fc,gc=>!Gb.contains(gc))}VQh(Ib,nc,Gc){return(nc=this.Eka(Ib,nc,Gc))?Ib.Vc.getPropertyMilliseconds(nc,x.a.caa):0}Eka(Ib,nc,Gc){Ib=Gc?Ib.Jm.runtime.wp:Ib.Jm.runtime.Aw;return Ib.Pa(nc)?Ib.J(nc):null}SQh(Ib,nc,Gc){const tc=new P.a,fc=new E.a,kc=Ib.Vc;nc=this.Eka(Ib,nc,Gc);var Bb=this.JZh(kc,
nc);if(Bb)for(tc.add(Bb),fc.add(Bb),nc=kc.getPropertyObjectIds(nc,f.a.HYd),Bb=0;nc&&Bb<nc.length;Bb++){const Wb=this.JZh(kc,this.Eka(Ib,nc.J(Bb),Gc));if(!Wb)break;fc.contains(Wb)||(tc.add(Wb),fc.add(Wb))}return tc}JZh(Ib,nc){if(!Ib.hasProperty(nc,f.a.Vlc)||!Ib.hasProperty(nc,f.a.IYd)||!Ib.hasProperty(nc,f.a.JYd))return null;const Gc=Ib.getPropertyString(nc,f.a.Vlc),tc=Ib.getPropertyString(nc,f.a.IYd);Ib=Ib.getPropertyString(nc,f.a.JYd);return G.a.fw(Gc+";"+tc+";"+Ib)}static ih(){return new S}static get instance(){return S.Ig.value}}
S.Ig=new c.a(S.ih);Object(z.a)(S,"AppsNodeComplexMerge",n.a,[]);class L extends n.a{constructor(){super()}get Bn(){return 36}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.PCb),1);return Ib}HC(Ib,nc){v.a.instance.Ba(51430790,1,3,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",nc);if(nc===y.a.eb(f.a.PCb)){var Gc=Ib.Nf.value.He,tc=Ib.Mm.value.He;nc=Ib.ll;var fc=Ib.Vc.getPropertyStrings(Ib.Nf.value.at,f.a.PCb);Gc=Ib.Vc.getPropertyStrings(Gc,f.a.PCb);tc=Ib.Vc.getPropertyStrings(tc,f.a.PCb);
fc=this.SXa(fc,Gc,tc);Ib.Vc.setPropertyStrings(nc,f.a.PCb,fc);Ib.hg.add(y.a.eb(f.a.PCb));return!0}return!1}static ih(){return new L}static get instance(){return L.Ig.value}}L.Ig=new c.a(L.ih);Object(z.a)(L,"AutoSaveParametersNodeComplexMerge",n.a,[]);class I extends n.a{constructor(){super()}get Bn(){return 44}rk(){const Ib=super.rk();Ib.W(y.a.eb(x.a.$e),1);return Ib}HC(Ib,nc){const Gc=Ib.Jm.runtime.Qa;if(nc===y.a.eb(x.a.$e))return v.a.instance.Ba(589608865,1,3,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Ib.ll.id,Ib.ll.Kb,nc),Gc.us(212),Gc.isFeatureEnabled(212)?this.aFl(Ib,nc):this.qFl(Ib,nc),!0;v.a.instance.Ba(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Ib.Nf.value.He.id,nc);return!1}aFl(Ib,nc){const Gc=y.a.oka(nc),tc=Ib.Vc;var fc=tc.getPropertyObjectIds(Ib.Nf.value.at,Gc),kc=tc.getPropertyObjectIds(Ib.Nf.value.He,Gc),Bb=tc.getPropertyObjectIds(Ib.Mm.value.He,Gc);Bb=I.i3k(Ib,kc,Bb);fc=this.SXa(fc,
kc,Bb);kc=Ib.ll;0<fc.length?tc.setPropertyObjectIds(kc,Gc,fc):kc.removeProperty(Gc);Ib.hg.add(nc)}static ih(){return new I}static get instance(){return I.Ig.value}static i3k(Ib,nc,Gc){const tc=new P.a,fc=new F.a;nc.forEach(kc=>{const Bb=Ib.Jm.runtime.Aw.J(kc);Bb&&fc.add(Bb.fW(f.a.zo).toString(),kc);return!0});Gc.forEach(kc=>{var Bb=Ib.Jm.runtime.wp.J(kc);Bb?(Bb=Bb.fW(f.a.zo).toString(),fc.Pa(Bb)&&fc.get(Bb)!==kc?v.a.instance.Ba(557061773,1,3,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
tc.add(kc)):tc.add(kc);return!0});return tc}}I.Ig=new c.a(I.ih);Object(z.a)(I,"BookmarkContainerNodeComplexMerge",n.a,[]);var O=b(1401);class M extends n.a{constructor(){super()}get Bn(){return 41}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.pPb),1);Ib.W(y.a.eb(f.a.zo),1);Ib.W(y.a.eb(f.a.hF),1);Ib.W(y.a.eb(f.a.ZV),1);return Ib}HC(Ib,nc){if(nc===y.a.eb(f.a.pPb))return Ib.hg.add(y.a.eb(f.a.pPb)),!0;if(nc===y.a.eb(f.a.zo))return Ib.hg.add(y.a.eb(f.a.zo)),!0;if(nc===y.a.eb(f.a.hF)||nc===y.a.eb(f.a.ZV)){var Gc=
Ib.Nf.value.He,tc=Ib.Mm.value.He,fc=Ib.ll;var kc=(new Date).toString();const Bb=Ib.Jm.runtime.Qa;Bb.us(212);if(Bb.isFeatureEnabled(212))return v.a.instance.Ba(556656202,1,3,"BookmarkNodeComplexMerge: Started at [timestamp: {0}]",kc),fc=this.y2i(Ib,Gc,tc,fc,y.a.eb(f.a.hF))&&this.y2i(Ib,Gc,tc,fc,y.a.eb(f.a.ZV)),fc||(v.a.instance.Ba(557061774,1,1,"BookmarkNodeComplexMerge: Failed to merge Bookmark [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Ib.Nf.value.He.id,nc),Ib.Jm.ma.uf(Object.assign(new O.a,
{Bn:this.Bn,pxc:Ib.Nf.value.at.Kb,msd:nc,Dnd:this.nsd.J(nc)}))),kc=(new Date).toString(),v.a.instance.Ba(556656203,1,3,"BookmarkNodeComplexMerge: Ended at [timestamp: {0}]",kc),fc;kc=Ib.Vc.getPropertyString(Gc,f.a.hF);nc=Ib.Vc.getPropertyString(tc,f.a.hF);kc=this.Ud(kc)?nc:this.Ud(nc)?kc:null;if(this.Ud(kc))return!1;Ib.Vc.setPropertyString(fc,f.a.hF,kc);Ib.hg.add(y.a.eb(f.a.hF));Gc=Ib.Vc.getPropertyString(Gc,f.a.ZV);tc=Ib.Vc.getPropertyString(tc,f.a.ZV);tc=this.Ud(Gc)?nc:this.Ud(tc)?Gc:null;if(this.Ud(tc))return!1;
Ib.Vc.setPropertyString(fc,f.a.ZV,tc);Ib.hg.add(y.a.eb(f.a.ZV));return!0}return!1}y2i(Ib,nc,Gc,tc,fc){const kc=y.a.oka(fc);nc=Ib.Vc.getPropertyObjectId(nc,kc);Gc=Ib.Vc.getPropertyObjectId(Gc,kc);var Bb=Ib.Nf.value.He.id;v.a.instance.Ba(557061775,1,3,"BookmarkNodeComplexMerge: Merging [favoredBookmarkParaId: {0}] and [conflictBookmarkParaId: {1}]",nc,Gc);const Wb=this.Pdi(Ib,nc,Bb,y.a.eb(f.a.hF)===fc,!0);Bb=this.Pdi(Ib,Gc,Bb,y.a.eb(f.a.hF)===fc,!1);if(!Wb&&!Bb||Wb&&Bb&&!nc.equals(Gc))return v.a.instance.Ba(557061776,
1,1,"BookmarkNodeComplexMerge: Failed to merge BookmarkParaIds [Id: {0}] and [Id: {1}] for [Type: {3}] because either no BookmarkParagraph Start/End is found, or two BookmarkParagraph Start/End are found in different paragraphs respectively",nc,Gc,y.a.eb(f.a.hF)===fc?"StartBookmarkParaId":"EndBookmarkParaId"),!1;Ib.Vc.setPropertyObjectId(tc,kc,Wb?nc:Gc);Ib.hg.add(fc);v.a.instance.Ba(557061777,1,3,"BookmarkNodeComplexMerge: Successfully completed custom merge on bookmarks");return!0}Pdi(Ib,nc,Gc,tc,
fc){if(!nc)return v.a.instance.Ba(557061778,1,1,"BookmarkNodeComplexMerge: paragraphId is null, skip this paragraph"),!1;const kc=Ib.Jm.runtime.Fl;var Bb=kc.get(nc),Wb=null;if(Bb&&Bb.tj)Wb=Bb.tj;else{Bb=Ib.Jm.runtime.Aw.get(nc)||Ib.Jm.runtime.pj.J(nc);if(!Bb)return v.a.instance.Ba(557061779,1,3,"BookmarkNodeComplexMerge: paragraphNode or paragraph object is null, skip this paragraph"),!1;Wb=Bb}if(!Wb.hasProperty(x.a.BC))return v.a.instance.Ba(557061661,1,3,"BookmarkNodeComplexMerge: Paragraph does not paragraph properties, skip this paragraph"),
!1;Bb=Ib.Vc.getPropertyObjectIds(Wb,x.a.BC);if(!Bb)return v.a.instance.Ba(557061662,1,3,"BookmarkNodeComplexMerge: textRunFormattingGuids is null, skip this paragraph"),!1;Wb=!1;for(let jc=0;jc<Bb.length;jc++){const Rb=Ib.Jm.runtime.pj.J(Bb.J(jc));if(Rb&&Rb.hasProperty(f.a.tq)&&Gc.equals(Ib.Vc.getPropertyObjectId(Rb,f.a.apb))){Wb=!0;if(!tc&&44===Ib.Vc.getPropertyUint32(Rb,f.a.tq))return v.a.instance.Ba(557061780,1,3,"BookmarkNodeComplexMerge: Paragraph contains BookMarkStart Placeholder but we are looking for BookmarkEnd Placeholder, skip this paragraph"),
!1;if(tc&&45===Ib.Vc.getPropertyUint32(Rb,f.a.tq))return v.a.instance.Ba(557061781,1,3,"BookmarkNodeComplexMerge: Paragraph contains BookmarkEnd Placeholder but we are looking for BookMarkStart Placeholder, skip this paragraph"),!1}}if(!Wb)return v.a.instance.Ba(557061782,1,3,"BookmarkNodeComplexMerge: Paragraph does not contain BookMark PlaceholderKind, skip this paragraph"),!1;let zb=null,Gb=!0;(fc?Ib.Jm.runtime.Aw:Ib.Jm.runtime.wp).forEach((jc,Rb)=>{393229===Rb.Kb&&Ib.Vc.getPropertyObjectIds(Rb,
x.a.Tda).UG().contains(nc)&&(zb=Rb,Gb=!1);return Gb});if(!zb)return v.a.instance.Ba(557061783,1,3,"BookmarkNodeComplexMerge: Paragraph does not map to an OE, skip this paragraph"),!1;let gc=null;Gb=!0;kc.forEach((jc,Rb)=>{393241===Rb.tj.Kb&&Ib.Vc.getPropertyObjectIds(Rb.tj,x.a.$e).UG().contains(zb.id)&&(gc=Rb.tj,Gb=!1);return Gb});return gc?!0:(v.a.instance.Ba(557061784,1,3,"BookmarkNodeComplexMerge: OE does not map to an OGN, skip this paragraph"),!1)}Ud(Ib){return Ib&&Ib.length?!1:!0}static ih(){return new M}static get instance(){return M.Ig.value}}
M.Ig=new c.a(M.ih);Object(z.a)(M,"BookmarkNodeComplexMerge",n.a,[]);class R extends n.a{constructor(){super();this.see=!1}get Bn(){return 7}rk(){const Ib=super.rk();Ib.W(y.a.eb(x.a.$e),1);return Ib}HC(Ib,nc){if(nc===y.a.eb(x.a.$e)){const fc=Ib.ll,kc=Ib.Vc;var Gc=Ib.Jm.runtime.Qa;Gc&&(this.see=Gc.isFeatureEnabled(122));v.a.instance.Ba(4511579,1,3,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",fc.id,fc.Kb,nc);nc=kc.getPropertyObjectIds(Ib.Nf.value.at,
x.a.$e);Gc=kc.getPropertyObjectIds(Ib.Nf.value.He,x.a.$e);var tc=kc.getPropertyObjectIds(Ib.Mm.value.He,x.a.$e);nc=this.iFl(nc,Gc,tc);if(this.see&&0<nc.length){Gc=new Sys.StringBuilder;for(tc=0;tc<nc.length;tc++)Gc.append(nc.J(tc).toString()+",");v.a.instance.Ba(559710276,1,3,"Merge result for CommentContentNode {0}: {1}",fc.id,Gc.toString())}0<nc.length?kc.setPropertyObjectIds(fc,x.a.$e,nc):fc.removeProperty(x.a.$e);Ib.hg.add(y.a.eb(x.a.$e));return!0}v.a.instance.Ba(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Ib.Nf.value.He.id,nc);return!1}iFl(Ib,nc,Gc){const tc=new P.a,fc=new F.a(0);this.eyk(Ib,Gc,tc,fc);return this.vnk(nc,fc,tc)}eyk(Ib,nc,Gc,tc){Ib=Ib||new P.a;nc=nc||new P.a;Ib.forEach(fc=>{tc.W(fc,1);return!0});nc.forEach(fc=>{tc.xb(fc).returnValue?tc.W(fc,2):(tc.W(fc,0),Gc.add(fc));return!0})}vnk(Ib,nc,Gc){Ib=Ib||new P.a;const tc=new P.a,fc=new P.a,kc=new P.a;Ib.forEach(Bb=>{let Wb=!0,zb;({value:zb}=nc.xb(Bb)).returnValue&&(zb?1===zb&&(Wb=!1):nc.W(Bb,2));Wb?tc.add(Bb):this.see&&fc.add(Bb);return!0});
Gc.forEach(Bb=>{let Wb=!1,zb;({value:zb}=nc.xb(Bb)).returnValue?zb||(Wb=!0,nc.W(Bb,2)):v.a.instance.Ba(4511585,1,3,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Bb);Wb?tc.add(Bb):this.see&&kc.add(Bb);return!0});this.rli(fc,"Favored");this.rli(kc,"Unfavored");return tc}rli(Ib,nc){if(Ib.length){var Gc=new Sys.StringBuilder;for(let tc=0;tc<Ib.length;tc++)Gc.append(Ib.J(tc).toString()+",");v.a.instance.Ba(561637572,
1,3,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",nc,Gc.toString())}}static ih(){return new R}static get instance(){return R.Ig.value}}R.Ig=new c.a(R.ih);Object(z.a)(R,"CommentContentNodeComplexMerge",n.a,[]);class W extends n.a{constructor(){super()}get Bn(){return 8}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.S9),3);Ib.W(y.a.eb(f.a.HH),3);Ib.W(y.a.eb(f.a.F3c),2);Ib.W(y.a.eb(f.a.commentId),2);Ib.W(y.a.eb(f.a.Kxh),2);Ib.W(y.a.eb(f.a.wIa),2);Ib.W(y.a.eb(f.a.oUa),1);Ib.W(y.a.eb(f.a.bub),
1);Ib.W(y.a.eb(f.a.fvb),1);Ib.W(y.a.eb(f.a.Nda),1);Ib.W(y.a.eb(f.a.VE),1);Ib.W(y.a.eb(x.a.$e),0);Ib.W(y.a.eb(f.a.hD),0);return Ib}HC(Ib,nc){if(nc!==y.a.eb(f.a.oUa)&&nc!==y.a.eb(f.a.bub)&&nc!==y.a.eb(f.a.fvb)&&nc!==y.a.eb(f.a.VE)&&nc!==y.a.eb(f.a.Nda))return!1;const Gc=Ib.Jm.runtime.Qa,tc=Ib.Nf.value.He;var fc=Ib.Mm.value.He;const kc=Ib.ll;if(nc===y.a.eb(f.a.oUa)){nc=Ib.Vc.getPropertyString(tc,f.a.oUa);fc=Ib.Vc.getPropertyString(fc,f.a.oUa);fc=this.Ud(nc)?fc:this.Ud(fc)?nc:null;if(this.Ud(fc))return!1;
Ib.Vc.setPropertyString(kc,f.a.oUa,fc);Ib.hg.add(y.a.eb(f.a.oUa));return!0}if(nc===y.a.eb(f.a.fvb))return nc=Ib.Vc.getPropertyBool(tc,f.a.fvb),fc=Ib.Vc.getPropertyBool(fc,f.a.fvb),nc=null!=nc?nc:!1,nc=(null!=fc?fc:!1)||nc,Ib.Vc.setPropertyBool(kc,f.a.fvb,nc),Ib.hg.add(y.a.eb(f.a.fvb)),!0;if(nc===y.a.eb(f.a.bub)){nc=Ib.Vc.getPropertyBool(tc,f.a.bub);fc=Ib.Vc.getPropertyBool(fc,f.a.bub);if(nc===fc)return!0;nc=null!=nc?nc:!1;nc=(null!=fc?fc:!1)||nc;Ib.Vc.setPropertyBool(kc,f.a.bub,nc);return!0}if(nc===
y.a.eb(f.a.VE)){nc=Ib.Vc.getPropertyBool(tc,f.a.VE);fc=Ib.Vc.getPropertyBool(fc,f.a.VE);if(nc===fc)return!0;nc=null!=nc?nc:!1;nc=(null!=fc?fc:!1)||nc;Ib.Vc.setPropertyBool(kc,f.a.VE,nc);Ib.hg.add(y.a.eb(f.a.VE));return!0}if(nc===y.a.eb(f.a.Nda)){Gc.us(25);if(!Gc.isFeatureEnabled(25))return!1;nc=Ib.Vc.getPropertyString(tc,f.a.Nda);fc=Ib.Vc.getPropertyString(fc,f.a.Nda);if(nc===fc)return!0;Ib.Vc.setPropertyString(kc,f.a.Nda,fc||nc);Ib.hg.add(y.a.eb(f.a.Nda));return!0}return!1}Ud(Ib){return Ib&&Ib.length?
!1:!0}static ih(){return new W}static get instance(){return W.Ig.value}}W.Ig=new c.a(W.ih);Object(z.a)(W,"CommentNodeComplexMerge",n.a,[]);var Y=b(2);class N extends n.a{constructor(){super()}get Bn(){return 46}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.contentControlNode),1);Ib.W(y.a.eb(x.a.lastModifiedTime),0);Ib.W(y.a.eb(f.a.w4c),5);return Ib}HC(Ib,nc){var Gc=Ib.Jm.runtime.Qa;Y.AFrameworkApplication.qr("Word-TOCMerge;Word-TOCMergecf");if(!Gc.Vab(1000005))return!1;if(nc===y.a.eb(f.a.contentControlNode)){v.a.instance.Ba(556865370,
1,3,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ib.ll.id,Ib.ll.Kb,nc);Gc=y.a.oka(nc);const Bb=Ib.Vc;var tc=Bb.getPropertyObjectIds(Ib.Nf.value.at,Gc),fc=Bb.getPropertyObjectIds(Ib.Nf.value.He,Gc),kc=Bb.getPropertyObjectIds(Ib.Mm.value.He,Gc);kc=N.V3k(kc,Ib.Jm.runtime.MDc);tc=this.SXa(tc,fc,kc);fc=Ib.ll;0<tc.length?Bb.setPropertyObjectIds(fc,Gc,tc):fc.removeProperty(Gc);Ib.hg.add(nc);return!0}v.a.instance.Ba(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",
Ib.Nf.value.He.id,nc);return!1}static ih(){return new N}static get instance(){return N.Ig.value}static V3k(Ib,nc){const Gc=new P.a;Ib.forEach(tc=>{nc.contains(tc,(fc,kc)=>fc.equals(kc))||Gc.add(tc);return!0});return Gc}}N.Ig=new c.a(N.ih);Object(z.a)(N,"ContentControlContainerNodeComplexMerge",n.a,[]);class aa extends n.a{constructor(){super()}get Bn(){return 37}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.T9),1);Ib.W(y.a.eb(f.a.hj),1);Ib.W(y.a.eb(f.a.Vh),1);Ib.W(y.a.eb(f.a.Qbc),1);Ib.W(y.a.eb(f.a.Fpf),
2);Ib.W(y.a.eb(f.a.Epf),2);return Ib}HC(Ib,nc){var Gc=Ib.Mm.value.He;const tc=Ib.ll;if(nc===y.a.eb(f.a.T9))return nc=Ib.Vc.getPropertyBool(Gc,f.a.T9),null==nc||nc||(Ib.Vc.setPropertyBool(tc,f.a.T9,!1),Ib.hg.add(y.a.eb(f.a.T9))),!0;var fc=Ib.Nf.value.He;if(nc===y.a.eb(f.a.Qbc)){nc=Ib.Vc.getPropertyObjectId(fc,f.a.Qbc);var kc=Ib.Vc.getPropertyObjectId(Gc,f.a.Qbc);if(nc&&!nc.equals(kc))return!1;if(nc=nc||kc)Ib.Vc.setPropertyObjectId(tc,f.a.Qbc,nc),Ib.hg.add(y.a.eb(f.a.Qbc));return!0}if(nc===y.a.eb(f.a.hj)||
nc===y.a.eb(f.a.Vh)){kc=y.a.oka(nc);fc=Ib.Vc.getPropertyObjectId(fc,kc);Gc=Ib.Vc.getPropertyObjectId(Gc,kc);const Bb=this.Odi(Ib,Ib.ll.id,fc),Wb=this.Odi(Ib,Ib.ll.id,Gc);if(fc&&fc.equals(Gc))return!0;if(fc&&!Ib.Jm.runtime.Fl.get(fc)||Bb&&Wb)return!1;(fc=Bb?fc:Wb?Gc:null)?Ib.Vc.setPropertyObjectId(tc,kc,fc):tc.removeProperty(kc);Ib.hg.add(nc);return!0}return!1}Odi(Ib,nc,Gc){if(!Gc)return!1;const tc=Ib.Jm.runtime.Fl;Gc=tc.get(Gc);if(!Gc||!Gc.tj)return!1;Gc=Ib.Vc.getPropertyObjectIds(Gc.tj,x.a.BC);if(!Gc)return!1;
for(let kc=0;kc<Gc.length;kc++){var fc=Gc.J(kc);if((fc=tc.get(fc))&&fc.tj&&(fc=Ib.Vc.getPropertyObjectId(fc.tj,f.a.qd))&&fc.equals(nc))return!0}return!1}static ih(){return new aa}static get instance(){return aa.Ig.value}}aa.Ig=new c.a(aa.ih);Object(z.a)(aa,"ContentControlNodeComplexMerge",n.a,[]);class ia extends n.a{constructor(){super()}get Bn(){return 10}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.customXmlPartNode),1);return Ib}HC(Ib,nc){if(nc===y.a.eb(f.a.customXmlPartNode)){nc=Ib.ll;const tc=Ib.Vc;
var Gc=tc.getPropertyObjectIds(Ib.Nf.value.at,f.a.customXmlPartNode);const fc=tc.getPropertyObjectIds(Ib.Nf.value.He,f.a.customXmlPartNode),kc=tc.getPropertyObjectIds(Ib.Mm.value.He,f.a.customXmlPartNode);Gc=this.jFl(Gc,fc,kc);0<Gc.length?tc.setPropertyObjectIds(nc,f.a.customXmlPartNode,Gc):nc.removeProperty(f.a.customXmlPartNode);Ib.hg.add(y.a.eb(f.a.customXmlPartNode));return!0}return!1}jFl(Ib,nc,Gc){return this.SXa(Ib,nc,Gc)}static ih(){return new ia}static get instance(){return ia.Ig.value}}ia.Ig=
new c.a(ia.ih);Object(z.a)(ia,"CustomXmlPartContainerNodeComplexMerge",n.a,[]);class ea extends n.a{constructor(){super()}get Bn(){return 9}get nD(){return 0}static ih(){return new ea}static get instance(){return ea.Ig.value}}ea.Ig=new c.a(ea.ih);Object(z.a)(ea,"CustomXmlPartNodeComplexMerge",n.a,[]);class la extends n.a{constructor(){super()}get Bn(){return 29}get nD(){return 3}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.embeddedFontNode),1);return Ib}HC(Ib,nc){if(nc===y.a.eb(f.a.embeddedFontNode)){nc=
Ib.Vc;var Gc=nc.getPropertyObjectIds(Ib.Nf.value.at,f.a.embeddedFontNode),tc=nc.getPropertyObjectIds(Ib.Nf.value.He,f.a.embeddedFontNode);const fc=nc.getPropertyObjectIds(Ib.Mm.value.He,f.a.embeddedFontNode);Gc=this.SXa(Gc,tc,fc);tc=Ib.ll;0<Gc.length?nc.setPropertyObjectIds(tc,f.a.embeddedFontNode,Gc):tc.removeProperty(f.a.embeddedFontNode);Ib.hg.add(y.a.eb(f.a.embeddedFontNode));return!0}return!1}static ih(){return new la}static get instance(){return la.Ig.value}}la.Ig=new c.a(la.ih);Object(z.a)(la,
"EmbeddedFontContainerNodeComplexMerge",n.a,[]);class xa extends n.a{constructor(){super()}get Bn(){return 30}get nD(){return 3}static ih(){return new xa}static get instance(){return xa.Ig.value}}xa.Ig=new c.a(xa.ih);Object(z.a)(xa,"EmbeddedFontNodeComplexMerge",n.a,[]);class Ha extends n.a{constructor(){super()}get Bn(){return 11}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.dQ),4);Ib.W(y.a.eb(f.a.pVa),1);return Ib}HC(Ib,nc){if(nc===y.a.eb(f.a.pVa)){const Gc=Ib.ll,tc=Ib.Vc;v.a.instance.Ba(4063307,1,3,
"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Gc.id,Gc.Kb,nc);nc=tc.getPropertyObjectIds(Ib.Nf.value.at,f.a.pVa);const fc=tc.getPropertyObjectIds(Ib.Nf.value.He,f.a.pVa),kc=tc.getPropertyObjectIds(Ib.Mm.value.He,f.a.pVa);nc=this.loi(nc,fc,kc,(Bb,Wb)=>Bb.equals(Wb));0<nc.length?tc.setPropertyObjectIds(Gc,f.a.pVa,nc):Gc.removeProperty(f.a.pVa);Ib.hg.add(y.a.eb(f.a.pVa));return!0}v.a.instance.Ba(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Ib.Nf.value.He.id,nc);return!1}static ih(){return new Ha}static get instance(){return Ha.Ig.value}}Ha.Ig=new c.a(Ha.ih);Object(z.a)(Ha,"FootnoteEndnoteContainerNodeComplexMerge",n.a,[]);class ua extends n.a{constructor(){super()}get Bn(){return 12}get nD(){return 3}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.jZ),1);return Ib}HC(Ib,nc){const Gc=Ib.ll,tc=Ib.Vc;if(nc===y.a.eb(f.a.jZ)){let fc=-1;v.a.instance.Ba(5002527,1,3,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Gc.id,Gc.Kb,nc);const kc=tc.getPropertyInt32(Ib.Nf.value.He,f.a.jZ),Bb=tc.getPropertyInt32(Ib.Mm.value.He,f.a.jZ);null!=kc&&-1!==kc?fc=kc:null!=Bb&&(fc=Bb);tc.setPropertyInt32(Gc,f.a.jZ,fc);Ib.hg.add(nc);return!0}v.a.instance.Ba(5002528,1,3,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ib.Nf.value.at.id,nc);return!1}static ih(){return new ua}static get instance(){v.a.instance.Ba(5002526,1,3,"FootnoteEndnoteNodeComplexMerge: Got Instance");
return ua.Ig.value}}ua.Ig=new c.a(ua.ih);Object(z.a)(ua,"FootnoteEndnoteNodeComplexMerge",n.a,[]);class Ra extends n.a{constructor(){super()}get Bn(){return 13}get nD(){return 3}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.Oaa),4);return Ib}static ih(){return new Ra}static get instance(){return Ra.Ig.value}}Ra.Ig=new c.a(Ra.ih);Object(z.a)(Ra,"HeaderFooterContainerNodeComplexMerge",n.a,[]);var ab=b(37);class Ba extends n.a{constructor(){super()}get Bn(){return 14}get nD(){return 3}rk(){const Ib=super.rk();
Ib.W(y.a.eb(f.a.runId),3);Ib.W(y.a.eb(f.a.Gb),3);Ib.W(y.a.eb(f.a.E$h),3);Ib.W(y.a.eb(f.a.lW),1);Ib.W(y.a.eb(ab.a.gfa),1);Ib.W(y.a.eb(x.a.m6),1);Ib.W(y.a.eb(f.a.R1),1);Ib.W(y.a.eb(x.a.rma),1);Ib.W(y.a.eb(ab.a.cjb),1);Ib.W(y.a.eb(f.a.Lob),1);return Ib}HC(Ib,nc){if(nc===y.a.eb(x.a.m6)||nc===y.a.eb(f.a.R1)||nc===y.a.eb(f.a.lW)||nc===y.a.eb(f.a.KN)||nc===y.a.eb(x.a.obb)||nc===y.a.eb(x.a.rma)||nc===y.a.eb(ab.a.gfa)||nc===y.a.eb(ab.a.cjb)||nc===y.a.eb(f.a.Lob)){const tc=Ib.ll;var Gc=Ib.Vc;v.a.instance.Ba(4018185,
1,3,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",tc.id,tc.Kb,nc);const fc=Gc.getPropertyInt32(Ib.Nf.value.He,ab.a.gfa);Gc=Gc.getPropertyInt32(Ib.Mm.value.He,ab.a.gfa);if(null!=fc&&(!fc||2===fc))return!0;if(null!=Gc&&(!Gc||2===Gc))return nc=Ib.Mm.value.He,this.kqb(nc,tc,x.a.m6),this.kqb(nc,tc,f.a.R1),this.kqb(nc,tc,f.a.KN),nc.hasProperty(f.a.lW)&&this.kqb(nc,tc,f.a.lW),this.kqb(nc,tc,x.a.obb),this.kqb(nc,tc,x.a.rma),this.kqb(nc,tc,ab.a.gfa),this.kqb(nc,
tc,ab.a.cjb),Ib.hg.add(y.a.eb(x.a.m6)),Ib.hg.add(y.a.eb(f.a.R1)),Ib.hg.add(y.a.eb(f.a.KN)),Ib.hg.add(y.a.eb(f.a.lW)),Ib.hg.add(y.a.eb(x.a.obb)),Ib.hg.add(y.a.eb(x.a.rma)),Ib.hg.add(y.a.eb(ab.a.gfa)),Ib.hg.add(y.a.eb(ab.a.cjb)),Ib.hg.add(y.a.eb(f.a.Lob)),!0}v.a.instance.Ba(4018186,1,3,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ib.Nf.value.at.id,nc);return!1}static ih(){return new Ba}static get instance(){return Ba.Ig.value}}Ba.Ig=new c.a(Ba.ih);
Object(z.a)(Ba,"ImageNodeComplexMerge",n.a,[]);class Ga extends n.a{constructor(){super()}get Bn(){return 40}get nD(){return 0}static ih(){return new Ga}static get instance(){return Ga.Ig.value}}Ga.Ig=new c.a(Ga.ih);Object(z.a)(Ga,"IntelligenceAnnotationNodeComplexMerge",n.a,[]);class ja extends n.a{constructor(){super()}get Bn(){return 32}get nD(){return 0}static ih(){return new ja}static get instance(){return ja.Ig.value}}ja.Ig=new c.a(ja.ih);Object(z.a)(ja,"IntelligenceContentLocatorNodeComplexMerge",
n.a,[]);class X extends n.a{constructor(){super()}get Bn(){return 34}get nD(){return 0}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.Obb),1);return Ib}HC(Ib,nc){const Gc=Ib.ll,tc=Ib.Vc;if(nc===y.a.eb(f.a.Obb)){nc=tc.getPropertyObjectIds(Ib.Nf.value.at,f.a.Obb);const fc=tc.getPropertyObjectIds(Ib.Nf.value.He,f.a.Obb),kc=tc.getPropertyObjectIds(Ib.Mm.value.He,f.a.Obb);nc=this.SXa(nc,fc,kc);tc.setPropertyObjectIds(Gc,f.a.Obb,nc);Ib.hg.add(y.a.eb(f.a.Obb));return!0}return!1}static ih(){return new X}static get instance(){return X.Ig.value}}
X.Ig=new c.a(X.ih);Object(z.a)(X,"IntelligenceRegionNodeComplexMerge",n.a,[]);class fa extends n.a{constructor(){super()}get Bn(){return 35}get nD(){return 0}static ih(){return new fa}static get instance(){return fa.Ig.value}}fa.Ig=new c.a(fa.ih);Object(z.a)(fa,"IntelligenceRejectionNodeComplexMerge",n.a,[]);class pa extends n.a{constructor(){super()}get Bn(){return 39}get nD(){return 0}static ih(){return new pa}static get instance(){return pa.Ig.value}}pa.Ig=new c.a(pa.ih);Object(z.a)(pa,"IntelligenceReviewedNodeComplexMerge",
n.a,[]);class Ia extends n.a{constructor(){super()}get Bn(){return 33}get nD(){return 0}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.Gtc),1);Ib.W(y.a.eb(f.a.khd),1);Ib.W(y.a.eb(f.a.Pde),1);Ib.W(y.a.eb(f.a.Qde),1);return Ib}HC(Ib,nc){const Gc=Ib.ll,tc=Ib.Vc;if(nc===y.a.eb(f.a.Gtc)||nc===y.a.eb(f.a.khd)||nc===y.a.eb(f.a.Pde)||nc===y.a.eb(f.a.Qde)){nc=nc===y.a.eb(f.a.Gtc)?f.a.Gtc:f.a.khd;var fc=tc.getPropertyObjectIds(Ib.Nf.value.at,nc);const kc=tc.getPropertyObjectIds(Ib.Nf.value.He,nc),Bb=tc.getPropertyObjectIds(Ib.Mm.value.He,
nc);fc=this.SXa(fc,kc,Bb);tc.setPropertyObjectIds(Gc,nc,fc);Ib.hg.add(y.a.eb(nc));return!0}return!1}static ih(){return new Ia}static get instance(){return Ia.Ig.value}}Ia.Ig=new c.a(Ia.ih);Object(z.a)(Ia,"IntelligenceRootNodeComplexMerge",n.a,[]);class ta extends n.a{constructor(){super()}get Bn(){return 15}get nD(){return 3}static ih(){return new ta}static get instance(){return ta.Ig.value}}ta.Ig=new c.a(ta.ih);Object(z.a)(ta,"NumberListNodeComplexMerge",n.a,[]);var oa=b(108);class va extends n.a{constructor(){super()}get Bn(){return 16}get nD(){return 0}rk(){const Ib=
super.rk();Ib.W(y.a.eb(f.a.MOb),1);Ib.W(y.a.eb(oa.a.Xxh),7);Ib.W(y.a.eb(oa.a.Wxh),7);return Ib}HC(Ib,nc){const Gc=Ib.ll,tc=Ib.Vc;if(nc===y.a.eb(f.a.MOb))return this.P0f(tc,Ib.Nf.value.He,Ib.Mm.value.He,Gc,f.a.MOb),Ib.hg.add(nc),!0;v.a.instance.Ba(4207940,1,3,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ib.Nf.value.at.id,nc);return!1}static ih(){return new va}static get instance(){return va.Ig.value}}va.Ig=new c.a(va.ih);
Object(z.a)(va,"OutlineElementNodeComplexMerge",n.a,[]);class Fa extends n.a{constructor(){super()}get Bn(){return 17}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.MOb),1);Ib.W(y.a.eb(f.a.b$),1);Ib.W(y.a.eb(oa.a.aC),1);Ib.W(y.a.eb(oa.a.dwc),1);Ib.W(y.a.eb(oa.a.xaa),8);return Ib}HC(Ib,nc){const Gc=Ib.ll,tc=Ib.Vc;if(nc===y.a.eb(f.a.MOb))return this.P0f(tc,Ib.Nf.value.He,Ib.Mm.value.He,Gc,f.a.MOb),Ib.hg.add(nc),!0;if(nc===y.a.eb(f.a.b$)){var fc=tc.getPropertyBool(Ib.Nf.value.He,f.a.b$),kc=tc.getPropertyBool(Ib.Mm.value.He,
f.a.b$);tc.setPropertyBool(Gc,f.a.b$,null==fc?!1:fc&&null==kc?!1:kc);Ib.hg.add(nc);return!0}if(nc===y.a.eb(oa.a.dwc))return this.P0f(tc,Ib.Nf.value.He,Ib.Mm.value.He,Gc,oa.a.dwc),Ib.hg.add(nc),!0;if(nc===y.a.eb(oa.a.aC))return fc=tc.getPropertyBool(Ib.Nf.value.He,oa.a.aC),kc=tc.getPropertyBool(Ib.Mm.value.He,oa.a.aC),tc.setPropertyBool(Gc,oa.a.aC,null==fc?!0:fc||null==kc?!0:kc),Ib.hg.add(nc),!0;v.a.instance.Ba(4057305,1,3,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Ib.Nf.value.at.id,nc);return!1}static ih(){return new Fa}static get instance(){return Fa.Ig.value}}Fa.Ig=new c.a(Fa.ih);Object(z.a)(Fa,"OutlineGroupNodeComplexMerge",n.a,[]);var cb=b(48),Za=b(40);class gb extends n.a{constructor(){super()}get Bn(){return 18}get nD(){return 2}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.Vbe),3);Ib.W(y.a.eb(f.a.Vt),1);Ib.W(y.a.eb(f.a.rP),1);Ib.W(y.a.eb(f.a.YL),1);Ib.W(y.a.eb(f.a.UN),1);Ib.W(y.a.eb(f.a.Vv),1);return Ib}HC(Ib,nc){const Gc=Ib.Vc;if(Ib.Jm.runtime.Qa.isFeatureEnabled(116)){if(nc===
y.a.eb(f.a.Vt)||nc===y.a.eb(f.a.YL)||nc===y.a.eb(f.a.rP)||nc===y.a.eb(f.a.Vv)||nc===y.a.eb(f.a.UN))return this.WNm(Gc,Ib)}else if(nc===y.a.eb(f.a.Vt)||nc===y.a.eb(f.a.Vv)){let tc,fc;({e4c:nc,mcb:tc,bcb:fc}=this.Xlf(Object(Za.a)(Gc,Gc.getPropertyUint32s,"getPropertyUint32s"),Ib.Nf.value.at,Ib.Nf.value.He,Ib.Mm.value.He,f.a.Vt,null));if(!fc&&!tc)return v.a.instance.Ba(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Ib.Nf.value.He.id,y.a.eb(f.a.Vt)),!0;let kc,Bb,Wb;({e4c:kc,mcb:Bb,bcb:Wb}=this.Xlf(Object(Za.a)(Gc,Gc.getPropertyObjectIds,"getPropertyObjectIds"),Ib.Nf.value.at,Ib.Nf.value.He,Ib.Mm.value.He,f.a.Vv,null));if(!Bb&&!Wb)return v.a.instance.Ba(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Ib.Nf.value.He.id,y.a.eb(f.a.Vv)),!0;const zb=Bb&&!Wb;if((tc&&!fc)!==zb)return v.a.instance.Ba(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Ib.Nf.value.He.id,y.a.eb(f.a.Vt),y.a.eb(f.a.Vv)),!1;zb&&(Gc.setPropertyObjectIds(Ib.ll,f.a.Vv,kc),Gc.setPropertyUint32s(Ib.ll,f.a.Vt,nc));v.a.instance.Ba(4318877,1,3,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",Ib.Nf.value.He.id,y.a.eb(f.a.Vt),tc,fc,y.a.eb(f.a.Vv),Bb,Wb);Ib.hg.add(y.a.eb(f.a.Vv));Ib.hg.add(y.a.eb(f.a.Vt));
return!0}v.a.instance.Ba(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ib.Nf.value.He.id,nc);return!1}m5h(Ib,nc,Gc,tc){let fc;({e4c:nc,mcb:tc,bcb:fc}=this.Xlf(nc,Gc.Nf.value.at,Gc.Nf.value.He,Gc.Mm.value.He,Ib,tc));return fc||tc?{returnValue:!0,Tof:nc,mcb:tc,bcb:fc}:(v.a.instance.Ba(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Gc.Nf.value.He.id.toString(),y.a.eb(Ib)),{returnValue:!1,Tof:nc,mcb:tc,bcb:fc})}v4h(Ib,nc,Gc,tc,fc){let kc;let Bb,Wb,zb,Gb;({Tof:kc,mcb:gc,bcb:Bb,returnValue:zb}=this.m5h(Ib,Object(Za.a)(Gc,Gc.getPropertyUint32s,"getPropertyUint32s"),tc,null));({Tof:Gc,mcb:fc,bcb:Wb,returnValue:Gb}=this.m5h(nc,Object(Za.a)(Gc,Gc.getPropertyObjectIds,"getPropertyObjectIds"),tc,fc));var gc=gc&&!Bb;return zb&&Gb?gc!==(fc&&!Wb)?(v.a.instance.Ba(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
tc.Nf.value.He.id.toString(),y.a.eb(Ib),y.a.eb(nc)),{returnValue:2,I1d:kc,G1d:Gc,Kye:gc}):{returnValue:0,I1d:kc,G1d:Gc,Kye:gc}:{returnValue:1,I1d:kc,G1d:Gc,Kye:gc}}CWf(Ib){let nc=!0;Ib.forEach(Gc=>Gc!==cb.a.nil?nc=!1:!0);return nc}CNk(Ib,nc,Gc){return this.CWf(Ib)&&this.CWf(nc)&&this.CWf(Gc)?!0:!1}WNm(Ib,nc){let Gc,tc,fc,kc,Bb,Wb;var zb=({I1d:kc,G1d:Bb,Kye:tc}=this.v4h(f.a.rP,f.a.Vv,Ib,nc,null)).returnValue;if(2===zb||1===zb)return!0;({I1d:fc,G1d:Wb,Kye:Gc,returnValue:zb}=this.v4h(f.a.Vt,f.a.YL,Ib,
nc,Object(Za.a)(this,this.CNk,"getExtendedGuidEquivalence")));if(2===zb||1===zb)return!0;let Gb;nc.Jm.runtime.Qa.Jbe(1000002);({e4c:zb,mcb:gc,bcb:Gb}=this.o4j(Object(Za.a)(Ib,Ib.getPropertyDictionary,"getPropertyDictionary"),nc.Nf.value.at,nc.Nf.value.He,nc.Mm.value.He,f.a.UN,nc.Jm.runtime.Qa.Vab(1000002)));if(!Gb&&!gc)return v.a.instance.Ba(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",nc.Nf.value.He.id.toString(),
y.a.eb(f.a.UN)),!0;var gc=gc&&!Gb;if(Gc!==tc||Gc!==gc)return v.a.instance.Ba(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",nc.Nf.value.He.id.toString(),y.a.eb(f.a.Vt),y.a.eb(f.a.rP),y.a.eb(f.a.UN),tc,Gc,gc),!0;Gc&&(Ib.setPropertyObjectIds(nc.ll,f.a.Vv,Bb),Ib.setPropertyUint32s(nc.ll,
f.a.rP,kc),Ib.setPropertyObjectIds(nc.ll,f.a.YL,Wb),Ib.setPropertyUint32s(nc.ll,f.a.Vt,fc),Ib.setPropertyDictionary(nc.ll,f.a.UN,zb));v.a.instance.Ba(592545118,1,3,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingAbsListId: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",nc.Nf.value.He.id.toString(),tc,Gc,gc);nc.hg.add(y.a.eb(f.a.rP));nc.hg.add(y.a.eb(f.a.Vv));nc.hg.add(y.a.eb(f.a.Vt));nc.hg.add(y.a.eb(f.a.YL));nc.hg.add(y.a.eb(f.a.UN));return!0}static ih(){return new gb}static get instance(){return gb.Ig.value}}
gb.Ig=new c.a(gb.ih);Object(z.a)(gb,"PageContentNodeComplexMerge",n.a,[]);class Ya extends n.a{constructor(){super()}get Bn(){return 19}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.eha),1);Ib.W(y.a.eb(f.a.appsNode),2);Ib.W(y.a.eb(f.a.customXmlPartContainerNode),2);return Ib}HC(Ib,nc){if(nc===y.a.eb(f.a.eha)){const tc=Ib.Vc;var Gc=tc.getPropertyObjectIds(Ib.Nf.value.at,f.a.eha);const fc=tc.getPropertyObjectIds(Ib.Nf.value.He,f.a.eha),kc=tc.getPropertyObjectIds(Ib.Mm.value.He,f.a.eha);Gc=this.vFl(Gc,fc,
kc,Bb=>{let Wb;({value:Wb}=Ib.Jm.runtime.wp.xb(Bb)).returnValue?Ib.Jm.runtime.Fl.W(Bb,new t.a(Wb,!1)):v.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")});if(0<Gc.length)return tc.setPropertyObjectIds(Ib.ll,f.a.eha,Gc),Ib.hg.add(y.a.eb(f.a.eha)),!0}v.a.instance.Ba(4018187,1,3,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ib.Nf.value.He.id,
nc);return!1}static ih(){return new Ya}static get instance(){return Ya.Ig.value}}Ya.Ig=new c.a(Ya.ih);Object(z.a)(Ya,"PageManifestNodeComplexMerge",n.a,[]);var fb=b(1639);class ib extends n.a{constructor(){super()}get Bn(){return 43}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.P0),0);Ib.W(y.a.eb(f.a.pBa),0);Ib.W(y.a.eb(f.a.EAa),0);Ib.W(y.a.eb(f.a.bfa),1);return Ib}HC(Ib,nc){if(nc===y.a.eb(f.a.bfa)){nc=Ib.Vc;var Gc=Ib.Nf.value.at,tc=Ib.Mm.value.He,fc=Ib.Nf.value.He;Gc=Gc?nc.getPropertyObjectId(Gc,f.a.bfa):
null;tc=tc?nc.getPropertyObjectId(tc,f.a.bfa):null;fc=fc?nc.getPropertyObjectId(fc,f.a.bfa):null;v.a.instance.Ba(589657691,1,3,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",Gc?Gc.toString():"NULL",tc?tc.toString():"NULL",fc?fc.toString():"NULL");if(tc){if(fc&&tc.equals(fc))return Ib.hg.add(y.a.eb(f.a.bfa)),nc.setPropertyObjectId(Ib.ll,f.a.bfa,tc),!0;if(fb.a.Hbe.equals(tc))return Ib.hg.add(y.a.eb(f.a.bfa)),nc.setPropertyObjectId(Ib.ll,f.a.bfa,fb.a.Hbe),!0}if(fc&&fb.a.Hbe.equals(fc))return Ib.hg.add(y.a.eb(f.a.bfa)),
nc.setPropertyObjectId(Ib.ll,f.a.bfa,fb.a.Hbe),!0;v.a.instance.Ba(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",Gc?Gc.toString():"NULL",tc?tc.toString():"NULL",fc?fc.toString():"NULL")}return!1}static ih(){return new ib}static get instance(){return ib.Ig.value}}ib.Ig=new c.a(ib.ih);Object(z.a)(ib,"PageMetadataNodeComplexMerge",n.a,[]);var hb=b(1453),db=b(106);class da extends n.a{constructor(){super()}get Bn(){return 31}rk(){const Ib=super.rk();Ib.W(y.a.eb(db.a.Yp),
1);Ib.W(y.a.eb(f.a.listID),1);Ib.W(y.a.eb(f.a.fe),1);for(let nc=0;nc<da.jdb.length;nc++)Ib.W(da.jdb[nc],1);return Ib}HC(Ib,nc){const Gc=Ib.Vc,tc=Ib.ll,fc=Ib.Jm.runtime.Qa.isFeatureEnabled(112);y.a.oka(nc);if(nc===y.a.eb(db.a.Yp)){const kc=Gc.getPropertyUint32(Ib.Nf.value.He,db.a.Yp),Bb=Gc.getPropertyUint32(Ib.Mm.value.He,db.a.Yp);if(null!=kc&&null!=Bb&&kc===Bb)return Gc.setPropertyUint32(tc,db.a.Yp,kc),Ib.hg.add(nc),!0;if(null==kc&&null==Bb)return fc?tc.removeProperty(db.a.Yp):Gc.setPropertyUint32(tc,
db.a.Yp,kc),Ib.hg.add(y.a.eb(db.a.Yp)),!0;if(null!=kc&&null==Bb)return Gc.setPropertyUint32(tc,db.a.Yp,kc),Ib.hg.add(nc),!0;if(null==kc&&null!=Bb)return Gc.setPropertyUint32(tc,db.a.Yp,Bb),Ib.hg.add(nc),!0}else if(nc===y.a.eb(f.a.fe)){if(fc)return this.tNm(Gc,Ib)}else if(nc===y.a.eb(f.a.listID)){if(fc)return this.wNm(Ib,f.a.listID)}else if(Array.contains(da.jdb,nc)&&fc)return this.sNm(Ib);return!1}wNm(Ib,nc){const Gc=Ib.ll;var tc=Ib.Mm.value,fc=Ib.Nf.value;let kc;const Bb=tc.Fga.xb(y.a.eb(nc)).returnValue,
Wb=({value:kc}=fc.Fga.xb(y.a.eb(nc))).returnValue;fc=fc.He;tc=tc.He;let zb=!1;Wb?kc.isDeleted?(Gc.removeProperty(nc),zb=!0):kc.qT?(Gc.Tma(nc,fc.fW(f.a.listID)),zb=!0):Bb&&(tc.hasProperty(f.a.listID)?Gc.Tma(nc,tc.fW(f.a.listID)):Gc.removeProperty(nc),zb=!0):Bb&&(tc.hasProperty(f.a.listID)?(Gc.Tma(nc,tc.fW(f.a.listID)),zb=!0):v.a.instance.Ba(578851419,1,1,"PersistablePropertySetComplexMerge: Merging ListId property. Not present in [base]: {0} [favored] : {1} conflict {2}.]",Ib.Nf.value.at.rCb(),Ib.Nf.value.He.rCb(),
Ib.Mm.value.He.rCb()));return zb?(Ib.hg.add(y.a.eb(nc)),!0):!1}sNm(Ib){let nc=!0,Gc=!0,tc,fc;({Jll:nc,Vjl:Gc,pxk:tc,F$j:fc}=this.p4j(Ib));v.a.instance.Ba(578932993,1,3,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",Ib.Nf.value.He.id.toString(),nc,Gc);return nc&&!Gc?(this.cpi(fc,Ib),!0):nc?!1:(this.cpi(tc,Ib),!0)}p4j(Ib){let nc,Gc,tc,fc;const kc=Ib.Mm.value;let Bb;const Wb=Ib.Nf.value;let zb;Gc=nc=!0;tc=new F.a;
fc=new F.a;for(let Gb=0;Gb<da.jdb.length;Gb++){const gc=da.jdb[Gb],jc=({value:Bb}=kc.Fga.xb(gc)).returnValue;({value:zb}=Wb.Fga.xb(gc)).returnValue&&(nc=this.n2i(Ib.Nf,tc,zb,gc)&&nc);jc&&(Gc=this.n2i(Ib.Mm,fc,Bb,gc)&&Gc)}return{Jll:nc,Vjl:Gc,pxk:tc,F$j:fc}}n2i(Ib,nc,Gc,tc){const fc=y.a.oka(tc);Ib=Ib.value.He;nc.W(tc,Ib.hasProperty(fc)?Ib.fW(fc):null);return!Gc.qT}cpi(Ib,nc){const Gc=nc.ll;for(let fc=0;fc<da.jdb.length;fc++){var tc=da.jdb[fc];const kc=y.a.oka(tc);(tc=Ib.J(tc))?Gc.Tma(kc,tc):Gc.removeProperty(kc)}for(Ib=
0;Ib<da.jdb.length;Ib++)nc.hg.add(da.jdb[Ib]);v.a.instance.Ba(578932994,1,3,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",nc.Nf.value.He.id.toString())}tNm(Ib,nc){const Gc=nc.ll,tc=Ib.getPropertyInt32(nc.Nf.value.He,f.a.fe),fc=Ib.getPropertyInt32(nc.Mm.value.He,f.a.fe);return null!=tc&&null!=fc&&tc===fc?(Ib.setPropertyInt32(Gc,f.a.fe,tc),nc.hg.add(y.a.eb(f.a.fe)),!0):null==tc&&null==fc?(Gc.removeProperty(f.a.fe),nc.hg.add(y.a.eb(f.a.fe)),!0):null!=tc&&null==
fc?(Ib.setPropertyInt32(Gc,f.a.fe,tc),nc.hg.add(y.a.eb(f.a.fe)),!0):null==tc&&null!=fc?(Ib.setPropertyInt32(Gc,f.a.fe,fc),nc.hg.add(y.a.eb(f.a.fe)),!0):!1}static ih(){return new da}static get instance(){return da.Ig.value}}da.Ig=new c.a(da.ih);da.jdb=[y.a.eb(f.a.Zk),y.a.eb(f.a.dt),y.a.eb(x.a.FW),y.a.eb(f.a.N6),y.a.eb(f.a.Rl),y.a.eb(f.a.Fo),y.a.eb(x.a.AW),y.a.eb(f.a.Lhf),y.a.eb(x.a.font),y.a.eb(oa.a.mxb)];Object(z.a)(da,"PersistablePropertySetComplexMerge",n.a,[]);class Wa extends n.a{constructor(){super()}get Bn(){return 21}get nD(){return 0}static ih(){return new Wa}static get instance(){return Wa.Ig.value}}
Wa.Ig=new c.a(Wa.ih);Object(z.a)(Wa,"RevisionMetadataNodeComplexMerge",n.a,[]);class mb extends n.a{constructor(){super()}get Bn(){return 22}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.languageHint),7);Ib.W(y.a.eb(f.a.Gjd),2);return Ib}static ih(){return new mb}static get instance(){return mb.Ig.value}}mb.Ig=new c.a(mb.ih);Object(z.a)(mb,"SharedPersistablePropertySetComplexMerge",n.a,[]);class Tb extends n.a{constructor(){super()}get Bn(){return 38}get nD(){return 3}static ih(){return new Tb}static get instance(){return Tb.Ig.value}}
Tb.Ig=new c.a(Tb.ih);Object(z.a)(Tb,"StylePropertySetComplexMerge",n.a,[]);var Da=b(1235),La=b(1295);class Ta extends n.a{constructor(){super()}get Bn(){return 23}get nD(){return 0}rk(){const Ib=super.rk();Ib.W(y.a.eb(x.a.$e),4);Ib.W(y.a.eb(f.a.rowSpan),1);Ib.W(y.a.eb(f.a.colSpan),1);Ib.W(y.a.eb(f.a.ghostCell),1);Ib.W(y.a.eb(f.a.sCa),2);Ib.W(y.a.eb(f.a.Y_a),2);Ib.W(y.a.eb(f.a.G_),2);Ib.W(y.a.eb(f.a.bCb),5);return Ib}v_b(Ib){if(!Ib)return v.a.instance.Ba(573957923,1,2,"Feature helper is null"),!1;
Ib.us(181);return Ib.isFeatureEnabled(181)}HC(Ib,nc){var Gc=nc===y.a.eb(f.a.rowSpan)||nc===y.a.eb(f.a.colSpan)||nc===y.a.eb(f.a.ghostCell);if(!this.v_b(Ib.Jm.runtime.Qa))return!Gc;var tc=Ib.Mm.value.at,fc=La.e(Ib.Jm,tc,null);if(fc.equals(cb.a.nil))return v.a.instance.Ba(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",tc.id),Ib.Jm.ma.uf(Object.assign(new Da.a,{info:"Table node ID could not be found for table cell"})),!1;var kc=Ib.Jm.runtime.IQb.J(fc).J(tc.id);if(!kc)return!Gc;
tc=Ib.ll;fc=Ib.Vc;if(nc===y.a.eb(f.a.ghostCell))return fc.setPropertyBool(tc,f.a.ghostCell,kc.gg),Ib.hg.add(y.a.eb(f.a.ghostCell)),!0;if(nc===y.a.eb(f.a.rowSpan))return nc=kc.rowSpan,kc=kc.colSpan,null!=nc&&null!=kc&&(1<nc||1<kc)?fc.setPropertyUint32(tc,f.a.rowSpan,nc):tc.removeProperty(f.a.rowSpan),Ib.hg.add(y.a.eb(f.a.rowSpan)),!0;if(nc===y.a.eb(f.a.colSpan))return nc=kc.rowSpan,Gc=kc.colSpan,kc=kc.gg,null!=nc&&null!=Gc&&(1<nc||1<Gc)?fc.setPropertyUint32(tc,f.a.colSpan,Gc):kc&&null!=Gc?fc.setPropertyUint32(tc,
f.a.colSpan,Gc):tc.removeProperty(f.a.colSpan),Ib.hg.add(y.a.eb(f.a.colSpan)),!0;v.a.instance.Ba(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",nc);Ib.Jm.ma.uf(Object.assign(new Da.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!Gc}static ih(){return new Ta}static get instance(){return Ta.Ig.value}}Ta.Ig=new c.a(Ta.ih);Object(z.a)(Ta,
"TableCellNodeComplexMerge",n.a,[]);class Sa extends n.a{constructor(){super()}get Bn(){return 24}v_b(Ib){if(!Ib)return v.a.instance.Ba(573845782,1,2,"Feature helper is null"),!1;Ib.us(181);return Ib.isFeatureEnabled(181)}get nD(){return 0}rk(){const Ib=super.rk();Ib.W(y.a.eb(x.a.$e),1);Ib.W(y.a.eb(x.a.a3),1);Ib.W(y.a.eb(x.a.$Oa),1);Ib.W(y.a.eb(f.a.DEc),1);Ib.W(y.a.eb(f.a.HEc),1);Ib.W(y.a.eb(f.a.sCa),2);Ib.W(y.a.eb(f.a.Y_a),2);Ib.W(y.a.eb(f.a.G_),2);return Ib}HC(Ib,nc){if(nc===y.a.eb(x.a.$e)||nc===
y.a.eb(x.a.a3)||nc===y.a.eb(f.a.DEc)||nc===y.a.eb(f.a.HEc)||nc===y.a.eb(x.a.$Oa)){const fc=Ib.ll;var Gc=Ib.Vc;v.a.instance.Ba(4273303,1,3,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",fc.id,fc.Kb,nc);if(this.fqk(Ib))return!1;var tc=Gc.getPropertyObjectIds(Ib.Nf.value.at,x.a.$e);const kc=Gc.getPropertyObjectIds(Ib.Nf.value.He,x.a.$e),Bb=Gc.getPropertyObjectIds(Ib.Mm.value.He,x.a.$e);tc=this.loi(tc,kc,Bb,(Wb,zb)=>Wb.equals(zb));if(0<tc.length)return Gc.setPropertyObjectIds(fc,
x.a.$e,tc),Gc.setPropertyInt32(fc,x.a.$Oa,tc.length),this.v_b(Ib.Jm.runtime.Qa)&&({value:nc}=Ib.Mm.value.Fga.xb(y.a.eb(x.a.a3)),{value:Gc}=Ib.Nf.value.Fga.xb(y.a.eb(x.a.a3)),nc.qT?fc.Tma(x.a.a3,nc.newValue):fc.Tma(x.a.a3,Gc.newValue)),Ib.hg.add(y.a.eb(x.a.$e)),Ib.hg.add(y.a.eb(x.a.a3)),Ib.hg.add(y.a.eb(x.a.$Oa)),Ib.hg.add(y.a.eb(f.a.DEc)),Ib.hg.add(y.a.eb(f.a.HEc)),!0}v.a.instance.Ba(4018189,1,3,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Ib.Nf.value.He.id,nc);return!1}fqk(Ib){const nc=Ib.Mm.value,Gc=Ib.Nf.value;let tc,fc;({value:tc}=nc.Fga.xb(y.a.eb(x.a.a3)));({value:fc}=Gc.Fga.xb(y.a.eb(x.a.a3)));return tc.qT||fc.qT?tc.qT&&fc.qT?(v.a.instance.Ba(4273304,1,3,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",tc.oldValue,fc.newValue,tc.newValue),Ib.Jm.ma.uf(Object.assign(new Da.a,{Mh:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):
Sa.ZGh(Ib.Jm,tc,Gc,"BaseConflict")||Sa.ZGh(Ib.Jm,fc,nc,"BaseFavored")?!0:!1:!1}static ih(){return new Sa}static get instance(){return Sa.Ig.value}static ZGh(Ib,nc,Gc,tc){return nc.qT&&({value:nc}=Gc.Fga.xb(y.a.eb(x.a.$e)),nc.qT)?(v.a.instance.Ba(4273305,1,3,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",tc),Ib.ma.uf(Object.assign(new Da.a,{Mh:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Sa.Ig=new c.a(Sa.ih);
Object(z.a)(Sa,"TableNodeComplexMerge",n.a,[]);class Hb extends n.a{constructor(){super()}get Bn(){return 25}get nD(){return 0}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.Gb),3);Ib.W(y.a.eb(x.a.$e),4);Ib.W(y.a.eb(f.a.sCa),2);Ib.W(y.a.eb(f.a.Y_a),2);Ib.W(y.a.eb(f.a.G_),2);Ib.W(y.a.eb(f.a.bCb),5);return Ib}static ih(){return new Hb}static get instance(){return Hb.Ig.value}}Hb.Ig=new c.a(Hb.ih);Object(z.a)(Hb,"TableRowNodeComplexMerge",n.a,[]);class Oa extends n.a{constructor(){super()}rk(){const Ib=super.rk();
Ib.W(y.a.eb(f.a.BIm),2);Ib.W(y.a.eb(x.a.$e),1);return Ib}HC(Ib,nc){if(nc===y.a.eb(x.a.$e)){const tc=Ib.ll,fc=Ib.Vc;v.a.instance.Ba(42754251,1,3,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",tc.id,tc.Kb,nc);var Gc=fc.getPropertyObjectIds(Ib.Nf.value.at,x.a.$e);const kc=fc.getPropertyObjectIds(Ib.Nf.value.He,x.a.$e),Bb=fc.getPropertyObjectIds(Ib.Mm.value.He,x.a.$e);if(Gc=this.yFl(Gc,kc,Bb))return 0<Gc.length?fc.setPropertyObjectIds(tc,x.a.$e,
Gc):tc.removeProperty(x.a.$e),Ib.hg.add(y.a.eb(x.a.$e)),!0}v.a.instance.Ba(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ib.Nf.value.He.id,nc);return!1}yFl(Ib,nc,Gc){const tc=new F.a(0);Ib.forEach(kc=>{tc.W(kc,0);return!0});nc.forEach(kc=>{tc.Pa(kc)?tc.W(kc,1):tc.W(kc,3);return!0});Gc.forEach(kc=>{let Bb;({value:Bb}=tc.xb(kc)).returnValue?1===Bb?tc.W(kc,5):3===Bb?(v.a.instance.Ba(42754253,1,2,"TaskNode was found added by both sides of merge"),
tc.W(kc,3)):tc.W(kc,2):tc.W(kc,4);return!0});const fc=new P.a;tc.forEach((kc,Bb)=>{Bb&&2!==Bb&&1!==Bb&&fc.add(kc);return!0});return fc}static ih(){return new Oa}static get instance(){return Oa.Ig.value}}Oa.Ig=new c.a(Oa.ih);Object(z.a)(Oa,"TaskContentNodeComplexMerge",n.a,[]);class za{equals(Ib,nc){return Ib&&nc?Ib.UserId===nc.UserId&&Ib.Provider===nc.Provider&&Ib.DisplayName===nc.DisplayName&&Ib.Email===nc.Email:!Ib&&!nc}$A(){return 0}}Object(z.a)(za,"CommentTaskPersonComparer",null,[318]);class $a{equals(Ib,
nc){return Ib&&nc?Ib.startDate?Ib.endDate?Ib.startDate.getTime()===nc.startDate.getTime()&&Ib.endDate.getTime()===nc.endDate.getTime():!nc.endDate:!nc.startDate:!Ib&&!nc}$A(){return 0}}Object(z.a)($a,"CommentTaskScheduleEqualityComparer",null,[318]);class Xb{equals(Ib,nc){if(!Ib||!nc)return!Ib&&!nc;if(!Ib.extensions&&!nc.extensions)return!0;if(!Ib.extensions||!nc.extensions||Ib.extensions.count!==nc.extensions.count)return!1;let Gc=!0;Ib.extensions.forEach((tc,fc)=>{let kc;return({value:kc}=nc.extensions.xb(tc)).returnValue&&
fc===kc?!0:Gc=!1});return Gc}$A(){return 0}}Object(z.a)(Xb,"ExtensionListEqualityComparer",null,[318]);class Eb{bvk(Ib,nc){return Ib&&nc?Ib.recordId===nc.recordId&&Eb.vQg.equals(Ib.user,nc.user)&&Eb.vQg.equals(Ib.assignee,nc.assignee)&&Ib.type===nc.type&&Ib.title===nc.title&&Ib.priority===nc.priority&&Ib.isLossy===nc.isLossy&&Ib.completion===nc.completion&&Ib.commentId===nc.commentId&&Ib.time===nc.time&&Eb.Tij.equals(Ib.schedule,nc.schedule):!Ib&&!nc}equals(Ib,nc){return this.bvk(Ib,nc)}$A(){return 0}}
Eb.vQg=new za;Eb.Tij=new $a;new Xb;Object(z.a)(Eb,"HistoryRecordEqualityComparer",null,[318]);var ob=b(1721),tb=b(1176);class yb extends n.a{constructor(Ib){super();this.aTa=Ib}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.vbc),5);Ib.W(y.a.eb(f.a.taskId),2);Ib.W(y.a.eb(f.a.tIm),2);Ib.W(y.a.eb(f.a.wIm),2);Ib.W(y.a.eb(f.a.kCa),1);return Ib}dFg(Ib){if(!Ib.Mm.value.at&&!Ib.Nf.value.at){const nc=Ib.Nf.value.He.yH();nc.removeProperty(f.a.kCa);const Gc=Ib.Nf.value.He,tc=Ib.Mm.value.He;Ib.Nf=new c.a(()=>new tb.a(nc,
Gc));Ib.Mm=new c.a(()=>new tb.a(nc,tc))}return super.dFg(Ib)}HC(Ib,nc){if(nc!==y.a.eb(f.a.kCa))return v.a.instance.Ba(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ib.Nf.value.He.id,nc),!1;const Gc=Ib.ll,tc=Ib.Vc;v.a.instance.Ba(42754255,1,3,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Gc.id,Gc.Kb,nc);nc=tc.getPropertyString(Ib.Nf.value.at,f.a.kCa);const fc=
tc.getPropertyString(Ib.Nf.value.He,f.a.kCa),kc=tc.getPropertyString(Ib.Mm.value.He,f.a.kCa);nc=this.xFl(nc,fc,kc);if(!nc)return!1;0<nc.length?tc.setPropertyString(Gc,f.a.kCa,nc):Gc.removeProperty(f.a.kCa);Ib.hg.add(y.a.eb(f.a.kCa));return!0}xFl(Ib,nc,Gc){Ib=this.aTa.Soc(Ib);nc=this.aTa.Soc(nc);Gc=this.aTa.Soc(Gc);if(!yb.gei(Ib,nc))return v.a.instance.Ba(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!yb.gei(Ib,Gc))return v.a.instance.Ba(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),
null;Gc=yb.M8j(Ib.length,nc,Gc);return this.aTa.xsg(Gc)}static ih(){const Ib=new ob.a;return new yb(Ib)}static get instance(){return yb.Ig.value}static M8j(Ib,nc,Gc){const tc=new P.a;for(let fc=0;fc<nc.length;fc++)tc.add(nc.J(fc));for(;Ib<Gc.length;Ib++)tc.add(Gc.J(Ib));return tc}static gei(Ib,nc){const Gc=Ib.length;if(Gc>nc.length)return!1;for(let tc=0;tc<Gc;tc++)if(!yb.npj.equals(nc.J(tc),Ib.J(tc)))return nc.J(tc).recordId===Ib.J(tc).recordId&&v.a.instance.Ba(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),
!1;return!0}}yb.Ig=new c.a(yb.ih);yb.npj=new Eb;Object(z.a)(yb,"TaskSingleNodeComplexMerge",n.a,[]);class lb extends n.a{constructor(){super()}get Bn(){return 26}rk(){const Ib=super.rk();Ib.W(y.a.eb(x.a.$e),1);return Ib}HC(Ib,nc){const Gc=x.a.$e;if(nc===y.a.eb(Gc)){nc=Ib.ll;const fc=Ib.Vc;var tc=fc.getPropertyObjectIds(Ib.Nf.value.at,Gc);const kc=fc.getPropertyObjectIds(Ib.Nf.value.He,Gc),Bb=fc.getPropertyObjectIds(Ib.Mm.value.He,Gc);tc=this.DFl(tc,kc,Bb);fc.setPropertyObjectIds(nc,Gc,tc);Ib.hg.add(y.a.eb(Gc));
return!0}return!1}DFl(Ib,nc,Gc){return this.SXa(Ib,nc,Gc)}static ih(){return new lb}static get instance(){return lb.Ig.value}}lb.Ig=new c.a(lb.ih);Object(z.a)(lb,"VectorClockContainerNodeComplexMerge",n.a,[]);class Cc extends n.a{constructor(){super()}get Bn(){return 27}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.o3),1);return Ib}HC(Ib,nc){const Gc=f.a.o3;if(nc===y.a.eb(Gc)){nc=Ib.ll;const tc=Ib.Vc,fc=tc.getPropertyUint32(Ib.Nf.value.He,Gc)||0,kc=tc.getPropertyUint32(Ib.Mm.value.He,Gc)||0;tc.setPropertyUint32(nc,
Gc,this.OSk(fc,kc));Ib.hg.add(y.a.eb(Gc));return!0}return!1}OSk(Ib,nc){return Ib>nc?Ib:nc}static ih(){return new Cc}static get instance(){return Cc.Ig.value}}Cc.Ig=new c.a(Cc.ih);Object(z.a)(Cc,"VectorClockNodeComplexMerge",n.a,[]);class Hc extends n.a{constructor(){super()}get Bn(){return 28}get nD(){return 0}rk(){const Ib=super.rk();Ib.W(y.a.eb(f.a.rHh),3);Ib.W(y.a.eb(f.a.Gb),3);Ib.W(y.a.eb(f.a.Hqk),5);Ib.W(y.a.eb(f.a.yoi),5);Ib.W(y.a.eb(f.a.Oaa),5);return Ib}static ih(){return new Hc}static get instance(){return Hc.Ig.value}}
Hc.Ig=new c.a(Hc.ih);Object(z.a)(Hc,"WordSectionNodeComplexMerge",n.a,[]);b.d(H,"a",function(){return Jc});class Jc{QBh(Ib){switch(Ib.Kb){case 131073:return Ib.hasProperty(f.a.H$)?Ba.instance:da.instance;case 1074135140:return m.instance;case 1074135137:return A.instance;case 1074135139:return D.instance;case 1074135138:return U.instance;case 1074135136:return S.instance;case 1074135157:return L.instance;case 1074135152:return I.instance;case 1074135153:return M.instance;case 1074135126:return R.instance;
case 1074135127:return W.instance;case 1074135145:return aa.instance;case 1074135144:return N.instance;case 1074135142:return ia.instance;case 1074135143:return ea.instance;case 1074135163:return la.instance;case 1074135164:return xa.instance;case 1074135124:return Ha.instance;case 1074135125:return ua.instance;case 1074135122:return Ra.instance;case 393233:return Ba.instance;case 1074135170:return Ga.instance;case 1074135168:return ja.instance;case 1074135166:return X.instance;case 1074135167:return fa.instance;
case 1074135169:return pa.instance;case 1074135165:return Ia.instance;case 393234:return ta.instance;case 393229:return va.instance;case 393241:return Fa.instance;case 393227:return gb.instance;case 131120:return ib.instance;case 393271:return Ya.instance;case 393230:return hb.a.instance;case 131140:return Wa.instance;case 1179649:return mb.instance;case 1073872969:return Tb.instance;case 393252:return Ta.instance;case 393250:return Sa.instance;case 393251:return Hb.instance;case 1074135154:return lb.instance;
case 1074135161:return Oa.instance;case 1074135162:return yb.instance;case 1074135155:return Cc.instance;case 1073872968:return Hc.instance}return n.a.instance}}Object(z.a)(Jc,"GraphNodeComplexMergeFactory",null,[1792])},1639:function(z,H,b){z=b(0);var f=b(1062),c=b(4),n=b(15),m=b(111),x=b(127),y=b(151),v=b(505),t=b(48),A=b(282),D=b(1056);class U{constructor(ea,la=0){this.Srf=null;this.Hoe=0;this.cK=ea;this.ooi=la}}Object(z.a)(U,"GraphMergerResponse",null,[]);var F=b(40),E=b(1),P=b(490),G=b(1161),
K=b(1232);class S extends K.a{constructor(){super();this.rXi=null;this.O8i=!1}get Fra(){return"Crash"}GVb(){this.detail.W("Type",this.Fra);this.detail.W("Trace",this.vMm(this.rXi));this.detail.W("Continue",this.O8i);return this.detail}vMm(ea){ea=ea.split("\n");const la=4<ea.length?4:ea.length,xa=new Sys.StringBuilder;for(let Ha=0;Ha<la;Ha++)Ha===la-1?xa.append(String.format("{0}...",ea[Ha])):xa.append(String.format("{0}\n",ea[Ha]));return xa.toString()}}Object(z.a)(S,"CrashMergeFailureDetail",K.a,
[]);var L=b(1641),I=b(1176),O=b(1305),M=b(1162),R=b(1400);class W{constructor(){this.zqh=new A.a;this.Lxh=new A.a;this.yzh=new A.a}}Object(z.a)(W,"RangeMarkers",null,[]);class Y{constructor(){this.colSpan=this.rowSpan=null;this.gg=!1;this.OQe=new y.a;this.QZe=new y.a;this.m_e=new y.a}get mOf(){return this.OQe.Q7()}set mOf(ea){ea||(this.OQe=new y.a);this.OQe=ea.Q7()}get r8f(){return this.QZe.Q7()}set r8f(ea){ea||(this.QZe=new y.a);this.QZe=ea.Q7()}get kle(){return this.m_e.Q7()}set kle(ea){ea||(this.m_e=
new y.a);this.m_e=ea.Q7()}}Object(z.a)(Y,"TableCellStructureInfo",null,[]);var N=b(1235),aa=b(1295);b.d(H,"a",function(){return ia});class ia{constructor(){this.Ibe=0;this.LWg=this.ulb=this.Qhc=this.Wf=this.H$g=this.s5a=null;this.n3g=0;this.PUg=this.GPg=null}get JKi(){return this.s5a}get kjm(){return this.H$g}get Vc(){return this.Wf}get Gxb(){return this.Qhc}get h3h(){return this.ulb}get I5k(){return this.LWg}get Nwc(){return this.n3g}get tvh(){return this.GPg}get F9c(){return this.PUg}RXa(ea,la,
xa,Ha,ua,Ra,ab){xa=this.hgk(ea,la,Ha,ua,Ra,ab,this.F9c);Ha=0;const Ba=xa.runtime.nwe;let Ga=null;try{this.oAl(Ba,xa,ab,ea,la,ua,Ra);for(ea=1;Ha<this.Gxb.length;Ha++)if(!(0,this.Gxb[Ha])(xa)){ea=2;xa.ma.Die("GraphMerger.GetMergeFunctions()",Ha);break}return Ga=new U(xa.output.cK,ea)}catch(ja){const X=!xa.output.timeout;xa.output.crash=X;const fa=this.G9d(ja),pa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",X?"Crashed":"Timed Out",xa.input.g3b,!!xa.output.cK,
fa);X?(m.a.instance.Ba(4051608,1,1,"MergeChanges Crash. [Error: {0}]",pa),xa.ma.uf(Object.assign(new S,{rXi:fa,O8i:!!xa.output.cK}))):m.a.instance.Ba(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",pa);if(xa.output.cK)return Ga=new U(xa.output.cK,2);throw ja;}finally{xa.output.succeeded?this.lAl(Ba,xa,Ha):xa.output.timeout?this.nAl(xa,Ha):xa.output.crash?xa.output.cK?this.mAl(xa,Ha):this.kAl(xa,Ha):this.jAl(xa,Ha);xa.ma.iAl();m.a.instance.mna(42350232,1,xa.output.succeeded?3:2,"MergeLogger",xa.ma.WSk());
xa.ma.MXa.O4h()&&m.a.instance.mna(559015903,1,2,"MarkerInfo",xa.ma.MXa.toString());if(xa.runtime.Qa&&xa.runtime.Qa.isFeatureEnabled(121))try{this.Lyl(xa)}catch(ja){m.a.instance.Ba(571619421,1,3,"Error logging references: {0}",ja.toString())}Ga.Hoe|=(xa.output.succeeded?2:1)<<2*(ab-1);if(Ga)try{Ga.Srf=this.P_l(xa)}catch(ja){m.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",ja)}}}Lyl(ea){const la=ua=>{const Ra=this.OJa()-ea.input.dCa>this.Nwc;if(0<this.Nwc&&Ra)throw m.a.instance.Ba(571619422,
1,2,"Timed out while calculating added and deleted nodes: {0}",ua),x.a.invalidOperation(ua);};let xa=ea.runtime.Aw.keys,Ha=ua=>ea.runtime.Aw.J(ua);this.S2f(ea,la,xa,Ha,"Favored");xa=ea.runtime.wp.keys;Ha=ua=>ea.runtime.wp.J(ua);this.S2f(ea,la,xa,Ha,"Unfavored");xa=ea.runtime.Fl.keys;Ha=ua=>{const Ra=ea.runtime.Fl.J(ua);return Ra?Ra.tj:ea.runtime.Aw.J(ua)};this.S2f(ea,la,xa,Ha,"Merged")}S2f(ea,la,xa,Ha,ua){var Ra=new y.a;const ab=new y.a;for(let Ba=0;Ba<xa.length;Ba++){la("LogAddedAndDeletedNodes");
const Ga=Ha(xa.J(Ba));if(4325465===Ga.Kb)continue;const ja=ea.runtime.pj.J(Ga.id);ja&&this.Myl(Ra,ab,Ga,ja)}this.hli(ab,Ba=>ea.runtime.pj.J(Ba),la);this.hli(Ra,Ha,la);la=new Sys.StringBuilder;for(xa=0;xa<Ra.length;xa++)la.append(Ra.J(xa).toString()+",");Ra=new Sys.StringBuilder;for(xa=0;xa<ab.length;xa++)Ra.append(ab.J(xa).toString()+",");m.a.instance.mna(571619423,1,3,ua+" revision: Added references",la.toString());m.a.instance.mna(571619424,1,3,ua+" revision: Deleted references",Ra.toString())}Myl(ea,
la,xa,Ha){const ua=xa.Fn();for(let ab=0;ab<ua.length;ab++){const Ba=ua[ab];if(this.O$h(Ba)){var Ra=this.Vc.getPropertyObjectIds(xa,Ba);this.Azl(ea,la,Ha,Ba,Ra)}else this.vdi(Ba)&&(Ra=this.Vc.getPropertyObjectId(xa,Ba),this.zzl(ea,la,Ha,Ba,Ra))}}hli(ea,la,xa){xa("LogNestedReferences");xa=new y.a;const Ha=new v.a;for(let ua=0;ua<ea.length;ua++){const Ra=ea.J(ua);this.y3f(Ra,xa,Ha,la)}for(la=0;la<xa.length;la++)ea.add(xa.J(la))}y3f(ea,la,xa,Ha){const ua=Ha(ea);if(ua){const ab=ua.Fn();for(let Ba=0;Ba<
ab.length;Ba++){var Ra=ab[Ba];if(this.O$h(Ra)){Ra=this.Vc.getPropertyObjectIds(ua,Ra);for(let Ga=0;Ga<Ra.length;Ga++)xa.contains(Ra.J(Ga))||(la.add(Ra.J(Ga)),xa.add(Ra.J(Ga)),this.y3f(Ra.J(Ga),la,xa,Ha))}else this.vdi(Ra)&&(Ra=this.Vc.getPropertyObjectId(ua,Ra),xa.contains(Ra)||(la.add(Ra),xa.add(Ra),this.y3f(ea,la,xa,Ha)))}}}Azl(ea,la,xa,Ha,ua){if(this.Vc.hasProperty(xa,Ha)){xa=this.Vc.getPropertyObjectIds(xa,Ha);const Ra=xa.UG();Ha=ua.UG();for(let ab=0;ab<ua.length;ab++)Ra.contains(ua.J(ab))||ea.add(ua.J(ab));
for(ea=0;ea<xa.length;ea++)Ha.contains(xa.J(ea))||la.add(xa.J(ea))}else for(la=0;la<ua.length;la++)ea.add(ua.J(la))}zzl(ea,la,xa,Ha,ua){ua&&(this.Vc.hasProperty(xa,Ha)?(xa=this.Vc.getPropertyObjectId(xa,Ha),ua.equals(xa)||(ea.add(ua),la.add(xa))):ea.add(ua))}hAl(ea){m.a.instance.Ba(4535064,1,3,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ea.input.g3b,ea.output.crash,ea.output.timeout)}oAl(ea,la,xa,Ha,ua,Ra,ab){if(ea){ea=Ha.length?Ha.Ve(Ha.length-1):null;var Ba=ua.length?ua.Ve(ua.length-
1):null;xa=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",la.input.g3b,Ha.length,ea?ea.id:t.a.nil,ea?ea.NY?ea.NY.id:t.a.nil:t.a.nil,ua.length,Ba?Ba.id:t.a.nil,Ba?Ba.NY?Ba.NY.id:t.a.nil:t.a.nil,Ra,ab,this.Nwc,xa);switch(la.input.source){case 5:m.a.instance.Ba(51663493,1,3,xa);break;default:m.a.instance.Ba(4051606,
1,3,xa)}}}lAl(ea,la,xa){if(ea)switch(ea=this.jbd(la,xa,"Succeeded"),la.input.source){case 5:m.a.instance.Ba(51663494,1,3,ea);break;default:m.a.instance.Ba(4059162,1,3,ea)}}nAl(ea,la){la=this.jbd(ea,la,"Timeout");switch(ea.input.source){case 5:m.a.instance.Ba(51663495,1,3,la);break;default:m.a.instance.Ba(4059163,1,2,la)}}jAl(ea,la){la=this.jbd(ea,la,"Rejection");switch(ea.input.source){case 5:m.a.instance.Ba(51663496,1,3,la);break;default:m.a.instance.Ba(4059164,1,2,la)}}mAl(ea,la){la=this.jbd(ea,
la,"Crash - Rejection");switch(ea.input.source){case 5:m.a.instance.Ba(51663497,1,3,la);break;default:m.a.instance.Ba(4059165,1,2,la)}}kAl(ea,la){la=this.jbd(ea,la,"Crash - Failed");switch(ea.input.source){case 5:m.a.instance.Ba(51663498,1,3,la);break;default:m.a.instance.Ba(4059166,1,2,la)}}jbd(ea,la,xa){const Ha=ea.output.cK,ua=Ha&&Ha.length?Ha.Ve(Ha.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",
ea.input.g3b,xa,this.OJa()-ea.input.dCa,la,Ha?Ha.length:0,ua?ua.id:t.a.nil,ua?ua.NY?ua.NY.id:t.a.nil:t.a.nil,ea.input.source)}hgk(ea,la,xa,Ha,ua,Ra,ab){const Ba=new L.a,Ga=Ba.input;Ga.f8=ea;Ga.SCa=la;Ga.Xi=xa;Ga.g2=Ha;Ga.atc=ua;Ga.source=Ra;Ga.F9c=ab;Ga.dCa=this.OJa();Ba.ma.vum(Ga.dCa);ea=Ba.runtime;ea.Jyd=m.a.instance.R2(1,4);ea.nwe=m.a.instance.R2(1,3);let ja="";ea.jF=X=>{if(this.Nwc){var fa=this.OJa()-Ga.dCa,pa=fa>this.Nwc;ja+=String.format(" ({0}: {1})",X,fa);pa&&(Ba.output.timeout=!0,X=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",
Ga.g3b,this.Nwc,X,fa,ja),this.PJm(X))}};return Ba}vcd(){return[Object(F.a)(this,this.dVl,"otherAuthorsHaveChangesToMerge"),Object(F.a)(this,this.snl,"isInputValid"),Object(F.a)(this,this.Kel,"initializeOutputMergeState"),Object(F.a)(this,this.wYb,"initializeRuntimeMergeState"),O.a.H_l,Object(F.a)(this,this.G_l,"preProcessTableStructure"),Object(F.a)(this.tvh,this.tvh.gFl,"mergeChildNodeLists"),Object(F.a)(this,this.ANm,"tryObjectMerge"),O.a.r_l,Object(F.a)(this,this.Ayk,"finalizeObjectMerge"),Object(F.a)(this,
this.pWm,"validateMarkers"),Object(F.a)(this,this.cKj,"addMergeResultsToOutput")]}dVl(ea){const la=ea.input.f8;ea=ea.output;return la?la.length?!0:(m.a.instance.Ba(4051610,1,4,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ea.cK=la,ea.succeeded=!0,!1):(m.a.instance.Ba(4051609,1,4,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),ea.cK=la,ea.succeeded=!0,!1)}snl(ea){var la=ea.input;const xa=la.f8,Ha=la.SCa,ua=la.Xi,Ra=la.g2;la=la.atc;ea=ea.output;
if(!Ha||!Ha.length)return m.a.instance.Ba(42350233,1,4,"IsInputValid: No local changes to merge."),ea.cK=xa,ea.succeeded=!0,!1;let ab=!0;if(2!==Ra&&1!==Ra)return ea.cK=xa,!1;ua&&ua!==t.a.nil||(ab=!1);xa.length<(la?2:1)&&(m.a.instance.Ba(4051614,1,4,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",la),ab=!1);ab||(ea.cK=2===Ra?xa:Ha);return ab}wYb(ea){var la=ea.input,xa=la.f8,Ha=la.SCa,ua=la.g2,Ra;
let ab;({zJm:Ra,NYm:ab,yIa:la}=this.HRk(ea,xa,Ha,la.atc));if(!la)return m.a.instance.Ba(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",Ra.id,ab.id),ea.ma.uf(Object.assign(new G.a,{Mh:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.uli(Ra,xa.length,"TheirChanges"),this.uli(ab,Ha.length,"YourChanges"),ea.output.cK=2===ua?xa:Ha,!1;ea.runtime.yIa=la;({KOm:xa,mxk:Ha}=this.Gnk(ua,Ra,ab));
({LOm:la,nxk:ua,LVj:Ra}=this.oTk(ea,xa,Ha,la));ea.runtime.pj=Ra;ea.runtime.wp=la;ea.runtime.Aw=ua;ea.runtime.Fl=new A.a;ea.runtime.H6d=Ha.id;ea.runtime.uAe=xa.id;ea.runtime.cyb=new A.a;ea.runtime.fUa=new v.a;ea.runtime.fvf=new A.a;ea.runtime.IQb=new A.a;ea.runtime.VBg=new A.a;ea.runtime.i8b=new W;ea.runtime.tdg=new v.a;ea.runtime.MDc=new y.a;ea.runtime.Qa=ea.input.F9c(ea);ea.runtime.Qa.zlc(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",f.a.q_i);ea.runtime.Qa.zlc(1000002,
"Microsoft.Office.WordOnline.CheckIfDictionaryEmpty","WoChe585;WoChe585cf",f.a.fvh);ea.runtime.Qa.zlc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",f.a.a0i);ea.runtime.Qa.zlc(1000003,"Microsoft.Office.WordOnline.ServerGraphMergeMaxTimeout","WoSer121;WoSer121cf",f.a.yOi);ea.runtime.Qa.zlc(1000004,"Microsoft.Office.WordOnline.CustomTabStopsMerge","CustomTabStopsMerge;CustomTabStopsMergecf",f.a.QDh);return ea.runtime.x8h=!0}uli(ea,la,xa){const Ha=new y.a;for(;ea;)Ha.add(ea),
ea=ea.NY;const ua=new Sys.StringBuilder;ua.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",xa,la,Ha.length));let Ra=Ha.length,ab=0;Ha.forEach(Ba=>({O6h:Ra,Mli:ab}=this.yLj(ua,Ba,Ha,Ra,ab)).returnValue);m.a.instance.Ba(4273302,1,3,ua.toString())}yLj(ea,la,xa,Ha,ua){ea.append(String.format(" [{0} {1} {2}]",Ha,la.V$?"S":"B",la.id));Ha--;ua++;return 50<ua&&xa.length!==ua?(ea.append(" ...Truncated."),{returnValue:!1,O6h:Ha,Mli:ua}):{returnValue:!0,O6h:Ha,Mli:ua}}HRk(ea,la,xa,
Ha){la=la.Ve(la.length-1-(Ha?1:0));xa=xa.Ve(xa.length-1);Ha=la.S$a(xa);ea.runtime.jF("GetCommonBase");ea.ma.Rla("GetCommonBase");return{zJm:la,NYm:xa,yIa:Ha}}oTk(ea,la,xa,Ha){let ua,Ra;({result:ua}=la.Hxb(Ha));ea.runtime.jF("GetUnfavoredChanges");ea.ma.Rla("GetUnfavoredChanges");({result:Ra}=xa.Hxb(Ha));5===ea.input.source&&(ea.runtime.qxk=P.a.PZh(xa),ea.runtime.KFg=P.a.PZh(la));ea.runtime.jF("GetFavoredChanges");ea.ma.Rla("GetFavoredChanges");la=new D.a(Object(F.a)(Ha,Ha.Aka,"getMergeableObject"));
ea.runtime.jF("GetModifiedObjects");ea.ma.Rla("GetModifiedObjects");return{LOm:ua,nxk:Ra,LVj:la}}Gnk(ea,la,xa){2===ea?(ea=la,la=xa):ea=xa;return{KOm:la,mxk:ea}}Kel(ea){const la=ea.input,xa=la.f8,Ha=la.SCa;ea.output.cK=(2===la.g2?xa:Ha).Q7();ea.runtime.jF("InitializeOutputMergeState");ea.ma.Rla("InitializeOutputMergeState");return!0}cKj(ea){var la=ea.input.Xi;const xa=ea.runtime.Fl,Ha=ea.output.cK;la=this.igk(ea,Ha.Ve(Ha.length-1),la,t.a.create());this.hyk(ea,la,xa);Ha.add(la);return ea.output.succeeded=
!0}igk(ea,la,xa,Ha){ea.runtime.nwe&&m.a.instance.Ba(4051616,1,3,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",xa,Ha);ea=this.kjm(Ha);ea.dWj(la,xa);return ea}hyk(ea,la,xa){ea.runtime.nwe&&m.a.instance.Ba(4059167,1,3,"FillRevision: Adding {0} objects to merged revision.",xa.count);xa.forEach((Ha,ua)=>{la.hLj(ua.tj);return!0})}v_b(ea){if(!ea)return m.a.instance.Ba(573957952,1,2,"Feature helper is null"),!1;ea.us(181);return ea.isFeatureEnabled(181)}G_l(ea){if(!this.v_b(ea.runtime.Qa))return!0;
const la=ea.runtime.Aw,xa=ea.runtime.wp,Ha=ea.runtime.pj;let ua=!0;la.forEach((Ra,ab)=>{393252===ab.Kb&&(ua=this.sAi(ea,Ra,ab,Ha,la));return ua});if(!ua)return!1;xa.forEach((Ra,ab)=>{393252===ab.Kb&&(ua=this.sAi(ea,Ra,ab,Ha,xa));return ua});ea.ma.Rla("PreProcessTableStructure");return ua}sAi(ea,la,xa,Ha,ua){const Ra=null==this.Vc.getPropertyBool(xa,c.a.ghostCell)?!1:this.Vc.getPropertyBool(xa,c.a.ghostCell),ab=null==this.Vc.getPropertyUint32(xa,c.a.rowSpan)?1:this.Vc.getPropertyUint32(xa,c.a.rowSpan),
Ba=null==this.Vc.getPropertyUint32(xa,c.a.colSpan)?1:this.Vc.getPropertyUint32(xa,c.a.colSpan);if(Ra)return!0;var Ga=Ha.J(la);if(Ga){Ha=null==this.Vc.getPropertyBool(Ga,c.a.ghostCell)?!1:this.Vc.getPropertyBool(Ga,c.a.ghostCell);var ja=null==this.Vc.getPropertyUint32(Ga,c.a.rowSpan)?1:this.Vc.getPropertyUint32(Ga,c.a.rowSpan);var X=null==this.Vc.getPropertyUint32(Ga,c.a.colSpan)?1:this.Vc.getPropertyUint32(Ga,c.a.colSpan);Ha=Ha!==Ra;ja=ja!==ab;X=X!==Ba}else X=ja=Ha=!0;const fa=aa.e(ea,xa,ua);if(fa.equals(t.a.nil))return m.a.instance.Ba(573957953,
1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",la),ea.ma.uf(Object.assign(new N.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let pa=ea.runtime.IQb.J(fa);pa||(ea.runtime.IQb.W(fa,new A.a),pa=ea.runtime.IQb.J(fa));let Ia=pa.J(la),ta=new y.a;const oa=new y.a,va=new y.a;Ha&&(Ia||(ta=this.Vc.getPropertyObjectIds(xa,n.a.$e)));if(ja||X)if(Ia){if(Ia.gg)return m.a.instance.Ba(573957961,1,3,"Table cell has conflicting ghostcell properties we are not handling"),
ea.ma.uf(Object.assign(new N.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=Ia.rowSpan&&ab!==Ia.rowSpan||null!=Ia.colSpan&&Ba!==Ia.colSpan)return m.a.instance.Ba(573957962,1,3,"Same table cell has different rowSpan/colSpan in conflicting revisions"),ea.ma.uf(Object.assign(new N.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var Fa;({rowIndex:xa,jnc:Fa}=aa.b(ea,ua,xa));if(-1===xa||-1===Fa)return m.a.instance.Ba(573957954,
1,2,"Table cell location could not be found. Table Cell ID: {0}",la),ea.ma.uf(Object.assign(new N.a,{info:"Table cell location could not be found"})),!1;for(var cb=xa;cb<xa+ab;cb++)for(var Za=Fa;Za<Fa+Ba;Za++){var gb=aa.c(ea,fa,cb,Za);if(gb.equals(t.a.nil))return m.a.instance.Ba(573957955,1,3,"Other revision deleted the table cells this revision is trying to merge"),ea.ma.uf(Object.assign(new N.a,{info:"Ghost cell not found in the table bounds"})),!1;var Ya=ua.gz(gb,ea.runtime.pj.J(gb));if(!Ya)return m.a.instance.Ba(573957956,
1,3,"Other revision has inserted cells in between the cells this revision is trying to merge"),ea.ma.uf(Object.assign(new N.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!gb.equals(la)){if(null==this.Vc.getPropertyBool(Ya,c.a.ghostCell)||!this.Vc.getPropertyBool(Ya,c.a.ghostCell))return m.a.instance.Ba(573957957,1,3,"Other revision deleted some of the cells this revision is trying to merge"),ea.ma.uf(Object.assign(new N.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),
!1;var fb=pa.J(gb);if(fb)return m.a.instance.Ba(573957958,1,3,"The ghost cell is already merged with some other cells in the other revision"),ea.ma.uf(Object.assign(new N.a,{info:"Ghost cell is already merged with some other cell"})),!1;oa.add(gb);fb=new Y;fb.gg=!0;Ya=this.Vc.getPropertyUint32(Ya,c.a.colSpan);null!=Ya&&(fb.colSpan=Ya);pa.W(gb,fb)}}if(Ga&&(null==this.Vc.getPropertyBool(Ga,c.a.ghostCell)||!this.Vc.getPropertyBool(Ga,c.a.ghostCell))&&(ua=null==this.Vc.getPropertyUint32(Ga,c.a.rowSpan)?
1:this.Vc.getPropertyUint32(Ga,c.a.rowSpan),xa=null==this.Vc.getPropertyUint32(Ga,c.a.colSpan)?1:this.Vc.getPropertyUint32(Ga,c.a.colSpan),ua>ab||xa>Ba)){cb=Fa=-1;({rowIndex:Fa,jnc:cb}=aa.a(ea,null,Ga,Fa,cb));if(-1===Fa||-1===cb)return m.a.instance.Ba(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",la),ea.ma.uf(Object.assign(new N.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;Ga=oa.UG();for(Za=
Fa;Za<Fa+ua;Za++)for(gb=cb;gb<cb+xa;gb++){fb=aa.d(ea,null,fa,Za,gb);if(!fb)return m.a.instance.Ba(573957960,1,2,"Table cell could not be found within table bounds"),ea.ma.uf(Object.assign(new N.a,{info:"Ghost cell not found in the table bounds"})),!1;fb.id.equals(la)||Ga.contains(fb.id)||va.add(fb.id)}}}!Ia&&(Ha||ja||X)&&(m.a.instance.Ba(573957963,1,3,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",la),Ia=new Y,Ia.rowSpan=ab,Ia.colSpan=Ba,Ia.gg=Ra,Ia.kle=
ta,Ia.mOf=oa,Ia.r8f=va,pa.add(la,Ia));return!0}ANm(ea){return this.B2i(ea,!1)}Ayk(ea){return this.B2i(ea,!0)}B2i(ea,la){const xa=ea.runtime,Ha=xa.pj,ua=xa.Aw,Ra=la?xa.fvf:xa.wp,ab=xa.Fl;let Ba=!0;const Ga=ea.runtime.Jyd;let ja=0,X=0,fa=0;Ra.forEach((pa,Ia)=>{Ga&&m.a.instance.Ba(4051617,1,4,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",pa,Ia.Kb,la);X++;50===X&&(ja++,ea.runtime.jF(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",ja,fa,la)),X=0);if(ea.runtime.Qa&&
ea.runtime.Qa.Vab(1000005)&&ea.runtime.MDc.contains(Ia.id,(va,Fa)=>va.equals(Fa))||this.ICm(Ia.Kb))return!0;if(!la&&this.rlk(Ia.Kb,ea.runtime.Qa))return xa.fvf.W(pa,Ia),!0;var ta=ua.get(pa);if(!ta)return ab.Pa(pa)?ab.J(pa).uoi(Ia):ab.W(pa,new M.a(Ia,!1)),!0;if(!Ha.J(pa)&&!this.GFl(ta.Kb)){var oa=!!ea.input.f8&&!!ea.input.f8.last()&&ea.input.f8.last().YH(pa);const va=!!ea.input.SCa&&!!ea.input.SCa.last()&&ea.input.SCa.last().YH(pa),Fa=new I.a(ta,Ia);if(!Fa.qT)return ab.W(pa,new M.a(ta,!1)),!0;m.a.instance.Ba(4051618,
1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",pa,Ia.Kb,la,oa,va,!Fa.qT,ea.input.source);ea.ma.uf(Object.assign(new G.a,{Mh:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return Ba=!1}oa=ab.gz(pa,new M.a(Ha.J(pa)));({ll:ta,returnValue:Ba}=this.I5k.merge(ea,this.h3h,this.Vc,oa,ta,Ia));fa++;Ba&&(ea.runtime.jF(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",
pa,Ia.Kb,fa,ja,la)),ta&&(ab.Pa(ta.tj.id)?ab.J(ta.tj.id).uoi(ta.tj):ab.W(ta.tj.id,ta)));return Ba});ea.ma.Rla("ObjectMerge");Ba&&5===ea.input.source&&ea.runtime.KFg.length&&ua.forEach((pa,Ia)=>393230===Ia.Kb&&ea.runtime.KFg.contains(pa,(ta,oa)=>ta.equals(oa))&&(Ba=Ha.J(pa)?!(new R.a(n.a.ml,this.Vc.getPropertyString(Ha.J(pa),n.a.ml),this.Vc.getPropertyString(Ia,n.a.ml))).qT:!1,!Ba)?(m.a.instance.Ba(16869081,1,2,"Failed to Merge Object {0} which was changed in the favored and removed in the unfavored, finalize: {1}",
pa,la),ea.ma.uf(Object.assign(new G.a,{Mh:"GraphMerger.TryObjectMerge",eventId:"baw1z"})),!1):!0);Ga&&m.a.instance.Ba(4059168,1,4,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",Ra.count,fa,la);return Ba}pWm(ea){try{ea.runtime.i8b.yzh.forEach(la=>{var xa=ea.runtime.Fl.J(la);if(xa){var Ha=this.Vc.getPropertyObjectId(xa.tj,c.a.Vh);xa=this.Vc.getPropertyObjectId(xa.tj,c.a.hj);if(!Ha||!xa){let ua;(ua=ea.ma.MXa).Ntc=ua.Ntc+1;return!0}Ha=this.Uuc(ea,Ha,la,c.a.qd,ua=>38===ua||
40===ua);la=this.Uuc(ea,xa,la,c.a.qd,ua=>39===ua||41===ua);if(!Ha||!la){let ua;(ua=ea.ma.MXa).Ntc=ua.Ntc+1}}else m.a.instance.Ba(559535576,1,2,"ValidateMerge: Couldn't find merged node to verify");ea.runtime.jF("Validate markers taking too long");return!0}),ea.runtime.i8b.zqh.forEach(la=>{var xa=ea.runtime.Fl.J(la);if(xa){var Ha=this.Vc.getPropertyObjectId(xa.tj,c.a.hF);xa=this.Vc.getPropertyObjectId(xa.tj,c.a.ZV);if(!Ha||!xa){let ua;(ua=ea.ma.MXa).Ltc=ua.Ltc+1;return!0}Ha=this.Uuc(ea,Ha,la,c.a.apb,
ua=>44===ua);la=this.Uuc(ea,xa,la,c.a.apb,ua=>45===ua);if(!Ha||!la){let ua;(ua=ea.ma.MXa).Ltc=ua.Ltc+1}}else m.a.instance.Ba(559535577,1,2,"ValidateMerge: Couldn't find merged node to verify");ea.runtime.jF("Validate markers taking too long");return!0}),ea.runtime.i8b.Lxh.forEach(la=>{var xa=ea.runtime.Fl.J(la);if(xa){var Ha=this.Vc.getPropertyObjectId(xa.tj,c.a.qB);xa=this.Vc.getPropertyObjectId(xa.tj,c.a.dy);if(!Ha||!xa){let ua;(ua=ea.ma.MXa).Mtc=ua.Mtc+1;return!0}Ha=this.Uuc(ea,Ha,la,c.a.Yj,ua=>
33===ua);la=this.Uuc(ea,xa,la,c.a.Yj,ua=>34===ua);if(!Ha||!la){let ua;(ua=ea.ma.MXa).Mtc=ua.Mtc+1}}else m.a.instance.Ba(559535578,1,2,"ValidateMerge: Couldn't find merged node to verify");ea.runtime.jF("Validate markers taking too long");return!0})}catch(la){m.a.instance.Ba(559535579,1,2,"ValidateMerge threw an exception: {0}",la)}return ea.ma.MXa.O4h()?!1:!0}Uuc(ea,la,xa,Ha,ua){if(ea.runtime.tdg.contains(la))return!1;if(la=this.SUh(ea,la)){la=this.Vc.getPropertyObjectIds(la,n.a.BC);for(let Ba=0;Ba<
la.length;Ba++){var Ra=this.SUh(ea,la.Ve(Ba));if(Ra){var ab=this.Vc.getPropertyBool(Ra,n.a.d3);if(ab&&ab&&(ab=this.Vc.getPropertyUint32(Ra,c.a.tq),Ra=this.Vc.getPropertyObjectId(Ra,Ha),ua(ab)&&Ra.equals(xa)))return!0}}}return!1}SUh(ea,la){const xa=ea.runtime.Fl.J(la);return xa?xa.tj:ea.runtime.pj.J(la)}ICm(ea){switch(ea){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}rlk(ea,la){let xa=!1;if(1074135145===ea)return!0;la&&la.us(212);la&&la.isFeatureEnabled(212)&&
1074135153===ea&&(xa=!0);return xa}GFl(ea){switch(ea){case 1074135162:return!0}return!1}Phk(ea,la){const xa=new y.a,Ha=new y.a,ua=new y.a;var Ra=ea.runtime.yIa;const ab=Ra?Ra.id:t.a.nil;this.v2f(Ra).forEach(Ba=>{xa.add(la(Ba));return!0});Ra=ea.input.f8.Ve(ea.input.f8.length-1);this.v2f(Ra,ab).forEach(Ba=>{Ha.add(la(Ba));return!0});ea=ea.input.SCa.Ve(ea.input.SCa.length-1);this.v2f(ea,ab).forEach(Ba=>{ua.add(la(Ba));return!0});return{JVj:xa,AJm:Ha,OYm:ua}}v2f(ea,la=null){const xa=new y.a;la||(la=t.a.nil);
for(;ea&&!la.equals(ea.id);)xa.add(ea),ea=ea.NY;xa.reverse();return xa}WGm(ea){const la=3===this.Ibe;let xa=!1;!ea.output.succeeded&&(2===this.Ibe||ea.output.crash&&1===this.Ibe)&&(xa=!0);let Ha=!1;ea.input.f8&&0<ea.input.f8.length&&(la||xa)&&ea.runtime.Aw&&ea.runtime.pj&&ea.runtime.Qa&&(Ha=ea.runtime.Qa.isFeatureEnabled(81));return Ha}O$h(ea){return 9===E.a.Lsb(E.a.$7d(ea))}vdi(ea){return 8===E.a.Lsb(E.a.$7d(ea))}static YOk(ea){return ea.output.crash?2:ea.output.succeeded?3:1}}ia.Hbe=t.a.pe("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(z.a)(ia,"GraphMergerBase",null,[1514])},1641:function(z,H,b){z=b(0);var f=b(1452),c=b(48);class n{constructor(){this.source=0;this.Xi=this.SCa=this.f8=null;this.g2=0;this.atc=!1;this.mode=this.dCa=0;this.F9c=null;this.g3b=c.a.create()}}Object(z.a)(n,"InputState",null,[]);class m{constructor(){this.timeout=this.succeeded=this.crash=!1;this.cK=null}}Object(z.a)(m,"OutputState",null,[]);class x{constructor(){this.x8h=this.nwe=this.Jyd=!1;this.Qa=this.tdg=this.i8b=this.VBg=this.IQb=this.fUa=this.jF=
this.cyb=this.MDc=this.KFg=this.qxk=this.Fl=this.fvf=this.wp=this.Aw=this.pj=this.uAe=this.H6d=this.yIa=null}}Object(z.a)(x,"RuntimeState",null,[]);b.d(H,"a",function(){return y});class y{constructor(){this.input=new n;this.runtime=new x;this.output=new m;this.ma=new f.a(this)}}Object(z.a)(y,"MergeState",null,[])},1642:function(z,H,b){b.r(H);z=b(0);var f=b(505),c=b(151),n=b(111),m=b(201),x=b(1293),y=b(1409),v=b(1430),t=b(4),A=b(1635);class D{constructor(S,L){this.start=S;this.end=L}}Object(z.a)(D,
"MergeDiffIdx",null,[]);class U{constructor(S,L,I,O=!1,M=null,R=null,W=!0,Y=!1){this.yId=this.xId=this.PSg=this.aSc=0;this.Ukc=this.cIe=null;this.ulb=M||new A.a;this.Wf=I;this.Uha=S.Q7();this.TFj=L.Q7();this.pR=new D(0,0);this.wV=new D(0,0);this.ygc=O;this.uOc=W;this.yOe=Y;this.yMc=R;this.R0j();this.psm()}get rL(){return this.Uha}get zK(){return this.TFj}get pz(){return this.aSc}get pv(){return this.PSg}get Wja(){return this.xId}get eea(){return this.yId}get lok(){const S=new c.a;for(let L=this.cIe.start;L<
this.cIe.end;L++)S.add(this.rL.Ve(L));return S}get rwf(){const S=new c.a;for(let L=this.Ukc.start;L<this.Ukc.end;L++)S.add(this.zK.Ve(L));return S}S4d(S){if(this.pv<S.pv){if(this.pv+this.Wja>S.pv)return!0}else if(this.pv>S.pv){if(S.pv+S.Wja>this.pv)return!0}else if(2===this.pz&&3===S.pz||3===this.pz&&2===S.pz||2===this.pz&&2===S.pz||3===this.pz&&3===S.pz)return!0;return!1}AIi(S,L,I,O){S.WB(L);S.my(L,I);return O+=I.length-1}bXi(S,L,I,O,M){let R=this.rL.Ve(S),W=this.zK.Ve(L);if(!R||!W||!R.Shb&&!W.Shb)return{returnValue:!1,
RHa:O,zPa:M};let Y=new c.a,N=new c.a;R.Shb&&(Y=R.xzd(),R=Y.Ve(I?0:Y.length-1));W.Shb&&(N=W.xzd(),W=N.Ve(I?0:N.length-1));I=this.ygc&&this.yOe?!(this.guc(R)||this.guc(W)):this.ygc;if(!R.jz(W,this.ulb,this.yMc,I,this.uOc))return{returnValue:!1,RHa:O,zPa:M};Y.length&&(O=this.AIi(this.rL,S,Y,O));N.length&&(M=this.AIi(this.zK,L,N,M));return{returnValue:!0,RHa:O,zPa:M}}$yk(S,L,I,O,M,R){for(;M<=I&&R<=O;){const W=S.Ve(M),Y=L.Ve(R),N=this.ygc&&this.yOe?!(this.guc(W)||this.guc(Y)):this.ygc;if(!W.jz(Y,this.ulb,
this.yMc,N,this.uOc))break;this.pR.start+=W.length;this.wV.start+=Y.length;M++;R++}return{Jhf:M,vGg:R}}Yyk(S,L,I,O,M,R){for(;M>=I&&R>=O;){const W=S.Ve(M),Y=L.Ve(R),N=this.ygc&&this.yOe?!(this.guc(W)||this.guc(Y)):this.ygc;if(!W.jz(Y,this.ulb,this.yMc,N,this.uOc))return{returnValue:!0,RHa:M,zPa:R};M--;R--}return{returnValue:!1,RHa:M,zPa:R}}Zyk(S,L,I,O){let M=!1;do({Jhf:S,vGg:L}=this.$yk(this.rL,this.zK,I,O,S,L)),{RHa:I,zPa:O,returnValue:M}=this.bXi(S,L,!0,I,O);while(M);return{Jhf:S,vGg:L,RHa:I,zPa:O}}Xyk(S,
L,I,O){let M=!1;do{if(!({RHa:I,zPa:O}=this.Yyk(this.rL,this.zK,S,L,I,O)).returnValue)break;({RHa:I,zPa:O,returnValue:M}=this.bXi(I,O,!1,I,O))}while(M);return{RHa:I,zPa:O}}R0j(){var S=0,L=0,I=this.rL.length-1,O=this.zK.length-1;0<=I&&this.rL.Ve(I);0<=O&&this.zK.Ve(O);({Jhf:S,vGg:L,RHa:I,zPa:O}=this.Zyk(S,L,I,O));if(S<I||L<O)({RHa:I,zPa:O}=this.Xyk(S,L,I,O));I++;O++;this.cIe=new D(S,I);this.Ukc=new D(L,O);this.pR.end=this.pR.start;this.wV.end=this.wV.start;for(var M=S;M<I;M++){var R=this.rL.Ve(M);this.pR.end+=
R.length}for(M=L;M<O;M++)R=this.zK.Ve(M),this.wV.end+=R.length;n.a.instance.Ba(3993809,1,3,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",S,I,L,O);n.a.instance.Ba(3993810,1,3,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.pR.start,this.pR.end,this.wV.start,this.wV.end);this.pR.start<=this.pR.end&&this.wV.start<=this.wV.end&&(S=this.rL.Ve(S),L=this.zK.Ve(L),
M=this.rL.Ve(I),R=this.zK.Ve(O),I=this.rL.Ve(I-1),O=this.zK.Ve(O-1),n.a.instance.Ba(3993811,1,3,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",S,M,L,R,I,O))}psm(){this.PSg=this.pR.start;this.xId=this.yId=0;this.pR.start===this.pR.end&&this.wV.start===this.wV.end?this.aSc=0:this.pR.start===this.pR.end&&this.wV.start<this.wV.end?(this.aSc=1,this.yId=this.wV.end-this.wV.start):this.wV.start===
this.wV.end&&this.pR.start<this.pR.end?(this.aSc=2,this.xId=this.pR.end-this.pR.start):(this.aSc=3,this.xId=this.pR.end-this.pR.start,this.yId=this.wV.end-this.wV.start);n.a.instance.Ba(3993814,1,3,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.pz,this.pv,this.Wja,this.eea)}rol(S,L){return S.b2()&&L.b2()?S.runId===L.runId&&S.nf===L.nf:!1}ksl(S){if(!S.b2()||"\ufffc"!==S.text)return!1;S=S.Krb;return S?S.hasProperty(t.a.Yj)||S.hasProperty(t.a.apb)||
S.hasProperty(t.a.Vxf)||S.hasProperty(t.a.dQ)||S.hasProperty(t.a.H$)||S.hasProperty(t.a.Ala)||S.hasProperty(t.a.Pcb)||S.hasProperty(t.a.tq)&&(S=this.Wf.getPropertyInt32(S,t.a.tq))&&(36===S||35===S||24===S||23===S||33===S||34===S||44===S||45===S||42===S||43===S)?!0:!1:!1}guc(S){if(!S.b2()||"\ufffc"!==S.text)return!1;S=S.Krb;return S?S.hasProperty(t.a.tq)&&(S=this.Wf.getPropertyInt32(S,t.a.tq))&&(33===S||34===S)?!0:!1:!1}jjd(S){return S.b2()&&!this.ksl(S)}Z1j(){if(2===this.pz)return!1;var S=this.Ukc.start;
if(!S)return!1;let L=null;for(var I=this.Ukc.start;I<this.Ukc.end;I++){const O=this.zK.Ve(I);if(this.jjd(O)){L=O;break}}if(!L)return!1;--S;for(I=this.zK.Ve(S);I&&!this.jjd(I);)S--,I=this.zK.Ve(S);return I&&this.rol(I,L)?!0:!1}WUh(S){const L=new c.a;for(let I=0;I<S.length;I++)S.J(I).Shb?L.my(L.length,S.J(I).xzd()):L.insert(L.length,S.J(I));return L}tol(){if(3!==this.pz||this.Wja!==this.eea)return!1;const S=this.WUh(this.lok),L=this.WUh(this.rwf);if(S.length!==L.length)return!1;for(let I=0;I<S.length;I++)if(!S.J(I).jz(L.J(I),
this.ulb,this.yMc,!0,this.uOc))return!1;return!0}sol(){if(this.pz&&3!==this.pz||this.rL.length!==this.zK.length)return!1;let S=!1;for(let L=0;L<this.rL.length;L++){if(!this.rL.J(L).jz(this.zK.J(L),this.ulb,this.yMc,!0,this.uOc))return!1;if(3===this.rL.J(L).type||1===this.rL.J(L).type){const I=this.rL.J(L),O=this.zK.J(L);S=I.runId!==O.runId||I.nf!==O.nf||S}}return S}}Object(z.a)(U,"MergeBlockDiff",null,[]);var F=b(1233);class E{constructor(S,L){this.id=S;this.index=L}}Object(z.a)(E,"ParagraphStartIndex",
null,[]);var P=b(1305),G=b(1208);b.d(H,"ParagraphMerge",function(){return K});class K{constructor(S,L,I,O,M,R){this.sjc=this.CKb=this.wm=this.xt=null;this.Ce=!1;this.jfh=this.NUg=this.cOg=this.cqa=this.iEa=this.Uha=null;this.Qc=S;this.JC=L;this.Uxa=O;this.Bwa=I;this.xM=M;this.FRd=this.xM(109);this.Wf=R}OZh(S){const L=new f.a;S.rL.forEach(I=>{2===I.type&&L.add(I.jj);return!0});S.zK.forEach(I=>{2===I.type&&L.remove(I.jj);return!0});return L}eXh(S){const L=new c.a;S.zK.forEach(I=>{2===I.type&&L.add(I.jj);
return!0});return L}xyh(S){const L=new c.a;let I=0,O=0;S.zK.forEach(M=>{2===M.type&&(L.add(new E(M.jj,I<S.pv?I:I<S.pv+S.eea?S.pv:I-S.eea+S.Wja)),I=O);O+=M.length;return!0});return L}p$j(S,L){var I=this.xyh(S);const O=this.xyh(L);S=this.OZh(S);const M=this.OZh(L);L=new c.a;const R=new f.a;let W=0;for(let Y=0;Y<I.length;Y++){const N=I.J(Y);if(W<O.length){let aa=O.J(W);for(;W<O.length&&aa.index<=N.index;){if(aa.id.equals(N.id)){W++;break}S.contains(aa.id)||R.contains(aa.id)||(L.add(aa.id),R.add(aa.id));
W++;aa=O.J(W)}}M.contains(N.id)||(L.add(N.id),R.add(N.id))}for(;W<O.length;)I=O.J(W),S.contains(I.id)||R.contains(I.id)||(L.add(I.id),R.add(I.id)),W++;return L}initialize(){if(this.Ce){const S=!!this.xt&&!!this.wm;this.Qc.ma.uf(Object.assign(new F.a,{Mh:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return S}this.Ce=!0;if(!({rL:this.Uha,D9c:this.iEa,kCd:this.cqa,HZd:this.cOg,I6d:this.NUg,vAe:this.jfh}=G.a.jCh(this.Qc,this.Wf,this.JC,this.Bwa,this.Uxa,this.xM,!1,!1)).returnValue)return!1;
this.xt=new U(this.Uha,this.iEa,this.Wf,void 0,void 0,this.xM);this.wm=new U(this.Uha,this.cqa,this.Wf,void 0,void 0,this.xM);n.a.instance.Ba(593272919,1,3,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.xt.Wja,this.xt.eea,this.wm.Wja,this.wm.eea));return!0}$_a(){n.a.instance.Ba(593826836,1,3,"Attempting to merge with LCS");let S=!1;const L=this.Qc.runtime.Qa.isFeatureEnabled(109),I=new v.a(this.Wf,this.Qc);var O=null;let M=
null;var R=null;const W=N=>this.Qc.runtime.pj.J(N);O=N=>this.Qc.runtime.Aw.J(N)||this.Qc.runtime.pj.J(N);const Y=N=>this.Qc.runtime.wp.J(N)||this.Qc.runtime.pj.J(N);L?(this.xt=new U(this.Uha,this.iEa,this.Wf,void 0,void 0,this.xM,!1),this.wm=new U(this.Uha,this.cqa,this.Wf,void 0,void 0,this.xM,!1),({updateHints:O}=I.hDh(this.JC,W,this.Bwa,O,this.xt.pv,this.xt.pv+this.xt.Wja,this.xt.pv+this.xt.eea)).returnValue&&({updateHints:M}=I.hDh(this.JC,W,this.Uxa,Y,this.wm.pv,this.wm.pv+this.wm.Wja,this.wm.pv+
this.wm.eea)).returnValue&&(S=!0)):({updateHints:O}=I.gDh(this.JC,W,this.Bwa,O,this.xt.pv,this.xt.pv+this.xt.Wja,this.xt.pv+this.xt.eea)).returnValue&&({updateHints:M}=I.gDh(this.JC,W,this.Uxa,Y,this.wm.pv,this.wm.pv+this.wm.Wja,this.wm.pv+this.wm.eea)).returnValue&&(S=!0);S||(n.a.instance.Ba(593826835,1,2,"Failed to create update hints with LCS"),S=!1);S&&(R=new P.a(this.Qc,this.JC,this.Bwa,this.Uxa,N=>this.Qc.runtime.Qa?this.Qc.runtime.Qa.isFeatureEnabled(N):!1,this.Wf,null,O,M),({Fl:R}=R.DFc()).returnValue||
(n.a.instance.Ba(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.Qc.ma.uf(Object.assign(new F.a,{Mh:"TryLCSMerge",eventId:"9zrqs"})),S=!1));n.a.instance.Ba(593826833,1,S?3:2,"TryLCSMerge: [Success: {0}]",S);return{returnValue:S,Fl:R}}DFc(){let S;S=null;if(!this.initialize())return this.Qc.ma.UL("ParagraphMerge Initialize"),this.txb(),{returnValue:!1,Fl:S};this.Qc.ma.UL("ParagraphMerge Initialize");this.Qc.runtime.Qa.us(109);let L;this.Qc.ma.ive(2);let I=({$_a:L}=this.qqk()).returnValue;
this.FRd&&(I=I&&({Fl:S,$_a:L}=this.wcd(this.Qc,this.Wf,this.xM,this.sjc,this.CKb)).returnValue);this.Qc.ma.uug();if(!I){this.Qc.ma.UL("ParagraphMerge DoMergeInteral");if(L){this.Qc.ma.ive(3);({Fl:S,returnValue:I}=this.$_a());this.Qc.ma.uug();if(I)return{returnValue:!0,Fl:S};this.txb();return{returnValue:!1,Fl:S}}this.txb();return{returnValue:!1,Fl:S}}if(!this.FRd)return this.wcd(this.Qc,this.Wf,this.xM,this.sjc,this.CKb);this.Qc.ma.UL("ParagraphMerge DoMergeInteral");return{returnValue:!0,Fl:S}}wcd(){let S;
if(!({Ioe:S}=G.a.wcd(this.Qc,this.Wf,this.xM,this.sjc,this.CKb)).returnValue)return this.Qc.ma.UL("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.txb(),{returnValue:!1,Fl:S,$_a:!0};this.Qc.ma.UL("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,Fl:S,$_a:!1}}txb(S=!1){n.a.instance.mna(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+S+"] BaseRevisionMergeBlocksList: {0}",this.cOg);n.a.instance.mna(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.NUg);n.a.instance.mna(4478667,
1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.jfh);S=new c.a;G.a.zwc(this.Wf,"BaseObjects_",this.JC,S);G.a.zwc(this.Wf,"FavoredObjects_",this.Bwa,S);G.a.zwc(this.Wf,"ConflictObjects_",this.Uxa,S);G.a.kzl(this.Qc,S)}Tsh(S){let L,I;I=L=0;if(!this.xt.pz)L=this.wm.pv;else if(1===this.xt.pz)L=this.wm.pv<this.xt.pv?this.wm.pv:this.wm.pv===this.xt.pv?S||1!==this.wm.pz?this.wm.pv+this.xt.eea:this.wm.pv:this.wm.pv+this.xt.eea;else if(2===this.xt.pz||3===this.xt.pz)L=this.wm.pv<=this.xt.pv?this.wm.pv:this.wm.pv+
(this.xt.eea-this.xt.Wja);if(2===this.wm.pz||3===this.wm.pz)I=L+this.wm.Wja;return{d3h:L,C5k:I}}XMh(S,L){let I;I=0;if(!L)return{returnValue:!0,Dod:I};let O=0,M=0;for(;O<S.length;){let R;for(let W=O;W<S.length;W++){O=W;R=S.J(W);const Y=R.length;M+=Y;if(!(M<L)){if(M>L)if(R.Shb)S.WB(O),S.my(O,R.xzd()),M-=Y;else return n.a.instance.Ba(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
L),this.Qc.ma.uf(Object.assign(new F.a,{Mh:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,Dod:I};break}}if(M===L)return O++,I=O,{returnValue:!0,Dod:I}}n.a.instance.Ba(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",L);this.Qc.ma.uf(Object.assign(new F.a,{Mh:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,Dod:I}}kTj(S,L,I){let O=0;var M=0,R=!1;const W=this.wm.rwf.Q7();
if(this.wm.Z1j())for(--L;0<=L;L--){let Y=S.J(L);if(this.wm.jjd(Y)){M=S.J(L);O=M.runId;M=M.nf;R=!0;break}}R||((M=S.J(I))&&this.wm.jjd(M)?(O=M.runId,M=M.nf):M=O=0);for(S=0;S<W.length;S++)I=W.J(S),I.b2()&&(R=I,this.wm.jjd(I)?(R.runId=O,R.nf=M):(R.runId=0,R.nf=0));return W}Bdi(S){if(2===S.length){const L=1===S.J(0).type?S.J(0):null;S=2===S.J(1).type;if(L&&S&&""===L.text)return!0}return!1}qqk(){const S=this.xt.sol();if(!S&&!this.xt.pz)return this.sjc=this.wm.zK.Q7(),this.CKb=this.eXh(this.wm),{returnValue:!0,
$_a:!1};if(!this.wm.pz)return this.sjc=this.xt.zK.Q7(),this.CKb=this.eXh(this.xt),{returnValue:!0,$_a:!1};(this.Bdi(this.xt.zK)||this.Bdi(this.wm.zK))&&this.Qc.ma.Cki(Object.assign(new F.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!S){var L=this.xt.S4d(this.wm);if(L&&this.xM(90)&&(n.a.instance.Ba(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.xt=new U(this.Uha,this.iEa,this.Wf,!0,void 0,this.xM),this.wm=
new U(this.Uha,this.cqa,this.Wf,!0,void 0,this.xM),L=this.xt.S4d(this.wm),this.xM(96)&&!L)){var I=new U(this.Uha,this.iEa,this.Wf,!0,void 0,this.xM,void 0,!0),O=new U(this.Uha,this.cqa,this.Wf,!0,void 0,this.xM,void 0,!0);n.a.instance.Ba(545861915,1,3,"DoMergeInternal: Diff {0} with comments formatting included",I.S4d(O)?"does overlap":"does not overlap")}if(L)return n.a.instance.Ba(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.Qc.ma.uf(Object.assign(new y.a,
{Mh:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,$_a:!0}}L=0;this.CKb=this.p$j(this.xt,this.wm);({d3h:O,C5k:M}=this.Tsh(!1));I=this.xt.zK.Q7();if(!({Dod:O}=this.XMh(I,O)).returnValue||(2===this.wm.pz||3===this.wm.pz)&&!({Dod:L}=this.XMh(I,M)).returnValue)return{returnValue:!1,$_a:!1};if(2===this.wm.pz||3===this.wm.pz){this.qCc(I,L);this.qCc(I,O-1);var M=null;for(var R=L-1;R>=O;R--)2===I.J(R).type&&(M=I.J(R)),I.WB(R);0<I.length&&(R=I.J(I.length-1),2!==R.type&&4!==R.type&&M&&(this.Qc.runtime.Qa.us(126),
this.Qc.runtime.Qa.isFeatureEnabled(126)&&(I.add(M),this.CKb.add(M.jj))));n.a.instance.Ba(4019726,1,3,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",L-O-1,O)}if(1===this.wm.pz||3===this.wm.pz)M=this.wm.rwf,S&&(M=this.kTj(I,O,L)),this.qCc(I,O-1),this.qCc(I,O),this.qCc(M,0),this.qCc(M,M.length-1),I.my(O,M),n.a.instance.Ba(4019727,1,3,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",O,S,M.Go());this.sjc=I;return{returnValue:!0,$_a:!1}}qCc(S,
L){0>L||L>=S.length||(S=S.J(L),Object(m.a)(x.a,S)&&(S.$Wa=!0))}CCd(S,L){let I;I=L;if(!this.initialize())return{returnValue:!1,mgb:S,xua:I};if(this.wm.S4d(this.xt))return this.txb(!0),this.Qc.ma.uf(Object.assign(new y.a,{Mh:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,mgb:S,xua:I};if(!this.wm.pz||3===this.wm.pz&&this.wm.tol())return{returnValue:!0,mgb:S,xua:L};let O;({d3h:O}=this.Tsh(!0));L<O||L===O&&(1!==this.wm.pz||1===this.wm.pz&&1===this.xt.pz&&L===this.xt.pv+this.xt.eea)?I=L:(I=L+this.wm.eea-
this.wm.Wja,I<O&&(I=O));return{returnValue:!0,mgb:S,xua:I}}}Object(z.a)(K,"ParagraphMerge",null,[1790])},1643:function(z,H,b){b.r(H);z=b(0);var f=b(1313),c=b(1200),n=b(1177),m=b(1416),x=b(1199);class y{constructor(E="",P="",G="",K=-99999,S=-1){this.Type=this.Description=this.Title=null;this.Age=this.Score=0;this.Title=E?E:"";this.Description=P?P:"";this.Type=G?G:"";this.Score=K;this.Age=S}}Object(z.a)(y,"Suggestion",null,[]);class v{constructor(E,P){this.GroupType=this.Suggestions=null;this.Suggestions=
E;this.GroupType=P}}Object(z.a)(v,"SuggestionGroup",null,[]);class t{}t.help="help";t.answer="answer";t.commands="commands";t.pom="servicecommands";Object(z.a)(t,"SuggestionGroupType",null,[]);var A=b(1111),D=b(2),U=b(31);b.d(H,"InteractionLogger",function(){return F});class F{constructor(E,P,G){this.KNe=0;this.O8e=this.JQc=null;this.Jb=E;this.e7e=this.YKe=this.LSe=!1;this.Hjj=P;this.Be=D.AFrameworkApplication.he;this.tc=G;this.ZHd=this.v1e=0}get wBa(){return this.Jb.wBa}vve(E){this.Jb.vve(E)}sli(){if(this.JQc){var E=
0;for(const P of this.JQc)this.Jb.IAl(P,E++);this.JQc=null}}beginQuery(E,P,G){this.Jb.CAl(E,P,G)}tyb(E,P){this.Jb.$Vj(E,P);this.LSe=!0;this.e7e=!1}gBa(){this.LSe=!1;this.YKe||(this.sli(),this.Jb.uJh(this.KNe))}DAl(E,P){this.Jb.EAl(E,P)}CMl(E,P,G,K,S){for(const L of this.Hjj)if(E.startsWith(L)){this.e7e=!0;break}this.Jb.Wyl(E,P,G,K,S)}cNl(E){this.YKe=!1;this.KNe=E;this.LSe||this.e7e||(this.sli(),this.Jb.uJh(this.KNe,!1))}bNl(E,P){this.Jb.Zyl(E,P);this.YKe=!0}JPh(E,P){if(!E.count)return"";let G="";
const K=Date.now();for(let S of E)E=(K-S.timeStamp)/1E3,E=A.a.zEg(E),0<G.length&&(G+=";"),G+=P?S.commandId:S.controlId,G+=":",G+=E.toString();return G}Aeb(){var E=this.JPh(f.a.instance.Kad(),!1);0<E.length&&this.Jb.Vyl(E);E=this.JPh(f.a.instance.Kqc(),!0);0<E.length&&this.Jb.Jyl(E)}RAl(E){this.Jb.Pyl(E)}taa(E,P,G,K,S,L,I,O=null){this.Jb.Zzl(E,P,G,K,S,L,I,O)}wG(E,P,G=null){this.Jb.nmd(E,P,G)}onError(E,P,G=null){this.Jb.tdb(E,P,G)}Rrm(E){this.JQc=E}R0k(E,P=!1){const G=[];if(!E)return G;for(let K=0;K<
E.length;K++){const S=n.a[E[K].groupType].toLowerCase(),L=[],I=E[K].results;if(I){for(let O=0;O<I.length;O++)"findindocument"!==S||""===this.tc.$Lf&&!P?Array.add(L,new y(I[O].label,I[O].description,S,I[O].score,I[O].sYd)):Array.add(L,new y("","",S,I[O].score,I[O].sYd));"answer"===S||"definition"===S||"wolframanswer"===S||"entity"===S?Array.add(G,new v(L,t.answer)):"classifier"===S||"appsforoffice"===S?Array.add(G,new v(L,t.commands)):"serviceclassifier"===S?Array.add(G,new v(L,t.pom)):"assistance"===
S?Array.add(G,new v(L,t.help)):("document"===S||"people"===S||"findindocument"===S||"notes"===S||"image"===S)&&Array.add(G,new v(L,S))}}return G}n0h(E,P,G=!1){const K={};K.Query=P;K.SuggestionGroups=U.c(this.R0k(E,G));return U.c(K)}Z0h(E){const P={"Content-Type":"application/json",Accept:"application/json"};P["X-Office-Version"]=D.AFrameworkApplication.buildVersion;P["X-Office-Application"]=D.AFrameworkApplication.K.Oa("Application");P["X-Office-Platform"]="WAC";P["X-TellMe-SqmUserId"]=D.AFrameworkApplication.K.Oa("LoggableUserId")||
"";P["X-TellMe-SessionId"]=this.Jb.wBa.hla;P["X-TellMe-SuggestionTypes"]="Ranker";P["X-TellMe-Culture"]=D.AFrameworkApplication.uiCulture;P["X-TellMe-ProcessSessionId"]=D.AFrameworkApplication.userSessionId;P["X-TellMe-Flights"]=E;P["X-TellMe-PartialQueryIndex"]=this.v1e;return P}z6b(E,P,G){this.taa(P.length,"RankerLogging",E.data.ff.toString(),Math.round(window.performance.now()-G),x.a.i_i,!0,c.a.rWa)}e6b(E,P,G){this.taa(P.length,"RankerLogging",E.data.ff.toString(),Math.round(window.performance.now()-
G),x.a.i_i,!1,c.a.rWa)}$0h(){this.O8e||(this.O8e=new m.a(this.tc,null,6E3));return this.O8e.z8}E3f(E){const P=this.n0h(this.JQc,E,!0),G=this.Z0h("RankerLogging"),K=window.performance.now();this.Be.Hi(this.$0h(),2,P,G,!1,0,S=>{this.z6b(S,E,K)},S=>{this.e6b(S,E,K)},null,null,!1,4E3,6E3);this.v1e++}Ehm(){this.v1e=0}ltg(E){this.ZHd=E}}Object(z.a)(F,"InteractionLogger",null,[])},1646:function(z,H,b){b.r(H);z=b(0);var f=b(15),c=b(4),n=b(111),m=b(151),x=b(48),y=b(1399),v=b(1292),t=b(1231),A=b(1208);class D{constructor(P,
G,K=null){this.author=P;this.Hnd=G;this.Yfg=K||x.a.nil}jz(P){return P?this.author===P.author&&this.Hnd===P.Hnd&&this.Yfg===P.Yfg:!1}}Object(z.a)(D,"RunMergeBlockTrackedChangeAttribute",null,[]);class U{constructor(P,G,K){this.insertion=P||U.xyf;this.deletion=G||U.xyf;this.ANa=K||U.xyf}get A9k(){return 0<this.insertion.author.length}get k9k(){return 0<this.deletion.author.length}get R9k(){return 0<this.ANa.author.length}jz(P){return P?this.insertion.jz(P.insertion)&&this.deletion.jz(P.deletion)&&this.ANa.jz(P.ANa):
!1}}U.xyf=new D("",0);Object(z.a)(U,"RunMergeBlockTrackedChangeInfo",null,[]);var F=b(1451);b.d(H,"ParagraphMergeBlockCreator",function(){return E});class E extends v.a{constructor(P,G,K,S,L,I,O){super();this.maxValue=Number.MAX_VALUE;this.yA=new y.a;this.iec=null;this.hP=0;this.YZg=!1;this.$Rc="";this.eHe=P;this.Fr=G;this.gv=K;this.XCj=S;this.bKd=L;this.sZg=I;this.Wf=O;if(this.Wf.hasProperty(this.Fr,f.a.ml))if(this.Wf.hasProperty(this.Fr,c.a.Gb))if(this.Wf.hasProperty(this.Fr,c.a.tm))if(this.Wf.hasProperty(this.Fr,
c.a.po))if(this.Wf.hasProperty(this.Fr,f.a.BC))if(this.E4=this.Wf.getPropertyString(this.Fr,f.a.ml),this.qP=this.Wf.getPropertyUint32(this.Fr,c.a.Gb),this.fr=this.Wf.getPropertyUint32s(this.Fr,c.a.tm),this.fQd=this.Wf.getPropertyUint32s(this.Fr,c.a.po),this.VPe=this.Wf.getPropertyObjectIds(this.Fr,f.a.BC),this.E4||""===this.E4)if(this.E4.length||1!==this.VPe.length||(this.fr.length||(this.fr.add(0),n.a.instance.Ba(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),
this.fQd.length||(this.fQd.add(0),n.a.instance.Ba(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.hvj=this.D8d(this.Fr,c.a.a8f,this.fr.length),this.wUc=this.D8d(this.Fr,f.a.$N,this.fr.length),this.Lpa=this.D8d(this.Fr,f.a.cva,this.fr.length),this.Doa=this.D8d(this.Fr,c.a.mQ,this.fr.length),this.tpa=this.d3k(this.Fr,c.a.fO,this.fr.length),this.sdl(),P=this.Wf.hasProperty(this.Fr,f.a.hA)?this.Wf.getPropertyUint32s(this.Fr,f.a.hA):new m.a,this.FSd=
A.a.jRi(P,this.E4.length),this.fr.length!==this.fQd.length)n.a.instance.Ba(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",G.id);else if(this.fr.length!==this.VPe.length)n.a.instance.Ba(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",G.id);else{this.sZg&&(this.Wf.hasProperty(this.Fr,c.a.Ir)?this.iec=this.Wf.getPropertyObjectIds(this.Fr,c.a.Ir):(n.a.instance.Ba(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",
G.id),this.iec=this.l1(this.fr.length,x.a.nil)),this.fr.length!==this.iec.length&&(n.a.instance.Ba(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",G.id,this.fr.length,this.iec.length),this.iec=this.l1(this.fr.length,x.a.nil)));if(this.fr.length!==this.wUc.length||this.fr.length!==this.Lpa.length||this.fr.length!==this.Doa.length||this.fr.length!==this.tpa.length)this.fr.length===this.wUc.length||this.bKd||n.a.instance.Ba(8266445,
1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",G.id,this.fr.length,this.wUc.length),this.fr.length===this.Lpa.length||this.bKd||n.a.instance.Ba(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",G.id,this.fr.length,this.Lpa.length),this.fr.length===this.Doa.length||this.bKd||n.a.instance.Ba(20742792,
1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",G.id,this.fr.length,this.Doa.length),this.fr.length===this.tpa.length||this.bKd||n.a.instance.Ba(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",G.id,this.fr.length,this.tpa.length),P=this.Wf.getPropertyBool(this.Fr,f.a.upf),n.a.instance.Ba(17877020,
1,3,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",G.id,L,null==P?!1:P),this.wUc=this.l1(this.fr.length,!0),this.Lpa=this.l1(this.fr.length,!1),this.Doa=this.l1(this.fr.length,!1),this.tpa=this.l1(this.fr.length,0),this.Wf.setPropertyBool(this.Fr,f.a.upf,!1);this.yA.vWm(this.fr.length)?(this.FSd.length!==this.fr.length+1&&n.a.instance.Ba(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",
G.id,this.fr.length,this.FSd.length),this.rsj=!0):n.a.instance.Ba(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",G.id)}else n.a.instance.Ba(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",G.id);else n.a.instance.Ba(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",G.id);else n.a.instance.Ba(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",G.id);else n.a.instance.Ba(3993796,
1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",G.id);else n.a.instance.Ba(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",G.id);else n.a.instance.Ba(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",G.id)}sdl(){this.Wf.hasProperty(this.Fr,c.a.HWa)?this.yA.Jub=this.Wf.getPropertyBools(this.Fr,c.a.HWa):this.yA.Jub=this.l1(this.fr.length,!1);this.Wf.hasProperty(this.Fr,c.a.Sya)?this.yA.Iqb=this.Wf.getPropertyBools(this.Fr,c.a.Sya):
this.yA.Iqb=this.l1(this.fr.length,!1);this.Wf.hasProperty(this.Fr,c.a.IWa)?this.yA.Iub=this.Wf.getPropertyStrings(this.Fr,c.a.IWa):this.yA.Iub=this.l1(this.fr.length,"");this.Wf.hasProperty(this.Fr,c.a.IUa)?this.yA.Hqb=this.Wf.getPropertyStrings(this.Fr,c.a.IUa):this.yA.Hqb=this.l1(this.fr.length,"");this.Wf.hasProperty(this.Fr,c.a.JWa)?this.yA.Kub=this.Wf.getPropertyListOfMilliseconds(this.Fr,c.a.JWa):this.yA.Kub=this.l1(this.fr.length,0);this.Wf.hasProperty(this.Fr,c.a.JUa)?this.yA.w9a=this.Wf.getPropertyListOfMilliseconds(this.Fr,
c.a.JUa):this.yA.w9a=this.l1(this.fr.length,0);this.Wf.hasProperty(this.Fr,c.a.DYa)?this.yA.pfb=this.Wf.getPropertyBools(this.Fr,c.a.DYa):this.yA.pfb=this.l1(this.fr.length,!1);this.Wf.hasProperty(this.Fr,c.a.W_a)?this.yA.hzb=this.Wf.getPropertyStrings(this.Fr,c.a.W_a):this.yA.hzb=this.l1(this.fr.length,"");this.Wf.hasProperty(this.Fr,c.a.X_a)?this.yA.jzb=this.Wf.getPropertyListOfMilliseconds(this.Fr,c.a.X_a):this.yA.jzb=this.l1(this.fr.length,0);this.Wf.hasProperty(this.Fr,c.a.oPa)?this.yA.izb=this.Wf.getPropertyObjectIds(this.Fr,
c.a.oPa):this.yA.izb=this.l1(this.fr.length,x.a.nil)}D8d(P,G,K){return this.Wf.hasProperty(P,G)?this.Wf.getPropertyBools(P,G):this.l1(K,!1)}d3k(P,G,K){return this.Wf.hasProperty(P,G)?this.Wf.getPropertyUint32s(P,G):this.l1(K,0)}l1(P,G){const K=new m.a;for(let S=0;S<P;S++)K.add(G);return K}X1k(P){const G=this.FSd.Ve(P);P=this.FSd.Ve(P+1);return this.E4.substring(G,P)}nXh(){if(this.YZg)return null;var P=this.hP<this.fr.length?this.fr.Ve(this.hP):this.maxValue;if(P===this.maxValue||this.XCj&&!this.E4.length)return this.YZg=
!0,P=new t.a(this.gv,this.Fr.id,this.qP),this.$Rc=this.zff(this.$Rc,P.toString()),P;const G=this.fQd.Ve(this.hP),K=this.VPe.Ve(this.hP),S=this.hvj.Ve(this.hP),L=this.wUc.Ve(this.hP),I=this.Lpa.Ve(this.hP),O=this.Doa.Ve(this.hP),M=this.tpa.Ve(this.hP),R=this.sZg?this.iec.Ve(this.hP):null;var W=null;this.yA.Jub.Ve(this.hP)&&(W=new D(this.yA.Iub.Ve(this.hP)||"",this.yA.Kub.Ve(this.hP)));var Y=null;this.yA.Iqb.Ve(this.hP)&&(Y=new D(this.yA.Hqb.Ve(this.hP)||"",this.yA.w9a.Ve(this.hP)));var N=null;this.yA.pfb.Ve(this.hP)&&
(N=new D(this.yA.hzb.Ve(this.hP)||"",this.yA.jzb.Ve(this.hP),this.yA.izb.Ve(this.hP)));W=new U(W,Y,N);Y=this.X1k(this.hP);this.hP++;N=Y.startsWith("\ufddfHYPERLINK ");P=new F.a(this.eHe,this.gv,this.Fr.id,G,P,K,Y,S,!N,L,I,O,M,W,R);this.$Rc=this.zff(this.$Rc,P.toString());return P}cXh(){let P;P=null;var G="";if(!this.rsj)return{f6f:P,Udb:G};if(G=this.nXh())P=new m.a,P.add(G);for(;G=this.nXh();)P.add(G);G=this.$Rc;return{f6f:P,Udb:G}}}Object(z.a)(E,"ParagraphMergeBlockCreator",v.a,[])},1650:function(z,
H,b){b.r(H);z=b(0);var f=b(151),c=b(1292),n=b(1230);class m extends n.a{constructor(y,v){super(4,y,v)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.jj)}Qqc(){return"Table"}clone(){return new m(this.source,this.jj)}jz(y,v,t,A=!1){return super.jz(y,v,t,A)?this.jj.equals(y.jj):!1}get length(){return 1}}Object(z.a)(m,"TableMergeBlock",n.a,[]);b.d(H,"TableMergeBlockCreator",function(){return x});class x extends c.a{constructor(y,v){super();this.fOg=new m(v,y.id)}cXh(){let y;
y=new f.a;y.add(this.fOg);return{f6f:y,Udb:this.zff("",this.fOg.toString())}}}Object(z.a)(x,"TableMergeBlockCreator",c.a,[])},1715:function(z,H,b){b.r(H);var f=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},c=b(0),n=b(40),m=
b(58);class x extends Sys.EventArgs{constructor(Q,sa){super();this.fze=Q;this.actualValue=sa}}Object(c.a)(x,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var y=b(35);class v{constructor(){this.Dec=[];this.kRg=this.nLe=0;this.Rd=null;this.la=new m.a}init(Q,sa,bb){this.Rd=Q;this.nLe=sa;this.kRg=bb;this.Rd.SXd(Object(n.a)(this,this.$5b,"onCpuMeterFrameAvailable"));this.qNj(Object(n.a)(this,this.zck,"cpuPercentThresholdExceeded"))}$5b(Q,sa){sa.sod&&(Array.enqueue(this.Dec,sa.sod.CP),this.Dec.length>
this.kRg&&(Array.dequeue(this.Dec),this.e4j()))}e4j(){var Q=this.Dec.length;let sa=0;for(let bb=0;bb<Q;bb++){const Cb=Array.dequeue(this.Dec);sa+=Cb;Array.enqueue(this.Dec,Cb)}Q=sa/Q;Q>this.nLe&&this.la.raiseEvent("CPTTE",new x(this.nLe,Q))}zck(Q,sa){y.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.J2d(sa.fze,sa.actualValue))}qNj(Q){this.la.addHandler("CPTTE",Q)}J2d(Q,sa){const bb={};bb.ThresholdValue=Q;bb.ActualValue=sa;return bb}}Object(c.a)(v,"CpuMeterMonitor",null,[1828]);
var t=b(410);class A{constructor(){this.S=this.T=this.M=this.C=0}}Object(c.a)(A,"ProfileInformation",null,[]);var D=b(6),U=b(22),F=b(169),E=b(65);class P{constructor(Q=0,sa=0){this.HHb=!1;this.OGb={};this.hOd=Q;this.yOd=sa;this.D$e=0;U.a.addHandler(window.self,D.a.Ilh,()=>{this.HHb=!0});U.a.addHandler(window.self,D.a.Jlh,()=>{this.HHb=!1})}Llh(Q,sa,bb){const Cb=P.generateKey(sa,bb);Cb in this.OGb?sa=this.OGb[Cb]:(sa=new A,sa.S=bb?1:0,this.OGb[Cb]=sa,this.D$e++);sa.C++;sa.M=Q>sa.M?Q:sa.M;sa.T+=Q}nqa(Q,
sa){this.Llh(Q,sa,!1);this.HHb&&this.Llh(Q,sa,!0)}getData(){if(0<this.yOd&&this.D$e>this.yOd)return this.kLk();const Q=0<this.hOd,sa={},bb=this.OGb;for(let dc in bb){var Cb=dc;const Oc=bb[dc];this.iLi(Oc);Q&&Oc.T>=this.hOd&&(sa[Cb]=Oc)}return Q?E.a.Ud(sa)?null:sa:this.OGb}kLk(){var Q=0<this.hOd,sa=[];const bb=this.OGb;for(let Cb in bb){const dc={key:Cb,value:bb[Cb]};let Oc=dc.value;(!Q||Oc.T>=this.hOd)&&Array.add(sa,dc)}if(sa.length>this.yOd)sa.sort((Cb,dc)=>dc.value.T-Cb.value.T),sa=sa.slice(0,this.yOd);
else if(!sa.length)return null;Q={};for(const Cb of sa)sa=Cb.value,this.iLi(sa),Q[Cb.key]=sa;return Q}iLi(Q){Q.M=F.a.YQ(Q.M,0);Q.T=F.a.YQ(Q.T,0)}reset(){this.OGb={};this.D$e=0}static generateKey(Q,sa){return sa?Q+" [it]":Q}}Object(c.a)(P,"FunctionCallAggregator",null,[1214]);var G=b(2),K=b(978);class S{}Object(c.a)(S,"CpuMeterFrame",null,[]);class L extends Sys.EventArgs{constructor(Q){super();this.sod=Q}}Object(c.a)(L,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class I{}Object(c.a)(I,"MiniTaskItemInfo",
null,[]);class O{}Object(c.a)(O,"TaskItemInfo",null,[]);var M=b(1011),R=b(1035),W=b(181);class Y{constructor(Q,sa,bb,Cb,dc){this.tMb=0;this.F4=null;this.HSd=this.Jch=0;this.mah=!1;this.Mfc=0;this.APc=!1;this.xca=null;this.JLd=0;this.z_e=new m.a;this.OUd=[];this.Fx=Q;this.wYe=sa;this.$Pe=bb;this.V2g=Cb;G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.ewb();this.smj=dc;this.aQe=new P(100);this.Ttj=M.a.bC(1,5,new R.a)}SXd(Q){this.z_e.addHandler("OnCpuMeterFrameAvailable",
Q)}Wmg(Q){this.z_e.removeHandler("OnCpuMeterFrameAvailable",Q)}HYa(Q,sa,bb,Cb=null){bb=Cb?Cb.priority:7;const dc=this.Fx();this.start(sa,bb);try{Q()}finally{this.stop(sa,Cb),Q=this.Fx()-dc,this.V2g.track(Q,sa)}}Jd(Q,sa){const bb=this.Fx();try{Q()}finally{Q=this.Fx()-bb,this.$Pe.nqa(Q,sa),0<this.tMb&&this.aQe.nqa(Q,sa),this.V2g.track(Q,sa)}}Hbg(Q){const sa=new O;sa.TN=Q.g4f;sa.TP=Q.priority;this.yDi(1,sa)}Jwc(Q){this.JLd|=Q}start(Q,sa){if(!this.tMb){this.aQe.reset();const bb=this.ggi(Q);bb&&this.pje(1);
this.F4=new O;this.F4.TN=Q;this.F4.TP=sa;this.F4.ST=(new Date).toISOString();this.F4.STS=F.a.YQ(this.Fx(),2);bb?this.F4.UI=1:this.yol(Q)?this.F4.UI=2:this.F4.UI=0}this.tMb++}pje(Q){this.Mfc|=Q}A0d(Q=!0,sa=0){this.Mfc=Q?0:this.Mfc&~sa}stop(Q,sa=null){let bb;this.tMb--;0>=this.tMb&&this.F4&&(bb=this.Fx()-this.F4.STS,this.HSd+=bb,this.wYe.nqa(bb,Q),this.ggi(Q)&&this.A0d(!1,1),this.F4.TRT=F.a.YQ(bb,2),sa&&(this.F4.TQT=F.a.YQ(sa.b5l,2),this.F4.TDT=F.a.YQ(sa.fhi,2)),this.smj&&(this.yDi(0,this.F4),this.zgm()),
this.tMb=0);0<=Q.indexOf(K.a.fOm)&&this.Jwc(2);0<=Q.indexOf(K.a.GIi)&&this.Jwc(4);1===(this.Mfc&1)&&this.Jwc(1);2===(this.Mfc&2)&&this.Jwc(8)}zgm(){var Q=this.F4.TRT;if(750<Q){let bb=this.aQe.getData();if(bb){const Cb={};for(let dc in bb){var sa=bb[dc];const Oc=dc;Oc.startsWith("SiOp_")||(Cb[Oc]=F.a.YQ(100*sa.T/Q,2))}bb=Cb}Q=Object.assign(new I,{T:Q,S:bb});this.Ttj.track(Q,this.F4.TN)}}hDm(){var Q=this.Fx()-this.Jch,sa=F.a.YQ(this.HSd/Q*100,2);Q=new S;Q.CP=sa;Q.II=this.JLd;sa=this.wYe.getData();E.a.count(sa)&&
(Q.LRT=sa);sa=this.$Pe.getData();E.a.count(sa)&&(Q.FP=sa);this.z_e.raiseEvent("OnCpuMeterFrameAvailable",new L(Q));this.yXi()}yXi(){this.wYe.reset();this.$Pe.reset();this.HSd=this.tMb=0;this.Jch=this.Fx();this.JLd=0;this.F4=null}run(){this.mah?this.hDm():(this.yXi(),this.mah=!0);this.xca?this.xca(Object(n.a)(this,this.run,"run"),1E3):window.setTimeout(Object(n.a)(this,this.run,"run"),1E3)}iXd(Q,sa,bb){const Cb=Array(2);Cb[0]=sa;Cb[1]=bb;this.OUd[Q]||(this.OUd[Q]=[]);this.OUd[Q].push(Cb)}yDi(Q,sa){Q=
this.OUd[Q];if(!W.a.Ud(Q))for(let Cb=0;Cb<Q.length;Cb++){var bb=Q[Cb];const dc=bb[0];bb=bb[1];dc&&!dc(sa)||bb(sa)}}ewb(){if(!this.APc){const Q=window.setTimeout;this.xca=(sa,bb)=>Q(sa,bb);this.APc=!0}}ggi(Q){return Q.startsWith("key")||Q.startsWith("input")}yol(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}Object(c.a)(Y,"CpuMeter",null,[121]);class N{constructor(Q){this.mKc=null;this.iq=new t.a;this.Fx=Q}initialize(Q,sa,bb,Cb=!1){this.mKc||(this.mKc=new Y(this.Fx,
Q,sa,bb,Cb),this.iq.We(this.mKc));return this.mKc}}Object(c.a)(N,"CpuMeterProvider",null,[1827]);var aa=b(144),ia=b(135);class ea{constructor(Q=1){this.oE=[];this.sId=[];this.Eh=Q}hzk(){let Q=0;for(let sa=0;sa<this.oE.length;sa++)this.oE[sa]<this.oE[Q]&&(Q=sa);return Q}nqa(Q,sa){Q=F.a.YQ(Q,2);if(this.oE.length<this.Eh)Array.add(this.oE,Q),Array.add(this.sId,sa);else{var bb=this.hzk();Q>this.oE[bb]&&(this.oE[bb]=Q,this.sId[bb]=sa)}}getData(){return this.oE.length?{["Vals"]:this.oE,["Desc"]:this.sId}:
null}reset(){this.oE=[];this.sId=[]}}Object(c.a)(ea,"MaxDataAggregator",null,[1214]);var la=b(32),xa=b(21);class Ha{get name(){return"Common.App.CpuMeter"}Nb(Q){Q.register(N,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").fa().zd(()=>new N(la.a.af));Q.register(v,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").fa().zd(()=>new v)}init(){const Q=G.AFrameworkApplication.K;if(Q.$("CpuMeterIsEnabled")){const sa=xa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
ia.a.instance.GYd.continueWith(()=>{Ha.Sdl(Q,sa)})}}dispose(){}static Sdl(Q,sa){const bb=M.a.bC(10,5,new P(Q.zb("TaskManagerLoggingThreshold",0),Q.zb("CpuMeterMaximumEntriesToLog",0)));sa=sa.initialize(new ea(5),new P,bb,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));sa.run();Q.$("CpuMeterMonitorIsEnabled")&&xa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(sa,Q.MH("CpuMeterAverageCpuPercentThreshold",80),Q.zb("CpuMeterRollingAverageFramesCount",15));y.b(16827671,306,50,"Initializing CpuMeter")}static main(){aa.a.instance.jc(new Ha)}}
Object(c.a)(Ha,"CpuMeterPackage",null,[2,3]);var ua=b(11),Ra=b(78),ab=b(1277),Ba=b(1012),Ga=b(18),ja=b(977);class X{constructor(){this.oxa=this.pxa=this.NHc=null;this.BNb=!0;this.RPc=!1}Nb(Q){G.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&Q.register(1782,"Common.IEventTimingMeter").fa().zd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=new Ba.a(G.AFrameworkApplication.K.zb("EventTimingMeterEventSamplingPercent",0)/100);Q=new ab.a(Object(n.a)(Q,
Q.XBa,"shouldBeInSample"));const sa=M.a.bC(16,1,Q);this.pxa=new ja.a("TypingDuration-SlowPercentileAtValue","Percentile",G.AFrameworkApplication.K.MH("AshaVetoForTypingThresholdInMS",150),G.AFrameworkApplication.K.MH("AshaVetoForTypingThresholdPercentile",95),this.BNb);this.oxa=new ja.a("TypingDuration-BrokenSlowPercentileAtValue","Percentile",G.AFrameworkApplication.K.MH("AshaVetoForTypingBrokenThresholdInMS",200),G.AFrameworkApplication.K.MH("AshaVetoForTypingThresholdPercentile",95),this.BNb);
(this.RPc=!Ga.a.TLa)&&G.AFrameworkApplication.qO(()=>{this.hmf()});this.NHc=bb=>{bb=bb.rawEvent.detail;for(const Cb of bb)sa.track(Cb,"EventTimingData"),"false"===Cb.metadata.altPressed.toString()&&"false"===Cb.metadata.ctrlPressed.toString()&&"false"===Cb.metadata.repeat.toString()&&this.RPc&&(this.pxa.vma(Cb.timeToRequestAnimationFrameMs),this.oxa.vma(Cb.timeToRequestAnimationFrameMs))};U.a.addHandler(window.self,D.a.Hlh,this.NHc)}dispose(){this.NHc&&(U.a.removeHandler(window.self,D.a.Hlh,this.NHc),
this.NHc=null)}hmf(){this.pxa.yBa();this.pxa.doe&&(ua.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),Ra.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null));this.oxa.yBa();this.oxa.doe&&(ua.ULS.sendTraceTag(588649308,209,15,"Report SlowTypingSession Veto with BrokenSlowTypingSession error"),Ra.Health.instance.recordQosError("BrokenSlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){aa.a.instance.jc(new X)}}
Object(c.a)(X,"EventTimingMeterPackage",null,[2,3]);var fa=b(74),pa=b(55),Ia=b(31);class ta{constructor(Q,sa,bb,Cb=null,dc=null){this.$O=Q;this.EWg=sa;this.qWg=bb;this.z8g=Cb;this.x8g=dc}Pvk(Q){const sa=new Sys.StringBuilder(this.$O.aLi);sa.append("RoamingServiceHandler.ashx?action=");sa.append("getFirstRunExperienceSettings");sa.append("&");sa.append(this.iYk(Q));sa.append("&");sa.append(G.AFrameworkApplication.yk);G.AFrameworkApplication.he.Hi(sa.toString(),1,null,null,!0,2,Object(n.a)(this,this.ALf,
"getRequestSuccessCallback"),Object(n.a)(this,this.uae,"getRequestFailureCallback"),null)}Svk(Q){var sa=new Sys.StringBuilder(this.$O.aLi);sa.append("RoamingServiceHandler.ashx?action=");sa.append("saveFirstRunExperienceSettings");sa.append("&");sa.append(G.AFrameworkApplication.yk);sa=sa.toString();Q=Ia.c(Q);G.AFrameworkApplication.he.Hi(sa,2,Q,null,!0,4,Object(n.a)(this,this.t_l,"postRequestSuccessCallback"),Object(n.a)(this,this.rfg,"postRequestFailureCallback"),null)}ALf(Q){let sa=!1,bb=null;
try{if(0<Q.data.od.length){const Cb=Object(pa.a)(Object,Ia.a(Q.data.od)),dc=Cb?Cb[this.$O.qff]:null;dc&&(bb=Object(pa.a)(Object,Ia.a(dc.toString())))}sa=!0}catch(Cb){this.uae(null)}sa&&this.EWg&&this.EWg(Q.data,bb)}uae(Q){this.qWg&&this.qWg(Q?Q.data:null)}t_l(Q){this.z8g&&this.z8g(Q?Q.data:null)}rfg(Q){this.x8g&&this.x8g(Q?Q.data:null)}iYk(Q){const sa=new Sys.StringBuilder("requestedsettings=");for(let bb=0;bb<Q.count;bb++)sa.append(Q.J(bb)),bb<Q.count-1&&sa.append(";");return sa.toString()}}Object(c.a)(ta,
"FirstRunExperienceRequestHandler",null,[]);class oa{constructor(){this.RMc=this.rPe=this.$O=null}zAm(Q){Q?(this.$O=Q,this.uol()&&(ua.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Q=new fa.a,Q.add(this.$O.qff),this.rPe=new ta(this.$O,Object(n.a)(this,this.ALf,"getRequestSuccessCallback"),Object(n.a)(this,this.uae,"getRequestFailureCallback"),null,Object(n.a)(this,this.rfg,"postRequestFailureCallback")),this.rPe.Pvk(Q)),this.$O.Pfi&&
this.hyg()):ua.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}uol(){try{if(this.$O.Pfi)return!0;if(!G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||G.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.$O.Ikl||this.$O.Mvc||G.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const Q=G.AFrameworkApplication.K.Oa("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){ua.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}WLi(Q){const sa={},bb={};bb.FREDisplayedDate=(new Date).toUTCString();bb.VersionDisplayed=Q;bb.RemindMeLater=!1;sa[this.$O.qff]=Ia.c(bb);ua.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.rPe.Svk(sa)}ALf(Q,sa){Q=Q?+Q.uS-+Q.lG:-1;Q>this.$O.bLi?ua.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
Q,this.$O.bLi):sa?this.Dzm(sa)?(ua.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.$O.Ooi),this.hyg()):ua.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(ua.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.hyg())}uae(Q){ua.ULS.sendTraceTag(51675541,
306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Q?Q.ff:-1)}rfg(Q){ua.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Q?Q.ff:-1)}hyg(){this.AAm()}AAm(){const Q=xa.a.instance.sa("Common.ISystemInitiatedFeedback");if(Q){var sa=this.$O.yBk;sa&&(G.AFrameworkApplication.Lf(sa),G.AFrameworkApplication.Vn(sa));ua.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",
sa);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.RMc=Object(n.a)(this,this.hOl,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.RMc,!0),window.addEventListener("FRELaunchedEvent",this.RMc,!0)):(ua.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.WLi(this.$O.currentVersion))}else ua.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback")}hOl(Q){if(Q){var sa=Q.detail;
Q=Q.type;var bb=this.$O&&this.$O.sth?this.$O.sth.split("-")[0]:null;if("FRELaunchedEvent"===Q||bb&&sa&&sa.id&&-1!==sa.id.indexOf(bb))sa.success&&(ua.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.WLi(this.$O.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.RMc,!0),window.removeEventListener("FRELaunchedEvent",this.RMc,!0))}}Dzm(Q){return"RemindMeLater"in Q&&"FREDisplayedDate"in Q&&"true"===Q.RemindMeLater.toString()&&
(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.$O.Ooi?!0:!1}}Object(c.a)(oa,"FirstRunExperienceLauncher",null,[1771]);class va{constructor(){this.Z=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Nb(Q){this.Z=Q;this.Z.register(1771,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").fa().zd(()=>new oa)}init(){}dispose(){}static main(){aa.a.instance.jc(new va)}}Object(c.a)(va,"FirstRunExperienceLauncherPackage",null,[2,3]);class Fa{constructor(){this.y=
this.x=0}}Object(c.a)(Fa,"HammerPoint",null,[]);var cb=b(14);class Za{constructor(Q,sa,bb,Cb,dc){this.H1g=this.b3a=this.xLd=1;this.SVd=this.fZc=this.s6a=0;this.KZe=this.o1a=null;this.LDb=this.aPe=this.hRd=!1;this.gf=Q;this.LSa=sa;this.MLb=bb;this.ea=Cb;dc&&(this.hRd=dc.$("PromoteLayerPinchToZoomIsEnabled"),this.aPe=dc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.LDb=dc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get oI(){return this.LSa}Dml(){return!!this.gf.instance}BOl(Q){this.ea&&this.ea.processAction(cb.a.GXi,
2);const sa=this.gf.instance;this.hRd&&sa.kDi();this.b3a=sa.Kh;this.xLd=Q.X$c.scale;this.H1g=1;this.KZe=this.Ysh();this.o1a=this.LSa.getBounds();if(!this.o1a)return ua.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.WYh(Q);this.LDb?this.JQi(this.LSa.scrollWidth,this.o1a.width,Q,this.b3a,sa):this.s6a=this.LSa.scrollWidth>this.o1a.width?this.N1c(this.MLb.scrollLeft,Q.x,this.b3a):null;this.SVd=this.LSa.scrollHeight>this.o1a.height?this.N1c(this.MLb.scrollTop,Q.y,this.b3a):null;return!0}Uog(){this.s6a=
null;this.fZc=0}JQi(Q,sa,bb,Cb,dc){Q>sa?this.s6a?(Q=dc.Y1f,Q!==this.fZc&&(this.s6a-=this.fZc-Q,this.fZc=Q)):(this.s6a=this.N1c(this.MLb.scrollLeft,bb.x,Cb),this.fZc=dc.Y1f):this.Uog()}AOl(Q){const sa=this.WYh(Q);if(!sa)return ua.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;Q=this.Eqm(Q.X$c.scale/this.xLd)*this.b3a;this.MTm(sa,Q);this.NTm(sa,Q);return!0}MTm(Q,sa){const bb=this.LSa.scrollWidth,Cb=this.o1a.width;this.LDb?this.JQi(bb,Cb,Q,sa,this.gf.instance):!this.s6a&&bb>Cb&&
(this.s6a=this.N1c(this.MLb.scrollLeft,Q.x,sa));if(Q=this.eth(Q.x,this.s6a,bb,Cb,sa))this.MLb.scrollLeft=Q}NTm(Q,sa){const bb=this.LSa.scrollHeight,Cb=this.o1a.height;!this.SVd&&bb>Cb&&(this.SVd=this.N1c(this.MLb.scrollTop,Q.y,sa));if(Q=this.eth(Q.y,this.SVd,bb,Cb,sa))this.MLb.scrollTop=Q}eth(Q,sa,bb,Cb,dc){return bb<=Cb||!sa||!Cb?null:Math.max(0,Math.min(sa*dc-Q,bb-Cb))}N1c(Q,sa,bb){return(Q+sa)/bb}zOl(Q){Q=Q.X$c.scale;this.aPe&&(Q/=this.xLd);this.FMh(Q);this.hRd&&this.gf.instance.Rig();this.ea&&
this.ea.processAction(cb.a.Pyf,2);this.LDb&&this.Uog()}yOl(Q){Q=Q.X$c.scale;this.aPe&&(Q/=this.xLd);this.FMh(Q,!0);this.hRd&&this.gf.instance.Rig();this.ea&&this.ea.processAction(cb.a.Pyf,2);this.LDb&&this.Uog()}Eqm(Q){const sa=this.gf.instance,bb=new Date>=this.KZe;bb&&(this.KZe=this.Ysh());Math.abs(Q-this.H1g)>=.01*Q&&sa.yvm(Q*this.b3a,bb);return sa.Kh/this.b3a}FMh(Q,sa=!1){Q*=this.b3a;this.gf.instance.Rve(Q,!1);const bb={};bb.initialScale=this.b3a;bb.finalScale=Q;bb.cancelled=sa;ua.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",bb)}WYh(Q){return(Q=Q.X$c.center)?Object.assign(new Fa,{x:Q.x-this.o1a.x,y:Q.y-this.o1a.y}):null}Ysh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(c.a)(Za,"PinchZoomAdapter",null,[1849]);class gb{constructor(Q){this._element=Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(c.a)(gb,"ScrollContainerElement",null,[1846]);class Ya{constructor(Q,
sa,bb,Cb,dc,Oc){this.O7e=this.slb=null;this.Z=Q;this.Gc=sa;this.IMd=bb;this.S_g=Cb;this.Prj=dc;this.ngc=Oc;this.nHd=new fa.a}register(Q,sa){this.IMd&&this.Z.Fa("Common.IGestureInputManager").execute(bb=>{this.lFm();this.slb=bb;this.nHd.add(Q);if(this.S_g){if(this.Prj&&bb.VOk()){this.ZXi();return}var Cb=this.Z.Fa("Common.IZoomManager");this.Z.resolve("Common.IAppSettingsManager");const dc=new gb(Q);Cb=new Za(Cb,dc,sa,G.AFrameworkApplication.qa,G.AFrameworkApplication.K);bb.Y$l(Q,Cb)}this.ZXi()})}unregister(){if(this.slb&&
this.nHd){if(this.S_g){for(let Q of this.nHd)this.slb.nPm(Q);this.nHd.clear()}this.slb=null}}lFm(){this.ngc&&(this.Gc?this.O7e=this.Gc.le("Task","Register"):ua.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}ZXi(){this.ngc&&(this.O7e?this.O7e.stop():ua.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(c.a)(Ya,"GestureInputRegistrar",null,[1781]);class fb{constructor(){this.Z=null;this.Ce=!1}get name(){return"Common.App.GestureInput"}init(){this.Ce||(this.Z.resolve("Common.IGestureInputRegistrar"),
this.Ce=!0)}dispose(){}Nb(Q){this.Z=Q;Q.register(1781,"Common.IGestureInputRegistrar").fa().zd(()=>new Ya(Q,G.AFrameworkApplication.pa.so,G.AFrameworkApplication.mjd(),G.AFrameworkApplication.bei(),!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){aa.a.instance.jc(new fb)}}Object(c.a)(fb,"GestureInputPackage",null,[2,3]);var ib=b(286),hb=b(57);
class db{constructor(){this.Hzb=this.bQh=null}}Object(c.a)(db,"GestureAdapterInfo",null,[]);var da=b(316),Wa=b(196);class mb{constructor(){this.NFb=null}A2f(){if(!this.NFb){var Q=G.AFrameworkApplication.Oo(String.format("{0}",mb.j6k),5);Q=Wa.a.create(Q,null,null);da.a.GE(Q);this.NFb=Q.DXa}return this.NFb}static get instance(){mb.ta||(mb.ta=new mb);return mb.ta}}mb.j6k="hammer.min.js";mb.ta=null;Object(c.a)(mb,"HammerJsDependencyLoader",null,[1848]);const Tb=(Q,sa,bb=null)=>{if(void 0===sa||null===
sa)throw ua.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Cb=null;switch(Q){case D.a.pinch:Cb=new Hammer.Pinch(bb);break;case D.a.pan:Cb=new Hammer.Pan(bb)}Cb&&(Cb.manager=sa);return Cb};var Da;(function(Q){Q[Q.none=-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(Da||(Da={}));Object(c.b)("GestureEvent",Da);var La=b(46);class Ta extends La.a{constructor(Q,sa,bb,Cb,dc,Oc,yd,md){super(Q,bb,Cb,Oc);this.vJc=sa;this.G5a=
yd;this.nwa=md;this.Onj=dc}get shiftKey(){return this.G5a}get ctrlKey(){return this.nwa}get clientPoint(){return this.vJc}get X$c(){return this.Onj}static create(Q,sa,bb,Cb,dc,Oc){if(bb.rawEvent)if(Oc){var yd=bb.rawEvent;yd=new Sys.UI.Point(yd.clientX,yd.clientY)}else yd=La.a.N8d(bb);else yd=new Sys.UI.Point(bb.clientX,bb.clientY);return new Ta(Q,yd,sa,bb,Cb,dc,bb.shiftKey,bb.ctrlKey,Oc)}}Object(c.a)(Ta,"GestureEventArgs",La.a,[]);class Sa{constructor(){this.srcEvent=this.pointerType=this.changedPointers=
this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(c.a)(Sa,"GestureManagerData",null,[]);class Hb{}Hb.jdj=2;Hb.kdj=4;Hb.ldj=8;Hb.mdj=8;Object(c.a)(Hb,"HammerConstants",null,[]);var Oa=b(63),za=b(100),$a=b(16),Xb=b(76);
class Eb extends U.a{constructor(Q,sa){super();this.ERa=ib.a.lFk;this.$1e=!!window.PointerEvent;this.Geh=window.hasOwnProperty("ontouchstart");this.TGb=this.lTc=null;this.rRa=!1;this.rpa=new hb.a;this.FUc=new hb.a;this.lWg=new fa.a;this.vkb=null;this.dec=this.ngc=this.vPg=this.wJe=this.eYe=this.l$g=this.IPg=this.tZc=!1;this.QRc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.P7e=null;this.Af=Oa.EventHandlerManager.instance;this.$1e?(ua.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),
this.lTc=Object(n.a)(this,this.Tme,"onPointerEvent"),this.TGb=D.a.nFk):this.Geh?(ua.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.lTc=Object(n.a)(this,this.Fyb,"onTouchEvent"),this.TGb=D.a.touchEvents):(ua.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.lTc=Object(n.a)(this,this.Lme,"onMouseEvent"),this.TGb=D.a.mFk);this.Gc=sa;this.Dz=Q;G.AFrameworkApplication.K&&(this.tZc=G.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.IPg=G.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),
this.l$g=G.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.eYe=G.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),this.wJe=G.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.vPg=G.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.ngc=G.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.dec=this.tZc&&G.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&G.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}VOk(){return this.$1e?
0:this.Geh?1:2}Iu(Q){super.Iu(Q);this.Af.VKa(this.TGb,Q,0,this.lTc)}zu(Q){super.zu(Q);this.Af.v9a(Q,this.TGb)}Y$l(Q,sa){G.AFrameworkApplication.mjd()?mb.instance.A2f().continueWith(bb=>{this.kFm();if(bb.Sh||bb.Tn)ua.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",bb.status);else{ua.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",bb.status);if(this.vPg){bb=window.Hammer;if("undefined"===typeof bb){ua.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");
this.Uxe();return}if("undefined"===typeof bb.inputHandler){ua.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.Uxe();return}}if(!Q)throw this.Uxe(),Error.argumentNull("source element can not be null");bb=za.a.Va(Q,this.ERa);if(void 0===bb||null===bb)bb=new hb.a,za.a.xj(Q,this.ERa,bb),this.Z$l(Q);if(!bb.Pa(Da[0])){var Cb=Object.assign(new db,{Hzb:Tb(Da[0],this,null),bQh:sa});bb.add(Da[0],Cb)}}this.Uxe()}):ua.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}kFm(){this.ngc&&
(this.Gc?this.P7e=this.Gc.le("Task","RegisterGestureAdapterAfterLoad"):ua.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}Uxe(){this.ngc&&(this.P7e?this.P7e.stop():ua.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}nPm(Q){ua.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const sa=za.a.Va(Q,this.ERa);void 0!==sa&&null!==sa&&(sa.remove(Da[0]),sa.count||(za.a.mI(Q,this.ERa),this.curRecognizer=null,this.oPm(Q)))}Z$l(Q){this.lWg.add(Q);
this.Af.VKa(this.TGb,Q,0,this.lTc)}oPm(Q){this.lWg.remove(Q);this.Af.v9a(Q,this.TGb)}recognize(Q){var sa=Array(Q.pointers.length);for(var bb=0;bb<Q.pointers.length;bb++)sa[bb]=Q.pointers[bb].target;bb=null;for(this.vkb=this.ESk(sa);void 0!==this.vkb&&null!==this.vkb&&(bb=za.a.Va(this.vkb,this.ERa),void 0===bb||null===bb);this.vkb=this.vkb.parentNode);if(void 0!==bb&&null!==bb){this.curRecognizer&&this.curRecognizer.state===Hb.mdj&&(this.curRecognizer=null);sa=bb.keys;for(let Cb of sa){sa=bb.J(Cb);
void 0!==sa&&null!==sa&&void 0!==sa.Hzb&&null!==sa.Hzb&&(void 0===this.curRecognizer||null===this.curRecognizer||sa.Hzb===this.curRecognizer||sa.Hzb.canRecognizeWith(this.curRecognizer))&&sa.Hzb.recognize(Q);const dc=sa.Hzb.state;this.curRecognizer||Hb.jdj!==dc&&Hb.kdj!==dc&&Hb.ldj!==dc||(this.curRecognizer=sa.Hzb)}}}emit(Q,sa){if("hammer.input"!==Q){this.rRa=!1;sa=Ta.create(Q,this.vkb,sa.srcEvent,sa,3,this.$1e);var bb=za.a.Va(this.vkb,this.ERa);if(this.Xpl(Q))var Cb=0;else if(this.zpl(Q))Cb=1;else if(this.rsl(Q))Cb=
2;else{ua.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:bb}=bb.xb(Da[Cb]));void 0!==bb&&null!==bb&&((bb=bb.bQh,bb.Dml())?Q.endsWith("start")?this.rRa=bb.BOl(sa):Q.endsWith("end")?(bb.zOl(sa),this.rRa=!0):Q.endsWith("cancel")?(bb.yOl(sa),this.rRa=!0):Q.endsWith("move")&&(this.rRa=bb.AOl(sa)):ua.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(pa.a)(Hammer.Recognizer,Q)}ESk(Q){if(1>Q.length)return null;
if(1===Q.length)return Q[0];var sa=Q[0],bb=!0;for(let Cb=1;Cb<Q.length;Cb++){if(!Q[Cb])return null;if(sa!==Q[Cb]){bb=!1;break}}if(bb)return sa;sa=this.EQh(Q[0]);bb=0;for(const Cb of Q){Q=this.EQh(Cb);if(sa.J(sa.count-1)!==Q.J(Q.count-1))return null;for(let dc=sa.count-2,Oc=Q.count-2;dc>=bb&&0<=Oc;dc--,Oc--)if(sa.J(dc)!==Q.J(Oc)){bb=dc+1;break}}return sa.J(bb)}EQh(Q){const sa=new fa.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)sa.add(Q);return sa}YVh(Q){switch(Q){case D.a.hR:case D.a.MPb:return 1;case D.a.gR:case D.a.Vif:return 2;
case D.a.xK:case D.a.c_d:return 4;case D.a.wze:case D.a.Uif:return 8}return 0}Fyb(Q,sa,bb){Q=this.YVh(Q);sa=this.OQk(bb);Hammer.inputHandler(this,Q,sa);this.rRa&&bb.preventDefault();return this.rRa}o4h(){return 1<this.rpa.count}K_d(){ua.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.tZc)for(let Q of this.rpa)this.aHi(Q.key);else this.rpa=new hb.a;this.session=null}qKj(Q,sa,bb){ua.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.FUc.Pa(Q)){try{sa.setPointerCapture(Q)}catch(Cb){ua.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Cb)}this.FUc.add(Q,sa)}this.rpa.W(Q,bb);this.dec&&1<this.rpa.count&&this.Dz&&!this.Dz.e2c&&(this.Dz.e2c=!0)}aHi(Q){ua.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.FUc.Pa(Q)){try{this.FUc.J(Q).releasePointerCapture(Q)}catch(sa){ua.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",sa)}this.FUc.remove(Q)}else ua.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.rpa.remove(Q);this.dec&&
1>=this.rpa.count&&this.Dz&&this.Dz.e2c&&(this.Dz.e2c=!1)}Tme(Q,sa,bb){var Cb=bb.rawEvent.pointerType.toString();const dc=bb.rawEvent.pointerId.toString();if("touch"!==Cb)return!1;Q=this.YVh(Q);if(1!==Q&&!this.rpa.Pa(dc))return!1;this.IPg&&1===Q&&bb.rawEvent.isPrimary&&this.rpa.count&&(ua.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.K_d());this.tZc?this.qKj(dc,sa,bb):this.rpa.W(dc,bb);this.eYe&&2===Q&&(!this.wJe||this.wJe&&"function"===typeof bb.rawEvent.getCoalescedEvents)&&
(sa=bb.rawEvent.getCoalescedEvents())&&this.o4h()&&(this.QRc=Math.max(this.QRc,sa.length));this.l$g&&(this.rRa=!1);Cb=this.NQk(this.rpa,bb,Cb);Hammer.inputHandler(this,Q,Cb);if(4===Q||8===Q)this.tZc?this.aHi(dc):this.rpa.remove(dc),this.rpa.count||(this.session=null,this.eYe&&-1!==this.QRc&&(ua.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.QRc),this.QRc=-1));this.rRa&&bb.preventDefault();return this.rRa}Lme(){return!1}OQk(Q){const sa=new Sa;var bb=Q.rawEvent;const Cb=
bb.touches;bb=bb.changedTouches;sa.pointers=Array.clone(Cb);sa.pointers=Array.clone(0<Cb.length?Cb:bb);sa.changedPointers=Array.clone(bb);sa.srcEvent=Q;sa.pointerType="touch";return sa}NQk(Q,sa,bb){const Cb=new Sa;Cb.pointers=Xb.toArray(Q.values);Cb.changedPointers=[sa];Cb.pointerType=bb;Cb.srcEvent=sa;return Cb}Xpl(Q){return $a.a.startsWith(Q,D.a.pinch)}zpl(Q){return $a.a.startsWith(Q,D.a.pan)}rsl(Q){return $a.a.startsWith(Q,D.a.swipe)}}Object(c.a)(Eb,"GestureInputManager",U.a,[1829,1830]);var ob=
b(210);class tb{constructor(){this.Z=null;this.Ce=!1}get name(){return"Common.App.GestureInputManager"}Nb(Q){Q.register(Eb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").fa().zd(()=>new Eb(ob.a.instance,G.AFrameworkApplication.pa.so));this.Z=Q}init(){this.Ce||(this.Z.resolve("Common.App.GestureManager.GestureInputManager"),this.Ce=!0)}dispose(){}static main(){aa.a.instance.jc(new tb)}}Object(c.a)(tb,"GestureInputManagerPackage",null,[2,3]);var yb=b(195);class lb{}
Object(c.a)(lb,"ShellRenderData",null,[]);var Cc=b(1398),Hc=b(44),Jc=b(1183);class Ib{constructor(Q,sa,bb){this.n5g=this.o5g=!1;this.Kxa=this.XWc=this.WWc=null;this.Rjc=new t.a;this.Be=Q;this.VSc=bb;this.w9=sa.appSettings[Ib.DXm]||""}get Fwm(){return this.Rjc.task}get hUa(){return this.Be.value}Wgm(){this.Kxa=document.getElementById(Ib.bZi);const Q={};Q[Ib.V8k]=G.AFrameworkApplication.yk;Q["Content-Type"]="application/json; charset=utf-8";ua.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");
const sa=Hc.a.lp(this.w9+Ib.Gwm,Ib.JKl,G.AFrameworkApplication.pa.mb.mo.toString());this.hUa.Hi(sa,1,"",Q,!0,2,Object(n.a)(this,this.Qeb,"onSuccessCallback"),Object(n.a)(this,this.xeb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}rAl(Q){try{const sa={};sa.FlightName=Q.FlightName;sa.SessionID=Q.SessionID;ua.ULS.sendTraceTag(594883776,215,50,Ia.c(sa))}catch(sa){ua.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}Qeb(Q){if((Q=Q.data.od)&&Q.length)try{const sa=Ia.a(Q);G.AFrameworkApplication.pa.mb.bA?
(this.WWc=sa.NavBarDataJson,ua.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.")):this.qNm(sa)&&(this.WWc=sa.NavBarDataJson);this.WWc?({dz:this.XWc}=Ia.d(sa.NavBarDataJson)).returnValue?(this.rAl(this.XWc),this.Rjc.We(this.XWc)):(ua.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Jc.a.OBd(this.WWc)}),this.Rjc.Zga()):(ua.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Rjc.Zga())}catch(sa){this.$Ba(),ua.ULS.sendTraceTag(6362370,
215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Rjc.Zga()}else this.$Ba(),ua.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}xeb(){this.Kxa&&this.$Ba();this.Rjc.Zga();ua.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}qNm(Q){if(!Q.JsUrl||!Q.JsUrl.length)return this.$Ba(),ua.ULS.sendTraceTag(6387854,215,10,"Empty or null JS URL."),!1;const sa=Wa.a.create(Q.JsUrl);sa.fJ(Object(n.a)(this,this.uKl,"o365ShellJs_LoadFinished"));
da.a.GE(sa);if(!Q.CssUrl||!Q.CssUrl.length)return this.$Ba(),ua.ULS.sendTraceTag(6387855,215,10,"Empty or null CSS URL."),!1;Q=new Cc.a(Q.CssUrl);Q.fJ(Object(n.a)(this,this.tKl,"o365ShellCss_LoadFinished"));da.a.GE(Q);return!0}tKl(Q,sa){sa.succeeded?(this.n5g=!0,this.hIi()):(ua.ULS.sendTraceTag(7608092,215,10,"CSS failed to load"),this.$Ba())}uKl(Q,sa){sa.succeeded?(this.o5g=!0,this.hIi()):(ua.ULS.sendTraceTag(7608093,215,10,"JS failed to load"),this.$Ba())}hIi(){if(this.n5g&&this.o5g)if(this.Kxa){Sys.UI.DomElement.removeCssClass(this.Kxa,
Ib.qxb);var Q=document.createElement("div");Q.id=Ib.kTi;this.Kxa.appendChild(Q);this.dfm()}else ua.ULS.shipAssertTag(7608280,215,!1)}dfm(){const Q=window.self.O365Shell;if(Q)if(Q.SetData)if(this.WWc)if(this.XWc){Q.SetData(this.XWc);var sa=Object.assign(new lb,{launcher:Ib.kTi,switcher:Ib.bZi});Q.RenderAsync?Q.RenderAsync(sa,Object(n.a)(this,this.YSl,"onSwitcherRendered")):(this.$Ba(),ua.ULS.shipAssertTag(6613131,215,!1))}else this.$Ba();else this.$Ba(),ua.ULS.shipAssertTag(6613130,215,!1);else this.$Ba(),
ua.ULS.shipAssertTag(6613129,215,!1);else this.$Ba(),ua.ULS.shipAssertTag(6613128,215,!1)}YSl(){if(this.Kxa){const Q=this.Kxa.getElementsByTagName("a");Q&&0<Q.length&&Q[0]&&"none"!==this.Kxa.style.display&&Q[0].focus();G.AFrameworkApplication.qa.processAction(cb.a.vKl,2);ua.ULS.sendTraceTag(6612807,215,50,"O365 switcher tiles added to the DOM.")}else ua.ULS.sendTraceTag(41551900,215,15,"Switcher DOM element is null. Cannot append shell container.")}$Ba(){this.Kxa&&!Sys.UI.DomElement.containsCssClass(this.Kxa,
Ib.DKh)&&(Sys.UI.DomElement.removeCssClass(this.Kxa,Ib.qxb),Sys.UI.DomElement.addCssClass(this.Kxa,Ib.DKh),ua.ULS.sendTraceTag(7129104,215,10,"Failed to display O365 Shell Switcher."))}static get instance(){return Ib.ta||(Ib.ta=Ib.J$a())}static J$a(){return new Ib(new yb.a(()=>G.AFrameworkApplication.he),G.AFrameworkApplication.K,G.AFrameworkApplication.pa.mb.mo)}}Ib.V8k="X-qs";Ib.JKl="at";Ib.Gwm="O365ShellServiceProxy.ashx";Ib.ta=null;Ib.bZi="sw_bar";Ib.qxb="SwitcherLoading";Ib.DKh="SwitcherError";
Ib.kTi="ShellContainer";Ib.DXm="ShellWebServiceBase";Object(c.a)(Ib,"O365ShellActor",null,[1817]);class nc{constructor(){this.Z=null}get name(){return"Common.App.O365Shell"}Nb(Q){this.Z=Q;this.Z.register(Ib,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").fa().zd(()=>new Ib(new yb.a(()=>G.AFrameworkApplication.he),G.AFrameworkApplication.K,G.AFrameworkApplication.pa.mb.mo))}init(){G.AFrameworkApplication.K.Do(Object(n.a)(this,this.ux,"onFullAppSettingsReady"))}ux(){G.AFrameworkApplication.AIg&&
(!G.AFrameworkApplication.K.$("AppSwitcherMitigationIsEnabled")||G.AFrameworkApplication.pa.mb.bA)&&this.Z.resolve("Common.App.O365Shell.O365ShellActor").Wgm()}dispose(){}static main(){aa.a.instance.jc(new nc)}}Object(c.a)(nc,"PackageManager",null,[2,3]);class Gc{rMa(){}init(){}dispose(){}}Object(c.a)(Gc,"NoOpOfflineLogger",null,[1851,13]);var tc=b(545);class fc{}fc.EYd=0;Object(c.a)(fc,"OfflineLoggerConstants",null,[]);var kc=b(77),Bb=b(166),Wb=b(323);class zb{constructor(Q,sa,bb,Cb,dc){this.q3a=
!1;this.e9=null;this.yKc=this.thc=this.vFb=0;this.ZK=this.qmb=this.lV=null;this.Fi=!1;this.CFa=bb;this.cHa=Cb;this.Zca=dc;this.Be=sa;this.Za=Q}init(){this.bwg();this.iyl();this.q3a=!1;this.Be.oOb(this);this.lV=new kc.a(3,2,2500,Object(n.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Za.Eb(this.lV)}x1c(Q){return"OfflineLog|"+Q}iyl(){const Q=this.CFa.getItem("OfflineLoggerManifest");void 0!==Q&&null!==Q&&0<Q.length&&(this.e9=zb.LFc(Q));this.e9||(this.e9={});if(void 0===this.e9.end||null===
this.e9.end)this.e9.end=0;if(void 0===this.e9.offset||null===this.e9.offset)this.e9.offset=0;this.vFb=this.e9.offset;isFinite(this.vFb)||(this.vFb=0);this.thc=this.e9.end;isFinite(this.thc)||(this.thc=0);this.yKc=this.thc}bwg(){this.qmb=new Wb.a;this.ZK=new Bb.a;this.cHa.mkh(Object(n.a)(this,this.Ubg,"onUlsReadyToBeSent"));this.cHa.Okh(Object(n.a)(this,this.Wbg,"onUlsSentSuccessfully"));this.cHa.Nkh(Object(n.a)(this,this.Vbg,"onUlsSentFailed"));this.cHa.dkh(Object(n.a)(this,this.r9f,"onAfterUlsHostDisposed"))}Ubg(Q,
sa){if(void 0!==sa&&null!==sa&&void 0!==sa.args&&null!==sa.args){Q=!1;if(!this.qmb.Pa(sa.args.tag)){if(!this.qmb.Pa(fc.EYd))return;Q=!0}this.qmb.remove(Q?fc.EYd:sa.args.tag);this.ZK.Pa(sa.AO)||this.ZK.W(sa.AO,new fa.a);this.ZK.J(sa.AO).add(sa.args)}}Wbg(Q,sa){this.ZK.remove(sa.AO)}Vbg(Q,sa){if(void 0!==sa&&null!==sa&&this.ZK.Pa(sa.AO)){Q=this.ZK.J(sa.AO);for(let bb=0,Cb=Q.count;bb<Cb;++bb)sa=zb.serialize(Q.J(bb),this.Zca),this.aCd(this.x1c(this.yKc++),sa)}}r9f(){this.dispose()}aCd(Q,sa){try{return this.CFa.setItem(Q,
sa),!0}catch(bb){return ua.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",bb.message),!1}}sendOfflineLogs(){if(!this.q3a){for(var Q=this.vFb,sa=new fa.a,bb=null;Q<this.thc&&5>=sa.count;++Q){var Cb=this.x1c(Q);const dc=this.CFa.getItem(Cb);this.CFa.removeItem(Cb);if(void 0===dc||null===dc)continue;const Oc=({sessionId:Cb}=zb.deserialize(dc)).returnValue;if(Oc){if(!bb)bb=Cb;else if(Cb!==bb)break;sa.add(Oc)}else ua.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",
dc)}0<sa.count&&this.cHa.zJi(this,Xb.toArray(sa),bb);this.vFb=Q;Q>=this.thc&&(this.Za.xe(this.lV),this.lV=null)}}rMa(Q,sa,bb){!this.Fi&&ua.ULS.R2(sa,bb)&&this.qmb.W(Q,!0)}dispose(){if(!this.Fi){this.lV&&this.Za.xe(this.lV);var Q=Xb.toArray(this.ZK.keys);Q.sort();for(const sa of Q){Q=this.ZK.J(sa);for(let bb=0,Cb=Q.count;bb<Cb;++bb){const dc=zb.serialize(Q.J(bb),this.Zca);this.aCd(this.x1c(this.yKc++),dc)}}this.vFb<this.yKc?(this.e9.end=this.yKc,this.e9.offset=this.vFb,this.aCd("OfflineLoggerManifest",
JSON.stringify(this.e9))):this.CFa.removeItem("OfflineLoggerManifest")}this.Fi=!0}YAa(){this.q3a=!0}WXa(){this.q3a=!1}static serialize(Q,sa){const bb={};bb.t=Q.tag;bb.c=Q.category;bb.l=Q.level;bb.m=Q.message;bb.lt=Q.logType;bb.s=sa;bb.ts=Q.timestamp;bb.o=Q.isMinified;bb.a=Q.args;return JSON.stringify(bb)}static deserialize(Q){return(Q=zb.LFc(Q))?{returnValue:new tc.a(Q.ts,Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static LFc(Q){try{return JSON.parse(Q)}catch(sa){ua.ULS.sendTraceTag(18614234,
222,10,"OfflineLogger TryParseString failed with exception: {0}",sa.message)}return null}}Object(c.a)(zb,"OfflineLoggerImpl",null,[1851,13,156]);class Gb{constructor(Q,sa,bb,Cb){this.sessionId=Q;this.version=sa;this.vZd=bb;this.Dcg=Cb;this.KQ=new fa.a}}Object(c.a)(Gb,"CachedLogUpload",null,[]);class gc{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(c.a)(gc,
"LoggingExceptionArgsLocalStorage",null,[]);class jc{constructor(Q){this.t=Q.tag;this.c=Q.category;this.l=Q.level;this.m=Q.message;this.lt=Q.logType;this.ts=Q.timestamp;this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new gc(Q.exceptionArgs))}}Object(c.a)(jc,"LoggingArgsLocalStorage",null,[]);var Rb=b(332);class rd{constructor(Q,sa,bb,Cb,dc,Oc){this.t=Q;this.m=sa;this.s=bb;this.v=Cb;this.i=dc;this.a=Oc;this.op="Log"}}Object(c.a)(rd,"LoggingKeyLocalStorage",null,[]);var sd=b(130);const Id=
(Q,sa,bb)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===Q.s||null===Q.s)&&"Log"===Q.op&&Q.t===sa&&isFinite(Q.t)&&sd.a.Fc(Q.s)&&(void 0===Q.m||null===Q.m||Q.m===bb);class me{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg,Zg){this.q3a=this.L2g=this.E2g=this.F2g=!1;this.ZK=this.qmb=this.e9=this.lV=null;this.Fi=!1;this.EIb=[];this.lhc=[];this.CFa=bb;this.cHa=Cb;this.Zca=dc;this.Be=sa;this.Za=Q;this.VSc=Oc;this.n_e=yd;this.w$g=md;this.T3a=Af;this.Ftj=wg;this.xVe=
Zg}get manifest(){return this.e9}get Qld(){return this.qmb}get EXa(){return this.ZK}init(){this.bwg();this.q3a=!1;this.Be.oOb(this);this.lV=new kc.a(3,1,2500,Object(n.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Za.Eb(this.lV)}determineLogsToSendAtBoot(){this.GFh(!0)}determineLogsToSendOnReconnect(){this.GFh(!1)}GFh(Q){this.W5d();this.EIb=[];Q&&(this.lhc=[]);for(var sa=0;sa<this.CFa.length;sa++){const bb=this.CFa.key(sa),Cb=me.LFc(bb,!1);Id(Cb,this.VSc,this.n_e)&&
(Cb.s===this.Zca?Array.add(this.EIb,bb):Q&&Array.add(this.lhc,bb))}if(this.EIb.length||Q&&this.lhc.length)if(sa=this.xVe?Object(n.a)(this,this.jDm,"sortDescendKeysToUpload"):Object(n.a)(this,this.mDm,"sortKeysToUpload"),this.EIb.sort(sa),Q&&this.lhc.sort(sa),0<this.EIb.length||0<this.lhc.length)this.lV=new kc.a(3,2,2500,Object(n.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Za.Eb(this.lV)}mDm(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}jDm(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):
Q.i-Q.i}x1c(Q,sa,bb,Cb){return JSON.stringify(new rd(this.VSc,this.n_e,sa,bb,Q,Cb))}bwg(){this.qmb=new Wb.a;this.ZK=new Bb.a;this.cHa.mkh(Object(n.a)(this,this.Ubg,"onUlsReadyToBeSent"));this.cHa.Okh(Object(n.a)(this,this.Wbg,"onUlsSentSuccessfully"));this.cHa.Nkh(Object(n.a)(this,this.Vbg,"onUlsSentFailed"));this.cHa.dkh(Object(n.a)(this,this.r9f,"onAfterUlsHostDisposed"))}Ubg(Q,sa){if(void 0!==sa&&null!==sa&&void 0!==sa.args&&null!==sa.args){if(this.Qld.Pa(sa.args.tag))this.Qld.remove(sa.args.tag);
else if(this.Qld.Pa(fc.EYd))this.Qld.remove(fc.EYd);else if(!(this.Ftj&&50>sa.args.level))return;({value:Q}=this.EXa.xb(sa.AO)).returnValue||(Q=new Gb(sa.sessionId,sa.version,sa.vZd,sa.Dcg),this.EXa.W(sa.AO,Q));this.EXa.J(sa.AO).KQ.add(sa.args)}}Wbg(Q,sa){this.EXa.remove(sa.AO)}Vbg(Q,sa){void 0!==sa&&null!==sa&&this.EXa.Pa(sa.AO)&&this.mpi(sa.AO)&&!this.L2g&&(this.L2g=!0,ua.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}mpi(Q){let sa=!1;if(({value:Cb}=this.EXa.xb(Q)).returnValue&&
Cb&&0<Cb.KQ.count){if(Cb.vZd>=this.T3a)return!1;var bb=Cb.KQ;const dc=Array(bb.count);for(let Oc=0,yd=bb.count;Oc<yd;++Oc)dc[Oc]=new jc(bb.J(Oc));bb=me.serialize(dc);var Cb=this.x1c(Cb.Dcg,Cb.sessionId,Cb.version,Cb.vZd);this.aCd(Cb,bb)&&(this.EXa.remove(Q),sa=!0)}return sa}r9f(){this.dispose()}aCd(Q,sa){try{return this.CFa.setItem(Q,sa),!0}catch(bb){return ua.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",bb.message),!1}}sendOfflineLogs(){if(!this.q3a){var Q=
0<this.EIb.length?this.EIb:this.lhc,sa=Q.length;if(sa)for(;0<sa;){G.AFrameworkApplication.Lf("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");sa--;var bb=this.xVe?Q.pop():Q[0];this.xVe||Array.removeAt(Q,0);const Oc=me.LFc(bb,!0);if(Id(Oc,this.VSc,this.n_e)){var Cb=this.CFa.getItem(bb);this.CFa.removeItem(bb);if(void 0!==Cb&&null!==Cb)if(Oc.a>this.T3a)ua.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",Oc.a,this.T3a);else if(bb=
me.LFc(Cb,!0),void 0!==bb&&null!==bb&&isFinite(bb.length))if(bb.length){Cb=bb[bb.length-1];var dc=(new Date).getTime()-Cb.ts;if(dc<-me.O_i)ua.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Cb.ts);else if(dc>this.w$g*me.O_i)ua.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.w$g,Cb.ts);else{Oc.s===this.Zca?this.F2g||(this.F2g=!0,ua.ULS.sendTraceTag(37290080,
222,50,"Attempted to re-send logs from this session.")):this.E2g||(this.E2g=!0,ua.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",Oc.s));sa=Array(bb.length);for(Cb=0;Cb<bb.length;Cb++){Q=Cb;a:{dc=bb[Cb];if(void 0===dc||null===dc){dc=null;break a}let yd=null;dc.e&&(yd=new Rb.a(null),yd.name=dc.e.n,yd.stack=dc.e.s,yd.message=dc.e.m,yd.file=dc.e.f,yd.line=dc.e.l,yd.column=dc.e.c);dc=new tc.a(dc.ts,dc.c,dc.t,dc.l,dc.m,dc.lt,dc.o,dc.a,yd)}sa[Q]=dc}this.cHa.zJi(this,
sa,Oc.s,Oc.v,Oc.a+1,Oc.i);break}}else ua.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Cb);else ua.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Cb)}}else this.W5d()}}rMa(Q,sa,bb){!this.Fi&&ua.ULS.R2(sa,bb)&&this.Qld.W(Q,!0)}dispose(){if(!this.Fi){this.lV&&this.Za.xe(this.lV);var Q=Xb.toArray(this.EXa.keys);for(const sa of Q)this.mpi(sa)}this.Fi=!0}YAa(){this.q3a=!0;this.W5d()}WXa(){this.q3a=!1;this.W5d();this.lV&&this.Za.xe(this.lV);
this.lV=new kc.a(3,1,2500,Object(n.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Za.Eb(this.lV)}W5d(){this.lV&&(this.Za.xe(this.lV),this.lV=null)}static serialize(Q){return JSON.stringify(Q)}static LFc(Q,sa){try{return JSON.parse(Q)}catch(bb){sa&&ua.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",bb.message)}return null}}me.O_i=864E5;Object(c.a)(me,"OfflineLoggerImplV2",null,[1851,13,156]);class we{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",
Q),-1}}key(Q){try{return localStorage.key(Q)}catch(sa){return this.handleError("Key",sa),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(sa){return this.handleError("GetItem",sa),null}}setItem(Q,sa){try{return localStorage.setItem(Q,sa)}catch(bb){return this.handleError("SetItem",bb),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(sa){this.handleError("RemoveItem",sa)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(Q,sa){ua.ULS.sendTraceTag(19170128,
222,10,"Invoking localStorage function[{0}] failed, message: {1}",Q,sa.message)}}Object(c.a)(we,"OfflineStorage",null,[1850]);class Me{create(Q){let sa=null;try{void 0!==localStorage&&null!==localStorage&&(sa=new we)}catch(bb){ua.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",bb.message)}Object.getType(ua.ULS.host).implementsInterface(106)&&sa||(ua.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",sa?"supported":
"not supported",Object.getType(ua.ULS.host).implementsInterface(106)?"supported":"not supported"),Q=0);Q=1===Q?new zb(G.AFrameworkApplication.Vb,G.AFrameworkApplication.he,sa,ua.ULS.host,G.AFrameworkApplication.userSessionId):2===Q?new me(G.AFrameworkApplication.Vb,G.AFrameworkApplication.he,sa,ua.ULS.host,G.AFrameworkApplication.userSessionId,G.AFrameworkApplication.pa.mb.mo,G.AFrameworkApplication.pa.mb.bBa,G.AFrameworkApplication.K.zb("OfflineLoggerRetentionInDays",30),G.AFrameworkApplication.K.zb("OfflineLoggerMaxAttempts",
5),G.AFrameworkApplication.K.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),G.AFrameworkApplication.K.$("SendOfflineLogsV2ImprovementIsEnabled")):new Gc;Q.init();return Q}}Object(c.a)(Me,"OfflineLoggerFactory",null,[]);class ld{Nb(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=G.AFrameworkApplication.K;let sa=0;Q.$("OneNoteOfflineLoggerIsEnabled")?sa=1:Q.$("OfflineLoggerV2IsEnabled")&&(sa=2);sa&&(G.AFrameworkApplication.Zye=(new Me).create(sa))}dispose(){}}Object(c.a)(ld,"OfflineLoggerPackage",
null,[2,3]);const Kg=Q=>{try{return Ia.a(Q)}catch(sa){}return null};class Vg{constructor(Q,sa,bb,Cb,dc,Oc){this.g0=!1;this.Ap=null;this.N1e=!1;this.ea=Q;this.Be=sa;this.je=bb;this.W1g=Cb;this.ra=dc;this.htj=Oc}init(Q,sa){sa&&Q.Fa("Common.Interface.IRtcBasicProvider").execute(Object(n.a)(this,this.Ehf,"awaitRtc"))}Ehf(Q){const sa=Q.bcd();sa.continueWith(()=>{this.Ap=sa.result;this.N1e&&(this.Ap.$Q(2,null,!0),this.N1e=!1);this.Ap.j5((bb,Cb)=>{2===Cb.type&&this.Bd.processAction(cb.a.fileNameUpdate,2)});
this.Ap.fya((bb,Cb)=>{2===Cb.newState&&this.Bd.processAction(cb.a.fileNameUpdate,2)});2===this.Ap.connectionState&&this.Bd.processAction(cb.a.fileNameUpdate,2)})}dVa(Q){this.tLh(Q,!0)}tLh(Q,sa){const bb=this.LZj(Q.xWi),Cb={};Cb[Vg.Lzh]=Vg.Mzh;this.pJi.Hi(bb,2,"",Cb,!1,2,Object(n.a)(this,this.$xc,"onRefreshFilenameSuccess"),sa?Object(n.a)(this,this.sRl,"onRefreshFilenameFailureRetry"):Object(n.a)(this,this.xvi,"onRefreshFilenameFailureNoRetry"),Q)}$xc(Q){this.g0=!1;const sa=Kg(Q.data.od);Q.data.state.onSuccess(sa,
this.W1g.value)}sRl(Q){5!==Q.data.status||this.g0?this.xvi(Q):(this.g0=!0,this.tLh(Q.data.state,!1))}xvi(Q){Q.data.state.onFailure(-1)}MTb(Q){this.uLh(Q,!0)}uLh(Q,sa){const bb=this.MZj(),Cb={};Cb[Vg.Lzh]=Vg.Mzh;Cb[Vg.T8k]=$a.a.nj(Q.uJi);Cb[Vg.R8k]=this.htj.value.W7j;this.pJi.Hi(bb,2,"",Cb,!1,2,Object(n.a)(this,this.Spd,"onRenameFileSuccess"),sa?Object(n.a)(this,this.wRl,"onRenameFileFailureRetry"):Object(n.a)(this,this.Avi,"onRenameFileFailureNoRetry"),Q)}MZj(){return this.Trh()}LZj(Q){let sa=this.Trh();
return sa=Hc.a.lp(sa,Vg.X8k,Q?"2":"1")}Trh(){let Q=(this.ra.value.appSettings.RenameWebServiceBase||"")+Vg.S8k;Q=Hc.a.lp(Q,Vg.U8k,$a.a.nj(G.AFrameworkApplication.yk));this.ov&&this.ov.efe&&(Q=Hc.a.lp(Q,Vg.W8k,"1"));return Q}Spd(Q){this.g0=!1;const sa=Kg(Q.data.od);Q.data.state.onSuccess(sa,this.W1g.value);this.hri()}hri(){this.Ap?this.Ap.$Q(2,null,!0):this.N1e=!0}wRl(Q){5!==Q.data.status||this.g0?this.Avi(Q):(this.g0=!0,this.uLh(Q.data.state,!1))}Avi(Q){Q.data.state.onFailure(-1)}get Bd(){return this.ea.value}get pJi(){return this.Be.value}get ov(){return this.je.value}static get instance(){return Vg.ta||
(Vg.ta=Vg.J$a())}static J$a(){return new Vg(new yb.a(()=>G.AFrameworkApplication.qa),new yb.a(()=>G.AFrameworkApplication.he),new yb.a(()=>G.AFrameworkApplication.ov),new yb.a(()=>xa.a.instance.resolve("Postmessage.IHostPostmessenger")),new yb.a(()=>G.AFrameworkApplication.K),new yb.a(()=>xa.a.instance.resolve("Common.IRenameProps")))}}Vg.Lzh="Content-Type";Vg.Mzh="application/json; charset=utf-8";Vg.S8k="renamehandler.ashx";Vg.U8k="qs";Vg.T8k="n";Vg.W8k="sl";Vg.R8k="X-CoauthLockId";Vg.X8k="u";Vg.ta=
null;Object(c.a)(Vg,"ExecuteRenameFileHandler",null,[]);class ad{constructor(){this.onFailure=this.onSuccess=null;this.xWi=!1}}Object(c.a)(ad,"ExecuteRefreshFilenameData",null,[]);class uc{constructor(){this.onFailure=this.onSuccess=this.uJi=null}}Object(c.a)(uc,"ExecuteRenameFileData",null,[]);class Yc{constructor(){this.Z=null;this.AOe=Vg.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Nb(Q){this.Z=Q}init(){G.AFrameworkApplication.K.Do(Object(n.a)(this,this.ux,"onFullAppSettingsReady"))}ux(){G.AFrameworkApplication.qvc()&&
(Vg.instance.init(this.Z,G.AFrameworkApplication.dBc),G.AFrameworkApplication.MTb=Object(n.a)(this,this.MTb,"executeRenameFile"),G.AFrameworkApplication.dVa=Object(n.a)(this,this.dVa,"executeRefreshFilename"),G.AFrameworkApplication.Cwd=Object(n.a)(this,this.Cwd,"sendFileNameAndLocationUpdateNotification"))}MTb(Q,sa,bb){const Cb=new uc;Cb.uJi=Q;Cb.onSuccess=sa;Cb.onFailure=bb;this.AOe.MTb(Cb)}dVa(Q,sa,bb){const Cb=new ad;Cb.onSuccess=Q;Cb.onFailure=sa;Cb.xWi=bb;this.AOe.dVa(Cb)}Cwd(){this.AOe.hri()}dispose(){}}
Object(c.a)(Yc,"PackageManager",null,[2,3]);var wd=b(119);class ee{constructor(Q,sa,bb){this.ryg=this.syg=this.tyg=!1;this.Gyg=!Q&&!sa;this.Hyg=!Q&&!bb;this.Gyg||this.Hyg||(this.tyg=!Q,this.syg=!sa,this.ryg=!bb)}}Object(c.a)(ee,"RenameDisabledDialogInfo",null,[]);class te extends wd.StandardDialog{constructor(Q,sa,bb,Cb,dc){super();this.LCg=[];this.sia=new ee(Q,sa,bb);this.tob=Cb;this.Vlb=dc;this.mf="RenameDisabledDialog";this.Jc=0;this.Yd(1,CommonUIStrings.l_DialogClose);this.Rum();this.kfm()}Rum(){this.sia.Gyg?
this.Yyd(this.tob?this.Vlb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.sia.Hyg?this.Yyd(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.ZJj();this.ZWd(this.LCg)}Yyd(Q){Array.add(this.LCg,Q)}ZJj(){const Q=[];this.sia.tyg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.sia.syg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);
this.sia.ryg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.LCg,Q)}}Object(c.a)(te,"ReactRenameDisabledDialogBase",wd.StandardDialog,[]);class wf extends te{constructor(Q,sa,bb,Cb,dc){super(Q,sa,bb,Cb,dc)}kfm(){this.Ixb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(c.a)(wf,"ReactRenameDisabledDialog",te,[]);var cf=b(136);class xb{static get lf(){return cf.a.Qv(xb.zk,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}xb.zk="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(c.a)(xb,"RenameDisabledDialogHtml",null,[]);class Mb extends cf.a{constructor(Q,sa,bb,Cb,dc){super();this.sia=new ee(Q,sa,bb);this.tob=Cb;this.Vlb=dc;this.mf="RenameDisabledDialog";this.Jc=0;this.Yd(1,CommonUIStrings.l_DialogClose);this.lf=xb.lf;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.I2("RenameRow")}MT(){if(this.sia.Gyg){let Q;Q=this.tob?this.Vlb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Mb.Yyd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.sia.Hyg?Mb.Yyd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.dal()}dal(){this.sia.tyg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.sia.syg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.sia.ryg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Yyd(Q,sa,bb){Q.style.display="none";sa.innerText=bb}}Object(c.a)(Mb,"RenameDisabledDialog",cf.a,[]);var Ec=b(66);class ud{constructor(Q,sa){this.yJb=0;this.ea=Q;this.LQa=sa}initialize(Q){if(!this.ea||!this.LQa)return!1;this.yJb=Q;this.pb();return!0}pb(){this.ea.na(cb.a.pof,Ec.a.frame,Object(n.a)(this,this.pof,"commitNewDocumentTitle"))}pof(Q,sa,bb,Cb,dc){if(1===bb)return this.ea.processAction(cb.a.renameFile,
1);Q=$a.a.GJ(this.LQa.Oz);dc=(0,dc.getNewDocumentTitle)();dc.length>this.yJb&&(dc=dc.substr(0,this.yJb));if(32!==this.ea.Db(cb.a.renameFile,2,dc))return this.hGc(Q),8;this.hGc(dc);return 32}hGc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Wg(){return new ud(G.AFrameworkApplication.qa,G.AFrameworkApplication.Oq)}}Object(c.a)(ud,"ReactRenameUIHandler",null,[1853]);var ge=b(1118),Le=b(1263),de=b(531),kf=b(83),mg=b(176),Fd=b(54);class xf{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,
Af,wg,Zg,Wh){this._initialized=!1;this._element=null;this.yJb=0;this.R5e=this.vSe=!1;this.ea=Q;this.Qna=sa;this.nd=bb;this.Eq=Cb;this.LQa=dc;this.qah=Oc;this.ZSd=yd;this.UJe=md;this.ylb=Af;this.J_g=wg;this.Fh=Zg;this.$Te=Wh}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,sa,bb){if(!(this.ea&&this.LQa&&this.qah&&this.ZSd&&this.UJe&&sa)||0>=Q)return!1;this._element=sa;this._element.title=bb;this._element.setAttribute(Fd.a.lg,Fd.a.R0);this._element.setAttribute("Unselectable",
"on");this.yJb=Q;this.GG();return this._initialized=!0}GG(){this.Qna&&(this.Qna.Ma(D.a.blur,this._element,Object(n.a)(this,this.onBlur,"onBlur")),this.Qna.Ma(D.a.paste,this._element,Object(n.a)(this,this.Opd,"onPaste")));this.nd.Ma(D.a.jh,this._element,Object(n.a)(this,this.onKeyDown,"onKeyDown"));this.Eq.Ma(D.a.pointerDown,this._element,Object(n.a)(this,this.eI,"onPointerDown"));this.Eq.Ma(D.a.dO,this._element,Object(n.a)(this,this.kYa,"onPointerUp"))}onBlur(){this.isActive&&!this.vSe&&(this.J_g||
this.UJe(this._element),this.$xh(),this.Duf(!1));return this.vSe=!1}Opd(){ua.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.tPl(Q):this.uPl(Q)}tPl(Q){let sa=!1;switch(Q.$a.keyCode){case Sys.UI.Key.enter:this.$xh();this.Duf(this.Fh||this.$Te);sa=!0;break;case Sys.UI.Key.tab:this.J_g&&this.UJe(this._element);break;case Sys.UI.Key.esc:this.spg(),this.Duf(this.Fh||this.$Te),sa=!0}return sa}uPl(Q){let sa=!1;switch(Q.$a.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.S1i(this.$Te),
this.isActive&&this.ZSd(this._element),sa=!0}return sa}eI(){this.isActive||(this.S1i(!1),this.isActive&&(this._element.focus(),this.ZSd(this._element),this.R5e=!0));return!1}kYa(){return this.R5e?(this.ZSd(this._element),this.R5e=!1,!0):!1}pvc(){return 32===this.ea.processAction(cb.a.renameFile,1)}$xh(){const Q=$a.a.GJ(this.LQa.Oz);let sa=this._element.innerText.trim();sa.length>this.yJb&&(sa=sa.substr(0,this.yJb));sa!==Q&&""!==sa?32!==this.ea.Db(cb.a.renameFile,2,sa)?this.spg():this.hGc(sa):this.spg()}spg(){this.hGc($a.a.GJ(this.LQa.Oz))}hGc(Q){this._initialized&&
(this._element.innerText=Q,this.qah())}S1i(Q){this.pvc()?this.isActive||(Q&&(this.vSe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Fd.a.lg,Fd.a.woh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,ge.CuiHelper.nIh),this.ylb&&this.ylb.execute(sa=>{sa.nDi(!0)}),Q&&this._element.focus(),ua.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ea.processAction(cb.a.HDc,
2)}Duf(Q){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Fd.a.lg,Fd.a.R0);Sys.UI.DomElement.removeCssClass(this._element,ge.CuiHelper.nIh);this.ylb&&this.ylb.execute(sa=>{sa.nDi(!1)});Q&&(this._element.blur(),this._element.focus())}static Bua(){Le.a.Bua(G.AFrameworkApplication.isRtl)}static Wg(){return new xf(G.AFrameworkApplication.qa,de.a.instance,kf.KeyInputManager.instance,mg.a.instance,G.AFrameworkApplication.Oq,xf.Bua,
la.a.$lm,la.a.owh,xa.a.instance.Fa("Common.App.Header.HeaderEventSource"),Ga.a.Ew,Ga.a.zh,Ga.a.Xg)}}Object(c.a)(xf,"RenameUIHandler",null,[1853]);class He{static get instance(){return G.AFrameworkApplication.pa.mb.bA?He.ta||(He.ta=ud.Wg()):He.ta||(He.ta=xf.Wg())}}He.ta=null;Object(c.a)(He,"RenameUIHandlerFactory",null,[]);class vd{constructor(){this.tod=this.cIl=this.Cjk=null}}Object(c.a)(vd,"RenameMruEntryProperties",null,[]);var Eg=b(173),Xg=b(95),zh=b(1182),bd;(function(Q){Q[Q.unknown=-1]="unknown";
Q[Q.success=0]="success";Q[Q.renameInvalidFileName=1]="renameInvalidFileName";Q[Q.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Q[Q.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Q[Q.permissionDenied=4]="permissionDenied";Q[Q.serverCommunicationFailure=5]="serverCommunicationFailure";Q[Q.fileNameTooLong=6]="fileNameTooLong"})(bd||(bd={}));Object(c.b)("CommonOperationResult",bd);class qf{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg,Zg,Wh){this.a0g=Q;this.ea=sa;this.je=bb;this.uM=
Cb;this.VIb=dc;this.eGj=Oc;this.tob=yd;this.Dfh=md;this.Tzj=Af;this.Vlb=wg;this.ra=Zg;this.Szj=Wh}pb(){G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.bA||this.Bd.na(cb.a.rtc,Ec.a.frame,Object(n.a)(this,this.rtc,"initializeRenameUIHandler"));this.Bd.na(cb.a.HDc,Ec.a.frame,Object(n.a)(this,this.HDc,"showRenameDisabledDialog"));this.Bd.na(cb.a.renameFile,Ec.a.frame,Object(n.a)(this,this.renameFile,"renameFile"));this.Bd.La(cb.a.fileNameUpdate,Ec.a.frame,Object(n.a)(this,this.E9l,"refreshFilename"),
64);this.Bd.La(cb.a.lke,Ec.a.frame,Object(n.a)(this,this.lke,"moveToFolderCompleteByHost"),64);this.Bd.na(cb.a.q3b,Ec.a.frame,Object(n.a)(this,this.q3b,"moveToFolder"));G.AFrameworkApplication.pa&&(G.AFrameworkApplication.K.$("PostMessageEmbedded")||G.AFrameworkApplication.K.$("IsJsApi"))&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&G.AFrameworkApplication.EN().execute(Q=>{Q.Ty(Xg.a.Cpi);Q.kI(Xg.a.Cpi,qf.l7l);Q.Ty(Xg.a.lBf);Q.kI(Xg.a.lBf,
qf.j7l)})}pvc(){return this.Szj.QZh()?8:32}pVm(){return this.ov?this.tob?this.ov.wxf:this.ov.xVa:!0}rtc(){return He.instance.initialize(G.AFrameworkApplication.P6d,G.AFrameworkApplication.DHh,G.AFrameworkApplication.THi||CommonUIStrings.l_RenameFileTooltip)?32:8}HDc(){const Q=this.pVm(),sa=this.eGj();ua.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.VIb,sa,Q,this.tob);G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.kz&&G.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new wf(this.VIb,!sa,!Q,this.tob,this.Vlb()):new Mb(this.VIb,!sa,!Q,this.tob,this.Vlb());return 32}renameFile(Q,sa,bb,Cb,dc){if(1===bb)return this.pvc();if(!G.AFrameworkApplication.MTb)return 8;if(8===this.pvc())return this.Bd.processAction(cb.a.HDc,2),8;ua.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");G.AFrameworkApplication.MTb(dc,Object(n.a)(this,
this.Spd,"onRenameFileSuccess"),Object(n.a)(this,this.vRl,"onRenameFileFailure"));return 32}Spd(Q,sa){Q?Q.OperationResult?this.H3h(Q.OperationResult):(this.snm(sa,Q.NewName),this.tQm(Q,Object(n.a)(G.AFrameworkApplication.pa.mb,G.AFrameworkApplication.pa.mb.vHg,"updateOpenInClientDocumentUrl")),G.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&G.AFrameworkApplication.pa.updateCommandUI(),this.Tzj.c4i()):this.H3h(5)}snm(Q,sa){const bb={};bb[Eg.a.Wxk]=sa;Q.Yg(Xg.a.lBf,bb)}tQm(Q,sa){this.BQm(Q);
G.AFrameworkApplication.t4d=Q.DirectInvokeDavUrl;sa=sa(Q.EditDocInClientUrl);const bb=new vd;bb.tod=this.uM.Oz;bb.Cjk=sa;bb.cIl=Q.EditDocInClientUrl;this.Bd.Db(cb.a.UHi,2,bb)}H3h(Q){switch(Q){case 1:Q=new wd.StandardDialog,Q.Jc=0,Q.dR(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.kKi()}}BQm(Q){this.uM.Oz=qf.CRj(this.uM.Oz,Q.NewName);Q.BreadcrumbFolderName&&(this.uM.breadcrumbFolderName=Q.BreadcrumbFolderName);Q.BreadcrumbFolderUrl&&(this.uM.breadcrumbFolderUrl=
Q.BreadcrumbFolderUrl);this.Dfh(Q.NewName)}vRl(Q){const sa=new wd.StandardDialog;sa.Jc=0;switch(Q){case 1:ua.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");sa.Yma(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ua.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");sa.Yma(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:ua.ULS.sendTraceTag(38114565,
203,15,"OnRenameFileFailure: {0}",{["Result"]:Q}),sa.Yma(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}G.AFrameworkApplication.EN().execute(bb=>{bb.Yg(Xg.a.Vxk,{["FailureMessage"]:bd[Q]})});this.kKi()}E9l(Q,sa,bb){if(1===bb)return this.pvc();if(!G.AFrameworkApplication.dVa)return 8;G.AFrameworkApplication.dVa(Object(n.a)(this,this.$xc,"onRefreshFilenameSuccess"),Object(n.a)(this,this.Zme,"onRefreshFilenameFailure"),!1);return 32}q3b(Q,sa,bb,Cb,dc){if(1===
bb)return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DTTMoveButton",!1)&&G.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===bb){const Oc={};Q=G.AFrameworkApplication.Xcb;sa=G.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");Q=(!Q||Q&&sa)&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Oc[Eg.a.KGm]=Q;dc&&dc.MoveButtonClickedTime&&(Oc[Eg.a.SGl]=dc.MoveButtonClickedTime.getTime());G.AFrameworkApplication.EN().execute(yd=>
{yd.Yg(Xg.a.q3b,Oc)});if(dc&&dc.MoveButtonClickedTime){if(Q=this.CH())dc=(new Date).getTime()-dc.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",dc.toString());Ra.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}lke(Q,sa,bb,Cb,dc){if(1===bb)return G.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.pvc():8;if(2===bb){if(!G.AFrameworkApplication.Cwd)return Ra.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",
!1,!1,null),8;if(!dc)return Ra.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(dc[Eg.a.tkl])if(dc[Eg.a.T6i])if(Q=dc[Eg.a.T6i].toLowerCase(),sa=G.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),bb=G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),sa&&G.AFrameworkApplication.Xcb&&bb){const Oc={};Oc[Eg.a.GAc]="1";Oc[Eg.a.documentUrl]=Q;Oc[Eg.a.reason]=zh.a.Oqg;Ra.Health.instance.recordKpiSuccess("MoveToFolder",
null);G.AFrameworkApplication.EN().execute(yd=>{yd.Yg(Xg.a.TSb,Oc)})}else if(!G.AFrameworkApplication.Xcb&&bb)Ra.Health.instance.recordKpiSuccess("MoveToFolder",null),la.a.Vm(Q,la.a.LCa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Ra.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Ra.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else G.AFrameworkApplication.dVa(Object(n.a)(this,this.$xc,"onRefreshFilenameSuccess"),
Object(n.a)(this,this.Zme,"onRefreshFilenameFailure"),!1),G.AFrameworkApplication.Cwd(),Ra.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}kzm(Q,sa){return Q&&sa?Q!==this.uM.breadcrumbFolderName||sa!==this.uM.breadcrumbFolderUrl:!1}$xc(Q,sa){Q&&(Q.NewName!==$a.a.GJ(this.uM.Oz)||this.kzm(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl))&&this.Spd(Q,sa)}Zme(){}kKi(){this.Dfh($a.a.GJ(this.uM.Oz))}get Bd(){return this.ea.value}get ov(){return this.je.value}CH(){try{return new Map}catch(Q){return null}}static get instance(){return qf.ta||
(qf.ta=qf.J$a())}static J$a(){return new qf(G.AFrameworkApplication.qvc,new yb.a(()=>G.AFrameworkApplication.qa),new yb.a(()=>G.AFrameworkApplication.ov),G.AFrameworkApplication.Oq,G.AFrameworkApplication.MAa,()=>G.AFrameworkApplication.NIg,G.AFrameworkApplication.dBc,Object(n.a)(He.instance,He.instance.hGc,"updateTitle"),xa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>G.AFrameworkApplication.Uq,G.AFrameworkApplication.K,xa.a.instance.resolve("Common.IRenameProps"))}static CRj(Q,
sa){Q=$a.a.NVa(Q);return sa+Q}static l7l(Q){const sa=Q.Values[Eg.a.Aol];ua.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",sa);sa?G.AFrameworkApplication.qa.Db(cb.a.lke,2,Q.Values):Ra.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static j7l(Q){G.AFrameworkApplication.qa.Db(cb.a.renameFile,2,Q.Values.NewName)}}qf.ta=null;Object(c.a)(qf,"RenameActor",null,[]);var Ci=b(129),Og=b(1018),Zh=b(521),ug=b(386);class sh{constructor(Q,
sa){this.ea=Q;this.Fkb=sa}pb(){this.ea.na(cb.a.LVi,Ec.a.frame,Object(n.a)(this,this.HBm,"showRenameDialogAction"))}HBm(Q,sa,bb){Q=32;if(1===bb)return ug.SessionStatusManager.instance.Kj?8:32;2===bb&&(32!==this.ea.processAction(cb.a.renameFile,1)?(this.ea.processAction(cb.a.HDc,2),Ci.a.instance.qb(Og.a.jka,{["Reason"]:Zh.a.Qem}),Q=8):32===this.ea.processAction(cb.a.Ywe,1)?this.ea.processAction(cb.a.Ywe,2):this.Fkb.value.create().wBb());return Q}}Object(c.a)(sh,"RenameDialogActor",null,[1841]);class Xd{constructor(Q,
sa,bb){this.dialog=null;this.ea=Q;this.uM=sa;this.jlb=bb}DYk(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:Xd.mpc,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:$a.a.GJ(this.uM.Oz),["maxLength"]:this.jlb};return Q}wBb(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.DYk()};this.dialog=new cf.a(!1,!1,!0);this.dialog.Jc=1;this.dialog.mf="RenameDialog";this.dialog.qh(CommonUIStrings.l_RenameDialogTitle,Object(n.a)(this,this.hng,"renameDialogHandler"),Q)}hng(Q,sa){if(sa&&
1===Q){if(sa[Xd.mpc]&&(Q=$a.a.GJ(this.uM.Oz),sa=(sa[Xd.mpc]||"").trim(),sa!==Q&&""!==sa)){this.ea.Db(cb.a.renameFile,2,sa);return}Ci.a.instance.qb(Og.a.QSb,{["Reason"]:Zh.a.wMh})}}}Xd.mpc="txtDocumentName";Object(c.a)(Xd,"ReactRenameDialog",null,[1852]);class bi{static get lf(){return cf.a.Qv(bi.zk,CommonUIStrings.l_RenameDialogLabel)}}bi.zk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(c.a)(bi,"RenameDialogHtml",null,[]);class kg extends cf.a{constructor(Q,sa,bb){super();this.ea=Q;this.uM=sa;this.jlb=bb;this.mf="RenameDialog";this.lf=bi.lf}wBb(){var Q={["txtDocumentName"]:$a.a.GJ(this.uM.Oz)};this.qh(CommonUIStrings.l_RenameDialogTitle,Object(n.a)(this,this.hng,"renameDialogHandler"),Q);Q=document.getElementById(kg.mpc);0<this.jlb&&(Q.maxLength=this.jlb);Q.focus()}hng(Q,sa){if(1===Q&&(Q=$a.a.GJ(this.uM.Oz),sa=(sa[kg.mpc]||"").trim(),sa!==Q&&""!==sa)){this.ea.Db(cb.a.renameFile,
2,sa);return}Ci.a.instance.qb(Og.a.QSb,{["Reason"]:Zh.a.wMh})}}kg.mpc="txtDocumentName";Object(c.a)(kg,"RenameDialog",cf.a,[1852]);class jf{constructor(Q){this.LQa=null;this.jlb=0;this.ea=Q;this._initialized=!1}initialize(Q,sa){this.LQa=Q;this.jlb=sa;this._initialized=!0}create(){return this._initialized?G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.kz&&G.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new Xd(this.ea,this.LQa,this.jlb):new kg(this.ea,this.LQa,this.jlb):null}}Object(c.a)(jf,
"RenameDialogFactory",null,[1839]);var vf=b(214);class gg{constructor(Q){this.ea=Q}pb(){this.ea.na(cb.a.Ywe,Ec.a.frame,Object(n.a)(this,this.IBm,"showRenameFlyoutAction"))}w2j(){return vf.appChromeContainsAction("setDocumentTitleFlyoutOpened")&&G.AFrameworkApplication.pa.mb.bA}IBm(Q,sa,bb){if(1===bb)return this.w2j()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}}Object(c.a)(gg,"RenameFlyoutActor",null,[1840]);class gd{constructor(Q,sa,bb,Cb,dc){this.W7j=
null;this.je=dc;this.b0g=bb;this.a0g=Cb;this.gGj=Q;this.Vlb=sa}get ov(){return this.je.value}QZh(){if(!this.a0g())return 5;if(this.Vlb())return 1;if(this.ov){if(this.b0g&&!this.ov.wxf)return 3;if(!this.b0g&&!this.ov.xVa)return 4}return this.gGj()?0:2}}Object(c.a)(gd,"RenameProps",null,[1838]);class Dh{constructor(Q,sa,bb,Cb,dc,Oc){this.Gk=!1;this.cXe=new hb.a;this.nfc=sa;this.Fx=bb;this.c1a=Cb;this.ra=dc;this.R4=Oc}enable(){this.Gk||(this.c4i(),this.BAg(),this.Gk=!0)}generateKey(Q,sa,bb){return String.format("{0}/{1}/{2}",
bb,Q,sa)}kRk(){const Q=$a.a.GJ(this.nfc().Oz);return this.generateKey(this.nfc().breadcrumbFolderName,this.nfc().breadcrumbFolderUrl,Q)}lRk(Q,sa,bb){return Q&&sa?this.generateKey(Q,sa,bb):bb}kok(Q,sa,bb){return Q&&Q!==this.nfc().breadcrumbFolderName||sa&&sa!==this.nfc().breadcrumbFolderUrl?!0:bb!==$a.a.GJ(this.nfc().Oz)}c4i(){const Q=this.kRk();this.cXe.W(Q,new Date)}Beg(Q){this.hym(Q)&&this.mhh(Q)}hym(Q){const sa=this.c1a();return sa?this.R4&&this.R4.fm||!sa.efe||!G.AFrameworkApplication.dVa?(this.$Xi(Q),
this.Gk=!1):!0:!1}nwi(Q,sa,bb,Cb){const dc=this.kok(Q,sa,bb);Q=this.lRk(Q,sa,bb);sa=this.cXe.xb(Q).returnValue;dc&&!sa&&(this.J3h(Cb),ua.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.w3f));dc||this.cXe.W(Q,this.Fx())}}Object(c.a)(Dh,"ARenamedFileChecker",null,[1812]);class Lh extends Dh{constructor(Q,sa,bb,Cb,dc,Oc,yd,md){super(Q,sa,bb,Cb,dc,Oc);this.At=dc;this.Rzj=yd;this.URe=md}get w3f(){return"RenamedFileCheckerUsingSettingsRefresh"}BAg(){this.At.Clc(Object(n.a)(this,this.b4h,
"handleSettingsRefresh"))}b4h(Q,sa){sa&&sa.Yxb&&sa.jsi&&(sa.Zsa("BreadcrumbDocName")||sa.Zsa("BreadcrumbFolderName")||sa.Zsa("BreadcrumbFolderUrl")||sa.Zsa("DirectInvokeDAVUrl")||sa.Zsa("EditDocInClientUrl"))&&(ua.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.w3f),this.Beg(sa))}$Xi(){this.At.HHi(Object(n.a)(this,this.b4h,"handleSettingsRefresh"))}mhh(Q){if(Q&&Q.Yxb){const sa=Q.Yxb;this.nwi(sa.Oa("BreadcrumbFolderName"),sa.Oa("BreadcrumbFolderUrl"),sa.Oa("BreadcrumbDocName"),
Q)}}J3h(Q){const sa={OperationResult:0,classId:1};Q=Q.Yxb;sa.BreadcrumbFolderName=Q.Oa("BreadcrumbFolderName");sa.BreadcrumbFolderUrl=Q.Oa("BreadcrumbFolderUrl");sa.DirectInvokeDavUrl=Q.Oa("DirectInvokeDAVUrl");sa.EditDocInClientUrl=Q.Oa("EditDocInClientUrl");Q=Q.Oa("BreadcrumbDocName");sa.NewName=G.AFrameworkApplication.lpc?Q:$a.a.GJ(Q);this.URe.execute(bb=>{this.kil(sa,bb)})}kil(Q,sa){this.Rzj().Spd(Q,sa)}}Object(c.a)(Lh,"RenamedFileCheckerUsingSettingsRefresh",Dh,[]);class Fj extends Dh{constructor(Q,
sa,bb,Cb,dc,Oc,yd,md,Af,wg){super(Q,bb,Cb,dc,Oc,Af);this.pVc=this.jL=null;this.ryj=sa;this.ea=yd;this.Za=md;wg&&wg.execute(Zg=>{this.rbm(Zg)})}get w3f(){return"RenamedFileCheckerUsingTask"}rbm(Q){this.jL=Q;this.jL.yOb(Object(n.a)(this,this.j6,"handleVisibilityChange"))}j6(Q,sa){!this.Gk||sa.newState&&1!==sa.newState||this.pVc||(this.BAg(),this.Beg(this.pVc))}BAg(){this.pVc=new kc.a(3,2,this.ryj(),Object(n.a)(this,this.Beg,"performRenameFileCheckTick"),89);this.Za.Eb(this.pVc)}$Xi(Q){this.Za.xe(Q)}mhh(Q){this.jL&&
2===this.jL.JY?this.Lcm(Q):G.AFrameworkApplication.dVa(Object(n.a)(this,this.$xc,"onRefreshFilenameSuccess"),Object(n.a)(this,this.Zme,"onRefreshFilenameFailure"),!0)}Lcm(Q){this.Za.xe(Q);this.pVc=null}$xc(Q){Q&&this.nwi(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}J3h(){this.ea.processAction(cb.a.fileNameUpdate,2)}Zme(){}}Object(c.a)(Fj,"RenamedFileCheckerUsingTask",Dh,[]);class Ag{constructor(){this.ra=this.Z=null}get name(){return"Common.App.RenameFile"}Nb(Q){this.Z=Q;this.ra=G.AFrameworkApplication.K;
this.Z.register(sh,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").zd(()=>new sh(G.AFrameworkApplication.qa,this.Z.Pd("Common.App.Rename.IRenameDialogFactory"))).fa();this.Z.register(jf,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").zd(()=>new jf(G.AFrameworkApplication.qa)).fa();this.Z.register(1812,"Common.App.Rename.IRenamedFileChecker").zd(()=>this.rhk()).fa();this.Z.register(gg,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").zd(()=>
new gg(G.AFrameworkApplication.qa)).fa()}rhk(){if(this.ra.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=this.Z.sa("Common.IRefreshableAppSettings");if(Q&&Q.Cei)return new Lh(()=>Q.zb("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>G.AFrameworkApplication.Oq,()=>new Date,()=>G.AFrameworkApplication.ov,Q,this.Z.sa("Common.ISessionStatus"),()=>qf.instance,this.Z.Fa("Postmessage.IHostPostmessenger"))}return new Fj(()=>this.ra.zb("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.ra.zb("RenamedFileCheckerPingIntervalInMs",
12E4),()=>G.AFrameworkApplication.Oq,()=>new Date,()=>G.AFrameworkApplication.ov,G.AFrameworkApplication.K,G.AFrameworkApplication.qa,G.AFrameworkApplication.Vb,this.Z.sa("Common.ISessionStatus"),this.Z.Fa("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.ra.Do(Object(n.a)(this,this.ux,"onFullAppSettingsReady"))}ux(){const Q=G.AFrameworkApplication.pa.mb.bA;G.AFrameworkApplication.qvc()&&He.instance.initialize(G.AFrameworkApplication.P6d,Q?null:G.AFrameworkApplication.DHh,Q?null:
G.AFrameworkApplication.THi||CommonUIStrings.l_RenameFileTooltip)&&(this.Z.register(gd,"Common.App.Rename.RenameProps").as("Common.IRenameProps").zd(()=>new gd(()=>G.AFrameworkApplication.NIg,()=>G.AFrameworkApplication.Uq,G.AFrameworkApplication.dBc,G.AFrameworkApplication.qvc,new yb.a(()=>G.AFrameworkApplication.ov))).fa(),qf.instance.pb(),this.ra.$("RenameDialogIsEnabled")&&(this.Z.resolve("Common.App.Rename.RenameDialogFactory").initialize(G.AFrameworkApplication.Oq,G.AFrameworkApplication.P6d),
this.Z.resolve("Common.App.Rename.IRenameDialogActor").pb()),this.Z.resolve("Common.App.Rename.IRenameFlyoutActor").pb(),G.AFrameworkApplication.dBc&&this.Z.resolve("Common.App.Rename.IRenamedFileChecker").enable())}dispose(){}}Object(c.a)(Ag,"PackageManager",null,[2,3]);class lg{static get lf(){return cf.a.Qv(lg.zk,CommonUIStrings.l_SaveACopyFileName)}}lg.zk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(c.a)(lg,"FileNameDialogHtml",null,[]);class mf extends cf.a{constructor(Q,sa,bb,Cb){super();this.YJd=this.gRa=null;this.ea=Q;this.Wva=sa;this.pZc=bb;this.Yd(1,CommonUIStrings.l_SaveButtonLabel);this.lf=lg.lf;this.mf="FileNameDialog-SaveACopy";this.el=Cb}cJa(Q,sa,bb){this.YJd=Q;this.gRa=bb;Q={["txtFileName"]:$a.a.GJ(G.AFrameworkApplication.Oq.Oz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,sa)};this.qh(CommonUIStrings.l_SaveToOneDrive,Object(n.a)(this,this.O6d,"fileNameDialogHandler"),
Q);ua.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}O6d(Q,sa){1!==Q?ua.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=sa.txtFileName.trim(),ua.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),sa=$a.a.NVa(G.AFrameworkApplication.fileName),Q&&""!==Q&&""!==sa&&(Q+=sa),this.pZc.NOa(this.YJd,this.gRa,Q,this.el))}}Object(c.a)(mf,"FileNameDialog",
cf.a,[1837]);class $g{constructor(Q,sa,bb){this.ea=Q;this.Wva=sa;this.pZc=bb}create(Q){return new mf(this.ea,this.Wva,this.pZc,Q)}}Object(c.a)($g,"FileNameDialogFactory",null,[1819]);class Be extends wd.StandardDialog{constructor(Q){super();this.Jc=1;this.Yd(1,CommonUIStrings.l_RetryButtonLabel);this.Yd(0,CommonUIStrings.l_DialogClose);this.ea=Q}QP(Q){ua.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Q);this.ew(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(n.a)(this,this.Ppg,"retryDialogHandler"))}Ppg(Q){1===Q?(ua.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ea.processAction(cb.a.RBc,2)):ua.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(c.a)(Be,"RetryDialog",wd.StandardDialog,[1818]);var lf=b(194);class ci{constructor(Q,sa,bb,Cb){this.kSd=null;this.UAj=Q;this.ra=bb;this.A6g=sa;this.r2g=new t.a;this.Gc=Cb}Mvc(){return this.ra.$("SaveToCloudStorageUIIsEnabled")}Trb(){return cb.a.Yqg}y_d(){da.a.Qtd(Object(n.a)(this,
this.iMi,"saveToCloudActionDispatcher"));da.a.P8c([new lf.a(cb.a.Yqg,Ec.a.frame,0)],this.A6g.Lrc())}pb(){const Q=this.A6g.Lrc();Q?(Q.fJ(()=>{this.r2g.We(!0)}),this.y_d()):ua.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}zEi(){ua.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}iMi(Q,sa,bb,Cb,dc){return sa.contextId!==Ec.a.frame||Q!==this.Trb()?2:this.Mvc()?1===bb?ug.SessionStatusManager.instance.Kj?8:32:2===bb?
(this.zEi(),dc&&dc.FileDownloadUrl&&ua.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Gc&&(this.kSd=this.Gc.le("DialogShown","SaveToOneDriveReponseTime")),this.r2g.task.continueWith(()=>{this.kSd&&(this.kSd.stop(),this.kSd=null);this.UAj.start(dc)}),32):8:8}}Object(c.a)(ci,"SaveToCloudStorageActor",null,[1823]);class Ji extends ci{constructor(Q,sa,bb,Cb){super(Q,sa,bb,Cb);this.dxj=sa}Mvc(){return this.ra.$("SaveACopyBrsIsEnabled")}Trb(){return cb.a.RBc}y_d(){da.a.Qtd(Object(n.a)(this,
this.iMi,"saveToCloudActionDispatcher"));da.a.P8c([new lf.a(cb.a.RBc,Ec.a.frame,0)],this.dxj.Lrc())}zEi(){ua.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(c.a)(Ji,"SaveACopyActor",ci,[]);class Fe{}Fe.default=0;Object(c.a)(Fe,"SaveToCloudErrorCodes",null,[]);class yf{constructor(Q,sa,bb,Cb,dc,Oc){this.el=null;this.OCj=Q;this.Exa=sa;this.pZc=bb;this.ra=Cb;this.VFd=dc;this.hH=Oc}start(Q){this.el=Q;this.Exa.Ztc?(ua.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),
this.A1j()):(ua.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.NBm())}NBm(){this.OCj.create().cJa()}yl(){this.hH().QP(Fe.default)}A1j(){try{ua.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Q={["client_id"]:this.ra.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.VFd||2===this.VFd)Q={["client_id"]:this.ra.appSettings.UploadToSkyDriveClientId};WL.init(Q);ua.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(n.a)(this,this.onSuccess,"onSuccess"),Object(n.a)(this,this.onFailure,"onFailure"))}catch(Q){ua.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.yl()}}onSuccess(Q){ua.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&Q.data.folders&&this.pZc.NOa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,null,this.el)}onFailure(Q){if(Q&&
Q.error){if("user_canceled"===Q.error.code){ua.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ua.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else ua.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.yl()}}Object(c.a)(yf,"SaveToCloudManager",null,[1825]);class Nc extends yf{constructor(Q,sa,bb,Cb,dc,Oc,yd){super(sa,bb,Cb,dc,Oc,yd);this.Nmj=Q}onSuccess(Q){Q&&
Q.data&&Q.data.folders?(ua.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Nmj.create(this.el).cJa(Q.data.folders[0].id,Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(ua.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.yl())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&ua.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}yl(){ua.ULS.sendTraceTag(7205458,
216,50,"Error occur in Save A Copy Manager.");super.yl()}}Object(c.a)(Nc,"SaveACopyManager",yf,[]);var vg=b(152);class Rh{constructor(Q,sa,bb,Cb,dc){this.gRa=this.Ti=this.XIc=null;this.g0=!1;this.el=this.v6a=null;this.aaf=Q;this.XFa=sa;this.hH=bb;this.Ch=Cb;this.Gc=dc}Bhb(){this.Ch&&1===this.Ch.state||(this.Ti=this.XFa(),this.Ti.message=CommonUIStrings.l_CommentProgressTooltip,this.Ti.Jc=5,this.Ti.lr=!1,this.Ti.QD(CommonUIStrings.l_DefaultDialogTitle,null,null))}sra(){this.Ti&&(this.Ti.close(),this.Ti=
null)}S7(){1!==G.AFrameworkApplication.pa.state&&this.hH().QP(Fe.default)}t8b(){ua.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");la.a.Vm(this.gRa,la.a.LCa(3),void 0,"UploadToCloudManager.RedirectToFolder")}s8b(Q){let sa=!1,bb=!1;G.AFrameworkApplication.K&&(sa=G.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),bb=G.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ua.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,sa);
if(sa&&bb){ua.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Cb={};Cb[Eg.a.GAc]="1";Cb[Eg.a.documentUrl]=Q;G.AFrameworkApplication.EN().execute(dc=>{dc.Yg(Xg.a.TSb,Cb)})}else la.a.Vm(Q,la.a.LCa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}NOa(Q,sa,bb=null,Cb=null){ua.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Gc&&(this.v6a=this.Gc.le("DialogShown","SaveToOneDriveUploadTime"));this.Bhb();this.gRa=
sa;this.XIc=this.aaf.create(Q,bb,Cb);this.el=Cb;this.ika()}ika(){ua.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.XIc.execute(Object(n.a)(this,this.eSl,"onSaveToCloudUploadFinished"),Object(n.a)(this,this.dSl,"onSaveToCloudUploadFailed"))}eSl(Q){this.sra();this.g0=!1;if(Q&&Q.data&&Q.data.od){var sa;if(({dz:sa}=Ia.d(Q.data.od)).returnValue)if(Q=sa,Q.StatusCode!==vg.a.Kw&&Q.StatusCode!==vg.a.W5c)ua.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),
this.S7();else{ua.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.s8b(Q.NewDocumentUrl):this.t8b()}catch(bb){ua.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",bb.toString())}this.ard()}else ua.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Jc.a.OBd(Q.data.od)}),this.S7()}else ua.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.S7()}dSl(Q){5!==Q.data.status&&12!==Q.data.status||this.g0?(ua.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),this.sra(),this.S7(),this.ard()):(ua.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.g0=!0,this.ika())}ard(){this.v6a&&(this.v6a.stop(),this.v6a=null)}}Object(c.a)(Rh,"UploadToCloudManager",null,[1822]);class Fk extends Rh{constructor(Q,sa,bb,Cb,dc,Oc){super(sa,bb,Cb,dc,Oc);this.ea=Q}f_f(){return!!this.el&&
!!this.el.SaveEntryPoint&&"VersionHistory"===this.el.SaveEntryPoint.toString()}S7(){ua.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.f_f()&&this.ea.Db(cb.a.Ese,2,{["FailureReason"]:"Unknown"});super.S7()}t8b(){ua.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.f_f()&&this.ea.processAction(cb.a.mvd,2);super.t8b()}s8b(Q){ua.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.f_f()&&this.ea.processAction(cb.a.mvd,
2);super.s8b(Q)}ika(){this.el&&"true"===this.el.SkipSaveToHost?super.ika():32!==this.ea.processAction(cb.a.tgb,1)?(ua.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.ika()):this.ea.Db(cb.a.tgb,2,[()=>{ua.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Rh.prototype.ika.call(this)},()=>{ua.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.S7()}])}}Object(c.a)(Fk,"SaveACopyUploadToCloudManager",Rh,[]);var il=b(649),cj=b(934);class Si{constructor(){this.Z=null}get name(){return"Common.App.SaveACopy"}init(){G.AFrameworkApplication.K.Do(Object(n.a)(this,this.ux,"onFullAppSettingsReady"))}ux(){G.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.Z.resolve("Common.App.SaveACopy.SaveACopyActor").pb()}dispose(){}Nb(Q){this.Z=Q;this.Z.register(Fk,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").zd(()=>new Fk(G.AFrameworkApplication.qa,
Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new cj.a).create(),()=>new Be(G.AFrameworkApplication.qa),G.AFrameworkApplication.pa,G.AFrameworkApplication.pa.so)).fa();this.Z.register($g,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").zd(()=>new $g(G.AFrameworkApplication.qa,G.AFrameworkApplication.pa.mb,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).fa();this.Z.register(Ji,"Common.App.SaveACopy.SaveACopyActor").zd(()=>
new Ji(Q.resolve("Common.App.SaveACopy.SaveACopyManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),G.AFrameworkApplication.K,G.AFrameworkApplication.pa.so)).fa();this.Z.register(Nc,"Common.App.SaveACopy.SaveACopyManager").zd(()=>new Nc(Q.resolve("Common.App.SaveACopy.FileNameDialogFactory"),Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),il.a.instance,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),G.AFrameworkApplication.K,G.AFrameworkApplication.aVa,
()=>new Be(G.AFrameworkApplication.qa))).fa()}static main(){aa.a.instance.jc(new Si)}}Object(c.a)(Si,"PackageManager",null,[2,3]);var ch=b(33);class $e extends wd.StandardDialog{constructor(Q,sa){super();this.qic=!1;this.PO=null;this.ea=Q;this.oMc=sa;this.aCa=!1}QP(Q,sa,bb){this.PO=sa;this.qic=bb;ua.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,bb);(Q=this.Rlf(Q))?(this.Jc=0,this.Yd(1,CommonUIStrings.l_DialogClose)):(this.Jc=6,this.Yd(0,CommonUIStrings.l_DialogClose));
Q||ua.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.ew(ch.a.Ckm,this.lMk(Q),this.kMk(Q,sa),Object(n.a)(this,this.Ppg,"retryDialogHandler"),!0)}Ppg(Q){1===Q?(ua.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.PO?this.ea.Db(cb.a.gwd,2,[this.PO,this.qic]):this.ea.processAction(cb.a.gwd,2)):ua.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}Rlf(Q){return 0>Q||6<Q?(ua.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",
Q),0):Q}kMk(Q,sa){Q=this.Rlf(Q);return this.oMc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,sa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,sa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}lMk(Q){Q=this.Rlf(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(c.a)($e,"ErrorRetryDialog",wd.StandardDialog,[1906]);class Gf{constructor(Q,sa){this.ra=
Q;this.ea=sa;this.oMc=this.ra.$("SaveToHostWithExtraCharsInFileName")}create(){return new $e(this.ea,this.oMc)}}Object(c.a)(Gf,"ErrorRetryDialogFactory",null,[1878]);class xg extends cf.a{constructor(Q,sa,bb,Cb,dc,Oc,yd=null){super();this.P8=null;this.ea=sa;this.Wva=Cb;this.w6a=Oc;this.ra=Q;this.hH=dc;this.Ch=bb;this.oMc=this.ra.$("SaveToHostWithExtraCharsInFileName");this.el=yd;this.Yd(1,CommonUIStrings.l_SaveButtonLabel)}get pa(){return this.Ch}mGh(Q,sa){this.Nma(1,!!Q&&Q!==sa);this.P8=document.getElementById(xg.vMh);
U.a.addHandler(this.P8,"change",Object(n.a)(this,this.eme,"onFileNameChange"));U.a.addHandler(this.P8,"input",Object(n.a)(this,this.eme,"onFileNameChange"));this.P8.focus()}uMh(Q){return this.oMc?(new RegExp("["+this.MKh('\\/:*?"<>|')+"]")).test(Q):(new RegExp("["+this.MKh('\\/:*?"<>|#{}%~&')+"]")).test(Q)}MKh(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}ZOf(){const Q=$a.a.GJ(G.AFrameworkApplication.Oq.Oz);this.Nma(1,!!this.P8&&""!==this.P8.value&&this.P8.value!==Q)}eme(){this.P8&&
window.setTimeout(()=>{this.ZOf()},0)}O6d(Q,sa){if(1!==Q)ua.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=sa[xg.vMh];sa=xg.Kxi in sa?sa[xg.Kxi]:!1;ua.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",$a.a.YEi(Q),sa);const bb=$a.a.NVa(G.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==bb||1===this.pa.state?this.uMh(Q)?this.hH.create().QP(1,Q,sa):this.w6a.NOa(Q+
bb,sa,this.el):this.hH.create().QP(2,Q,sa)}}dispose(){this.P8&&(U.a.removeHandler(this.P8,"change",Object(n.a)(this,this.eme,"onFileNameChange")),U.a.removeHandler(this.P8,"input",Object(n.a)(this,this.eme,"onFileNameChange")),this.P8=null);super.dispose()}}xg.vMh="txtFileName";xg.Kxi="chkOverwrite";Object(c.a)(xg,"FileNameDialogBase",cf.a,[]);class di{static get lf(){return cf.a.Qv(di.zk,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}di.zk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(c.a)(di,"FileNameDialogHtml",null,[]);class cn extends xg{constructor(Q,sa,bb,Cb,dc,Oc){super(Q,sa,bb,Cb,dc,Oc);this.lf=di.lf;this.mf="FileNameDialog-SaveAsToHost"}cJa(Q,sa){const bb=$a.a.GJ(G.AFrameworkApplication.Oq.Oz);sa={["txtFileName"]:Q||bb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:sa};this.qh(CommonUIStrings.L_SaveAs,Object(n.a)(this,this.O6d,"fileNameDialogHandler"),sa);this.mGh(Q,bb)}}Object(c.a)(cn,"FileNameDialog",xg,[1905]);class Nm{constructor(Q,sa,
bb,Cb,dc,Oc){this.ea=sa;this.ra=Q;this.Wva=Cb;this.w6a=Oc;this.hH=dc;this.Ch=bb}create(){return new cn(this.ra,this.ea,this.Ch,this.Wva,this.hH,this.w6a)}}Object(c.a)(Nm,"FileNameDialogFactory",null,[1877]);class Lf{constructor(Q,sa,bb){this.w6a=bb;this.YOe=sa;this.ra=Q}pb(){2===G.AFrameworkApplication.pa.mb.mo?G.AFrameworkApplication.qa.La(cb.a.gwd,Ec.a.frame,Object(n.a)(this,this.RLi,"saveAsToHostActionDispatcher"),4):G.AFrameworkApplication.qa.na(cb.a.gwd,Ec.a.frame,Object(n.a)(this,this.RLi,"saveAsToHostActionDispatcher"))}RLi(Q,
sa,bb,Cb,dc){return sa.contextId!==Ec.a.frame||Q!==cb.a.gwd?2:this.ra.$("SaveAsToHostBrsIsEnabled")?1===bb?ug.SessionStatusManager.instance.Kj?8:32:2===bb?(ua.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Q=this.YOe.create(),dc&&Object.getType(dc)===Array&&2===dc.length?Q.cJa(dc[0],!!dc[1]):Q.cJa(null,!1),32):8:8}}Object(c.a)(Lf,"SaveAsToHostActor",null,[]);class dj{constructor(Q,sa,bb,Cb,dc,Oc,yd,md){this.Ti=null;this.qic=this.g0=!1;this.v6a=this.el=this.PO=
null;this.ra=sa;this.w9=this.ra.appSettings.SaveAsToHostWebServiceBase;this.mZg=Cb;this.XFa=dc;this.Be=bb;this.hH=Oc;this.Gc=md;this.Ch=yd;this.ea=Q;this.O2a=sa.Oa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Bhb(){1!==this.Ch.state&&(this.Ti=this.XFa(),this.Ti.message=CommonUIStrings.l_CommentProgressTooltip,this.Ti.Jc=5,this.Ti.lr=!1,this.Ti.QD(CommonUIStrings.l_DefaultDialogTitle,null,null))}S7(Q=0){1!==this.Ch.state&&this.hH.create().QP(Q,$a.a.GJ(this.PO),this.qic)}t8b(){const Q=this.ra.appSettings.BreadcrumbFolderUrl;
ua.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");la.a.Vm(Q,la.a.LCa(3),void 0,"UploadToHostManager.RedirectToFolder")}s8b(Q){let sa=!1,bb=!1;this.ra&&(sa=this.ra.$("SaveACopyIsEnabledForUiHost"),bb=this.ra.$("UiHostSupportsDocRebootFeatures"));ua.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,sa);if(sa&&bb){ua.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Cb=
{};Cb[Eg.a.GAc]="1";Cb[Eg.a.documentUrl]=Q;Cb[Eg.a.reason]=zh.a.Oqg;G.AFrameworkApplication.EN().execute(dc=>{dc.Yg(Xg.a.TSb,Cb)})}else la.a.Vm(Q,la.a.LCa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}NOa(Q,sa,bb=null){ua.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.mZg&&!this.mZg()&&this.Be&&(this.Gc&&(this.v6a=this.Gc.le("DialogShown","SaveAsToHostUploadTime")),this.Bhb(),this.qic=sa,this.PO=Q,(this.el=bb)&&"true"===this.el.SkipSaveToHost?this.i6d():this.ika())}ika(){32!==
this.ea.processAction(cb.a.tgb,1)?(ua.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.i6d()):this.ea.Db(cb.a.tgb,2,[()=>{ua.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.i6d()},(Q,sa)=>{ua.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.S7(sa)}])}$Tl(Q){this.sra();this.g0=!1;if(Q&&Q.data&&Q.data.od)if(({dz:sa}=Ia.d(Q.data.od)).returnValue)if(Q=
sa,Q.StatusCode!==vg.a.Kw&&Q.StatusCode!==vg.a.W5c){ua.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var sa={};sa.FailureReason=Q.StatusCode.toString();sa.ExtraInfo=Q.ExtraInfo;this.vZa(sa);this.S7(parseInt(Q.ExtraInfo))}else{ua.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.uog();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.s8b(Q.NewDocumentUrl):this.t8b()}catch(bb){ua.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",
bb.toString())}this.ard()}else ua.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Jc.a.OBd(Q.data.od)}),this.vZa({["FailureReason"]:"Failed to deserialize response"}),this.S7();else ua.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.vZa({["FailureReason"]:"null response"}),this.S7()}ZTl(Q){5!==Q.data.status&&12!==Q.data.status||this.g0?(ua.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,
["HttpStatus"]:Q.data.ff}),this.vZa({["FailureReason"]:Q.data.ff.toString()}),this.sra(),this.S7(),this.ard()):(ua.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.g0=!0,this.el&&"true"===this.el.SkipSaveToHost?this.i6d():this.ika())}sra(){this.Ti&&(this.Ti.close(),this.Ti=null)}ard(){this.v6a&&(this.v6a.stop(),this.v6a=null)}uog(){this.el&&"VersionHistory"===this.el.SaveEntryPoint&&this.ea.processAction(cb.a.mvd,2)}vZa(Q){this.el&&"VersionHistory"===this.el.SaveEntryPoint&&
this.ea.Db(cb.a.Ese,2,Q)}i6d(){let Q=this.w9+this.O2a;Q=Hc.a.lp(Q,"qs",$a.a.nj(G.AFrameworkApplication.yk));Q=Hc.a.lp(Q,"n",$a.a.nj((new Date).getTime().toString()));Q=Hc.a.lp(Q,"ov",$a.a.nj(this.qic.toString()));Q=Hc.a.lp(Q,"fn",$a.a.nj(this.PO));this.el&&this.el.FileDownloadUrl&&(Q=Hc.a.lp(Q,"furl",$a.a.nj(this.el.FileDownloadUrl)));this.Be.Hi(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(n.a)(this,this.$Tl,"onUploadFinished"),Object(n.a)(this,this.ZTl,"onUploadFailed"),
null,void 0,void 0,void 0,void 0,"1")}}Object(c.a)(dj,"UploadToHostManager",null,[1798]);class ue{constructor(){this.Z=null}get name(){return"Common.App.SaveAsToHost"}init(){G.AFrameworkApplication.K.Do(Object(n.a)(this,this.ux,"onFullAppSettingsReady"))}ux(){G.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&this.Z.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").pb()}Nb(Q){this.Z=Q;this.Z.register(Gf,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").zd(()=>
new Gf(G.AFrameworkApplication.K,G.AFrameworkApplication.qa)).fa();this.Z.register(dj,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").zd(()=>new dj(G.AFrameworkApplication.qa,G.AFrameworkApplication.K,G.AFrameworkApplication.he,()=>G.AFrameworkApplication.ii,()=>(new cj.a).create(),Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),G.AFrameworkApplication.pa,G.AFrameworkApplication.pa.so)).fa();this.Z.register(Nm,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").zd(()=>
new Nm(G.AFrameworkApplication.K,G.AFrameworkApplication.qa,G.AFrameworkApplication.pa,G.AFrameworkApplication.pa.mb,Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).fa();this.Z.register(Lf,"Common.App.SaveAsToHost.SaveAsToHostActor").zd(()=>new Lf(G.AFrameworkApplication.K,Q.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).fa()}dispose(){}static main(){aa.a.instance.jc(new ue)}}
Object(c.a)(ue,"SaveAsToHostPackage",null,[2,3]);class Ce extends wd.StandardDialog{constructor(){super();this.Jc=0;this.Yd(1,CommonUIStrings.l_DialogClose)}QP(Q){this.ew(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(c.a)(Ce,"ErrorDialog",wd.StandardDialog,[1818]);var ij=b(186);class uk extends wd.StandardDialog{constructor(Q,sa,bb){super();this.ea=Q;this.Exa=sa;this.Wva=bb;this.pia=!1;this.Jc=1;this.G2(1);this.Yd(1,CommonUIStrings.l_SignIn);this.Yd(0,
CommonUIStrings.l_SignInToSaveDialogCancelButton)}cJa(){this.Exa.Rjh(Object(n.a)(this,this.kwi,"onSignIn"));this.$v(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(n.a)(this,this.zfl,"inputHandler"))}zfl(Q){Q?this.Yoe():(ua.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide())}Y3j(){let Q="2";if(this.Wva)switch(this.Wva.mo){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.Exa.Tdm(Object(n.a)(this,this.kwi,
"onSignIn"));super.hide()}Yoe(){const Q=new ij.QueryStringBuilder("Signin.aspx");Q.te("prompt","1");Q.te("cbcxt",this.Y3j());G.AFrameworkApplication.hqa(Q);la.a.Vm(Q.toString(),"LoginWindow",void 0,"SignInDialog")}kwi(){this.CAa&&this.hide();ua.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ea.processAction(cb.a.Yqg,2)}}Object(c.a)(uk,"SignInDialog",wd.StandardDialog,[1843]);class Gj{constructor(Q,sa,bb){this.ea=Q;this.Exa=sa;this.Wva=
bb}create(){return new uk(this.ea,this.Exa,this.Wva)}}Object(c.a)(Gj,"SignInDialogFactory",null,[1826]);class xj{constructor(Q,sa,bb,Cb,dc,Oc,yd){this.w9=Q;this.PO=sa;this.Pfc=bb;this.YJd=Cb;this.X2e=dc;this.O2a=Oc;this.el=yd}execute(Q,sa){if(!G.AFrameworkApplication.ii&&G.AFrameworkApplication.he){var bb=this.w9+this.O2a;bb=Hc.a.lp(bb,"fo",$a.a.nj(this.YJd));bb=Hc.a.lp(bb,"fn",$a.a.nj(this.PO));bb=Hc.a.lp(bb,"qs",$a.a.nj(this.X2e));bb=Hc.a.lp(bb,"n",$a.a.nj((new Date).getTime().toString()));this.el&&
this.el.FileDownloadUrl&&(bb=Hc.a.lp(bb,"furl",$a.a.nj(this.el.FileDownloadUrl)));this.Pfc&&(bb=Hc.a.lp(bb,"fnn",$a.a.nj(this.Pfc)));G.AFrameworkApplication.he.Hi(bb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,sa,null)}}}Object(c.a)(xj,"SkyDriveUploadCaller",null,[1842]);class Em{constructor(Q){this.ra=Q;this.CNb=Q.appSettings.SkyDriveUploadWebServiceBase;this.PO=Q.appSettings.FileName;this.O2a=Q.Oa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,sa,bb){return new xj(this.CNb,
this.PO,sa,Q,G.AFrameworkApplication.yk,this.O2a,bb)}}Object(c.a)(Em,"SkydriveUploadCallerFactory",null,[1824]);class Ti{constructor(){this.Z=null}get name(){return"Common.App.SaveToCloudStorage"}init(){G.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.Z.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").pb()}dispose(){}Nb(Q){this.Z=Q;this.Z.register(Gj,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").zd(()=>
new Gj(G.AFrameworkApplication.qa,il.a.instance,G.AFrameworkApplication.pa.mb)).fa();this.Z.register(Em,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").zd(()=>new Em(G.AFrameworkApplication.K)).fa();this.Z.register(ci,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").zd(()=>new ci(Q.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
G.AFrameworkApplication.K,G.AFrameworkApplication.pa.so)).fa();this.Z.register(Rh,"Common.App.SaveToCloudStorage.UploadToCloudManager").zd(()=>new Rh(Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new cj.a).create(),()=>new Ce,G.AFrameworkApplication.pa,G.AFrameworkApplication.pa.so)).fa();this.Z.register(yf,"Common.App.SaveToCloudStorage.SaveToCloudManager").zd(()=>new yf(Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),il.a.instance,Q.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
G.AFrameworkApplication.K,G.AFrameworkApplication.aVa,()=>new Ce)).fa()}static main(){aa.a.instance.jc(new Ti)}}Object(c.a)(Ti,"PackageManager",null,[2,3]);class wl extends wd.StandardDialog{constructor(){super();this.Jc=0;this.Yd(1,CommonUIStrings.l_DialogClose)}QP(Q,sa){this.MGh(Q,sa,ch.a.Ekm)}MGh(Q,sa,bb){ua.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",bb);this.ew(bb,Q,sa,null)}Vwf(Q,sa){ua.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");
this.ew(ch.a.Gkm,Q,sa,null,!0)}}Object(c.a)(wl,"ErrorDialog",wd.StandardDialog,[1307]);class ke{static get lf(){return cf.a.Qv(ke.zk,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}ke.zk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(c.a)(ke,"FileNameDialogHtml",null,[]);var Ui=b(72);class hg extends xg{constructor(Q,sa,bb,Cb,dc,Oc,yd,md){super(Q,sa,bb,Cb,dc,Oc,md);this.Ilb=this.v5e=this.VR=null;this.Z_j=CommonUIStrings.l_SaveToAnotherFolder;this.lf=ke.lf;this.mf="FileNameDialog-SaveToSharePoint";this.pWc=yd;this.oxj=md}cJa(Q){const sa=$a.a.GJ(G.AFrameworkApplication.Oq.Oz),bb=G.AFrameworkApplication.breadcrumbFolderName,Cb=G.AFrameworkApplication.breadcrumbBrandName,dc={["txtFileName"]:Q||sa};let Oc=CommonUIStrings.L_SaveAs;
2===G.AFrameworkApplication.pa.mb.mo&&(Oc=CommonUIStrings.L_SaveACopy);this.qh(Oc,Object(n.a)(this,this.O6d,"fileNameDialogHandler"),dc);this.mGh(Q,sa);this.Zvf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");G.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.VR=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.v5e=Fd.a.RYd(Q,this.VR,"anotherFolderDescribedBy",""),
this.VR.className="WACButton WACDialogButtonNormal",Q=!1,bb&&bb.length?(this.$hh(this.VR,this.v5e,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Cb,bb)),Q=this.zIj(Cb,bb)):this.$hh(this.VR,this.v5e,CommonUIStrings.l_CurrentOnlineFolder),this.OJj(this.VR),this.BIj(this.VR),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.VR,"SaveToAnotherLocationTwo"),ua.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):
Sys.UI.DomElement.addCssClass(this.VR,"SaveToAnotherLocationOne"),U.a.addHandler(this.VR,D.a.click,Object(n.a)(this,this.ubg,"onSaveToAnotherLocationClick")),U.a.addHandler(this.VR,D.a.jh,Object(n.a)(this,this.Uvi,"onSaveToAnotherLocationKeyDown")))}zIj(Q,sa){let bb;bb=!1;const Cb=document.getElementById("currentLocation");Cb.innerText="";const dc=this.kXh(Cb,Q),Oc=this.kXh(Cb,sa);let yd=255,md=255;255<dc+Oc&&(yd=Math.max(238,408-dc),md=Math.max(170,408-Oc),bb=!0);this.zLj(Cb,Q,md,sa,yd);return bb}kXh(Q,
sa){const bb=document.createElement("div");bb.innerText=sa;bb.style.visibility="hidden";Q.appendChild(bb);sa=bb.clientWidth;Q.removeChild(bb);return sa}zLj(Q,sa,bb,Cb,dc){sa&&(this.Zhh(Q,sa,bb),this.uLj(Q));Cb&&this.Zhh(Q,Cb,dc)}Zhh(Q,sa,bb){const Cb=document.createElement("div");Cb.innerText=sa;Cb.title=sa;Cb.className="SaveToAnotherFolderBreadcrumb";Cb.style.maxWidth=bb.toString()+"px";Q.appendChild(Cb)}uLj(Q){const sa=document.createElement("span");sa.id="FolderSeparator";const bb=document.createElementNS("http://www.w3.org/2000/svg",
"svg");bb.setAttribute("class","SeparatorCaret");const Cb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Cb.setAttribute("points","1 4 1 11 5 7.5");bb.appendChild(Cb);sa.appendChild(bb);Q.appendChild(sa)}$hh(Q,sa,bb){bb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,bb);sa&&(sa.innerText=bb);Q.tabIndex=0;Q.setAttribute(Fd.a.lg,Fd.a.R0)}BIj(Q){const sa=document.createElement("span");sa.id="anotherFolderText";sa.innerText=this.Z_j;sa.className="AnotherFolderTextSpan";
Q.appendChild(sa)}OJj(Q){const sa=document.createElement("span");sa.className="cui-img-cont-float cui-img-16by16 ";this.Ilb=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Ilb.setAttribute("class","FolderIconSVG");const bb=document.createElementNS("http://www.w3.org/2000/svg","path");bb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Ilb.appendChild(bb);sa.appendChild(this.Ilb);Q.appendChild(sa)}Uvi(Q){!Q||
Q.keyCode!==Ui.a.eq&&Q.keyCode!==Ui.a.PDd||this.ubg(Q)}ubg(){if(this.P8){const Q=$a.a.NVa(G.AFrameworkApplication.fileName);let sa=this.P8.value;this.hide();sa&&""!==sa&&""!==Q||1===this.pa.state?(""!==Q&&(sa+=Q),this.uMh(sa)?this.hH.create().QP(1,sa,!1):this.pWc.start(sa,this.oxj)):this.hH.create().QP(2,sa,!1)}}J3j(Q){this.VR&&this.Ilb&&(Q?(this.VR.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.VR,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Ilb,"DisabledFolderIconSVG")):(this.VR.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.VR,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Ilb,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.VR,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Ilb,"DisabledFolderIconSVG"))))}ZOf(){super.ZOf();this.J3j(!!this.P8&&""!==this.P8.value)}dispose(){this.VR&&(U.a.removeHandler(this.VR,D.a.click,Object(n.a)(this,this.ubg,"onSaveToAnotherLocationClick")),U.a.removeHandler(this.VR,D.a.jh,Object(n.a)(this,this.Uvi,
"onSaveToAnotherLocationKeyDown")),this.VR=null);super.dispose()}}Object(c.a)(hg,"FileNameDialog",xg,[1333]);var cc=b(411),xl=b(343),Ne=b(1180),gh=b(1331);class Mh{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(c.a)(Mh,"SaveAsDialogInput",null,[]);class sf{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(c.a)(sf,"SaveLocation",null,[]);var qd=b(202);class Eh{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af){this.wXe=
null;this.PO="";this.pWc=Q;this.hH=sa;this.el=Af;this.w6a=bb;this.Ch=dc;this.uM=Cb;this.mNb=yd;this.Pjc=md;Oc&&(this.wXe=new yb.a(()=>new Ne.a(Oc.value,null)))}tLk(){const Q=new cc.a(xl.a.ef());Q.W("type","currentHost");return Object.assign(new sf,{folderName:this.uM.breadcrumbFolderName,friendlyPath:this.uM.breadcrumbBrandName,properties:Q})}Irl(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}R_k(){if(!this.wXe||
!this.mNb)return null;var Q=this.wXe.value.Pe("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.Jpi)return null;Q=Q.Jpi;const sa=new fa.a;let bb=0,Cb=0;for(var dc=0;dc<Q.length;dc++){var Oc=Q[dc];if(!this.Irl(Oc))continue;bb++;if(!Oc.sharepoint_info)continue;const yd=Oc.url,md=Oc.sharepoint_info.site_url,Af=Oc.title;Oc=gh.b(Oc,G.AFrameworkApplication.isRtl);if(!(yd&&md&&Af&&Oc))continue;Cb++;const wg=new cc.a(xl.a.ef());wg.W("type","SharePoint");wg.W("siteUrl",md);wg.W("folderUrl",yd);Cb++;sa.add(Object.assign(new sf,
{folderName:Af,friendlyPath:Oc,properties:wg}))}dc=new Map;dc.set("NumPlaces",Q.length.toString());dc.set("NumSharepointPlaces",bb.toString());dc.set("placesWithMetadata",Cb.toString());Ra.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",dc);0<bb&&(Cb?.5>1*Cb/bb&&Ra.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ra.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return sa}jMk(){const Q=
new fa.a;Q.add(this.tLk());const sa=this.R_k();sa&&Q.addRange(sa);return Object.assign(new Mh,{enableMoreLocations:!G.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.PO,extension:$a.a.NVa(this.uM.Oz),saveLocations:Q.toArray(),scenario:"SaveToSharePoint"})}iMk(){const Q=Object(n.a)(this,this.jMk,"getDialogInput"),sa={};sa.inputPropsCallback=Q;return sa}cJa(Q){this.PO=Q;this.PO||(this.PO=String.format(CommonUIStrings.l_SaveACopy_Filename,$a.a.GJ(this.uM.Oz)));Q={["id"]:"SaveAsDialog",
["bodyControls"]:this.iMk()};let sa=CommonUIStrings.L_SaveAs;2===this.Ch.mb.mo&&(sa=CommonUIStrings.L_SaveACopy);const bb=new cf.a(!1,!1,!0);bb.Jc=1;bb.mf="SaveAsDialog";bb.Yd(1,CommonUIStrings.l_SaveButtonLabel);bb.qh(sa,Object(n.a)(this,this.Akm,"saveAsDialogHandler"),Q)}iBm(Q,sa){Q&&""!==Q&&""!==sa||1===this.Ch.state?this.Hrl()?this.ryl(Q,sa):(""!==sa&&(Q+=sa),this.pWc.start(Q,this.el)):(ua.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.hH.create().QP(2,
Q,!1))}ryl(Q,sa){Ra.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);this.Pjc.hUh(this.Pjc.LBh(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2)).then(bb=>{if(bb&&0<bb.length){const Cb=bb[0][Eg.a.JYl];bb=bb[0][Eg.a.LYl];if(""!==Cb&&""!==bb)this.mNb.NOa(bb,Q+sa,Cb,this.el),Ra.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.hH.create().QP(0,Q,!1);const dc=this.CH();dc&&(dc.set("SiteUrlAvailable",""===Cb?"false":
"true"),dc.set("FolderUrlAvailable",""===bb?"false":"true"));Ra.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new qd.a,{extendedProperties:dc}))}}else this.hH.create().QP(0,Q,!1),Ra.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(bb=>{"Canceled"===bb?((bb=this.CH())&&bb.set("IsCanceled","true"),Ra.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new qd.a,{extendedProperties:bb}))):
Ra.Health.instance.recordKpiFailure("SaveACopySFP",bb,!1,!1,null)})}Hrl(){return this.Pjc?this.Pjc.efi()&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",!1):(ua.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}CH(){try{return new Map}catch(Q){return null}}Akm(Q,sa){if(sa&&1===Q){Q=sa.fileName;var bb=$a.a.NVa(this.uM.Oz);sa.moreLocationsSelected&&this.iBm(Q,bb);if(sa.locationCallback){var Cb=sa.locationCallback();Cb?Cb.properties&&
"currentHost"===Cb.properties.J("type")?this.w6a.NOa(Q+bb,!1,this.el):Cb.properties&&"SharePoint"===Cb.properties.J("type")?(sa=Cb.properties.J("siteUrl"),Cb=Cb.properties.J("folderUrl"),this.mNb.NOa(Cb,Q+bb,sa,this.el)):ua.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ua.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ua.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(c.a)(Eh,"ReactSaveAsDialog",null,[1333]);class qi{constructor(Q,
sa,bb,Cb,dc,Oc,yd,md=null,Af=null,wg=null){this.ea=sa;this.ra=Q;this.Wva=Cb;this.w6a=Oc;this.hH=dc;this.Ch=bb;this.oah=yd;this.dtj=md;this.mNb=Af;this.Pjc=wg}create(Q){return this.Ch&&this.Ch.mb.kz?new Eh(this.oah,this.hH,this.w6a,G.AFrameworkApplication.Oq,this.Ch,this.dtj,this.mNb,this.Pjc,Q):new hg(this.ra,this.ea,this.Ch,this.Wva,this.hH,this.w6a,this.oah,Q)}}Object(c.a)(qi,"FileNameDialogFactory",null,[1308]);class bf{constructor(Q,sa,bb,Cb){this.ar=this.FFa=null;this.u2a=Q;this.Ch=bb;this.qyj=
Cb;this.uEa=new yb.a(()=>new Ne.a(sa.value,Object(n.a)(this,this.qab,"getMoreInfoEventReceived")))}get Dne(){this.FFa||(this.uEa.value.Pe("Save As",!0),this.ar&&this.ar.Cga&&this.ar.Cga.length&&(this.FFa=this.sKf(this.ar.Cga)));return this.FFa}start(Q){if(!this.Dne)if(G.AFrameworkApplication.breadcrumbFolderUrl&&G.AFrameworkApplication.breadcrumbFolderUrl.length)this.FFa=G.AFrameworkApplication.breadcrumbFolderUrl;else return ua.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.ar),!1;const sa=this.qyj();sa.xyg();const bb=sa.YKf();if(!bb)return ua.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.u2a.start((Cb,dc)=>{sa.hide();Q(Cb,dc)},()=>{this.ueb(sa)},bb,this.FFa);return!0}ueb(Q){Q.hide();ua.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}sKf(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const sa=Q.indexOf("/documents/");return-1!==sa?Q.substring(0,sa+1)+"_layouts/15/onedrive.aspx":""}qab(Q){this.ar||
3!==Q.state||(this.ar=Q)}}Object(c.a)(bf,"OneDriveFilePickerHelper",null,[1306]);class he extends cf.a{constructor(){super()}xyg(){this.AFb="FilePickerDialog";this.lf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.mf="PickerDialog-MsoSp";this.showDialog("",null)}YKf(){return document.getElementById("FilePickerDiv")}oO(){}uma(){}}Object(c.a)(he,"PickerDialog",cf.a,[1305]);class dk{constructor(Q,sa,bb,Cb,dc,Oc,yd){this.ra=Q;this.YOe=bb;this.ea=sa;this.pWc=Cb;this.u2a=dc;this.yTc=Oc;this.Xhj=
yd}pb(){const Q=this.u2a.Lrc();Q?Ga.a.Lu||this.ra.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.ea.La(cb.a.SBc,Ec.a.frame,Object(n.a)(this,this.lMi,"saveToSharePointActionDispatcher"),64):(Q.DXa.continueWith(sa=>{sa.Sh&&this.u2a.fag(sa)}),this.y_d()):ua.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}y_d(){da.a.Qtd(Object(n.a)(this,this.lMi,"saveToSharePointActionDispatcher"));da.a.P8c([new lf.a(cb.a.SBc,Ec.a.frame,0)],this.u2a.Lrc())}get Mvc(){return this.ra.$("SaveToAnotherFolderBrsIsEnabled")}get Kth(){return this.ra.$("UserCanWriteRelative")}lMi(Q,
sa,bb,Cb,dc){return sa.contextId!==Ec.a.frame||Q!==cb.a.SBc?2:this.Mvc&&(this.yTc.Dne||this.Kth)?1===bb?ug.SessionStatusManager.instance.Kj?8:this.Xhj()?32:8:2===bb?(ua.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(dc&&dc.SaveEntryPoint&&"VersionHistory"===dc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Kth?(ua.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.YOe.create(dc).cJa(null)):(ua.ULS.sendTraceTag(24524225,216,50,
"No permission save to current folder, show Picker to save to another folder."),this.pWc.start(null,dc)),32):8:8}}Object(c.a)(dk,"SaveToSharePointActor",null,[]);class Cf{constructor(Q,sa,bb,Cb){this.el=this.B4g=null;this.mNb=Q;this.hH=sa;this.yTc=bb;this.Ch=Cb}start(Q,sa){ua.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.B4g=Q;this.el=sa;this.yTc.start((bb,Cb)=>{this.bsd(bb,Cb)})||this.yyg()}bsd(Q,sa){if(Q)this.onSuccess(sa);else this.onFailure(sa)}yyg(){1!==this.Ch.state&&this.hH().Vwf(CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError)}onSuccess(Q){ua.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const sa=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let bb=null;if(sa&&(bb=Q?this.b0k(Q):this.a0k(sa))){this.mNb.NOa(sa,this.B4g,bb,this.el);return}ua.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",
!sa,!bb)}ua.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.yyg()}a0k(Q){Q.endsWith("/")||(Q+="/");let sa=0;for(let bb=0;bb<Q.length;bb++)if("/"===Q.charAt(bb)&&5===++sa)return Q.substr(0,bb);return null}b0k(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const sa=Q.lastIndexOf("/");return-1!==sa?Q.substring(0,sa):null}onFailure(Q){ua.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");Q&&Q.error?ua.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",
Q.error.errorCode,Q.error.message):ua.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.yyg()}}Object(c.a)(Cf,"SaveToSharePointManager",null,[1799]);class Xj{constructor(Q,sa,bb,Cb,dc,Oc,yd,md){this.w9=Q;this.PO=sa;this.Pfc=Cb;this.X2e=Oc;this.gRa=bb;this.WCj=dc;this.O2a=yd;this.el=md}execute(Q,sa){if(!G.AFrameworkApplication.ii&&G.AFrameworkApplication.he){var bb=this.w9+this.O2a;bb=Hc.a.lp(bb,"fu",$a.a.nj(this.gRa));bb=Hc.a.lp(bb,"su",$a.a.nj(this.WCj));bb=Hc.a.lp(bb,"fn",
$a.a.nj(this.PO));bb=Hc.a.lp(bb,"n",$a.a.nj((new Date).getTime().toString()));this.el&&this.el.FileDownloadUrl&&(bb=Hc.a.lp(bb,"furl",$a.a.nj(this.el.FileDownloadUrl)));bb=bb+"&"+this.X2e;this.Pfc&&this.Pfc.length?bb=Hc.a.lp(bb,"fnn",$a.a.nj(this.Pfc)):ua.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ua.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");G.AFrameworkApplication.he.Hi(bb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,
2,Q,sa,null,void 0,void 0,void 0,void 0,"9")}}}Object(c.a)(Xj,"SharePointSaveAsCaller",null,[1831]);class Oi{constructor(Q){this.CNb=Q.appSettings.SaveAsToHostWebServiceBase;this.PO=Q.appSettings.FileName;this.O2a=Q.Oa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,sa,bb,Cb){return new Xj(this.CNb,this.PO,Q,sa,bb,G.AFrameworkApplication.yk,this.O2a,Cb)}}Object(c.a)(Oi,"SharePointUploadCallerFactory",null,[1796]);var Mj=b(1216);class aj{constructor(Q,sa,bb,Cb,dc){this.Ti=this.XIc=
null;this.lHe=!1;this.p5e=this.gRa=null;this.aaf=sa;this.XFa=bb;this.hH=Cb;this.Ch=dc;this.ea=Q}NOa(Q,sa,bb,Cb){this.lHe=!1;ua.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Bhb();this.gRa=Q;Cb&&Cb.SaveEntryPoint&&(this.p5e=Cb.SaveEntryPoint);this.XIc=this.aaf.create(Q,sa,bb,Cb);Cb&&"true"===Cb.SkipSaveToHost?this.ika():this.UCk()}UCk(){const Q=()=>{ua.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.ika()};32!==this.ea.Db(cb.a.tgb,2,[()=>{ua.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.ika()},Q])&&Q()}ika(){ua.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.XIc.execute(Object(n.a)(this,this.gSl,"onSaveToSharePointUploadFinished"),Object(n.a)(this,this.fSl,"onSaveToSharePointUploadFailed"))}gSl(Q){if(Q&&Q.data&&Q.data.od){var sa;if(({dz:sa}=Ia.d(Q.data.od)).returnValue)if(sa.StatusCode!==vg.a.Kw&&sa.StatusCode!==
vg.a.W5c)ua.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,sa.StatusCode),sa.StatusCode!==vg.a.Gse&&this.oHh(Q.data.status)||(this.vZa(sa.StatusCode.toString()),this.tAm(sa.StatusCode));else{ua.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.uog();try{sa.NewDocumentUrl?this.s8b(sa.NewDocumentUrl):this.t8b()}catch(bb){ua.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
bb.toString())}}else ua.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Jc.a.OBd(Q.data.od)}),this.K4d()||(this.vZa("Failed to deserialize response"),this.dzd())}else ua.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.K4d()||(this.vZa("Unknown"),this.dzd())}fSl(Q){Q&&Q.data?this.oHh(Q.data.status)||(ua.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.vZa(Mj.a[Q.data.status]),this.dzd()):(ua.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.K4d()||(this.vZa("Unknown"),this.dzd()))}K4d(){if(!this.lHe)return ua.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.lHe=!0,this.ika(),!0;ua.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}oHh(Q){ua.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",Q);return this.K4d()}t8b(){ua.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");la.a.Vm(this.gRa,la.a.LCa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}s8b(Q){let sa=
!1,bb=!1;G.AFrameworkApplication.K&&(sa=G.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),bb=G.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ua.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,sa);if(sa&&bb){ua.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Cb={};Cb[Eg.a.GAc]="1";Cb[Eg.a.documentUrl]=Q;Cb[Eg.a.reason]=zh.a.Oqg;G.AFrameworkApplication.EN().execute(dc=>
{dc.Yg(Xg.a.TSb,Cb)})}else la.a.Vm(Q,la.a.LCa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Bhb(){this.Ch&&1===this.Ch.state||(this.Ti=this.XFa(),this.Ti.message=CommonUIStrings.l_CommentProgressTooltip,this.Ti.Jc=5,this.Ti.lr=!1,this.Ti.QD(CommonUIStrings.l_DefaultDialogTitle,null,null))}sra(){this.Ti&&(this.Ti.close(),this.Ti=null)}dzd(){this.yl(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}jBm(){this.yl(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}xAm(){const Q=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.yl(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,ch.a.Bkm)}yl(Q,sa,bb=ch.a.Fkm){ua.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,sa);this.sra();1!==this.Ch.state&&this.hH().MGh(Q,sa,bb)}tAm(Q){ua.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",Q);switch(Q){case vg.a.OFc:this.jBm();break;case vg.a.Gse:this.xAm();break;default:this.dzd()}}uog(){"VersionHistory"===this.p5e&&this.ea.processAction(cb.a.mvd,
2)}vZa(Q){"VersionHistory"===this.p5e&&this.ea.Db(cb.a.Ese,2,{["FailureReason"]:Q})}}Object(c.a)(aj,"UploadToSharePointManager",null,[1797]);var ek=b(469),ui=b(107);class Sh{constructor(){this.UWc=this.ROd=this.MOd=this.Z=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Nb(Q){this.Z=Q;this.MOd=ek.a.Jp(Q.Fa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.ROd=ek.a.Jp(Q.Fa("Common.IEventEmitter<Common.IMruResult>"));G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",
!1)?(this.UWc=ek.a.Jp(Q.Fa("Common.App.SharedFilePicker.ISharedFilePicker")),ui.Task.WAA.call(null,this.MOd,this.ROd,this.UWc).continueWith(()=>{this.oFi()})):(this.UWc=null,ui.Task.WAA.call(null,this.MOd,this.ROd).continueWith(()=>{this.oFi()}))}oFi(){this.Z.register(Oi,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").zd(()=>new Oi(G.AFrameworkApplication.K)).fa();this.Z.register(aj,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").zd(()=>
new aj(G.AFrameworkApplication.qa,this.Z.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new cj.a).create(),()=>new wl,G.AFrameworkApplication.pa)).fa();this.Z.register(Cf,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").zd(()=>new Cf(this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new wl,this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),G.AFrameworkApplication.pa)).fa();
this.Z.register(bf,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").zd(()=>new bf(this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new yb.a(()=>this.MOd.result),G.AFrameworkApplication.pa,()=>new he)).fa();this.Z.register(qi,"Common.App.SaveToSharePoint.FileNameDialogFactory").zd(()=>new qi(G.AFrameworkApplication.K,G.AFrameworkApplication.qa,G.AFrameworkApplication.pa,G.AFrameworkApplication.pa.mb,
this.Z.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Z.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new yb.a(()=>this.ROd.result),this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.UWc?this.UWc.result:null)).fa();this.Z.register(dk,"Common.App.SaveToSharePoint.SaveToSharePointActor").zd(()=>new dk(G.AFrameworkApplication.K,G.AFrameworkApplication.qa,this.Z.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>G.AFrameworkApplication.pa.E2j)).fa();G.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.Z.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").pb()}static main(){aa.a.instance.jc(new Sh)}}Object(c.a)(Sh,"PackageManager",null,[2,3]);class Fg{}Object(c.a)(Fg,
"StringDifference",null,[1820]);class cd{constructor(Q,sa){this.charCode=Q;this.description=sa}}Object(c.a)(cd,"UBTableEntry",null,[]);class Zc{}new cd(8,"C0 Controls 1");new cd(9,"Horizontal tab (HT)");new cd(10,"Line feed (LF)");new cd(12,"C0 Controls 2");new cd(13,"Carriage return (CR)");new cd(31,"C0 Controls 3");new cd(32,"Space");new cd(47,"ASCII Punctuation and Symbols 1");new cd(57,"ASCII Digits");new cd(64,"ASCII Punctuation and Symbols 2");new cd(90,"Uppercase Latin Alphabet");new cd(96,
"ASCII Punctuation and Symbols 3");new cd(122,"Lowercase Latin Alphabet");new cd(127,"U+0000..U+007F Basic Latin");new cd(159,"C1 Controls");new cd(160,"NB Space");new cd(191,"Latin-1 Punctuation and Symbols");new cd(255,"U+0080..U+00FF Latin-1 Supplement");new cd(383,"U+0100..U+017F Latin Extended-A");new cd(591,"U+0180..U+024F Latin Extended-B");new cd(687,"U+0250..U+02AF IPA Extensions");new cd(767,"U+02B0..U+02FF Spacing Modifier Letters");new cd(879,"U+0300..U+036F Combining Diacritical Marks");
new cd(1023,"U+0370..U+03FF Greek and Coptic");new cd(1279,"U+0400..U+04FF Cyrillic");new cd(1327,"U+0500..U+052F Cyrillic Supplement");new cd(1423,"U+0530..U+058F Armenian");new cd(1535,"U+0590..U+05FF Hebrew");new cd(1791,"U+0600..U+06FF Arabic");new cd(1871,"U+0700..U+074F Syriac");new cd(1919,"U+0750..U+077F Arabic Supplement");new cd(1983,"U+0780..U+07BF Thaana");new cd(2047,"U+07C0..U+07FF NKo");new cd(2111,"U+0800..U+083F Samaritan");new cd(2143,"U+0840..U+085F Mandaic");new cd(2303,"U+08A0..U+08FF Arabic Extended-A");
new cd(2431,"U+0900..U+097F Devanagari");new cd(2559,"U+0980..U+09FF Bengali");new cd(2687,"U+0A00..U+0A7F Gurmukhi");new cd(2815,"U+0A80..U+0AFF Gujarati");new cd(2943,"U+0B00..U+0B7F Oriya");new cd(3071,"U+0B80..U+0BFF Tamil");new cd(3199,"U+0C00..U+0C7F Telugu");new cd(3327,"U+0C80..U+0CFF Kannada");new cd(3455,"U+0D00..U+0D7F Malayalam");new cd(3583,"U+0D80..U+0DFF Sinhala");new cd(3711,"U+0E00..U+0E7F Thai");new cd(3839,"U+0E80..U+0EFF Lao");new cd(4095,"U+0F00..U+0FFF Tibetan");new cd(4255,
"U+1000..U+109F Myanmar");new cd(4351,"U+10A0..U+10FF Georgian");new cd(4607,"U+1100..U+11FF Hangul Jamo");new cd(4991,"U+1200..U+137F Ethiopic");new cd(5023,"U+1380..U+139F Ethiopic Supplement");new cd(5119,"U+13A0..U+13FF Cherokee");new cd(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new cd(5791,"U+1680..U+169F Ogham");new cd(5887,"U+16A0..U+16FF Runic");new cd(5919,"U+1700..U+171F Tagalog");new cd(5951,"U+1720..U+173F Hanunoo");new cd(5983,"U+1740..U+175F Buhid");new cd(6015,"U+1760..U+177F Tagbanwa");
new cd(6143,"U+1780..U+17FF Khmer");new cd(6319,"U+1800..U+18AF Mongolian");new cd(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new cd(6479,"U+1900..U+194F Limbu");new cd(6527,"U+1950..U+197F Tai Le");new cd(6623,"U+1980..U+19DF New Tai Lue");new cd(6655,"U+19E0..U+19FF Khmer Symbols");new cd(6687,"U+1A00..U+1A1F Buginese");new cd(6831,"U+1A20..U+1AAF Tai Tham");new cd(7039,"U+1B00..U+1B7F Balinese");new cd(7103,"U+1B80..U+1BBF Sundanese");new cd(7167,"U+1BC0..U+1BFF Batak");
new cd(7247,"U+1C00..U+1C4F Lepcha");new cd(7295,"U+1C50..U+1C7F Ol Chiki");new cd(7375,"U+1CC0..U+1CCF Sundanese Supplement");new cd(7423,"U+1CD0..U+1CFF Vedic Extensions");new cd(7551,"U+1D00..U+1D7F Phonetic Extensions");new cd(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new cd(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new cd(7935,"U+1E00..U+1EFF Latin Extended Additional");new cd(8191,"U+1F00..U+1FFF Greek Extended");new cd(8303,"U+2000..U+206F General Punctuation");
new cd(8351,"U+2070..U+209F Superscripts and Subscripts");new cd(8399,"U+20A0..U+20CF Currency Symbols");new cd(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new cd(8527,"U+2100..U+214F Letterlike Symbols");new cd(8591,"U+2150..U+218F Number Forms");new cd(8703,"U+2190..U+21FF Arrows");new cd(8959,"U+2200..U+22FF Mathematical Operators");new cd(9215,"U+2300..U+23FF Miscellaneous Technical");new cd(9279,"U+2400..U+243F Control Pictures");new cd(9311,"U+2440..U+245F Optical Character Recognition");
new cd(9471,"U+2460..U+24FF Enclosed Alphanumerics");new cd(9599,"U+2500..U+257F Box Drawing");new cd(9631,"U+2580..U+259F Block Elements");new cd(9727,"U+25A0..U+25FF Geometric Shapes");new cd(9983,"U+2600..U+26FF Miscellaneous Symbols");new cd(10175,"U+2700..U+27BF Dingbats");new cd(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new cd(10239,"U+27F0..U+27FF Supplemental Arrows-A");new cd(10495,"U+2800..U+28FF Braille Patterns");new cd(10623,"U+2900..U+297F Supplemental Arrows-B");
new cd(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new cd(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new cd(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new cd(11359,"U+2C00..U+2C5F Glagolitic");new cd(11391,"U+2C60..U+2C7F Latin Extended-C");new cd(11519,"U+2C80..U+2CFF Coptic");new cd(11567,"U+2D00..U+2D2F Georgian Supplement");new cd(11647,"U+2D30..U+2D7F Tifinagh");new cd(11743,"U+2D80..U+2DDF Ethiopic Extended");new cd(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new cd(11903,"U+2E00..U+2E7F Supplemental Punctuation");new cd(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new cd(12255,"U+2F00..U+2FDF Kangxi Radicals");new cd(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new cd(12351,"U+3000..U+303F CJK Symbols and Punctuation");new cd(12447,"U+3040..U+309F Hiragana");new cd(12543,"U+30A0..U+30FF Katakana");new cd(12591,"U+3100..U+312F Bopomofo");new cd(12687,"U+3130..U+318F Hangul Compatibility Jamo");new cd(12703,"U+3190..U+319F Kanbun");new cd(12735,
"U+31A0..U+31BF Bopomofo Extended");new cd(12783,"U+31C0..U+31EF CJK Strokes");new cd(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new cd(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new cd(13311,"U+3300..U+33FF CJK Compatibility");new cd(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new cd(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new cd(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new cd(42127,"U+A000..U+A48F Yi Syllables");new cd(42191,"U+A490..U+A4CF Yi Radicals");
new cd(42239,"U+A4D0..U+A4FF Lisu");new cd(42559,"U+A500..U+A63F Vai");new cd(42655,"U+A640..U+A69F Cyrillic Extended-B");new cd(42751,"U+A6A0..U+A6FF Bamum");new cd(42783,"U+A700..U+A71F Modifier Tone Letters");new cd(43007,"U+A720..U+A7FF Latin Extended-D");new cd(43055,"U+A800..U+A82F Syloti Nagri");new cd(43071,"U+A830..U+A83F Common Indic Number Forms");new cd(43135,"U+A840..U+A87F Phags-pa");new cd(43231,"U+A880..U+A8DF Saurashtra");new cd(43263,"U+A8E0..U+A8FF Devanagari Extended");new cd(43311,
"U+A900..U+A92F Kayah Li");new cd(43359,"U+A930..U+A95F Rejang");new cd(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new cd(43487,"U+A980..U+A9DF Javanese");new cd(43615,"U+AA00..U+AA5F Cham");new cd(43647,"U+AA60..U+AA7F Myanmar Extended-A");new cd(43743,"U+AA80..U+AADF Tai Viet");new cd(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new cd(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new cd(44031,"U+ABC0..U+ABFF Meetei Mayek");new cd(55215,"U+AC00..U+D7AF Hangul Syllables");new cd(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new cd(56191,"U+D800..U+DB7F High Surrogates");new cd(56319,"U+DB80..U+DBFF High Private Use Surrogates");new cd(57343,"U+DC00..U+DFFF Low Surrogates");new cd(63743,"U+E000..U+F8FF Private Use Area");new cd(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new cd(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new cd(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new cd(65039,"U+FE00..U+FE0F Variation Selectors");new cd(65055,"U+FE10..U+FE1F Vertical Forms");new cd(65071,"U+FE20..U+FE2F Combining Half Marks");
new cd(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new cd(65135,"U+FE50..U+FE6F Small Form Variants");new cd(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new cd(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new cd(65535,"U+FFF0..U+FFFF Specials");new cd(65663,"U+10000..U+1007F Linear B Syllabary");new cd(65791,"U+10080..U+100FF Linear B Ideograms");new cd(65855,"U+10100..U+1013F Aegean Numbers");new cd(65935,"U+10140..U+1018F Ancient Greek Numbers");new cd(65999,"U+10190..U+101CF Ancient Symbols");
new cd(66047,"U+101D0..U+101FF Phaistos Disc");new cd(66207,"U+10280..U+1029F Lycian");new cd(66271,"U+102A0..U+102DF Carian");new cd(66351,"U+10300..U+1032F Old Italic");new cd(66383,"U+10330..U+1034F Gothic");new cd(66463,"U+10380..U+1039F Ugaritic");new cd(66527,"U+103A0..U+103DF Old Persian");new cd(66639,"U+10400..U+1044F Deseret");new cd(66687,"U+10450..U+1047F Shavian");new cd(66735,"U+10480..U+104AF Osmanya");new cd(67647,"U+10800..U+1083F Cypriot Syllabary");new cd(67679,"U+10840..U+1085F Imperial Aramaic");
new cd(67871,"U+10900..U+1091F Phoenician");new cd(67903,"U+10920..U+1093F Lydian");new cd(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new cd(68095,"U+109A0..U+109FF Meoritic Cursive");new cd(68191,"U+10A00..U+10A5F Kharoshthi");new cd(68223,"U+10A60..U+10A7F Old South Arabian");new cd(68415,"U+10B00..U+10B3F Avestan");new cd(68447,"U+10B40..U+10B5F Inscriptional Parthian");new cd(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new cd(68687,"U+10C00..U+10C4F Old Turkic");new cd(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new cd(69759,"U+11000..U+1107F Brahmi");new cd(69839,"U+11080..U+110CF Kaithi");new cd(69887,"U+110D0..U+110FF Sora Sompeng");new cd(69967,"U+11100..U+1114F Chakma");new cd(70111,"U+11180..U+111DF Sharada");new cd(71375,"U+11680..U+116CF Takri");new cd(74751,"U+12000..U+123FF Cuneiform");new cd(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new cd(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new cd(92735,"U+16800..U+16A3F Bamum Supplement");new cd(94111,"U+16F00..U+16F9F Miao");new cd(110847,
"U+1B000..U+1B0FF Kana Supplement");new cd(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new cd(119295,"U+1D100..U+1D1FF Musical Symbols");new cd(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new cd(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new cd(119679,"U+1D360..U+1D37F Counting Rod Numerals");new cd(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new cd(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new cd(127023,"U+1F000..U+1F02F Mahjong Tiles");
new cd(127135,"U+1F030..U+1F09F Domino Tiles");new cd(127231,"U+1F0A0..U+1F0FF Playing Cards");new cd(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new cd(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new cd(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new cd(128591,"U+1F600..U+1F64F Emoticons");new cd(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new cd(128895,"U+1F700..U+1F77F Alchemical Symbols");new cd(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new cd(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new cd(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new cd(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new cd(917631,"U+E0000..U+E007F Tags");new cd(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new cd(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new cd(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(c.a)(Zc,"UnicodeBlocks",null,[1821]);class pj{constructor(){this.Z=
null}Nb(Q){this.Z=Q;this.Z.register(Fg,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").fa();this.Z.register(Zc,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").fa()}get name(){return"Common.App.SensitiveLogging"}init(){this.Z.resolve("Common.App.SensitiveLogging.IStringDifference");this.Z.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){aa.a.instance.jc(new pj)}}Object(c.a)(pj,
"SensitiveLoggingPackage",null,[2,3]);var Qb;(function(Q){Q[Q.myFiles=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.currentFolder=2]="currentFolder"})(Qb||(Qb={}));Object(c.b)("SharedFilePickerLandingLocation",Qb);class vk{constructor(Q){this.QXb=this.uzc=null;this._initialized=!1;this.gRf=Q}qzf(Q){this._initialized||(Q.Ty(Xg.a.fEi),Q.kI(Xg.a.fEi,Object(n.a)(this,this.pRl,"onReceivedPickerResponse")),this._initialized=!0)}hUh(Q){return this.QXb=new Promise((sa,bb)=>{const Cb={};Cb[Eg.a.HYl]=Q;this.uzc=
(dc,Oc)=>{""===Oc?(ua.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),sa(dc)):("Canceled"===Oc?ua.ULS.sendTraceTag(572548164,306,50,Oc):ua.ULS.sendTraceTag(556901065,306,10,Oc),bb(Oc))};this.gRf.execute(dc=>{this.qzf(dc);dc.Yg(Xg.a.RUl,Cb)})})}pRl(Q){this.uzc(Q.Values[Eg.a.vmm],void 0===Q.Values[Eg.a.Eeg]||null===Q.Values[Eg.a.Eeg]?"":Q.Values[Eg.a.Eeg])}efi(){return G.AFrameworkApplication.K.$("UiHostCommonFilePicker")}LBh(Q,sa,bb,Cb,dc,Oc,yd,md,Af=null){const wg={};wg[Eg.a.amm]=
Q;wg[Eg.a.titleText]=sa;wg[Eg.a.mQj]=bb;wg[Eg.a.nQj]=Cb;wg[Eg.a.oQj]=dc;wg[Eg.a.Dpk]=!0;wg[Eg.a.ayk]=Oc;wg[Eg.a.NYl]=yd;wg[Eg.a.MYl]=Qb[md];Af&&(null!=Af.yYd&&(wg[Eg.a.yYd]=Af.yYd),null!=Af.ygd&&(wg[Eg.a.ygd]=Af.ygd));return wg}}Object(c.a)(vk,"SharedFilePickerManager",null,[1814]);class Di{constructor(){this.Z=null}get name(){return"Common.App.SharedFilePicker"}Nb(Q){this.Z=Q;Q.register(vk,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").fa().zd(()=>
new vk(Q.Fa("Postmessage.IHostPostmessenger")))}init(){G.AFrameworkApplication.K.Do(()=>{this.qYb()})}qYb(){this.Z.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){aa.a.instance.jc(new Di)}}Object(c.a)(Di,"SharedFilePickerPackage",null,[2,3]);class nk extends Sys.EventArgs{constructor(Q){super();this.qIl=Q}}Object(c.a)(nk,"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class Hj{}Object(c.a)(Hj,"TypingSpeedMeterWindow",null,[]);class Sl{constructor(Q,sa,bb,Cb,
dc){this.Q6f=null;this.GRg=this.kVd=this.k9e=this.wxc=0;this.q$e=new m.a;this.Fx=Q;this.Rd=sa;this.Rd.SXd(Object(n.a)(this,this.$5b,"onCpuMeterFrameAvailable"));this.BFj=bb;this.luj=dc;this.YEj=Cb}iOj(Q){this.q$e.addHandler("TypingSpeedWindowAvailable",Q)}Cem(Q){this.q$e.removeHandler("TypingSpeedWindowAvailable",Q)}$5b(Q,sa){this.Q6f=sa.sod}Tgi(){var Q=this.Fx();Q-this.kVd>this.YEj&&this.TJi();this.wxc||(this.k9e=Q);this.kVd=Q;this.wxc++;this.wxc>=this.luj&&(this.q$e.raiseEvent("TypingSpeedWindowAvailable",
new nk(this.hth())),Q=new Hj,Q.TS=this.hth(),this.Q6f&&(Q.CP=this.Q6f.CP),Q.EC=this.GRg,this.BFj.track(Q),this.TJi())}TJi(){this.kVd=this.k9e=this.wxc=0}hth(){return 2>this.wxc?0:Math.round(6E4*(this.wxc-1)/(this.kVd-this.k9e))}cTm(Q){this.GRg=Q}dispose(){this.Rd.Wmg(Object(n.a)(this,this.$5b,"onCpuMeterFrameAvailable"))}}Object(c.a)(Sl,"TypingSpeedMeter",null,[1836]);class tj{constructor(Q){this.eNb=null;this.iq=new t.a;this.Fx=Q}initialize(Q,sa,bb,Cb){this.eNb||(this.eNb=new Sl(this.Fx,Q,sa,bb,
Cb),this.iq.We(this.eNb));return this.eNb}}Object(c.a)(tj,"TypingSpeedMeterProvider",null,[1816]);class lc{constructor(){this.p$e=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(G.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const Q=xa.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),sa=ek.a.Jp(xa.a.instance.Fa("Common.ICpuMeterProvider"));sa.continueWith(()=>{const bb=sa.result.iq.task;var Cb=new Ba.a(G.AFrameworkApplication.K.zb("TypingSpeedMeterWindowSamplingPercent",
0)/100);Cb=new ab.a(Object(n.a)(Cb,Cb.XBa,"shouldBeInSample"));const dc=M.a.bC(12,1,Cb),Oc=G.AFrameworkApplication.K.zb("TypingSpeedMeterWindowTimeoutMs",5E3),yd=G.AFrameworkApplication.K.zb("TypingSpeedMeterMaxKeystrokesPerWindow",5);bb.CWR(()=>this.p$e=Q.initialize(bb.result,dc,Oc,yd))})}}dispose(){this.p$e&&this.p$e.dispose()}Nb(Q){Q.register(tj,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").fa().zd(()=>new tj(la.a.af))}static main(){aa.a.instance.jc(new lc)}}
Object(c.a)(lc,"TypingSpeedMeterPackage",null,[2,3]);class Nk{create(Q){return new Ba.a(Q)}}Object(c.a)(Nk,"RandomSamplerFactory",null,[1221]);var Mf=b(9),jn=b(1036);class Ja{constructor(Q,sa,bb,Cb,dc){Q.Dkh(()=>{Cb.dvd()});Q.Kkh((Oc,yd)=>{Cb.avd(yd.revisionId,yd.JMa)});Q.YXd((Oc,yd)=>{Cb.hcl(yd.LKi,yd.JMa,yd.ize)});Q.Ckh(()=>{Cb.Yng()});sa.eOj((Oc,yd)=>{Cb.bKm(yd.IIi,yd.fze,yd.actualValue)});sa.cNj((Oc,yd)=>{Cb.aKm(yd.IIi,yd.fze,yd.actualValue)});dc.N_c(()=>{Cb.hCd()});bb.j5((Oc,yd)=>{6===yd.type&&
Cb.PBc(yd.l8)})}}Object(c.a)(Ja,"EventForwarder",null,[]);class sb{constructor(Q,sa,bb){this.xvj=Q;this.IU=bb;this.Ckc=sa}create(Q,sa){return new Ja(this.xvj,this.Ckc,Q,sa,this.IU)}}Object(c.a)(sb,"EventForwarderFactory",null,[]);var Yb=b(271);class vc{}vc.hOm="TypingToOutboundReplicationStart";vc.nVl="OutboundReplicationStartToOutboundReplicationEnd";vc.tLi="RtcNotificationToInboundReplicationEnd";vc.h3i="TypingToInboundReplicationEnd";Object(c.a)(vc,"PerfTrackerPhases",null,[]);class $c{constructor(Q,
sa,bb,Cb,dc,Oc,yd,md,Af=null){this.iYe=this.D2g=!1;this.g_e=5;this.Q3g=50;this.IYe=20;this.fXe=this.vYe=this.XCa=null;this.vKc=this.iKc=0;this.D7e=this.J8e=!1;this.NUd=Array(7);this.mHc=null;this.hXg=!1;this.AJe=null;this.kyj={};this.rLd=Q;this.L1a=sa;this.duj=bb;this.yYg=Cb.create(vc.tLi,dc,Oc,20,!1);this.LVd=Cb.create(vc.h3i,yd,md,20,!0);if(this.ra=G.AFrameworkApplication.K)this.D2g=this.ra.$("LogSteppedInboundFrameIsEnabled"),this.iYe=this.ra.$("LogTasksDetailsFromCPUMeterIsEnabled"),this.IYe=
this.ra.zb("InboundFrameMaxNumberOfLongRunningTasks",20),this.Q3g=this.ra.zb("InboundFrameMinLengthForLongRunningTasksInMs",50),this.g_e=this.ra.zb("InboundFrameNumberOfLastShortTasks",5);this.XEb=Af}get K4j(){null==this.AJe&&(this.AJe=!!this.ra&&this.ra.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.AJe}get oma(){return this.kyj}initialize(Q){this.XCa=Q}lgm(Q,sa,bb=null){this.Hvh();ua.ULS.shipAssertTag(8229761,324,0<Q.length);let Cb=!1;for(let Oc of Q){const yd=Oc.toString();
if(yd in this.oma){var dc=this.oma[yd];if(!dc.lCc){dc.BOi(Q,sa,bb);if(this.iYe&&!Cb){const md=this.Xwk(),Af=this.hFk(this.mHc);Cb=!0;this.Ali(Oc.toString(),dc,md,this.fXe,this.NUd,Af)}else this.Ali(Oc.toString(),dc,null,null,this.NUd,null);delete this.oma[yd]}}else dc=this.rLd.create(this.yYg,this.LVd),dc.BOi(Q,sa),this.oma[yd]=dc}this.D7e=!1}PBc(Q){ua.ULS.shipAssertTag(8257930,304,Q.mgi,"Expected data not sent on the wire");if(Q.mgi){if(Q.gte in this.oma){var sa=this.oma[Q.gte];sa.xte||(sa.PBc(Q.revisionId,
Q.txi,Q.pUi,Q.JMa),delete this.oma[Q.gte])}else sa=this.rLd.create(this.yYg,this.LVd),sa.PBc(Q.revisionId,Q.txi,Q.pUi,Q.JMa),this.oma[Q.gte]=sa;this.Hvh()}}odl(){this.J8e||(this.vYe=Array(this.IYe),this.fXe=Array(this.g_e),this.vKc=this.iKc=0,this.NUd=[0,0,0,0,0,0,0,0],this.mHc=Array(3),this.mHc[1]=[0,0],this.mHc[2]=[0,0],this.J8e=!0)}Aym(Q){return!Q.TP&&Q.TN===K.a.GIi&&(Q=Yb.a(this.oma))&&Q[0]?!0:!1}hNl(Q){this.J8e=!1;const sa=Yb.a(this.oma);sa&&sa[0]&&(Q.TRT>=this.Q3g&&this.iKc<this.IYe?this.vYe[this.iKc++]=
Q:(this.fXe[this.vKc]=Q,this.vKc=this.vKc<this.g_e-1?this.vKc+1:0),this.$Al(Q),this.kBl(Q))}gNl(){this.iYe&&(this.odl(),this.D7e=!0)}$Al(Q){this.NUd[Q.TP]++}kBl(Q){if(Q&&Q.UI){const sa=this.mHc[Q.UI];sa[0]+=1;sa[1]+=Q.TRT}}hFk(Q){const sa={};Q&&(Q[1]&&(sa.Typing=Q[1]),Q[2]&&(sa.Clicking=Q[2]));return sa}Xwk(){return this.iKc?this.vYe.slice(0,this.iKc-1):null}Hvh(){var Q=Yb.a(this.oma);if(Q&&(this.hXg||this.vBl(Q),Q.length>this.duj))for(let sa of Q){Q=this.oma[sa];const bb=Q.createdTime,Cb=this.L1a();
6E4<Cb-bb&&(y.b(8438528,304,50,"{0}",{["Not Received"]:Q.lCc?"RtcNotification":"ServerRevision",["Duration"]:Cb-bb}),Q.lCc||y.b(42075798,304,15,"{0}",{["RevisionId"]:sa,["Duration"]:Cb-bb}),delete this.oma[sa])}}vBl(Q){if(this.K4j&&this.XEb)for(let sa of Q)if(Q=this.oma[sa],Q.xte&&!Q.lCc&&(Q=Q.createdTime,2E3<this.L1a()-Q)){let bb=null;Mf.App.oa&&Mf.App.oa.Ca&&Mf.App.oa.Ca.Rb&&(bb=Mf.App.oa.Ca.Rb.contentReplicator);this.XEb.execute(Cb=>{Cb.flush(bb,1)});this.hXg=!0}}Ali(Q,sa,bb,Cb,dc,Oc){this.D2g&&
(sa=sa.SEk())&&(sa.RevisionId=Q,sa.LRTWR=bb,sa.LSTWR=Cb,sa.TSD=dc,sa.UIWR=Oc,this.XCa&&this.XCa.track(sa))}}Object(c.a)($c,"InboundMonitor",null,[1898]);class Md{constructor(Q,sa,bb,Cb){this.KKb=Q;this.pw=sa;this.rLd=bb;this.WEj=Cb}create(Q,sa,bb,Cb,dc=null){return new $c(this.rLd,this.pw,50,this.WEj,Q,sa,bb,Cb,dc)}}Object(c.a)(Md,"InboundMonitorFactory",null,[1862]);var Re=b(248);class Qf{}Qf.wBe="UserCount";Qf.jjm="RevisionChainLength";Object(c.a)(Qf,"PerfTrackerPivotNames",null,[]);class Xa{}Object(c.a)(Xa,
"PerfTrackingContext",null,[]);const vb=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class Pb{}Object(c.a)(Pb,"SteppedInboundFrame",null,[]);class oc{constructor(Q,sa,bb,Cb,dc){this.tLd=null;this.je=Mf.App.Ob;this.Wmb=null;this.uYg=500;this.sLd=this.m4=this.IHb=this.Bgc=this.qFd=-1;this.gMg=null;this.dbh=this.dah=!1;this.J$g=null;this.Y6g=this.Bia=0;this.KKb=Q;this.sLe=sa();this.BTd=!1;this.A0e=0;this.YJb=bb;this.Xpj=Cb;this.LVd=dc;G.AFrameworkApplication.K&&
(this.uYg=G.AFrameworkApplication.K.zb("InboundFrameSamplingMinimalTotalTimeMs",500))}get xte(){return this.dah}get lCc(){return this.dbh}get MKi(){return this.J$g}get createdTime(){return this.sLe}get JMa(){return this.Bia}get mVl(){return this.Y6g}get lTb(){return this.YJb()}PBc(Q,sa,bb,Cb){this.xte||(this.BTd=bb,this.A0e=sa,this.qFd=F.a.YQ(la.a.af(),2),this.gMg=(new Date).toISOString(),this.Wmb=Q,this.Y6g=Cb,this.dah=!0,this.lCc?this.IJh():(this.OXi(),ia.a.instance.Qp(Q.toString()+"Start"),Re.a.instance.pje(2)))}BOi(Q,
sa,bb=null){this.lCc||(this.Bia=sa,this.dbh=!0,this.J$g=Q,this.sLd=F.a.YQ(la.a.af(),2),this.xte&&(ia.a.instance.Qp(this.Wmb.toString()+"End"),bb&&(this.Bgc=bb.xJi,this.IHb=bb.D7,this.m4=bb.HIi),Re.a.instance.A0d(),this.IJh()))}SEk(){if(!(0<this.qFd&&0<this.Bgc&&0<this.IHb&&0<this.m4&&0<this.sLd))return null;const Q=new Pb;Q.TT=F.a.YQ(this.sLd-this.qFd,2);if(Q.TT<this.uYg)return null;Q.ST=this.gMg;Q.UC=this.lTb;Q.RS=F.a.YQ(this.Bgc-this.qFd,2);Q.SR=F.a.YQ(this.IHb-this.Bgc,2);Q.RRS=F.a.YQ(this.m4-
this.IHb,2);Q.RP=F.a.YQ(this.sLd-this.m4,2);Q.ResponseLanded=F.a.YQ(this.IHb,2);0<Q.RS?(ia.a.instance.YN("RTCToRequestSent",this.Wmb.toString()+"Start","RequestInvoked"+this.Bgc),ia.a.instance.YN("RequestSentToResponseReceived","RequestInvoked"+this.Bgc,"RequestCompleted"+this.IHb),ia.a.instance.YN("ResponseReceivedToReplicationStart","RequestCompleted"+this.IHb,"ReplicationStart"+this.m4)):ia.a.instance.YN("RTCToReplicationStart",this.Wmb.toString()+"Start","ReplicationStart"+this.m4);ia.a.instance.YN("Replication",
"ReplicationStart"+this.m4,this.Wmb.toString()+"End");return Q}OXi(){this.tLd=this.KKb.create();this.tLd.start(vc.tLi,vc.h3i)}IJh(){this.tLd||this.OXi();const Q=this.tLd.end(this.BTd,this.Ygk());this.Xpj.Dse(Q);this.LVd.Dse(Q+this.A0e)}Ygk(){const Q={};Q[Qf.wBe]=vb(this.lTb);var sa=this.MKi.length;Q[Qf.jjm]=9>=sa?sa.toString():"10AndAbove";return Object.assign(new Xa,{P:Q,FC:this.JMa,CFC:this.mVl+this.JMa,ID:this.Wmb.toString(),CD:this.A0e,UC:this.lTb,RCL:this.MKi.length})}}Object(c.a)(oc,"InboundOperation",
null,[1888]);class zc{constructor(Q,sa,bb){this.xoa=Q;this.L1a=sa;this.YJb=bb}create(Q,sa){return new oc(this.xoa,this.L1a,this.YJb,Q,sa)}}Object(c.a)(zc,"InboundOperationFactory",null,[1861]);class Kc{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af){this.CTd=!0;this.c8g=this.BQd=null;this.x0e=Q;this.Vlj=sa;this.oyj=bb;this.Gh=Cb;this.r$e=dc.create("TypingToOutboundReplicationStart",Oc,yd,20,!1);this.T3e=dc.create("OutboundReplicationStartToOutboundReplicationEnd",md,Af,20,!1)}get heg(){return this.BQd}get Toe(){return this.c8g}hCd(){!this.heg&&
this.CTd&&(this.CTd=this.Vlj())&&(this.BQd=this.x0e.create(Object(n.a)(this,this.$Q,"sendUpdateNotification"),this.oyj(),this.r$e,this.T3e),this.heg.hCd())}dvd(){this.CTd=!0;this.c8g=this.heg;this.Toe&&(this.BQd=null,this.Toe.dvd())}Yng(){this.BQd=null}avd(Q,sa){this.Toe&&this.Toe.avd(Q,sa)}$Q(Q){this.Gh.$Q(6,Q)}}Object(c.a)(Kc,"OutboundMonitor",null,[]);class Sc{constructor(Q,sa){this.x0e=Q;this.sxj=sa}create(Q,sa,bb,Cb,dc,Oc,yd){return new Kc(this.x0e,Q,sa,bb,this.sxj,Cb,dc,Oc,yd)}}Object(c.a)(Sc,
"OutboundMonitorFactory",null,[]);var ae=b(48);class Bd{constructor(Q){this.lnb=Q}get u6l(){return this.lnb}Pa(Q){return!!this.lnb&&Q in this.lnb}get mgi(){return this.Pa(Bd.c5d)&&this.Pa(Bd.z9b)&&this.Pa(Bd.uxg)}get revisionId(){if(this.Pa(Bd.z9b))return ae.a.pe(this.lnb[Bd.z9b]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get gte(){if(this.Pa(Bd.z9b))return this.lnb[Bd.z9b];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");
}get txi(){if(this.Pa(Bd.c5d))return Number.parseInvariant(this.lnb[Bd.c5d]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get pUi(){if(this.Pa(Bd.z9b))return Boolean.parse(this.lnb[Bd.uxg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get JMa(){if(this.Pa(Bd.R8f))return Number.parseInvariant(this.lnb[Bd.R8f]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static Tek(Q){return new Bd(Q)}static Xek(Q,
sa,bb,Cb){const dc={};dc[Bd.c5d]=Q.toString();dc[Bd.z9b]=sa.toString();dc[Bd.uxg]=bb.toString();dc[Bd.R8f]=Cb.toString();return new Bd(dc)}}Bd.z9b="RevisionID";Bd.c5d="Duration";Bd.uxg="ShouldSample";Bd.R8f="NumSequentialFailures";Object(c.a)(Bd,"ReplicationNotificationMessage",null,[1885]);class Rf{constructor(Q,sa,bb,Cb,dc,Oc,yd){this.ym=this.If=0;this.pKb=this.VYc=null;this.je=Mf.App.Ob;this.KGe=[];this.W8g=null;this.tJd={};this.Bia=0;this.KKb=Q;this.oBj=sa;this.L1a=bb;this.YJb=Cb;this.Obh=dc;
this.Wmb=null;this.tJd.TypingStartStage=null;this.tJd.ReplicationStartStage="TypingStartStage";this.tJd.ReplicationEndStage="ReplicationStartStage";this.Qfh=1<this.lTb;this.r$e=Oc;this.T3e=yd}get lTb(){return this.YJb()}hCd(){this.Nlf("TypingStartStage")&&(this.akg("TypingStartStage"),ua.ULS.shipAssertTag(8257931,324,!this.pKb&&!this.ym,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.If=this.L1a(),this.VYc=this.KKb.create(),this.FXi(this.VYc,vc.hOm))}dvd(){if(this.Nlf("ReplicationStartStage")){this.akg("ReplicationStartStage");
ua.ULS.shipAssertTag(8257932,324,!!this.VYc,"TypingStart not called");if(this.VYc){const Q=this.CJh(this.VYc,this.Wmb);this.r$e.Dse(Q)}this.pKb=this.KKb.create();this.FXi(this.pKb,vc.nVl)}}avd(Q,sa){this.Nlf("ReplicationEndStage")&&(this.akg("ReplicationEndStage"),this.ym=this.L1a(),this.Bia=sa,ua.ULS.shipAssertTag(8257933,324,!!this.pKb,"ReplicationStart not called"),this.pKb&&(ua.ULS.shipAssertTag(8193425,324,!!this.pKb,"ReplicationStart not called"),sa=this.CJh(this.pKb,Q),this.T3e.Dse(sa)),ua.ULS.shipAssertTag(8257934,
324,!!this.If,"StartTime not set. No message sent to other editors."),this.If&&(Q=Bd.Xek(this.ym-this.If,Q,this.Obh,this.Bia),this.oBj(Q.u6l)))}Nlf(Q){if(this.tJd[Q]===this.W8g)return!0;ua.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.aIj()});return!1}aIj(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let sa=0;sa<this.KGe.length;sa++)Q.append(" "+this.KGe[sa]);return Q.toString()}akg(Q){Array.add(this.KGe,Q);this.W8g=Q}FXi(Q,sa){this.Qfh&&Q.start(sa)}CJh(Q,
sa){if(!this.Qfh)return-1;const bb={};bb[Qf.wBe]=vb(this.lTb);sa=Object.assign(new Xa,{P:bb,FC:this.Bia,CFC:0,ID:sa?sa.toString():"",CD:0,UC:this.lTb,RCL:0});return Q.end(this.Obh,sa)}}Object(c.a)(Rf,"OutboundOperation",null,[1887]);class Ad{constructor(Q,sa,bb){this.KKb=Q;this.L1a=sa;this.YJb=bb}create(Q,sa,bb,Cb){return new Rf(this.KKb,Q,this.L1a,this.YJb,sa,bb,Cb)}}Object(c.a)(Ad,"OutboundOperationFactory",null,[1860]);class Yd{constructor(Q,sa){this.EQg=this._name=this.kE=null;this.Gc=Q;this.XCa=
sa}start(Q,sa=null){this.kE=this.Gc.le("UserAction",Q);this._name=Q;this.EQg=sa}end(Q,sa){let bb=-1;Q&&(bb=this.kE.eg,sa.D=bb,sa.CN=this.EQg,sa.CD+=bb,this.XCa.track(sa,this._name));return bb}}Object(c.a)(Yd,"PerfTracker",null,[1886]);class Sd{constructor(Q,sa){this.Gc=Q;this.XCa=sa}create(){return new Yd(this.Gc,this.XCa)}}Object(c.a)(Sd,"PerfTrackerFactory",null,[1859]);class Jf{constructor(Q,sa,bb){this.NTc=null;this.rxj=Q;this.xYg=sa;this.gjc=bb}init(Q,sa,bb,Cb,dc,Oc,yd){sa=this.gjc.create(sa/
100);bb=this.gjc.create(bb/100);this.NTc=this.rxj.create(Object(n.a)(sa,sa.XBa,"shouldBeInSample"),Object(n.a)(bb,bb.XBa,"shouldBeInSample"),Q,Cb,dc,Oc,yd)}hCd(){this.NTc.hCd()}dvd(){this.NTc.dvd()}Yng(){this.NTc.Yng()}avd(Q,sa){this.NTc.avd(Q,sa)}hcl(Q,sa,bb=null){this.xYg.lgm(Q,sa,bb)}PBc(Q){Q=Bd.Tek(Q);this.xYg.PBc(Q);ia.a.instance.Qp(Q.revisionId+"Start")}bKm(Q,sa,bb){y.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.J2d(Q,sa,bb))}aKm(Q,sa,bb){y.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",
this.J2d(Q,sa,bb))}J2d(Q,sa,bb){const Cb={};Cb.PhaseName=Q;Cb.ThresholdValue=sa;Cb.ActualValue=bb;return Cb}}Object(c.a)(Jf,"ReplicationTelemetryManager",null,[]);var Fi=b(571);class dm extends Fi.a{constructor(Q,sa){super(Q,sa);this.Eh=this.mUd=0}vma(Q){this.mUd+=Q;this.Eh++}getValue(){return this.Eh?this.mUd/this.Eh:0}xZa(){this.Eh=this.mUd=0}}Object(c.a)(dm,"AverageMetric",Fi.a,[]);class hi extends Fi.a{constructor(Q,sa){super(Q,sa);this.tFa=0}vma(Q){Q>this.tFa&&(this.tFa=Q)}getValue(){return this.tFa}xZa(){this.tFa=
0}}Object(c.a)(hi,"MaxMetric",Fi.a,[]);var jj=b(1596);class ac extends Fi.a{constructor(Q,sa,bb=100){super(Q,sa);this.tOd=this.bic=this.pkc=0;this.wSd=bb;this.V4e=new jj.a(this.wSd)}vma(Q){if(this.bic===this.wSd){const sa=this.V4e.dequeue();this.pkc-=sa;this.bic--}this.V4e.enqueue(Q);this.pkc+=Q;this.bic++;Q=this.pkc/this.bic;Q>this.tOd&&this.bic===this.wSd&&(this.tOd=Q)}getValue(){return this.tOd}xZa(){this.tOd=0;this.V4e=new jj.a(this.wSd);this.bic=this.pkc=0}}Object(c.a)(ac,"MaxRollingAverageMetric",
Fi.a,[]);class Tn extends Fi.a{constructor(Q,sa){super(Q,sa);this.Eh=0}vma(){this.Eh++}getValue(){return this.Eh}xZa(){this.Eh=0}}Object(c.a)(Tn,"CounterMetric",Fi.a,[]);class yl{constructor(Q,sa){this.BNb=sa;this.THe=new dm(Q+"-AverageValue","Milliseconds");this.HYe=new hi(Q+"-MaxValue","Milliseconds");this.OYe=new ac(Q+"-MaxRollingAverageValue","Milliseconds");this.lLe=new Tn(Q+"-NumberOfEvents","Count");this.pxa=new ja.a(Q+"-SlowPercentileAtValue","Percentile",G.AFrameworkApplication.K.MH("CoAuthLatencySlowTargetValue",
3E3),G.AFrameworkApplication.K.MH("CoAuthLatencySlowThresholdPercentile",95),this.BNb);this.oxa=new ja.a(Q+"-BrokenSlowPercentileAtValue","Percentile",G.AFrameworkApplication.K.MH("CoAuthLatencyBrokenSlowTargetValue",5E3),G.AFrameworkApplication.K.MH("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.BNb)}u2(Q){this.THe.vma(Q);this.HYe.vma(Q);this.OYe.vma(Q);this.lLe.vma(Q);this.pxa.vma(Q);this.oxa.vma(Q)}fre(){this.THe.yBa();this.HYe.yBa();this.OYe.yBa();this.lLe.yBa();this.pxa.yBa();this.oxa.yBa();
this.THe.xZa();this.HYe.xZa();this.OYe.xZa();this.lLe.xZa();this.pxa.xZa();this.oxa.xZa()}}Object(c.a)(yl,"ReplicationLatencyMetrics",null,[]);class em{constructor(){this.qXe=new hb.a}QEi(Q,sa,bb){if(!(0>sa)){if(!({value:Cb}=this.qXe.xb(Q,Cb)).returnValue){var Cb=new yl(Q,bb);this.qXe.W(Q,Cb)}Cb.u2(sa)}}fre(){for(let Q of this.qXe.values)Q.fre()}}Object(c.a)(em,"ReplicationTelemetryMetricsManager",null,[1858]);class dl{QEi(){}fre(){}}Object(c.a)(dl,"ReplicationTelemetryMetricsManagerStub",null,[1858]);
class Kn{constructor(Q,sa,bb,Cb,dc,Oc,yd){this.h6a=this.yVd=0;this.Cuj=Q;this.U1e=bb;this.heh=Cb;this.$Ng=dc;this.Ckc=sa;this.Duj=Oc;this.BNb=yd}Dse(Q){this.Cuj.QEi(this.U1e,Q,this.BNb);Q>this.heh&&this.Ckc.MJm(this.U1e,this.heh,Q);this.yVd+=Q;this.h6a++;this.yVd/this.h6a>this.$Ng&&this.h6a>this.Duj&&this.Ckc.uVj(this.U1e,this.$Ng,this.yVd/this.h6a)}}Object(c.a)(Kn,"TimeSpanVerifier",null,[1884]);class io{constructor(Q,sa){this.kAj=Q;this.Ckc=sa}create(Q,sa,bb,Cb,dc){return new Kn(this.kAj,this.Ckc,
Q,sa,bb,Cb,dc)}}Object(c.a)(io,"TimeSpanVerifierFactory",null,[1857]);class bc extends Sys.EventArgs{constructor(Q,sa,bb){super();this.IIi=Q;this.fze=sa;this.actualValue=bb}}Object(c.a)(bc,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class th{constructor(){this.la=new m.a}MJm(Q,sa,bb){this.la.raiseEvent("TSVTE",new bc(Q,sa,bb))}uVj(Q,sa,bb){this.la.raiseEvent("TSVATE",new bc(Q,sa,bb))}eOj(Q){this.la.addHandler("TSVTE",Q)}cNj(Q){this.la.addHandler("TSVATE",Q)}}Object(c.a)(th,"TimeSpanVerifierNotifier",
null,[1811]);class Gh{constructor(){this.Z=this.ra=null}get name(){return"Box4.ReplicationTelemetry"}Nb(Q){this.ra=Q.resolve("Common.IAppSettingsManager");this.Z=Q;if(this.ra.$("Box4ReplicationTelemetryIsEnabled")){Q.ia("ReplicationTelemetry.IPerfTrackerFactory",()=>new Sd(Mf.App.oa.so,M.a.bC(20,1,new R.a))).fa();Q.ia("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new th).fa();this.ra.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",
()=>new em).fa():Q.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new dl).fa();Q.ia("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new io(Q.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).fa();Q.ia("ReplicationTelemetry.OutboundOperationFactory",()=>new Ad(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Gh.PTh)).fa();Q.ia("ReplicationTelemetry.OutboundMonitorFactory",
()=>new Sc(Q.resolve("ReplicationTelemetry.OutboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).fa();Q.ia("ReplicationTelemetry.InboundOperationFactory",()=>new zc(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Gh.PTh)).fa();var sa=new Md(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Q.resolve("ReplicationTelemetry.InboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),
bb=this.ra.$("ComponentStateLoggingPackageIsEnabled")?this.Z.Fa("Common.IComponentStateLogManager"):null;Q.ia("ReplicationTelemetry.IInboundMonitor",()=>sa.create(this.ra.zb("Box4ReplicationTelemetryInboundOperationThreshold",0),this.ra.zb("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.ra.zb("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.ra.zb("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),bb)).fa();Q.ia("Common.IRandomSamplerFactory",()=>new Nk).fa();
Q.ia("ReplicationTelemetry.ReplicationTelemetryManager",()=>new Jf(Q.resolve("ReplicationTelemetry.OutboundMonitorFactory"),Q.resolve("ReplicationTelemetry.IInboundMonitor"),Q.resolve("Common.IRandomSamplerFactory"))).fa();Q.ia("ReplicationTelemetry.EventForwarderFactory",()=>new sb(jn.a.instance,Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),Q.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.ra.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.ra.zb("Box4ReplicationTelemetrySamplePercent",
0),sa=this.ra.zb("Box4ReplicationTelemetryPhaseSamplePercent",0),bb=this.ra.zb("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Cb=this.ra.zb("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),dc=this.ra.zb("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),Oc=this.ra.zb("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),yd=this;this.Z.Fa("Box4.Presence.IRtcProxyProvider").execute(Af=>{Af.dG().continueWith(()=>{const wg=
Af.dG().result,Zg=yd.Z.resolve("ReplicationTelemetry.ReplicationTelemetryManager");Zg.init(wg,Q,sa,bb,Cb,dc,Oc);yd.Z.resolve("ReplicationTelemetry.EventForwarderFactory").create(wg,Zg);if(yd.ra.$("LogSteppedInboundFrameIsEnabled")){const Wh=ek.a.Jp(yd.Z.Fa("Common.ICpuMeterProvider"));Wh.continueWith(()=>{const vh=yd.Z.resolve("ReplicationTelemetry.IInboundMonitor");var sl=new ab.a(()=>!0);sl=M.a.bC(19,1,sl);vh.initialize(sl);const qh=Wh.result.iq.task;qh.continueWith(()=>{qh.result.iXd(0,()=>vh.D7e,
Cd=>{vh.hNl(Cd)});qh.result.iXd(1,Cd=>vh.Aym(Cd),()=>{vh.gNl()})})})}ua.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var md=this;G.AFrameworkApplication.qO(()=>{md.Z.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").fre()})}}dispose(){}static PTh(){const Q=Mf.App.Ob;return Q?Q.lyf:0}}Object(c.a)(Gh,"ReplicationTelemetryPackage",null,[2,3]);var dh=b(1016),yj=b(50),ng=b(17),oh=b(137),ve=b(3),Kf=b(243),Ki=b(183),fm=b(270),fk=b(19),Nh=b(25),wk=b(10),cg=b(1708);class Oh{static get lf(){return cf.a.Qv(Oh.zk,
Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Oh.zk="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";Object(c.a)(Oh,"InsertSymbolsDialogHtml",null,[]);class $d extends cg.a{constructor(Q,sa,bb){super();this.qhc=this.$Sa=
this.bob=null;this.gTe=0;this.ea=Q;this.jb=sa;this.T5a=bb;this.Yd(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Yd(0,CommonUIStrings.l_DialogClose);this.pia=!1;this.lf=Oh.lf;this.mf="InsertSymbolsDialog"}dispose(){0<$d.M9e&&ua.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.gTe,$d.M9e);$d.wSg++;ua.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",$d.wSg);this.ea=this.T5a=null;super.dispose()}wBb(){this.qh(Box4Intl.Box4Strings.L_SymbolSingle,
Object(n.a)(this,this.$gl,"insertSymbolsDialogHandler"),null);this.gTe=0;$d.BSg++;ua.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",$d.BSg);const Q=this.yMf("symbol_d_"+$d.AQc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let sa=0;sa<Q.length;sa++)U.a.removeHandler(Q[sa],D.a.focus,Object(n.a)(this,this.dZi,"symbolFocusHandler"));super.hide()}$gl(Q){1===Q?(this.$$f("symbol_d_"+$d.AQc),this.jb.aM(this.LH,
!0),this.jb.Zj().Ci.hw(this.sF),this.sF.focus()):this.hide()}get iwb(){return $d.IQc}set iwb(Q){$d.IQc=Q}get gwb(){return $d.sQc}set gwb(Q){$d.sQc=Q}MT(){super.MT();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.T5a.HYj(),Q=Q.getElementsByTagName("a")))for(let sa=0;sa<Q.length;sa++)U.a.addHandler(Q[sa],D.a.focus,Object(n.a)(this,this.dZi,"symbolFocusHandler"))}yda(){const Q=document.getElementById("symbolsContainer");Q&&(this.bob||(this.bob=Object(n.a)(this,this.nHm,"symbolClickHandler"),
this.uo.Ma(D.a.click,Q,this.bob),this.uo.Ma(D.a.DE,Q,this.bob)),this.$Sa||(this.$Sa=Object(n.a)(this,this.pHm,"symbolKeyHandler"),this.nd.Ma(D.a.jh,Q,this.$Sa),this.nd.Ma(D.a.rs,Q,this.$Sa),this.nd.Ma(D.a.kh,Q,this.$Sa)));super.yda()}Mqb(){const Q=document.getElementById("symbolsContainer");Q&&(this.bob&&(this.uo.Ib(D.a.click,Q,this.bob),this.uo.Ib(D.a.DE,Q,this.bob),this.bob=null),this.$Sa&&(this.nd.Ib(D.a.jh,Q,this.$Sa),this.nd.Ib(D.a.rs,Q,this.$Sa),this.nd.Ib(D.a.kh,Q,this.$Sa),this.$Sa=null));
super.Mqb()}sSl(Q){this.GRi("symbol_d_"+$d.AQc,!1);$d.AQc=parseInt(Q.substr(Q.lastIndexOf("_")+1));this.GRi(Q,!0);if(Q=document.getElementById("SymbolNameValueLabel")){const sa=this.ksc($d.AQc);Q.innerText=sa.altText}}ksc(Q){const sa=this.T5a.oAd.oye.value,bb=Yb.a(sa);return sa[bb[Q]]}dZi(Q){if(Q.target!==this.qhc){const sa=this.jb.Zj();sa&&sa.Ci&&(sa.Ci.hw(Q.target),this.qhc=Q.target)}this.sSl(Q.target.id)}nHm(Q){const sa=Q.oe;if("a"!==sa.tagName.toLowerCase())return!1;Q.eventName===D.a.DE&&this.$$f(sa.id);
this.jb.aM(this.LH,!0);this.jb.Zj().Ci.hw(sa);sa.focus();return!0}pHm(Q){var sa=Q.oe;if("a"!==sa.tagName.toLowerCase())return!1;const bb=parseInt(sa.id.substr(sa.id.lastIndexOf("_")+1));if(Q.$a.ctrlKey||Q.$a.altKey||Q.$a.keyCode>=Ui.a.gHc&&Q.$a.keyCode<=Ui.a.qdc)return!1;if(Q.eventName===D.a.jh){Q=Q.$a.keyCode;let Cb=-1;Q===Sys.UI.Key.enter?(this.$$f(sa.id),this.jb.aM(this.LH,!0),this.jb.Zj().Ci.hw(sa),sa.focus()):Q===Sys.UI.Key.up?Cb=bb-15:Q===Sys.UI.Key.down?Cb=bb+15:Q===Sys.UI.Key.left?Cb=G.AFrameworkApplication.isRtl?
bb+1:bb-1:Q===Sys.UI.Key.right&&(Cb=G.AFrameworkApplication.isRtl?bb-1:bb+1);0<=Cb&&(sa=this.yMf("symbol_d_"+Cb))&&sa.focus()}return!0}$$f(Q){this.gTe++;$d.M9e++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const sa=this.ksc(Q),bb={};bb.SourceControlId="symbol_"+Q+"_"+sa.nye;this.ea.Db(ve.a.insertSymbol,2,bb);ua.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}yMf(Q){const sa=document.getElementById("symbolsContainer");return sa?sa.querySelector("#"+Q):null}GRi(Q,sa){(Q=
this.yMf(Q))&&(sa?Q.setAttribute("selected","true"):Q.removeAttribute("selected"))}}$d.AQc=0;$d.IQc=null;$d.sQc=null;$d.BSg=0;$d.wSg=0;$d.M9e=0;Object(c.a)($d,"InsertSymbolsDialog",cg.a,[]);class eg{constructor(Q,sa,bb,Cb,dc,Oc,yd,md){this.ea=Q;this.Lb=sa;this.ODj=new yb.a(Object(n.a)(this,this.Y0k,"getSymbolsDropDownMenuProps"));new yb.a(Object(n.a)(this,this.zMf,"getSymbolsDropDownXml"));this.q8e=Cb.oAd.oye;this.Qb=bb;this.T5a=Cb;this.sl=dc;this.Av=Oc;this.Da=yd;this.pl=md}Y0k(){return this.T5a.KZj()}zMf(){return this.T5a.build()}pb(){this.ea.La(ve.a.jig,
ng.a.application,Object(n.a)(this,this.jig,"queryInsertSymbols"),96);this.ea.na(ve.a.czb,ng.a.view,Object(n.a)(this,this.czb,"populateSymbolsDropDown"));this.ea.na(ve.a.nAd,ng.a.view,Object(n.a)(this,this.fZi,"symbolsDropDownOpenHandler"));this.ea.na(ve.a.qqe,ng.a.view,Object(n.a)(this,this.JCi,"querySymbolPositionHandler"));this.ea.na(ve.a.insertSymbol,ng.a.view,Object(n.a)(this,this.GWa,"insertSymbolViewHandler"));this.ea.na(ve.a.czb,ng.a.xc,Object(n.a)(this,this.czb,"populateSymbolsDropDown"));
this.ea.na(ve.a.nAd,ng.a.xc,Object(n.a)(this,this.fZi,"symbolsDropDownOpenHandler"));this.ea.na(ve.a.qqe,ng.a.xc,Object(n.a)(this,this.JCi,"querySymbolPositionHandler"));this.ea.na(ve.a.insertSymbol,ng.a.xc,Object(n.a)(this,this.Zgl,"insertSymbolHandler"));this.ea.pc(ve.a.czb,1124);this.ea.pc(ve.a.nAd,1036);this.ea.pc(ve.a.qqe,1124);this.ea.pc(ve.a.insertSymbol,1036);G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ea.na(ve.a.ztc,ng.a.view,Object(n.a)(this,
this.pVi,"showInsertMoreSymbolsDialogHandler")),this.ea.na(ve.a.ztc,ng.a.xc,Object(n.a)(this,this.pVi,"showInsertMoreSymbolsDialogHandler")),this.ea.pc(ve.a.ztc,1124))}JCi(Q,sa,bb,Cb,dc){if(1===bb)return 32;Q=this.T5a.Qyi(dc);Q=String.format(this.T5a.oHm,Q.character);dc[dh.a.InnerHTML]=Q;dc[dh.a.On]=!1;return 32}GWa(Q,sa,bb,Cb,dc){let Oc;if(({Xd:Oc,selected:yd,GWa:md}=this.G6c(sa,bb,Oc,yd,md)).returnValue)return md;var yd=fk.SelectionEditor.Le(yd);var md=!0;Q=8;bb=this.Qb.wc(15);bb.Wa(Oc.Xc);yd||
(Q=this.ea.Te(sa,ve.a.nra,2,!0,Cb,null),sa=32===Q,ua.ULS.shipAssertTag(6407387,348,sa,"DeleteForReplace did not succeed. Response is {0}",Q),md=sa);md&&(sa=Oc.ib.Fg,yd=fk.SelectionEditor.Le(sa),ua.ULS.shipAssertTag(6407388,348,yd,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",sa.contextId),Q=8,yd&&(Q=this.ea.Te(sa,ve.a.insertSymbol,2,!1,Cb,dc),ua.ULS.shipAssertTag(6407389,348,32===Q,"Insertion at IP context did not succeed. Response is {0}",Q),32===Q&&yj.FocusManager.instance().qf(Oc.KH)));
bb.dispose();return Q}G6c(Q,sa,bb,Cb,dc){bb=null;Q.view.Nc&&(bb=Q.view);Cb=null;if(!bb||!bb.ib)return y.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Q.toString()),{returnValue:!0,Xd:bb,selected:Cb,GWa:8};Cb=bb.ib.Fg;if(!Cb)return{returnValue:!0,Xd:bb,selected:Cb,GWa:2};if(this.Av.J(14)&&this.sl.Oja(Cb))return{returnValue:!0,Xd:bb,selected:Cb,GWa:8};if(bb.ib.Ia.UJ||this.pl&&this.pl.instance&&this.pl.instance.wQ(Cb)||
fk.SelectionEditor.bvb(Q.Km))return{returnValue:!0,Xd:bb,selected:Cb,GWa:2};if(eg.wg.LPa(wk.ParagraphReader.T1,Cb))return dc=8,eg.Zb.qb(Kf.a.Ie,{["Reason"]:Ki.a.GP}),{returnValue:!0,Xd:bb,selected:Cb,GWa:dc};dc=32;return 1===sa?{returnValue:!0,Xd:bb,selected:Cb,GWa:dc}:{returnValue:!1,Xd:bb,selected:Cb,GWa:dc}}Zgl(Q,sa,bb,Cb,dc){if(1===bb)return 32;if(fk.SelectionEditor.bvb(sa))return 2;Q=this.T5a.Qyi(dc);Cb.gs=Q.index;Cb=this.Lb.Sf(sa.node);bb=Cb.Na(11);ua.ULS.shipAssertTag(6379466,324,bb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
oh.a[sa.node.type]);bb=this.Qb.wc(15);bb.it(Cb);eg.characterPropertiesEditor.replaceTextRange(sa,Q.character,!0,!1);sa=Nh.SelectionFactory.$d(Cb.currentNode,sa.cpBegin+1);this.Da.setSelection(sa);bb.dispose();return 32}czb(Q,sa,bb,Cb,dc){if(1===bb)return 32;dc.MenuItems=this.ODj.value;return 32}fZi(Q,sa,bb){let Cb,dc,Oc;({Xd:Cb,selected:dc,GWa:Oc}=this.G6c(sa,bb,Cb,dc,Oc));return Oc}pVi(Q,sa,bb){2===bb&&(new $d(this.ea,yj.FocusManager.instance(),xa.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).wBb();
return 32}jig(){return 32}static get characterPropertiesEditor(){return eg.Hb||(eg.Hb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Q){eg.Hb=Q}static get wg(){return fm.ContextSetEditor.instance}static get Zb(){return Ci.a.instance}}eg.Hb=null;Object(c.a)(eg,"SymbolsActor",null,[1783]);class Nf{constructor(Q,sa){this.nye=Q;this.altText=sa}}Object(c.a)(Nf,"Symbol",null,[]);class ii{constructor(){this.p8e=null;this.q8e=new yb.a(ii.P5c)}get oye(){return this.q8e}sWh(Q){this.p8e||
(this.p8e=Yb.a(this.q8e.value));return Array.indexOf(this.p8e,Q)}static P5c(){const Q={};Q["\u2022"]=new Nf("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=new Nf("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new Nf("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Q["\u00a5"]=new Nf("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new Nf("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new Nf("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Q["\u2122"]=new Nf("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);
Q["\u00b1"]=new Nf("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Q["\u2260"]=new Nf("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=new Nf("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new Nf("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Q["\u00f7"]=new Nf("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new Nf("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new Nf("\u221e",Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new Nf("\u00b5",Box4Intl.Box4Strings.L_MicroSign);
Q["\u03b1"]=new Nf("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Q["\u03b2"]=new Nf("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Q["\u03c0"]=new Nf("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new Nf("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new Nf("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new Nf("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Q["\u0394"]=new Nf("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new Nf("\u263a",
Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new Nf("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new Nf("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Q["\u00bf"]=new Nf("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Q["\u00a1"]=new Nf("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new Nf("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new Nf("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new Nf("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);
Q["\u00c1"]=new Nf("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Q["\u00c2"]=new Nf("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Q["\u00c3"]=new Nf("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Q["\u00c4"]=new Nf("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new Nf("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Q["\u00c6"]=new Nf("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=
new Nf("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=new Nf("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new Nf("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new Nf("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new Nf("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=new Nf("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new Nf("\u00cd",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new Nf("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new Nf("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Q["\u00d1"]=new Nf("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new Nf("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new Nf("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new Nf("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);
Q["\u00d5"]=new Nf("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Q["\u00d6"]=new Nf("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=new Nf("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Q["\u00da"]=new Nf("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new Nf("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Q["\u00dc"]=new Nf("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=
new Nf("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=new Nf("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new Nf("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new Nf("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new Nf("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new Nf("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new Nf("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);
Q["\u00e6"]=new Nf("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new Nf("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Q["\u00e8"]=new Nf("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Q["\u00e9"]=new Nf("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new Nf("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Q["\u00eb"]=new Nf("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new Nf("\u00ec",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Q["\u00ed"]=new Nf("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new Nf("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new Nf("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new Nf("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new Nf("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new Nf("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);
Q["\u00f4"]=new Nf("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new Nf("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Q["\u00f6"]=new Nf("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Q["\u00f9"]=new Nf("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new Nf("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Q["\u00fb"]=new Nf("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new Nf("\u00fc",
Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Q["\u00ff"]=new Nf("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=new Nf("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=new Nf("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new Nf("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=new Nf("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new Nf("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);
Q["\u0153"]=new Nf("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new Nf("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Q["\u015f"]=new Nf("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Q["\u0178"]=new Nf("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(c.a)(ii,"SymbolsLoader",null,[1779]);var Uk=b(393),xd=b(327),Ld=b(216),kj=b(596),$h=b(1075),ji=b(301),Om=b(93);class Ul{constructor(Q){this.PDj=Q}get oAd(){return this.PDj}get oHm(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}Qyi(Q){Q=
Q.SourceControlId.split("_");const sa={};2===Q.length?(sa.character=Q[1],sa.index=this.oAd.sWh(sa.character)):(sa.character=Q[2],sa.index=parseInt(Q[1]));return sa}KZj(){return this.s0h()}build(){return this.zMf()}HYj(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');const sa=this.oAd.oye.value,bb=Yb.a(sa);let Cb=0;for(;Cb<bb.length;){Cb%15||Q.append('<tr role="presentation">');const dc=sa[bb[Cb]];Q.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Cb,$a.a.P1(dc.nye),$a.a.P1(dc.altText)));Cb++;Cb%15&&Cb!==bb.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}zMf(){const Q=this.s0h();return ji.t(Q)}s0h(){const Q=Object.assign(new Uk.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(Q.MenuSectionList,this.ILj());G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&Array.add(Q.MenuSectionList,this.fKj());return Q}fKj(){const Q=Object.assign(new xd.a,{Id:"msMoreSymbols",Title:"",
DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),sa=Object.assign(new Ld.a,{Id:"btnMoreSymbols",Command:ve.a.ztc.toString(),LabelText:$a.a.ve(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:$a.a.ve(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:G.AFrameworkApplication.Hp,Image16by16Class:Om.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(Q.ControlList,sa);return Q}ILj(){const Q=Object.assign(new xd.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),sa=Object.assign(new kj.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),bb=this.oAd.oye.value,Cb=Yb.a(bb),dc=Math.min(25,Cb.length);for(let yd=0;yd<dc;yd++){var Oc=bb[Cb[yd]];Oc=Object.assign(new $h.a,{Id:String.format("{0}{1}_{2}","symbol_",yd,Oc.nye),Character:Oc.nye,Command:ve.a.insertSymbol.toString(),QueryCommand:ve.a.qqe.toString(),Alt:$a.a.ve(Oc.altText)});sa.GalleryItems.push(Oc)}Array.add(Q.ControlList,
sa);return Q}}Object(c.a)(Ul,"SymbolsUiBuilder",null,[1778]);var Vl=b(47),Ok=b(221),of=b(13),Cn=b(618),Xo=b(324);class gm{constructor(){this.Z=null}get name(){return"Box4.Symbols"}init(){G.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.Z.resolve("Box4.Symbols.ISymbolsActor").pb()}dispose(){}Nb(Q){this.Z=Q;this.Z.register(ii,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").fa();this.Z.ia("Box4.Symbols.SymbolsUiBuilder",()=>new Ul(this.Z.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").fa();
this.Z.ia("Box4.Symbols.SymbolsActor",()=>new eg(G.AFrameworkApplication.qa,new Cn.a,new Xo.a,this.Z.resolve("Box4.Symbols.ISymbolsUIBuilder"),Ok.a.instance,of.a.instance,Vl.a.instance,this.Z.Fa("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").fa()}static main(){aa.a.instance.jc(new gm)}}Object(c.a)(gm,"Box4SymbolsPackage",null,[2,3]);var jl=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Pc=b(1291),Vd=b(1230),Kd=b(1208),zl=b(1635),hm=b(236),ph=b(261);class kn{constructor(){this.container=this.aQa=null}Nb(Q){this.container=Q}init(){this.aQa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.aQa&&this.aQa.dispose()}}Object(c.a)(kn,"ALiveBooksAccessibilityCheckPackageManager",
null,[2,3]);class Hl{get Dak(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get Eak(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get Fak(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get jVl(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Myb(){return CommonUIStrings.l_AccCheckerPaneTitle}get JXl(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(c.a)(Hl,"AccessibilityCheckStringsProvider",null,
[258]);class Eo{constructor(){this.zLi=this.contentId=null}}Object(c.a)(Eo,"ResultIds",null,[]);class Ln{constructor(Q,sa){this._element=null;this.Qd=sa;this.nd=Q}get element(){this._element||(this._element=this.Brf(),this.wz());return this._element}Qvg(Q){this._element=Q}dispose(){this.element&&(this.k3(),this.Qvg(null))}wz(){this.Qd&&this.nd?(this.Qd.Ma(D.a.click,this.element,Object(n.a)(this,this.onClick,"onClick")),this.nd.Ma(D.a.jh,this.element,Object(n.a)(this,this.XL,"onKeyPress"))):ua.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}k3(){this.Qd&&this.nd&&(this.Qd.Ib(D.a.click,this.element,Object(n.a)(this,this.onClick,"onClick")),this.nd.Ib(D.a.jh,this.element,Object(n.a)(this,this.XL,"onKeyPress")))}onClick(){this.vme();return!0}XL(Q){return this.Unl(Q.$a.keyCode)?(this.vme(),!0):!1}Unl(Q){return Q===Ui.a.PDd||Q===Ui.a.eq}}Object(c.a)(Ln,"AInteractivePaneElement",null,[278,13]);var zj=b(471),
bh=b(51);class Mn extends Ln{constructor(Q,sa,bb){super(Q,sa);this.B_e=bb}hide(){this.element.removeAttribute(Fd.a.lg);Fd.a.vq(this.element,Fd.a.gx,Fd.a.Nl);this.element.style.display="none"}show(){Fd.a.vq(this.element,Fd.a.gx,Fd.a.pL);Fd.a.vq(this.element,Fd.a.lg,Fd.a.jZd);this.element.style.display="block"}Brf(){const Q=zj.b("div",this.eri,"AccCheckerNotification");Fd.a.vq(Q,Fd.a.Ygf,Fd.a.Nl);Fd.a.vq(Q,Fd.a.xda,this.x8f);Q.tabIndex=0;const sa=zj.b("span",this.dri,"AccCheckerNotificationIcon");var bb=
Om.createClusteredImage(16,16,"Info_16x16x32","",!0,"");sa.appendChild(bb);bb=zj.b("span",this.x8f,"AccCheckerNotificationText");bh.a.eu(bb,this.fri);Q.appendChild(sa);Q.appendChild(bb);return Q}vme(){this.B_e()}}Object(c.a)(Mn,"APopupNotification",Ln,[277,278,13]);class ok extends Mn{constructor(Q,sa,bb,Cb){super(Q,sa,bb);this.Ixa=Cb}get eri(){return"AccCheckerOutOfSyncNotificationId"}get dri(){return"AccCheckerOutOfSyncNotificationIconId"}get x8f(){return"AccCheckerOutOfSyncNotificationTextId"}get fri(){return this.Ixa.jVl}}
Object(c.a)(ok,"OutOfSyncNotification",Mn,[]);class pk extends Mn{constructor(Q,sa,bb,Cb){super(Q,sa,bb);this.Ixa=Cb}get eri(){return"AccCheckerPartialResultNotificationId"}get dri(){return"AccCheckerPartialResultNotificationIconId"}get x8f(){return"AccCheckerPartialResultNotificationTextId"}get fri(){return this.Ixa.JXl}}Object(c.a)(pk,"PartialResultNotification",Mn,[]);var De=b(118),vi=b(113),pb=b(39),mi=b(226);class uj{constructor(Q,sa,bb,Cb=null,dc=null,Oc=null,yd=null){this.t$g=this.IM=this.nd=
this.aQa=null;this.fMa=Cb;this.Qd=Q;this.jb=sa;this.Oj=bb;this.Ixa=yd||new Hl;this.v0e=dc||new ok(this.fMa,this.Qd,Object(n.a)(this,this.xok,"dimissOutOfSyncNotification"),this.Ixa);this.x1e=Oc||new pk(this.fMa,this.Qd,Object(n.a)(this,this.yok,"dimissPartialResultNotification"),this.Ixa)}show(){}hide(){}get fMa(){return this.nd||(this.nd=G.AFrameworkApplication.pa.nU)}set fMa(Q){this.nd=Q}vBh(){}Vza(){}dispose(){}wPa(){}Hue(){}iil(Q){var sa=this.t$g[Q];Q=sa.contentId;if((sa=sa.zLi+"")&&sa.length){const bb=
[];Array.add(bb,Object.assign(new pb.a,{name:"RuleID",string:sa}));vi.a.sendTelemetryEvent(Object.assign(new mi.a,{name:String.format("{0}.{1}",uj.vCg,"ViolationSelected"),dataFields:bb}))}this.LHl(Q)}LHl(Q){Q&&this.aQa.Jqm(Q)||(this.jb.aM(De.AFrame.sbf,!1),this.Xzm())}xok(){this.Tyd(!1);this.Hue()}yok(){this.fVi(!1);this.Hue()}Xzm(){const Q=Object.assign(new wd.StandardDialog(!0),{lr:G.AFrameworkApplication.nla,Jc:1,aCa:!1});Q.G2(1);Q.Yd(1,this.Ixa.Dak);Q.Yd(0,CommonUIStrings.l_DialogCancel);Q.dR(this.Ixa.Fak,
this.Ixa.Eak,sa=>{1===sa&&this.UUf()})}QZj(Q){let sa=null;if(Q.Results&&0<Q.Results.length){sa={};let bb=0;for(const Cb of Q.Results)Cb.ResultId=uj.lHj+ ++bb,Q=new Eo,Q.contentId=Cb.ContentId,Q.zLi=Cb.RuleId,sa[Cb.ResultId]=Q}return sa}UAl(){vi.a.addNamespaceMapping(uj.vCg,uj.NIm);vi.a.sendTelemetryEvent(Object.assign(new mi.a,{name:String.format("{0}.{1}",uj.vCg,"ShowTaskpane")}))}}uj.lHj="AccCheckResult";uj.vCg="Office.UX.AccChecker";uj.NIm="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";
Object(c.a)(uj,"BaseAccessibilityCheckPane",null,[232,13]);class Hk{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(c.a)(Hk,"AccCheckerTaskPaneProps",null,[]);var Dn=b(1410),Ph=b(1559),Vc=b(1223),Th=b(156);class Vk extends uj{constructor(Q,sa,bb,Cb,dc=null,Oc=null,yd,md=
null,Af=null){super(sa,bb,Cb,Oc,void 0,void 0,md);this.rMg=null;this.s9g=this.w1e=this.QPd=this.LSd=this.nSd=!1;this.T$e=null;this.M8e=!!G.AFrameworkApplication.pa&&!!G.AFrameworkApplication.pa.mb&&G.AFrameworkApplication.pa.mb.Pge;this.oPe=this.u8=null;this.HRe=0;this.yU=dc;Af&&(this.u8=Af.b_m,this.oPe=Af.E1m,this.HRe=Af.B2m);this.EB=new Ph.a;xa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").qA.loadScript("accessibility-checker-pane-strings").catch(wg=>ua.ULS.sendTraceTag(41302158,334,
10,"Failed to load the resources for the accessibilityChecker feature: {0}",wg))}get isVisible(){return this.s9g}h_a(Q){this.s9g=Q}Uwf(Q){Q&&(this.rMg=Q,Q.IsSuccess&&(this.t$g=this.QZj(Q),Q.IsPartialResult&&this.fVi(!0)),this.nSd=!0,this.LSd=!1,this.Uu())}Tyd(Q){this.isVisible&&Q!==this.QPd&&(this.QPd=Q,this.Uu())}fVi(Q){this.w1e=Q;this.Uu()}iU(){this.LSd||Th.UISurfaces.Mt().then(Q=>{ia.a.instance.Qp(Vk.zDb+":PaneOpen:Start");Q.showTaskPane(Vk.zDb,this.UB());this.UUf();return null});this.isVisible?
Th.UISurfaces.Mt().then(Q=>{Q.setSelectedTaskPane(Vk.zDb);return null}):this.UAl()}Uu(){Th.UISurfaces.Mt().then(Q=>{Q.updateTaskPane(Vk.zDb,this.UB());return null})}UB(){var Q=new Hk;this.EB.rve(Q);Q=Object.assign(new Vc.a,{title:this.Ixa.Myb,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.K7();this.h_a(!0);G.AFrameworkApplication.pa.updateCommandUI()},onClose:()=>{this.aha();this.h_a(!1);this.LSd=this.nSd=!1;this.Uu();G.AFrameworkApplication.pa.updateCommandUI()},isModernPane:!0});
this.M8e&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const sa=this.jb.ed(Vk.zDb);sa.parent=De.AFrame.Ho;sa.GQ=!0;this.aQa=Q;this.dIj()}dispose(){this.wPa();this.v0e&&(this.v0e.dispose(),this.v0e=null);this.x1e&&(this.x1e.dispose(),this.x1e=null);super.dispose()}dIj(){this.EB.hO(this.onRecheckExecute());this.EB.hO(this.rFk());this.EB.hO(this.RYk());this.EB.hO(this.onInvokeNavigateExecute());this.EB.hO(this.GPk());this.EB.hO(this.mVk());this.EB.hO(this.HWk());
this.EB.hO(this.updateLastScanTime());this.EB.hO(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.UUf()}}}rFk(){return Q=>{Q.accessibilityCheckResultCollection=this.rMg}}RYk(){return Q=>{Q.resultsReady=this.nSd}}onInvokeNavigateExecute(){return Q=>{Q.onInvokeNavigateExecute=sa=>{this.iil(sa)}}}GPk(){return Q=>{Q.helpLink=this.Nwk}}mVk(){return Q=>{Q.outOfSync=this.QPd}}HWk(){return Q=>{Q.partialResult=this.w1e}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=sa=>
{this.T$e=sa}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{if(this.yU&&this.yU.value){const bb=this.yU.value;if(bb){var sa={};sa.query=Vk.qzj+Vk.hpj;sa=Object.assign(new Dn.a,{DW:sa});bb.T7(Vk.ERe,sa)}}else this.u8.value&&this.oPe&&this.HRe&&this.u8.value.Db(this.HRe,2,this.oPe)}}}UUf(){this.w1e=this.QPd=this.nSd=!1;this.T$e&&this.T$e();this.Uu();this.LSd=!0;this.aQa.lMl()}K7(){this.jb.qf(Vk.zDb)}aha(){this.Tcb()&&this.jb.qf(this.jb.SV)}Tcb(){return!!this.jb.Bf&&this.jb.Bf.name===Vk.zDb}}Vk.zDb=
"AccessibilityCheckerPane";Vk.hpj="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Vk.ERe="FA000000012";Vk.qzj="AssetID=";Object(c.a)(Vk,"ReactAccessibilityCheckPane",uj,[]);class gk extends Vk{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af=null){super(Q,sa,bb,Cb,dc,Oc,void 0,Af);this.vmj=md;this.mE=yd}dispose(){super.dispose()}get Nwk(){return this.vmj}iU(){this.mE.BUa();super.iU()}}Object(c.a)(gk,"ReactLiveBooksAccessibilityCheckPane",Vk,[]);var Il=b(1429),Wk=b(97),Wl=b(145),$f=b(71),im=b(162),qk=b(467),Xl;(function(Q){Q[Q.error=
0]="error";Q[Q.warning=1]="warning";Q[Q.tip=2]="tip";Q[Q.intelligentService=3]="intelligentService"})(Xl||(Xl={}));Object(c.b)("AccessibilityRuleCategory",Xl);class Aj{constructor(Q,sa,bb=null){this.fGe=null;this.zZg=!1;this.M6a=Q;this.wFd=sa;this.ea=bb;this.Bd.na(cb.a.G7j,Ec.a.frame,Object(n.a)(this,this.closePane,"closePane"))}get Bd(){return this.ea||(this.ea=G.AFrameworkApplication.qa)}set Bd(Q){this.ea=Q}Qtk(){this.zZg||(this.M6a.initialize(this),this.wFd.initialize(this),this.zZg=!0)}lMl(){y.b(19969184,
200,50,"{0}",{["AccCheckInvoked"]:1});this.wFd.Wjm()}iU(Q,sa,bb){if(1===bb)return ug.SessionStatusManager.instance.Kj?8:32;this.M6a.isVisible||this.Qtk();this.M6a.iU();return 32}closePane(Q,sa,bb){1!==bb&&this.M6a.Vza();return 32}hbg(){this.M6a.Tyd(!0)}Uwf(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const bb=Q.AccessibilityRules;for(let Cb in bb){var sa=Cb;const dc=bb[Cb].RuleId+"";sa!==dc&&y.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
sa,dc)}this.fGe=bb}else!this.fGe&&Q.Results&&0<Q.Results.length?(y.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.fGe;Q.IsSuccess||y.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.Vcm(Q);this.NAl(Q);this.M6a.Uwf(Q)}}Vcm(Q){const sa=Q.AccessibilityRules;if(Q=Q.Results)for(let bb=Q.length-1;0<=bb;bb--){const Cb=Q[bb];let dc="";const Oc=Cb.RuleId;Cb.ContentName||(dc+="Result does not have content name. ");Oc in sa||(dc+=String.format("No accessibility check rule exists for ID {0}.",
Oc));0<dc.length&&(y.b(36214999,200,15,"Omitting invalid accessibility check result: "+dc),Array.removeAt(Q,bb))}}NAl(Q){var sa={};const bb={};var Cb=Q.Results,dc=[];Array.add(dc,Object.assign(new pb.a,{name:"FinalViolationCount",int64:0}));Array.add(dc,Object.assign(new pb.a,{name:"FinalErrorCount",string:"0"}));Array.add(dc,Object.assign(new pb.a,{name:"FinalWarningCount",string:"0"}));Array.add(dc,Object.assign(new pb.a,{name:"FinalTipCount",string:"0"}));Array.add(dc,Object.assign(new pb.a,{name:"FinalIntelligentServiceCount",
string:"0"}));if(Cb){for(const md of Cb)if(Q.AccessibilityRules){var Oc=Q.AccessibilityRules[md.RuleId];if(Oc){if(sa[Xl[Oc.Category]]){let Af=sa[Xl[Oc.Category]];sa[Xl[Oc.Category]]=++Af}else sa[Xl[Oc.Category]]=1;bb[md.RuleId]?(Oc=bb[md.RuleId],bb[md.RuleId]=++Oc):bb[md.RuleId]=1}}dc[0].int64=Cb.length;for(var yd in sa)switch(Q=sa[yd],Cb=yd,Cb="Final"+Cb.charAt(0).toUpperCase()+Cb.substring(1,Cb.length)+"Count",Cb){case "FinalErrorCount":dc[1].string=Q.toString();break;case "FinalWarningCount":dc[2].string=
Q.toString();break;case "FinalTipCount":dc[3].string=Q.toString();break;case "FinalIntelligentServiceCount":dc[4].string=Q.toString()}}vi.a.sendTelemetryEvent(Object.assign(new mi.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:dc}));for(let md in bb)sa=md,dc=bb[md],yd=[],Array.add(yd,Object.assign(new pb.a,{name:"RuleID",string:sa})),Array.add(yd,Object.assign(new pb.a,{name:"FinalViolationCount",string:dc.toString()})),vi.a.sendTelemetryEvent(Object.assign(new mi.a,
{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:yd}))}dispose(){this.M6a&&this.M6a.dispose();this.wFd&&this.wFd.dispose()}}Object(c.a)(Aj,"AAccessibilityCheckManager",null,[61,13]);var Ik=b(1008);class Ob extends Aj{constructor(Q,sa,bb){super(sa,bb,Q);this.graph=null}uig(Q,sa,bb,Cb,dc){if(1===bb)return 32;dc[Ik.a.On]=this.M6a.isVisible;return 32}Lam(){for(let Q of this.Qqi){const sa=this.graph.ke(Q);sa.Dp(Object(n.a)(this,this.ge,"onPropertyChanged"));
sa.Ps(Object(n.a)(this,this.hK,"onConnected"));sa.ww(Object(n.a)(this,this.upd,"onDisconnected"))}}wPm(){for(let Q of this.Qqi){const sa=this.graph.ke(Q);sa.qua(Object(n.a)(this,this.ge,"onPropertyChanged"));sa.Oga(Object(n.a)(this,this.hK,"onConnected"));sa.tZa(Object(n.a)(this,this.upd,"onDisconnected"))}}dispose(){super.dispose();this.wPm()}ge(){this.hbg()}hK(){this.hbg()}upd(){this.hbg()}}Object(c.a)(Ob,"ALiveBooksAccessibilityCheckManager",Aj,[]);class ai extends Ob{constructor(Q,sa,bb,Cb,dc,
Oc){super(Q,sa,bb);this.Bd.na(cb.a.Xxg,Ec.a.frame,Object(n.a)(this,this.iU,"showPane"));this.Bd.La(cb.a.J4l,Ec.a.frame,Object(n.a)(this,this.uig,"queryToggleAccCheckerPane"),96);this.graph=dc;this.Tuj=Cb;this.Irj=Oc;this.Lam()}get Qqi(){return[12,14,22,19,30,43,44]}Jqm(Q){if(this.Irj)return ua.ULS.sendTraceTag(20713608,334,15,"ODT file. Disable content navigation."),!0;ua.ULS.shipAssertTag(20272215,334,!!Q);return this.Tuj.Zpi(Q)}}Object(c.a)(ai,"WordAccessibilityCheckManager",Ob,[]);var hk=b(73),
ca=b(24),Aa=b(103),jb=b(20),Fb=b(155),Zb=b(4),$b=b(27),Tc=b(430);class dd{constructor(Q,sa,bb,Cb,dc,Oc,yd){this.ug=null;this.RRb=0;this.Lb=sa;this.Lx=bb;this.Da=Cb;this.ea=dc;this.mc=Oc;this.hr=Q;this.Dc=yd}get Qo(){if(!this.ug){const Q=this.Lb.Sf(this.hr.Rb);this.Lx.fFg(Q);if(Q.Na(7)||Q.Bc(7))this.ug=hk.a.fo(Q,Q.origin)}return this.ug}Zpi(Q){if(!Q||!Q.nf||0>=Q.nf.length)return ua.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var sa=Array(Q.nf.length);let bb=7,Cb=null;for(let Oc=
0;Oc<Q.nf.length;Oc++)if(Cb=this.rzk(Q.nf[Oc])){if(7===bb)bb=this.RRb;else if(bb!==this.RRb)return ua.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var dc=this.Dc.rNa(Cb.characterData,Cb.ka);const yd=Q.cpBegin?this.Dc.mqb(dc,Q.cpBegin):-1;dc=Q.cpEnd?this.Dc.mqb(dc,Q.cpEnd):-1;if(-1>yd||-1>dc)return ua.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;sa[Oc]=ca.a.JP(yd,dc,!1,Cb);switch(Q.contentType){case 5:if(!Aa.HyperlinkReader.VPf(sa[Oc],
!1))return!1;break;case 6:if(!jb.ImageReader.S$(sa[Oc]))return!1;break;case 7:sa[Oc]=ca.a.JP(-1,-1,!1,Cb)}}else return!1;sa=new Fb.Selection(sa,!1);return this.jum(Cb,sa,Q.contentType)}rzk(Q){if(this.Qo)for(this.Qo.reset(),this.RRb=7;this.Qo.moveNext();){var sa=this.Qo.currentNode.type;if(38===sa||36===sa||23===sa)this.RRb=sa;else if(12===sa){sa=this.Qo.currentNode;const bb=sa.ha(Zb.a.Gb,0);if(Q===bb)return sa}}return null}DBg(Q){this.ea.processAction($b.a.KS,2);this.ea.processAction($b.a.M5,2);let sa=
2;switch(this.RRb){case 23:sa=32;break;case 38:sa=this.ea.Db($b.a.fNa,2,new Tc.a(Q));break;case 36:sa=this.ea.Db($b.a.zXa,2,new Tc.a(Q));break;default:ua.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.RRb)}if(32===sa)return!0;ua.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.RRb);return!1}jum(Q,sa,bb){if(this.DBg(Q)){Q=this.hr.ex;const Cb=this.Da.Ia.Ra;Cb&&Cb.equals(sa)&&this.mc.WBa(Q,null);this.mc.WBa(Q,sa);switch(bb){case 0:case 1:this.ea.processAction(ve.a.EAb,
2);break;case 2:this.ea.processAction(ve.a.ZBc,2);break;case 3:this.ea.processAction(ve.a.Hua,2)}return!0}return!1}}Object(c.a)(dd,"WordAccessibilityCheckNavigateManager",null,[1856]);class Dd{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);const sa=Q.AccessibilityRules,bb={};if(sa)for(let Cb=0;Cb<sa.length;++Cb){const dc=sa[Cb];bb[dc.Key]=dc.Value}Q.AccessibilityRules=
bb;return Q}}Object(c.a)(Dd,"AccessibilityCheckResultCollection",null,[]);class se{constructor(Q){this.aQa=null;this.rWg=Q}get fileId(){return this.rWg?this.rWg():null}initialize(Q){this.aQa=Q}Tsi(Q){this.aQa.Uwf(Q)}}Object(c.a)(se,"AAccessibilityCheckService",null,[320,13]);class Rc extends se{constructor(Q){super(Q)}onFailure(Q,sa){ua.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",sa);Q=Object.assign(new Dd,{IsSuccess:!1});this.Tsi(Q)}onSuccess(Q){Q=Rc.PYk(Q);
let sa=null;if(Q)try{sa=this.Smk(Q)}catch(bb){ua.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",bb.message),sa=Object.assign(new Dd,{IsSuccess:!1})}else ua.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),sa=Object.assign(new Dd,{IsSuccess:!1});this.Tsi(sa)}dispose(){}static PYk(Q){let sa=null;Q&&Q.yg&&(sa=Q.yg[0]);return sa?sa.Body:null}}Object(c.a)(Rc,"ALiveBooksAccessibilityCheckService",se,[]);var Qd=b(920),Pe=b(215);class Ve extends Pe.a{constructor(){super();
this.FileId=null;this.IsCoauthorable=!1}pi(){return 56}static construct(Q,sa){const bb=new Ve;bb.FileId=Q;bb.IsCoauthorable=sa;return bb}}Object(c.a)(Ve,"WordAccessibilityCheckRequest",Pe.a,[]);class Wf{}Object(c.a)(Wf,"AccessibilityCheckRule",null,[]);var re=b(127);class Qh{static parse(Q){switch($a.a.vf(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),re.a.argument(Q);
}}}Object(c.a)(Qh,"AccessibilityRuleCategoryParser",null,[]);class wi{constructor(){this.Category=this.Text=this.Id=null}static sKm(Q){const sa=new Wf;sa.RuleId=Q.Id;sa.RuleName=Q.Text;sa.Category=Qh.parse(Q.Category);return sa}}Object(c.a)(wi,"WordAccessibilityCheckRule",null,[]);class xh{}Object(c.a)(xh,"AccessibilityCheckResult",null,[]);class xk{constructor(){this.cpEnd=this.cpBegin=this.nf=null;this.contentType=0}}Object(c.a)(xk,"WordAccessibilityCheckContentId",null,[]);const dn=Q=>{switch($a.a.vf(Q)){case "tableheading":return 0;
case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var ze=b(1241);class tm{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static qKm(Q){const sa=new xh;sa.RuleId=Q.RuleId;sa.ContentName=Q.Label;const bb=new xk;bb.nf=Q.ParaId;bb.cpBegin=ze.b(Q.OS);bb.cpEnd=ze.b(Q.OE);bb.contentType=dn(Q.ContentType);
sa.ContentId=bb;return sa}}Object(c.a)(tm,"WordAccessibilityViolation",null,[]);class Nj{constructor(){this.Violations=this.Rules=null}static rKm(Q){const sa=new Dd;try{var bb={};if(Q.Rules){for(let Cb=0;Cb<Q.Rules.length;++Cb){const dc=wi.sKm(Q.Rules[Cb]);bb[dc.RuleId]=dc}sa.AccessibilityRules=bb}if(Q.Violations){const Cb=Array(Q.Violations.length);for(bb=0;bb<Q.Violations.length;++bb)Cb[bb]=tm.qKm(Q.Violations[bb]);sa.Results=Cb}sa.IsPartialResult=!1;sa.IsSuccess=!0}catch(Cb){ua.ULS.shipAssertTag(20272214,
334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",Cb.message),sa.IsSuccess=!1}return sa}}Object(c.a)(Nj,"WordAccessibilityCheckResult",null,[]);class en extends Rc{constructor(Q,sa,bb){super(Q);this.Zfc=sa;this.JRa=bb}Wjm(){const Q=Object.assign(new Qd.a,{kk:Ve.construct(this.fileId,this.JRa),status:1,wv:"AccessibilityCheck"});this.Zfc(12,!1,Object(n.a)(this,this.onSuccess,"onSuccess"),Object(n.a)(this,this.onFailure,"onFailure"),Q,null,Q)}Smk(Q){Q=
Ia.b(Q);return Nj.rKm(Q)}}Object(c.a)(en,"WordAccessibilityCheckService",Rc,[]);class xi extends kn{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}Nb(Q){super.Nb(Q);Q.ia("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new gk(G.AFrameworkApplication.qa,hm.a.instance,yj.FocusManager.instance(),ph.a.instance,Q.Pd("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),kf.KeyInputManager.instance,Il.a.instance,G.AFrameworkApplication.K.Oa("AccessibilityCheckerHelpUrl"))).fa();
Q.ia("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new en(()=>G.AFrameworkApplication.rootQuerySignature,qk.a.DJ,Wk.PageReader.instance.fcd(Mf.App.oa.Ca.Rb))).fa();Q.ia("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new dd(Mf.App.oa.Ca,Q.resolve("Box4.Graph.IGraphIteratorFactory"),Wl.PageNavigator.instance,Q.resolve("Box4.ISelectionManager"),G.AFrameworkApplication.qa,$f.InteractiveViewManager.instance,Q.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).fa();
Q.ia("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new ai(G.AFrameworkApplication.qa,Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),Q.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),Mf.App.rh.Ej,im.App.yvb)).fa()}init(){im.App.vGc&&this.container.resolve("Box4.IFeatureHelper").Uk.continueWith(()=>{kn.prototype.init.call(this)})}}Object(c.a)(xi,"WordAccCheckerPackageManager",
kn,[]);class kl{constructor(Q,sa){this.ndh=!1;this.je=Q;this.ZR=sa}Ota(Q){Q.jy.blh(Object(n.a)(this,this.mMm,"triggerWebToWebActiveCoauthSurveysEventHandler"))}mMm(){this.lMm()}lMm(){!this.ndh&&this.je&&(this.je.baa?this.ZR?this.ZR.execute(Q=>{Q.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):ua.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.ndh=!0)}}Object(c.a)(kl,"CoauthSurveyManager",null,[1772]);class Lc{constructor(){this.hr=
this.Z=null}get name(){return"WordEditor.CoauthSurveys"}init(){Mf.App.oa&&(this.hr=Mf.App.oa.Ca)&&(this.hr.lla?this.jha():this.hr.D9(()=>{this.jha()}))}jha(){var Q=this.hr.Rb;Q&&(Q=Q.contentReplicator)&&this.Z.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").Ota(Q)}dispose(){}Nb(Q){this.Z=Q;Q.ia("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new kl(Q.resolve("WordEditor.IWordEditorCoauthManager"),Q.Fa("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").fa()}static main(){G.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&
aa.a.instance.jc(new Lc)}}Object(c.a)(Lc,"WordEditorCoauthSurveyManagerPackage",null,[2,3]);var Nn;(function(Q){Q[Q.graphSpaceReplicatorNotSendingContent=0]="graphSpaceReplicatorNotSendingContent";Q[Q.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(Nn||(Nn={}));Object(c.b)("ComponentLoggingScenario",Nn);var Wp=b(1057);class Fo{flush(Q,sa){const bb=this.hMk(Q);bb.LoggingScenario=Nn[sa];Yb.a(bb).length?
ua.ULS.sendTraceTag(594571986,3013,15,"{0}",bb):ua.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",Wp.a[Q.Cya])}hMk(Q){const sa={};if(!Q)return sa;const bb=new jj.a;for(bb.enqueue(Q);!bb.isEmpty;){Q=bb.dequeue();const Cb=Wp.a[Q.Cya];try{sa[Cb]=Q.GL()}catch(dc){ua.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Cb.toString(),{["Kind"]:"Exception",["Stack"]:dc.stack,["Message"]:dc.message,
["FileName"]:dc.fileName,["LineNumber"]:dc.lineNumber})}if((Q=Q.wnc)&&Q.length)for(let dc of Q)!dc||Wp.a[dc.Cya]in sa||bb.enqueue(dc)}return sa}}Object(c.a)(Fo,"ComponentStateLogManager",null,[1777]);class Un{flush(){}}Object(c.a)(Un,"NoOpComponentStateLogManager",null,[1777]);class yh{constructor(){this.Z=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.Z.resolve("Common.IComponentStateLogManager")}dispose(){}Nb(Q){this.Z=Q;G.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?
Q.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new Fo).as("Common.IComponentStateLogManager").fa():Q.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Un).as("Common.IComponentStateLogManager").fa()}static main(){aa.a.instance.jc(new yh)}}Object(c.a)(yh,"WordEditorComponentStateLoggingPackage",null,[2,3]);var Oj=b(256),En=b(445),Yo=b(541),jq=b(542);class pp{constructor(Q,sa=null,bb=-1,Cb=null){this.jda=Q;this.ngh=Cb||(()=>sa);this.mId=bb}Hi(Q,sa,bb,Cb,
dc,Oc,yd,md,Af,wg=null,Zg=!1,Wh=null,vh=null){const sl=new XMLHttpRequest;let qh="";Oc="";2===sa?(qh="POST",bb&&(Oc=bb)):qh="GET";sa={};this.jda&&(Q=Oj.a.zcf(sa,Q,Oj.a.xBe,G.AFrameworkApplication.LDd,this.jda));sl.open(qh,Q,!0);this.OZj(sa,Q);if(Cb)for(let Mg in Cb)sl.setRequestHeader(Mg,$a.a.oQ(Cb[Mg]));for(let Mg in sa)sl.setRequestHeader(Mg,sa[Mg]);Q=Wh||this.mId;0<Q&&(sl.timeout=Q);Q=[];Array.add(Q,Oj.a.Vda);Cb=new Sys.Net.WebRequest;const Cd=new Yo.a(1,2,Cb,Q,dc,yd,md,Af,Zg,wg,vh);sl.onreadystatechange=
()=>{this.nRl(sl,Cd)};try{sl.send(Oc)}catch(Mg){ua.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}$rc(){return 1}nRl(Q,sa){if(this.T4j(Q,sa)&&4===Q.readyState)if(Q.getResponseHeader(Oj.a.GJh)&&G.AFrameworkApplication.K8c)G.AFrameworkApplication.K8c();else{var bb=Q.getResponseHeader(Oj.a.Lth);Oj.a.jGg(bb);this.xTm(Q,sa);Q.status===vg.a.Kw?(sa.status=2,sa.Su(new jq.a(sa))):(sa.status=Q.status&&Q.status!==vg.a.h9b?Q.status===vg.a.p2?5:3:7,sa.JH(new En.a(sa)))}}OZj(Q,
sa){Q["X-xhr"]=1;G.AFrameworkApplication.Dcb&&(Q[Oj.a.Zki]=1);G.AFrameworkApplication.buildVersion&&(Q[Oj.a.e9f]=$a.a.oQ(G.AFrameworkApplication.buildVersion));let bb=null;this.ngh&&(bb=this.ngh());bb&&(Q[Oj.a.MJg]=bb);G.AFrameworkApplication.canary&&(Q[Oj.a.Qmc]=$a.a.oQ(G.AFrameworkApplication.canary),G.AFrameworkApplication.bmd&&ua.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",Q[Oj.a.Qmc]));G.AFrameworkApplication.accessToken&&(Oj.a.tQb(sa,G.AFrameworkApplication.CY)||(Q[Oj.a.xbf]=$a.a.oQ(G.AFrameworkApplication.accessToken)),
Oj.a.tQb(sa,G.AFrameworkApplication.pHa)||(Q[Oj.a.ybf]=G.AFrameworkApplication.rTa.toString()));G.AFrameworkApplication.userType&&(Q[Oj.a.t7i]=$a.a.oQ(G.AFrameworkApplication.userType))}xTm(Q,sa){sa.ff=Q.status?Q.status:vg.a.h9b;try{sa.od=Q.responseText;if(void 0!==sa.zZa&&null!==sa.zZa){sa.Dk={};for(let bb=0;bb<sa.zZa.length;++bb){const Cb=sa.zZa[bb];sa.Dk[Cb]=Q.getResponseHeader(Cb)}}sa.iwe&&(sa.Kaa=Q.responseText&&Q.responseText.length?Q.responseXML:null)}catch(bb){ua.ULS.sendTraceTag(24938645,
205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",sa.id,sa.request.get_url(),4===Q.readyState)}}T4j(Q,sa){return Q?sa?!0:(ua.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(ua.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(Q,sa,bb){return new pp(Q,null,bb,sa)}}Object(c.a)(pp,"SimpleClientRequestSender",
null,[1207]);class qp{constructor(Q,sa,bb){this.Be=Q;this.kch=sa;this.q9g=bb}Hi(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg=null,Zg=!1,Wh=null,vh=null,sl=null,qh=null,Cd=!1){return this.q9g?this.kch.Hi(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg,Zg,vh,sl):this.Be.Hi(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg,Zg,Wh,vh,sl,qh,Cd)}$rc(Q){return this.q9g?this.kch.$rc():this.Be.$rc(Q)}}Object(c.a)(qp,"ClientRequestAdapter",null,[1269]);var Ip=b(154),Pj=b(238),og=b(197),lj=b(1038),ik=b(89),Yf=b(557),Li=b(536),um=b(116),ye=b(606),yk=b(424),Bf;(function(Q){Q[Q.none=
0]="none";Q[Q.getCells=1]="getCells";Q[Q.hotStoreStatus=2]="hotStoreStatus";Q[Q.saveMonitor=3]="saveMonitor";Q[Q.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";Q[Q.kickoutExecutor=5]="kickoutExecutor"})(Bf||(Bf={}));Object(c.b)("MostRecentRevisionIdOrigin",Bf);class zf extends Sys.EventArgs{constructor(Q,sa,bb){super();this.hMa=Q;this.xUl=sa;this.httpStatusCode=bb}}Object(c.a)(zf,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Pg{constructor(){this.b5a=0}get isEmpty(){return!this.b5a}CXd(Q){this.b5a|=
Q}Gei(Q){return!!(this.b5a&Q)}clear(){this.b5a=0}}Object(c.a)(Pg,"RetryAttempt",null,[]);class eh extends Pe.a{constructor(){super();this.CellId=this.FileId=null}pi(){return 37}static construct(Q){const sa=new eh;sa.FileId=Q.yh().Cn;sa.CellId=um.a(Q.Sb.id);return sa}}Object(c.a)(eh,"LastSavedRevisionRequest",Pe.a,[]);var Ei;(function(Q){Q[Q.noResultYet=-1]="noResultYet";Q[Q.upToDate=0]="upToDate";Q[Q.sessionLost=1]="sessionLost";Q[Q.userSignedOut=2]="userSignedOut";Q[Q.previousRequestPending=3]="previousRequestPending";
Q[Q.requestFailed=4]="requestFailed";Q[Q.shuttingDown=5]="shuttingDown";Q[Q.nullResponseData=6]="nullResponseData";Q[Q.invalidResponseData=7]="invalidResponseData";Q[Q.failedRevisionLookup=8]="failedRevisionLookup";Q[Q.savedWithinThreshold=9]="savedWithinThreshold";Q[Q.notSavedWarning=10]="notSavedWarning";Q[Q.kickoutThreshold=11]="kickoutThreshold";Q[Q.unknownRevision=12]="unknownRevision";Q[Q.contentNotYetLoaded=13]="contentNotYetLoaded";Q[Q.sessionExpired=14]="sessionExpired";Q[Q.canaryError=15]=
"canaryError";Q[Q.timeout=16]="timeout";Q[Q.kickoutThreshold_Offline=17]="kickoutThreshold_Offline";Q[Q.dssSessionDeleted=18]="dssSessionDeleted";Q[Q.dssSessionExpired=19]="dssSessionExpired";Q[Q.waitingForSessionTokenRefresh=20]="waitingForSessionTokenRefresh";Q[Q.dssSessionNotFound=21]="dssSessionNotFound";Q[Q.networkOffline=22]="networkOffline"})(Ei||(Ei={}));Object(c.b)("SaveMonitorResult",Ei);class td{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg,Zg,Wh,vh,sl,qh,Cd,Mg,sg,Xc,$q,hp,Cs,Lq,No,Ds,Es=null){this.lSc=
0;this.GPc=!1;this.bSd=null;this.rQc=this.gP=-1;this.r2e=null;this.UQd=0;this.VQd=!1;this.dKb=null;this.cTc=0;this.w5e=this.oeh=null;this.Xu=this.K1g=this.uNe=0;this.nXe=null;this.IDj=Q;this.OOe=sa;this.XEa=Q;this.vgh=bb;this.mCj=Cb;this.uWe=dc;this.tzj=Oc;this.rBj=yd;this.gic=md;this.jTg=Af;this.YJe=wg;this.av=Zg;this.CR=Wh;this.$Gb=vh;this.psj=sl;this.MRa=qh;this.yVe=Cd;this.zR=Mg;this.Fx=sg;this.nAj=Xc;this.xrj=Ds;this.Mec=new Pg;this.C4e=new yk.a;this.fQe=Lq;this.zA=new lj.a(-1);this.wh=Es;if(this.hUe=
G.AFrameworkApplication.K?G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsGlobalNetworkStateEnabledForDocxSaveMonitor",!1):!1)this.Ivj=G.AFrameworkApplication.K?G.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TimeoutIntervalForOfflineKickout",Number.MAX_SAFE_INTEGER):Number.MAX_SAFE_INTEGER;this.zA.O_c(Object(n.a)(this,this.Gim,"resultStateChanged"));this.$Rd=$q;this.imb=sg();this.CYg=hp;this.Afj=Cs;this.XEb=No;this.peh=this.vgh;this.jZe=ae.a.nil;
this.la=new m.a}get Q4d(){return this.uNe}get Nxb(){return this.jZe}get Pvb(){return!this.JVa()||this.Nxb.equals(this.JVa().id)}get qge(){return 10===this.zA.currentState?!0:!1}get Wnl(){return this.Fx().getTime()-this.imb.getTime()>this.uWe}get ync(){return this.Xu}get Cya(){return 3}get wnc(){let Q=null;Mf.App.oa&&Mf.App.oa.Ca&&Mf.App.oa.Ca.Rb&&(Q=Mf.App.oa.Ca.Rb.contentReplicator);return[Q,im.App.rB]}start(){this.uNe=this.jTg.h9a(Object(n.a)(this,this.qAk,"fireRequestIfNecessary"),this.XEa)}aGc(Q){if(!this.Q4d||
this.XEa===Q)return!1;const sa=this.XEa;this.XEa=Q;this.stop("changing save monitor interval from "+sa+"ms to "+Q+"ms");this.start();return!0}a_a(Q,sa){if(sa>=this.lSc&&Q&&!ae.a.nil.equals(Q)){var bb=!this.jZe.equals(Q);this.lSc=sa;this.jZe=Q;const Cb=this.Fx();this.w5e=Cb;const dc=this.Pvb;bb&&(sa={["Id"]:Q.toString(),["IsUpToDate"]:dc,["Origin"]:Bf[sa]},this.nXe&&(sa.LastUpToDateTime=this.nXe.toISOString()),(bb=this.EGf())&&bb.store&&(Q=bb.store.getRevision(Q))&&(sa.LastSavedCreationTime=Q.creationTime.toISOString()),
ua.ULS.sendTraceTag(557320151,td.Jo,50,"Updating Last Saved Revision: {0}",sa));dc&&(this.nXe=Cb)}else sa<this.lSc?ua.ULS.sendTraceTag(572051800,td.Jo,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.lSc,sa):ua.ULS.sendTraceTag(572051801,td.Jo,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',sa)}stop(Q){this.xe(Q)}xe(Q){this.Q4d&&(ua.ULS.sendTraceTag(5830084,td.Jo,50,"Stopping DocxSaveMonitor because {0}!",Q),this.jTg.xe(this.Q4d),this.uNe=0)}qAk(){var Q=this.imb;this.imb=
this.Fx();if(this.zR())this.zA.event(5),this.stop("session has shut down");else{this.XEa===td.yKi&&this.aGc(this.OOe);var sa=this.$Gb();if(sa)if(this.vai())this.zA.event(22),this.aGc(td.S_i),this.Fx().getTime()-this.imb.getTime()>this.Ivj&&this.xhe(17,ik.a.HHh,"while offline");else if(this.yVe()&&G.AFrameworkApplication.Lf("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.Pvb)this.zA.event(0);else if(this.MRa())this.zA.event(1),this.stop("session is lost"),
G.AFrameworkApplication.Vn("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.xrj&&!this.Vnl()&&(ua.ULS.sendTraceTag(554726995,td.Jo,10,"DocxSaveMonitor: Session lost but not kicked out"),this.$s(ik.a.U7c));else if(this.yVe())20!==this.zA.currentState?(this.zA.event(20),this.oeh=this.Fx(),ua.ULS.sendTraceTag(593510691,td.Jo,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.peh)):this.Fx().getTime()-this.oeh.getTime()>this.peh&&
(this.zA.event(14),this.stop("Waited too long for session token to be refreshed"),this.$s(ik.a.T7c));else if(this.psj())if(this.imb=Q,this.GPc)this.zA.event(3),this.Fx().getTime()-this.bSd.getTime()>this.uWe&&(Q=this.YJe.$rc(this.gP),ua.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.gP,Mj.a[Q]),this.$Rd&&this.$Rd.log(),this.stop("stuck on previousRequestPending"),this.$s());else if(Q=Li.b(eh.construct(sa)),this.GPc=!0,this.bSd=this.nAj(),
this.gP=this.YJe.Hi(td.serviceUrl,2,Q,{"Content-Type":"application/json; charset=utf-8"},!1,0,Object(n.a)(this,this.W4j,"checkSaveRequestSucceeded"),Object(n.a)(this,this.V4j,"checkSaveRequestFailed"),null,void 0,void 0,this.tzj,this.rBj,void 0,void 0,!0),0>=this.gP)this.GPc=!1,ua.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.gP.toString());else{Q=this.YJe.$rc(this.gP);sa=100;if(Q&&1!==Q||this.CYg)sa=50;ua.ULS.sendTraceTag(19161612,td.Jo,sa,
"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.gP,["Status"]:Mj.a[Q]});this.$Rd&&this.$Rd.start(this.gP)}else this.zA.event(2);else this.zA.event(13)}}vai(){return this.wh&&this.hUe&&(1===this.wh.networkState||3===this.wh.networkState)?!0:!1}f7k(){if(0>=this.gic)return!1;var Q=this.QUk();if(!Q)return this.r2e=null,this.UQd=0,this.VQd=!1;this.dKb=Q.r7d;this.dKb===this.r2e?this.UQd++:(this.r2e=this.dKb,this.UQd=1,this.VQd=!1);if(this.UQd<td.nGl)return!1;this.cTc=+this.Fx()-+this.dKb;if(this.cTc<=
this.gic)return!1;if(!this.VQd)return this.VQd=!0,this.oDi(),!1;if(this.XEb)this.XEb.execute(sa=>{sa.flush(this,0)});else{Q="";try{this.fQe&&(Q=this.fQe())}catch(sa){Q=Ia.c({["Kind"]:"Exception",["Stack"]:sa.stack,["Message"]:sa.message,["FileName"]:sa.fileName,["LineNumber"]:sa.lineNumber}),ua.ULS.sendTraceTag(50426817,td.Jo,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}ua.ULS.sendTraceTag(50426818,td.Jo,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",
this.dKb.toISOString(),this.cTc,this.gic,Q)}this.gic=-1;this.stop("Exceeded oldest allowed local revision");this.$s(ik.a.Yqk);return!0}QUk(){let Q=null,sa=this.JVa();for(;sa&&!sa.V$;)Q=sa,sa=sa.Xj;return Q}Crl(){return this.MRa()?(this.zA.event(1),this.stop("session is lost"),!0):this.yVe()?(this.zA.event(14),ua.ULS.sendTraceTag(20029718,td.Jo,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.$s(ik.a.T7c),!0):!1}EGf(){const Q=this.$Gb();return Q?Q.Sb:null}JVa(){return this.EGf().rj}Fth(Q){return this.Afj.Gei(Q)&&
!this.Mec.Gei(Q)}V4j(Q){this.Xu=this.ync+1;let sa=this.GPc=!1,bb=!1;(Q=Q.data)?(13===Q.status&&ua.ULS.sendTraceTag(22552772,td.Jo,15,"Request expired in CRM queue {0}",{["Id"]:Q.id,["ConsecutiveErrors"]:this.ync}),bb=7===Q.status||13===Q.status,this.Fth(2)&&bb?(this.Mec.CXd(2),sa=!0,this.rQc=Q.ff,this.zA.event(16)):this.Fth(1)&&5===Q.status?(this.Mec.CXd(1),sa=!0,this.rQc=Q.ff,this.zA.event(15)):(this.zA.event(4),ua.ULS.sendTraceTag(22552773,td.Jo,15,"Request failed {0}",{["Status"]:Q.status,["HttpStatus"]:Q.ff,
["Correlation"]:Q.Dk?Q.Dk[Oj.a.Vda]:"",["Id"]:Q.id,["ConsecutiveErrors"]:this.ync}),this.rQc=Q.ff)):(this.zA.event(4),ua.ULS.sendTraceTag(23425240,td.Jo,15,"RequestFailed and event data is null"));if(this.hUe&&this.vai&&this.wh.Kj)this.Mec.clear(),ua.ULS.sendTraceTag(546096136,td.Jo,50,"Client is offline and EV is deployed. Clearing the failed attempts.");else{if(!sa&&(this.Mec.clear(),bb?this.xhe(17,ik.a.HHh,"while offline"):this.xhe(11,ik.a.vxf,"while online")))return;this.aGc(sa?this.kHk(bb):this.OOe)}}kHk(Q){return Q?
td.S_i:td.yKi}xhe(Q,sa,bb){return this.Wnl?(this.zA.event(Q,{}),this.stop("request failed after kickout interval "+bb),this.XEb&&this.XEb.execute(Cb=>{Cb.flush(this,2)}),this.$s(sa),!0):!1}W4j(Q){this.Xu=this.ync+1;this.GPc=!1;var sa={};this.Mec.clear();if(Q=Q.data){var bb=Q.Dk?Q.Dk[Oj.a.Vda]:"";sa.HttpStatus=Q.ff;sa.Correlation=bb;sa.Id=Q.id;ua.ULS.sendTraceTag(23425242,td.Jo,this.CYg?50:100,"Request succeeded at the HTTP level {0}",sa);this.rQc=Q.ff}else ua.ULS.sendTraceTag(23425241,td.Jo,15,"Request succeeded with null response data");
if(this.zR()||!this.Q4d)this.zA.event(5),this.stop("session has shut down");else if(!this.Crl())if(Q&&Q.od)if(Q=this.pra(Q.od))if(this.CR.ACa(Q),Q.StatusCode)this.tvl(Q,sa)||this.zA.event(8,sa);else{this.Xu=0;this.imb=this.Fx();this.C4e.clear();sa={["LastSavedRevisionId"]:Q.LastSavedRevisionId};Q=um.b(Q.LastSavedRevisionId);this.a_a(Q,3);var Cb=this.EGf().store.getRevision(Q);if(Cb){Q=null;bb=this.JVa();Cb=(Cb=Cb.S$a(bb))?Cb.id:ae.a.nil;let dc=bb;for(;dc&&!dc.id.equals(Cb);)Q=dc,dc=dc.Xj;this.Z7k(Q,
sa,bb)||this.zA.event(9)}else this.f7k()||this.zA.event(12,sa);this.aGc(this.IDj)&&ua.ULS.sendTraceTag(22552774,td.Jo,50,"Received response from server -- going back to normal interval")}else this.zA.event(7),this.a1f("invalid response",sa);else this.zA.event(6),this.a1f("null response",sa)}tvl(Q,sa){const bb=Q.StatusCode;return 88===bb||89===bb||236===bb?(sa.KickoutDiagnostics=this.fQe(),88===bb?(sa.Result="deleted DSS session",this.zA.event(18,sa),this.stop("deleted DSS session"),this.$s(ik.a.localCobaltDeletedSessionFault)):
89===bb?(sa.Result="expired DSS session",this.zA.event(19,sa),this.stop("expired DSS session"),this.$s(ik.a.localCobaltExpiredSessionFault)):(G.AFrameworkApplication.Lf("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(Q=um.b(Q.LastSavedRevisionId),this.a_a(Q,4)),sa.Result="DSS session not found",this.zA.event(21,sa),this.stop("DSS session not found"),
this.$s(ik.a.localCobaltSessionNotFound)),!0):104===bb?(this.stop("this operation is disabled on the server"),!0):this.a1f("unrecognized OperationResult: "+bb,sa)}a1f(Q,sa){if(!this.C4e.contains(Q))this.C4e.add(Q);else if(this.xhe(11,ik.a.vxf,Q))return sa.ConsecutiveErrors=this.ync,sa.Reason=Q,ua.ULS.sendTraceTag(41997899,td.Jo,15,"DocxSaveMonitor kickout. {0}",sa),!0;this.aGc(this.OOe);return!1}Z7k(Q,sa,bb){let Cb=!1;if(Q){const dc=this.Fx().getTime()-Q.creationTime.getTime();dc>=this.vgh&&(Cb=!0,
td.joi(sa,this.XYk(Q,dc,bb)),dc>=this.uWe&&10===this.zA.currentState?(this.zA.event(11,sa),this.stop("didn't save in time"),this.$s()):(this.zA.event(10,sa),this.oDi(),this.BDf()))}return Cb}Fkh(Q){this.la.addHandler(td.qAi,Q)}Ndf(Q){this.la.addHandler(td.HDf,Q)}ase(Q){this.la.removeHandler(td.HDf,Q)}oDi(){this.la.raiseEvent(td.qAi)}XNj(Q){this.la.addHandler(td.Tvi,Q)}pra(Q){let sa;return({group:sa}=ye.a.nna(Q,sa)).returnValue?sa.Responses[0]:null}XYk(Q,sa,bb){const Cb={};Cb.FirstUnsavedRevisionId=
Q.id.toString();Cb.FirstUnsavedRevisionLengthToRoot=Q.aK;Cb.UnsavedTimeInMs=sa;Cb.CurrentRevisionId=bb.id.toString();Cb.CurrentRevisionLengthToRoot=bb.aK;return Cb}BDf(){qk.a.R7d(8,null,null,null)}$s(Q=ik.a.vxf){this.mCj?(this.stop(td.uvl),Q===ik.a.T7c?this.av.value.$s(Q,Object.assign(new Yf.a,{sS:4,IV:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,Fda:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.av.value.$s(Q,new Yf.a)):ua.ULS.sendTraceTag(19247383,td.Jo,
50,"Kickout disabled")}Gim(Q,sa){Q={};Q.DocxSaveMonitorState=Ei[sa.newState];Q.PreviousState=Ei[sa.y7b];Q.PreviousStateHits=sa.Urd;Q.PreviousStateTransitionTime=sa.Vrd.toISOString();Q.LastHttpStatus=this.rQc;Q.LastSuccessTime=this.imb.toISOString();this.bSd&&(Q.LastRequestStartTime=this.bSd.toISOString());Q.LastSavedRevisionID=this.Nxb.toString();Q.LastSavedRevisionIdOrigin=this.lSc;Q.LastSavedRevisionIdSetTime=this.w5e?this.w5e.toISOString():null;var bb=sa.QXi;bb&&td.joi(Q,bb);22===sa.y7b&&(this.imb=
this.Fx());bb=sa.newState;switch(bb){case 13:ua.ULS.sendTraceTag(5830086,td.Jo,50,"{0}",Q);break;case 1:ua.ULS.sendTraceTag(5884125,td.Jo,50,"{0}",Q);break;case 0:ua.ULS.sendTraceTag(5830087,td.Jo,50,"{0}",Q);break;case 2:ua.ULS.sendTraceTag(5830088,td.Jo,50,"{0}",Q);break;case 3:ua.ULS.sendTraceTag(5830089,td.Jo,50,"{0}",Q);break;case 4:ua.ULS.sendTraceTag(5884126,td.Jo,50,"{0}",Q);break;case 5:ua.ULS.sendTraceTag(5884127,td.Jo,50,"{0}",Q);break;case 6:ua.ULS.shipAssertTag(5830090,td.Jo,!1,"{0}",
Q);break;case 7:ua.ULS.shipAssertTag(5830091,td.Jo,!1,"{0}",Q);break;case 8:ua.ULS.sendTraceTag(5830092,td.Jo,15,"{0}",Q);break;case 10:ua.ULS.sendTraceTag(5830094,td.Jo,15,"{0}",Q);break;case 9:ua.ULS.sendTraceTag(5884128,td.Jo,50,"{0}",Q);break;case 11:ua.ULS.sendTraceTag(5830096,td.Jo,15,"{0}",Q);break;case 17:ua.ULS.sendTraceTag(37835678,td.Jo,15,"{0}",Q);break;case 12:ua.ULS.sendTraceTag(5830095,td.Jo,15,"{0}",Q);break;case 18:ua.ULS.sendTraceTag(38122832,td.Jo,15,"{0}",Q);break;case 19:ua.ULS.sendTraceTag(38122833,
td.Jo,15,"{0}",Q);break;case 21:ua.ULS.sendTraceTag(0,td.Jo,15,"{0}",Q);break;case 14:ua.ULS.sendTraceTag(6575508,td.Jo,15,"{0}",Q);break;case 15:ua.ULS.sendTraceTag(36739287,td.Jo,50,"{0}",Q);break;case 16:ua.ULS.sendTraceTag(36767649,td.Jo,15,"{0}",Q);break;case 20:ua.ULS.sendTraceTag(593510690,td.Jo,15,"{0}",Q);break;case 22:ua.ULS.sendTraceTag(0,td.Jo,15,"{0}",Q);break;default:ua.ULS.shipAssertTag(5884129,td.Jo,!1,"Bad state:{0} logInfo:{1}",bb,Q)}10===sa.newState&&10!==sa.y7b&&this.la.raiseEvent(td.Tvi)}GL(){const Q=
{};this.dKb&&(Q.ORT=this.dKb.toISOString());0<this.cTc&&(Q.AA=this.cTc);0<this.gic&&(Q.MAA=this.gic);const sa={};G.AFrameworkApplication.D6&&(sa.S=1);Mf.App.lostSession&&(sa.LS=1);Mf.App.Ob&&Mf.App.Ob.Po.fm&&(sa.KO=1);Q.AMD=sa;return Q}wPk(){const Q={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};G.AFrameworkApplication.buildVersion&&(Q["X-OfficeVersion"]=$a.a.oQ(G.AFrameworkApplication.buildVersion));G.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=$a.a.oQ(G.AFrameworkApplication.accessToken),
Q["X-AccessTokenTtl"]=G.AFrameworkApplication.rTa.toString());G.AFrameworkApplication.canary&&(Q["X-Key"]=$a.a.oQ(G.AFrameworkApplication.canary));G.AFrameworkApplication.userType&&(Q["X-UserType"]=$a.a.oQ(G.AFrameworkApplication.userType));const sa=G.AFrameworkApplication.he.r3;sa&&(Q["X-WacCluster"]=$a.a.oQ(sa));G.AFrameworkApplication.userSessionId&&(Q["X-UserSessionId"]=$a.a.oQ(G.AFrameworkApplication.userSessionId));return Q}S7d(){var Q=Mf.App.Ob.Po.networkState;if(1===Q||3===Q)ua.ULS.sendTraceTag(558158790,
td.Jo,15,"Not sending request because we dont have network.");else{Q=this.$Gb();var sa=new Sys.Net.WebRequest;sa.set_httpVerb("POST");sa.set_url(td.serviceUrl);var bb={};bb.body=Li.b(eh.construct(Q));bb.headers=this.wPk();bb.method=sa.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(sa.getResolvedUrl(),bb).then(Cb=>{ua.ULS.sendTraceTag(561551382,td.Jo,50,"Request succeeded at the HTTP level {0}",Cb.statusText);this.K1g=Cb.status;return Cb.json()},Cb=>{ua.ULS.sendTraceTag(561551383,
td.Jo,15,"Request failed at the HTTP level {0}",Cb);return null}).then(Cb=>{Cb=JSON.stringify(Cb);this.P4j(Cb,this.K1g);return Cb},()=>{ua.ULS.sendTraceTag(561551385,td.Jo,15,"Request succeeded with null response data");return""}):ua.ULS.sendTraceTag(561002076,td.Jo,15,"Browser does not support Fetch.")}catch(Cb){ua.ULS.sendTraceTag(561551386,td.Jo,15,String.format("Exception when attempting to get last revision save id : {0}",Cb))}}}P4j(Q,sa){let bb=ae.a.nil,Cb=!1;sa===vg.a.Kw&&((Q=this.pra(Q))?
(bb=um.b(Q.LastSavedRevisionId),Q.StatusCode||(Cb=!0)):ua.ULS.sendTraceTag(561002077,td.Jo,50,"Response is null when attempting to get last revision save id"));this.la.raiseEvent(td.HDf,new zf(bb,Cb,sa))}static joi(Q,sa){for(let bb in sa)Q[bb]=sa[bb]}Vnl(){return ug.SessionStatusManager.instance.fm}}td.yKi=0;td.serviceUrl=Mf.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";td.uvl="kickout";td.qAi="PS";td.HDf="FLSR";td.Tvi="SMWS";td.Jo=343;td.nGl=5;td.S_i=5E4;Object(c.a)(td,"DocxSaveMonitor",
null,[1883,111]);class vm{constructor(Q,sa){this.ISa=Q;this.bpj=sa}pb(Q){Q.na($b.a.Soe,ng.a.view,Object(n.a)(this,this.Soe,"pendingAutosavesCheck"));Q.na($b.a.FCd,ng.a.view,Object(n.a)(this,this.FCd,"updateDocxSaveMonitorInterval"));Q.pc($b.a.FCd,101)}Soe(){const Q=this.bpj();return 32!==Q?Q:!this.ISa||this.ISa.Pvb?32:2<=this.ISa.ync?8:4}FCd(Q,sa,bb,Cb,dc){this.ISa&&this.ISa.aGc(parseInt(dc.toString()));return 32}}Object(c.a)(vm,"DocxSaveMonitorActor",null,[]);class rp{h9a(Q,sa){return window.setInterval(Q,
sa)}xe(Q){window.clearInterval(Q)}}rp.instance=new rp;Object(c.a)(rp,"DocxSaveMonitorTaskManager",null,[1774]);class ni{constructor(Q){this.gP=0;this.Hxa=Q}start(Q){this.Hxa&&(this.gP=Q,this.Hxa.reset())}log(){if(this.Hxa){var Q={};Q.RequstId=this.gP;Q.InvokeCount=this.Hxa.Zde;Q.InvokeFailedCount=this.Hxa.$de;Q.NoOpenConnectionCount=this.Hxa.Oke;Q.SynchronousNotificationCount=this.Hxa.pye;Q.ResponseNotAvailable=this.Hxa.xvd;ua.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",
Q)}}}Object(c.a)(ni,"RequestLifeCycleTelemetryManager",null,[1773]);class Jp{constructor(){this.Z=this.ISa=null}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(Mf.App.lq||Mf.App.Hm)this.ISa=this.Z.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor"),(new vm(this.ISa,()=>og.WoncaApp.xq.cce())).pb(G.AFrameworkApplication.qa)}Ghk(){var Q=G.AFrameworkApplication.K;if(!Q.$("DocxSaveMonitorEnabled"))return null;var sa=Q.$("DocxSaveMonitorKickoutEnabled");const bb=Q.zb("DocxSaveMonitorIntervalMs",
6E4),Cb=Q.zb("DocxSaveMonitorFailureIntervalMs",5E3),dc=Q.zb("DocxSaveMonitorWarningTimeMs",12E4),Oc=Q.zb("DocxSaveMonitorKickoutTimeMs",3E5),yd=Q.zb("DocxSaveMonitorQueueTimeoutMs",6E4),md=Q.zb("DocxSaveMonitorSentTimeoutMs",12E4),Af=Q.zb("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var wg=Q.$("DocxSaveMonitorTelemetryInfoEnabled");const Zg=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Wh=G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",
!1),vh=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||Wh;Wh=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);const sl=G.AFrameworkApplication.he;var qh=vh?new pp(G.AFrameworkApplication.userSessionId,sl.r3,sl.Skk):null;qh=new qp(sl,qh,vh);wg=wg&&sl&&!vh?new ni(sl.cPa):null;vh=new Pg;vh.CXd(1);vh.CXd(2);Wh=Wh?this.Z.Fa("Common.IComponentStateLogManager"):null;sa=new td(bb,Cb,dc,sa,Oc,
yd,md,Af,rp.instance,qh,xa.a.instance.Pd("Box4.IKickoutExecutor"),Pj.a.instance,Object(n.a)(this,this.Wae,"getTargetNode"),()=>!G.AFrameworkApplication.lod||il.a.instance.Ztc,()=>Mf.App.lostSession,Object(n.a)(Ip.a.instance,Ip.a.instance.y5,"checkAndTriggerSessionHasExpired"),()=>G.AFrameworkApplication.ii,()=>new Date,()=>new Date,wg,Zg,vh,Object(n.a)(this,this.NFk,"getAdditionalDiagnosticLog"),Wh,Q,xa.a.instance.sa("Common.ISessionStatus")||ug.SessionStatusManager.instance);sa.start();ua.ULS.sendTraceTag(5884131,
td.Jo,50,"SaveMonitor initialized");return sa}Wae(){const Q=Mf.App.oa.Ca.nc;return Q?Q.Xc:null}NFk(){const Q={};G.AFrameworkApplication.Vb&&(Q.TM=G.AFrameworkApplication.Vb.GL());og.WoncaApp.xq&&(Q.RS=og.WoncaApp.xq.GL());im.App.rB&&(Q.CRS=im.App.rB.GL());Mf.App.oa&&Mf.App.oa.Ca&&Mf.App.oa.Ca.Rb&&Mf.App.oa.Ca.Rb.contentReplicator&&(Q.GSR=Mf.App.oa.Ca.Rb.contentReplicator.GL());G.AFrameworkApplication.D6&&(Q.S=1);Mf.App.lostSession&&(Q.LS=1);Mf.App.Ob&&Mf.App.Ob.Po.fm&&(Q.KO=1);return Sys.Serialization.JavaScriptSerializer.serialize(Q)}dispose(){this.ISa&&
this.ISa.stop("WordEditorDocxSaveMonitorPackage is being disposed")}Nb(Q){this.Z=Q;(Mf.App.lq||Mf.App.Hm)&&Q.ia("WordEditor.DocxSaveMonitor.DocxSaveMonitor",Object(n.a)(this,this.Ghk,"createSaveMonitor")).as("Wonca.IDocxSaveMonitor").fa()}static main(){aa.a.instance.jc(new Jp)}}Object(c.a)(Jp,"WordEditorDocxSaveMonitorPackage",null,[2,3]);class Zo{get qff(){return"Word"}get sth(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return 0}get currentVersion(){return 1}get Ikl(){return Zo.isEnabled()&&
G.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get Mvc(){return Zo.isEnabled()&&G.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get Pfi(){return G.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get yBk(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get Ooi(){return 24}get bLi(){return 4E3}get aLi(){return""}static isEnabled(){const Q=G.AFrameworkApplication.sessionStartInfoSettings?
Object(pa.a)(String,G.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup):"";return"Unknown"!==Q&&"Automation"!==Q}}Object(c.a)(Zo,"FirstRunExperienceLauncherSettings",null,[1854]);class $o{constructor(Q){this.vVg=Q}yAm(Q){this.vVg&&this.vVg.zAm(Q)}}Object(c.a)($o,"FirstRunExperienceManager",null,[1855]);class ll{constructor(){this.Z=null}get name(){return"WordEditor.FirstRunExperience"}Nb(Q){this.Z=Q;this.Z.ia("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new $o(this.Z.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).fa()}init(){const Q=
this.Z.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");Q&&Q.yAm(new Zo)}dispose(){}}Object(c.a)(ll,"WordEditorFirstRunExperiencePackageManager",null,[2,3]);class Ij{constructor(Q,sa,bb){this.ea=Q;this.xRa=sa;this.PVe=bb}dispose(){this.xRa&&this.xRa.dispose()}pb(){this.ea.na($b.a.jBd,ng.a.view,Object(n.a)(this,this.jBd,"toggleFormatPicturePane"));this.ea.La($b.a.Vaa,ng.a.view,Object(n.a)(this,this.Vaa,"showFormatPicturePane"),4);this.ea.na($b.a.Wfd,ng.a.view,Object(n.a)(this,this.Wfd,
"hideFormatPicturePane"));this.ea.La($b.a.sDc,ng.a.view,Object(n.a)(this,this.Vaa,"showFormatPicturePane"),4);this.ea.na($b.a.tDc,ng.a.view,Object(n.a)(this,this.Vaa,"showFormatPicturePane"));this.ea.na($b.a.uDc,ng.a.view,Object(n.a)(this,this.Vaa,"showFormatPicturePane"));this.PVe&&(this.ea.La($b.a.aig,ng.a.view,Object(n.a)(this,this.iCi,"queryFormatPicturePane"),96),this.ea.na($b.a.Kwe,ng.a.view,Object(n.a)(this,this.Vaa,"showFormatPicturePane")),this.ea.La($b.a.cig,ng.a.view,Object(n.a)(this,this.iCi,
"queryFormatPicturePane"),96),this.ea.na($b.a.Lwe,ng.a.view,Object(n.a)(this,this.Vaa,"showFormatPicturePane")))}iCi(Q,sa,bb,Cb,dc){if(1===bb)return 32;switch(Q){case $b.a.aig:dc[Ik.a.On]=1===this.xRa.Bqb;break;case $b.a.cig:dc[Ik.a.On]=2===this.xRa.Bqb}return 32}Vaa(Q,sa,bb,Cb,dc){if(1===bb)return 32;if(2===bb){sa=this.xRa.tg.isVisible;this.xRa.xy(!0,1===dc);bb=0;switch(Q){case $b.a.Kwe:dc=1;break;case $b.a.Lwe:dc=2;break;case $b.a.sDc:dc=2;bb=1;break;case $b.a.tDc:dc=1;bb=2;break;case $b.a.uDc:dc=
1;bb=3;break;case $b.a.jBd:dc=this.xRa.Bqb;this.PVe&&!dc&&(dc=1);break;default:bb=dc=0}sa&&Q===$b.a.Vaa||this.xRa.crm(dc,bb);return 32}return 8}Wfd(Q,sa,bb,Cb,dc){this.toggleButton(dc,!1);return this.M7j(bb)}M7j(Q){if(1===Q)return 32;this.xRa.xy(!1);return 32}jBd(Q,sa,bb,Cb,dc){return this.xRa.tg.isVisible?this.Wfd(Q,sa,bb,Cb,dc):this.Vaa(Q,sa,bb,Cb,dc)}toggleButton(Q,sa){Q&&(Q[Ik.a.On]=sa)}}Object(c.a)(Ij,"FormatPictureActor",null,[13]);class uh{constructor(Q,sa){this.IMb=!1;this.tg=Q;this.PVe=sa}get Bqb(){return this.tg.Ejk}crm(Q,
sa){switch(Q){case 0:case 1:this.tg.wBm(sa);break;case 2:this.tg.FBm(sa)}}xy(Q,sa=!1){this.IMb||this.nTf();Q?this.tg.iU(sa):this.tg.Vza()}dispose(){this.tg.dispose()}nTf(){this.IMb||(this.tg.initialize(),this.IMb=!0)}}Object(c.a)(uh,"FormatPictureManager",null,[1776,13]);var Jl=b(353),Kl=b(106),Pr=b(563);class Pm{}Pm.tO=Pr.a.Cqc;Pm.Byc=1;Pm.Myb=WordEditorIntl.WordEditorStrings.L_FormatPicture;Pm.Pya="FormatPictureTaskPaneData";Object(c.a)(Pm,"FormatPicturePaneConstants",null,[]);class Ll{constructor(){this.type=
"FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(c.a)(Ll,"FormatPictureTaskPaneProps",null,[]);class Jk{constructor(Q,sa,bb,Cb){this.H5e=0;this.ZKc=this.Xpa=null;this.zSd=this.sSd=this.QNd=this.pGd=this.uVd=0;this.Jv=this.U1a=!1;this.BLe=
0;this.mE=Q;this.atj=sa;this.tXe=bb;this.Qd=Cb}initialize(){this.X0();this.Uua()}get isVisible(){return this.Jv}iU(Q){this.Xyd(Q)}Vza(){this.aha();this.Z$k()}wBm(Q){this.HRi(Q,1)}FBm(Q){this.HRi(Q,2)}HRi(Q,sa){this.BLe=sa;this.H5e=Q}get Ejk(){return this.BLe}dispose(){}X0(){this.mE.BUa();this.H5e=this.BLe=0}get Ji(){return this.atj.value}get Bd(){return this.tXe.value}Tcb(){return!!this.Ji.Bf&&this.Ji.Bf.name===Pm.tO}ySl(){this.JPi()}JPi(){this.Ji.qf(Pm.tO)}Uua(){const Q=this.Ji.ed(Pm.tO);Q.parent=
De.AFrame.Ho;Q.C9(Object(n.a)(this,this.ySl,"onSetFocus"))}aha(){this.Tcb()&&this.Ji.qf(this.Ji.SV)}Xyd(Q){Th.UISurfaces.Mt().then(sa=>{sa.showTaskPane(Pm.tO,this.UB(Q));this.isVisible&&Q&&this.Ji.qf(Pm.tO);return null})}Uu(){Th.UISurfaces.Mt().then(Q=>{Q.updateTaskPane(Pm.tO,this.UB(!1));return null})}Z$k(){Th.UISurfaces.Mt().then(Q=>{Q.hideTaskPane(Pm.tO,2);return null})}UB(){const Q=new Ll;this.dwm(Q);return Object.assign(new Vc.a,{title:Pm.Myb,hideHeader:!1,width:320,location:2,contentProps:Q,
onOpen:sa=>{this.Jv=!0;Mf.App.oa.d7a(Object(n.a)(this,this.xl,"pollForStateAndUpdate"));Mf.App.oa.updateCommandUI();this.JPi();this.Qd.V6a(Pm.tO,sa)},onClose:()=>{this.aha();this.Jv=!1;Mf.App.oa.aBc(Object(n.a)(this,this.xl,"pollForStateAndUpdate"));Mf.App.oa.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}dwm(Q){const sa=Object(pa.a)(Object,vf.getRenderAppChromeSettings().numberFormatInfo);Q.section=this.H5e;Q.numberFormatInfo=sa;Q.title=this.Xpa;Q.description=
this.ZKc;Q.topCrop=this.uVd;Q.bottomCrop=this.pGd;Q.leftCrop=this.QNd;Q.rightCrop=this.sSd;Q.rotationAngle=this.zSd;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();Q.disabled=this.U1a}onTitleChange(){return Q=>{if(Q!==this.Xpa){this.Xpa=Q;var sa=new Jl.DictionaryPropertySet;sa.setValue(Kl.a.vWa,Q);this.Bd.Db(ve.a.oxd,2,sa);this.Uu()}}}onDescriptionChange(){return Q=>
{if(Q!==this.ZKc){var sa=new Jl.DictionaryPropertySet;sa.setValue(Kl.a.R1,Q);this.ZKc=Q;this.Bd.Db(ve.a.Xgb,2,sa);this.Uu()}}}onCropSpinButtonChange(){return(Q,sa)=>{const bb=new Jl.DictionaryPropertySet;switch(sa){case 0:this.uVd=Q;bb.setValue(Kl.a.xub,Q);this.Bd.Db($b.a.etc,2,bb);break;case 1:this.pGd=Q;bb.setValue(Kl.a.uub,Q);this.Bd.Db($b.a.btc,2,bb);break;case 2:this.QNd=Q;bb.setValue(Kl.a.vub,Q);this.Bd.Db($b.a.ctc,2,bb);break;case 3:this.sSd=Q,bb.setValue(Kl.a.wub,Q),this.Bd.Db($b.a.dtc,2,
bb)}this.Uu()}}onRotationSpinButtonChange(){return Q=>{this.zSd=Q;const sa=new Jl.DictionaryPropertySet;sa.setValue(Kl.a.vgd,0);sa.setValue(Kl.a.mT,Q);this.Bd.Db(ve.a.imageRotate,2,sa);this.Uu()}}xl(){let Q=!1;Q=this.m4l()||Q;Q=this.GNa()||Q;Q=this.FNa()||Q;Q=this.Gzc()||Q;(Q=this.j4l()||Q)&&this.Uu()}m4l(){const Q=2===this.Bd.Db(ve.a.n8c,1,null),sa=Q!==this.U1a;this.U1a=Q;return sa}GNa(){var Q=new Jl.DictionaryPropertySet;this.Bd.Db(ve.a.GNa,2,Q);Q=Q.ha(Kl.a.vWa,"");const sa=Q!==this.Xpa;this.Xpa=
Q;return sa}FNa(){var Q=new Jl.DictionaryPropertySet;this.Bd.Db(ve.a.FNa,2,Q);Q=Q.ha(Kl.a.R1,"");const sa=Q!==this.ZKc;this.ZKc=Q;return sa}Gzc(){var Q=new Jl.DictionaryPropertySet;this.Bd.Db($b.a.Hzc,2,Q);const sa=Q.ha(Kl.a.xub,0),bb=Q.ha(Kl.a.uub,0),Cb=Q.ha(Kl.a.vub,0);Q=Q.ha(Kl.a.wub,0);const dc=sa!==this.uVd||bb!==this.pGd||Cb!==this.QNd||Q!==this.sSd;this.uVd=sa;this.pGd=bb;this.QNd=Cb;this.sSd=Q;return dc}j4l(){var Q=new Jl.DictionaryPropertySet;this.Bd.Db(ve.a.Dfb,2,Q);Q=Q.ha(Kl.a.mT,0);const sa=
Q!==this.zSd;this.zSd=Q;return sa}}Object(c.a)(Jk,"ReactFormatPicturePane",null,[1775,13]);class Fm{constructor(){this.cKd=this.Z=null}get name(){return"WordEditor.FormatPicture"}Nb(Q){this.Z=Q;this.Z.ia("WordEditor.FormatPicture.IFormatPictureManager",()=>new uh(this.Z.resolve("WordEditor.FormatPicture.IFormatPicturePane"),im.App.qKg)).fa();this.Z.ia("WordEditor.FormatPicture.IFormatPicturePane",()=>new Jk(Il.a.instance,new yb.a(()=>yj.FocusManager.instance()),new yb.a(()=>G.AFrameworkApplication.qa),
hm.a.instance)).fa();this.Z.ia("WordEditor.FormatPicture.FormatPictureActor",()=>new Ij(G.AFrameworkApplication.qa,this.Z.resolve("WordEditor.FormatPicture.IFormatPictureManager"),im.App.qKg)).fa()}init(){if(im.App.gDb||im.App.xGc)this.cKd=this.Z.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.cKd.pb(),Mf.App.oa.updateCommandUI()}dispose(){this.cKd&&this.cKd.dispose()}static main(){aa.a.instance.jc(new Fm)}}Object(c.a)(Fm,"WordEditorFormatPicturePackage",null,[2,3]);class sp{constructor(){this.egc=
this.MVc=null;this.ZRd=0}get name(){return"WordEditor.FrameTiming"}Nb(){this.egc=new EventTiming.FrameTimingMeter;this.ZRd=G.AFrameworkApplication.K.zb("FrameTimingMeterReportingIntervalInSeconds",60);0>=this.ZRd&&(this.ZRd=60);this.MVc=Q=>{(Q=Q.rawEvent)&&ua.ULS.sendTraceTag(24962208,306,50,Ia.c(Q.detail))};U.a.addHandler(window.self,D.a.SIi,this.MVc)}init(){this.egc&&this.egc.start(this.ZRd)}dispose(){this.egc&&(this.egc.stop(),this.egc=null);this.MVc&&(U.a.removeHandler(window.self,D.a.SIi,this.MVc),
this.MVc=null)}static main(){aa.a.instance.jc(new sp)}}Object(c.a)(sp,"FrameTimingPackageManager",null,[2,3]);var ap=b(1079),Vi=b(501);class vj extends Pe.a{constructor(){super();this.Prompt=0;this.FileId=null}pi(){return 100}static construct(Q,sa){const bb=new vj;bb.FileId=Q;bb.Prompt=sa;return bb}}Object(c.a)(vj,"GraphMergeConsentChangedRequest",Pe.a,[]);class Bj{constructor(Q,sa,bb,Cb,dc,Oc=null,yd=null){this.Fi=!1;this.WO=null;this.Xah=this.bWe=!1;this.VO=Q;this.FWd=bb;this.iDa=Cb;this.uQa=dc;
this.FWd&&this.FWd.zNj(Object(n.a)(this,this.W3h,"handleOnGraphMergeComplete"));this.CR=Oc||Pj.a.instance;if(!yd){const md=new Vi.a;yd=Af=>md.Y5(0,Af)}this.$gj=yd}get dul(){return this.bWe}get bom(){return this.Xah}$of(){if(this.iDa.bce)this.bWe=!0;else if(this.bWe=!1,!this.bom){this.Xah=!0;var Q=this.uQa.Ega;ua.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",400===Q);if(100===Q||400===Q)Q=vj.construct(this.VO(),Q),this.xv(Q)}}W3h(Q,sa){sa&&sa.l6f&&sa.l6f.Srf&&!this.iDa.Sfi&&(this.iDa.b4i(),
this.iDa.bce=!0,this.xv(sa.l6f.Srf))}xv(Q){const sa=new Qd.a;sa.kk=Q;sa.status=1;sa.wv="GraphMerge";const bb=this.$gj(()=>{this.n9b(sa,33===Q.pi())});bb.IB(sa);bb.xJ()}n9b(Q,sa){this.Fi||(sa&&(this.iDa.bce=!1),2===Q.statusCode&&!W.a.Vsa(Q.yg)&&1===Q.yg.length&&Q.yg[0]?(Q=Q.yg[0],Q.StatusCode?this.iDa.Mug():sa&&this.uQa.lJi(Object(n.a)(this,this.$of,"consentChoiceMade")),this.CR.ACa(Q),this.dul&&this.$of()):this.iDa.Mug())}Ota(Q){this.WO=Q;this.WO.c7a(Object(n.a)(this,this.T3h,"handleOnAfterReplication"));
this.WO.gya(Object(n.a)(this,this.U3h,"handleOnAfterResponseReceived"))}T3h(Q,sa){sa&&sa.u0a&&this.iDa.b4i()}U3h(Q,sa){sa&&(sa.ShowMergePrompt&&this.uQa.lJi(Object(n.a)(this,this.$of,"consentChoiceMade")),G.AFrameworkApplication.Dg&&(G.AFrameworkApplication.Dg.SessionMergeInfo|=sa.PartMergeInfo))}dispose(){this.Fi||(this.FWd&&this.FWd.oem(Object(n.a)(this,this.W3h,"handleOnGraphMergeComplete")),this.WO&&(this.WO.Zfb(Object(n.a)(this,this.T3h,"handleOnAfterReplication")),this.WO.sZa(Object(n.a)(this,
this.U3h,"handleOnAfterResponseReceived"))),this.Fi=!0)}}Object(c.a)(Bj,"GraphMergeBackupManager",null,[1876,13]);class rk{constructor(Q,sa=null,bb=null,Cb=null){this.YHe=0;this.UUe=!1;this.d1g=new Date(0);this.bce=!1;this.uQa=Q;this.Fx=sa||(()=>new Date);bb||(bb=G.AFrameworkApplication.K?G.AFrameworkApplication.K.zb("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.Euj=bb;Cb||(Cb=G.AFrameworkApplication.K?G.AFrameworkApplication.K.zb("WordEditorGraphMergeMaxBackups",1):1);this.h3g=Cb}get Zsl(){return+this.Fx()-
+this.d1g<this.Euj}get Sfi(){return 500===this.uQa.Ega?!1:100===this.uQa.Ega?!0:this.UUe||this.bce||this.Zsl}b4i(){this.d1g=this.Fx();this.YHe++;this.YHe>=this.h3g&&this.Mug()}Mug(){this.UUe||(this.UUe=!0,ua.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.YHe,this.h3g))}}Object(c.a)(rk,"GraphMergeBackupThrottler",null,[1875]);class ej{constructor(Q,sa,bb=null){this.bXg=!1;this.Cz=Q;this.uGb=sa;null==bb&&(bb=!!G.AFrameworkApplication.K&&
G.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.L2e=bb?500:300}get Ega(){return this.L2e}lJi(Q){if(!this.bXg&&300===this.Ega){var sa=this.uGb.value;sa&&sa.isFeatureEnabled(81)&&(this.bXg=!0,this.Cz.execute(bb=>{bb.KAm(()=>{this.N$j(Q)},()=>{this.consentDenied(Q)})}))}}consentDenied(Q){300===this.Ega&&(ua.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.L2e=100,Q());this.zGi()}N$j(Q){300===this.Ega&&(ua.ULS.sendTraceTag(42333271,
300,50,"Consent received for investigating merge failures."),this.L2e=400,Q());this.zGi()}zGi(){this.Cz.execute(Q=>{Q.T$k()})}}Object(c.a)(ej,"GraphMergeCollectionConsentManager",null,[1805]);class gf extends Sys.EventArgs{constructor(Q){super();this.l6f=Q}}Object(c.a)(gf,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var ml=b(490),Kp=b(828),On=b(539),Xp=b(675),ri=b(1639),Fq=b(1434),jk=b(151),ao=b(111);class kq{constructor(Q,sa,bb,Cb,dc,Oc){this.xhg=this.hg=null;this.Hvc=this.TJg=!1;this.ll=null;
this.Jyd=Q.runtime.Jyd;this.Jm=Q;this.Vc=sa;this.Nf=bb;this.Mm=Cb;this.D$j=dc;this.graphNodeComplexMerge=Oc}}Object(c.a)(kq,"GraphNodeComplexMergeState",null,[]);var mj=b(1176),Qj=b(1162);class Go{constructor(Q,sa=null){this.Wf=Q;this.Qhc=sa||this.vcd()}get Gxb(){return this.Qhc}get Vc(){return this.Wf}vcd(){return[Object(n.a)(this,this.zCm,"simpleMerge"),Object(n.a)(this,this.b$j,"complexMerge")]}hwm(Q,sa,bb,Cb,dc,Oc){Q=new kq(Q,bb,new yb.a(()=>new mj.a(Cb?Cb.tj:null,dc)),new yb.a(()=>new mj.a(Cb?
Cb.tj:null,Oc)),new yb.a(()=>new mj.a(Oc,dc)),sa.QBh(dc));Q.hg=Cb.Kkc;Q.xhg=new jk.a;return Q}merge(Q,sa,bb,Cb,dc,Oc){sa=this.hwm(Q,sa,bb,Cb,dc,Oc);bb=!0;for(Cb=0;Cb<this.Gxb.length&&bb;Cb++)(bb=(0,this.Gxb[Cb])(sa))||Q.ma.Die("GraphNodeMerge.GetMergeFunctions()",Cb);(Q=sa.Hvc&&sa.ll?new Qj.a(sa.ll,!1):null)&&Q.avm(sa.hg);if(sa.Hvc)switch((Q?Q.tj:dc).Kb){case 1074135145:sa.Jm.runtime.i8b.yzh.W(Q.tj.id,Q.tj);break;case 1074135153:sa.Jm.runtime.i8b.zqh.W(Q.tj.id,Q.tj);break;case 1074135127:sa.Jm.runtime.i8b.Lxh.W(Q.tj.id,
Q.tj)}return{returnValue:sa.Hvc,ll:Q}}zCm(Q){if(Q.Jm.runtime.Qa&&Q.Jm.runtime.Qa.Vab(1000005)&&0<Q.hg.count)return!0;var sa=Q.graphNodeComplexMerge.nsd;return Q.Mm.value.eid(sa)&&Q.D$j.value.eid(sa)?Q.Nf.value.eid(sa)?!0:(sa=Q.Mm.value.He,Q.Hvc=!0,Q.ll=sa.yH(),!1):(Q.Hvc=!0,!1)}b$j(Q){const sa=Q.Mm.value.He;Q.Jyd&&ao.a.instance.Ba(4018183,1,3,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",sa.id,sa.Kb);const bb=Q.graphNodeComplexMerge.dFg(Q);Q.Hvc=bb;ao.a.instance.Ba(4018184,1,bb?4:3,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",
bb?"Succeeded":"Failed",sa.id,sa.Kb,!!Q.ll);return bb}}Object(c.a)(Go,"GraphNodeMerge",null,[1791]);class Rj extends Pe.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Prompt=this.Reason=this.Source=0}pi(){return 33}static construct(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg,Zg){const Wh=new Rj;Wh.FileId=Q;Wh.BaseRevisions=sa;Wh.TheirRevisions=
bb;Wh.YourRevisions=Cb;Wh.IgnoreConflictsInLastServerRevision=dc;Wh.MergeHint=Oc;Wh.ObjectSpaceId=yd?um.a(yd):null;Wh.RequestId=md?um.a(md):null;Wh.Source=Af;Wh.Reason=wg;Wh.Prompt=Zg;return Wh}}Object(c.a)(Rj,"CreateGraphMergeReplayRequest",Pe.a,[]);var Yp=b(710),Vn=b(15),Ho=b(1641),sr=b(1592);class jm{constructor(Q,sa=null,bb=null){this.Zw=Q;this.JC=Q.pj;this.Cmb=Q.C_i;this.HJb=Q.taj;this.Itj=Q.pki;this.Wf=sa||new Kp.a;this.Wxj=bb||Object(n.a)(this,this.vqk,"doParagraphMergeForModifiedObject")}Wqb(Q){const sa=
new jk.a;for(let bb=0;bb<Q.length;bb++){const Cb=this.rqk(Q.J(bb));sa.add(Cb)}return sa}Vqb(Q,sa,bb){const Cb=Q.Vh===Q.hj&&Q.startCp===Q.endCp;sa&&({gOa:Q.Vh,xua:Q.startCp}=this.EPa(Q.Vh,Q.startCp,Q.Vh,Q.startCp),Cb&&(Q.hj=Q.Vh,Q.endCp=Q.startCp));bb&&!Cb&&({gOa:Q.hj,xua:Q.endCp}=this.EPa(Q.hj,Q.endCp,Q.hj,Q.endCp));return Q}rqk(Q){if(Q.Vh===Q.hj){var sa=new jk.a;sa.add(Q.startCp);sa.add(Q.endCp);({gOa:bb,q9b:Cb}=this.THg(Q.Vh,sa,bb,Cb));return new Yp.a(bb,Cb.J(0),bb,Cb.J(1))}var bb=new jk.a;var Cb=
new jk.a;let dc,Oc,yd;bb.add(Q.startCp);({gOa:sa,q9b:Oc}=this.THg(Q.Vh,bb,sa,Oc));Cb.add(Q.endCp);({gOa:dc,q9b:yd}=this.THg(Q.hj,Cb,dc,yd));return new Yp.a(sa,Oc.J(0),dc,yd.J(0))}THg(Q,sa,bb,Cb){bb=Q;Cb=sa;if(!this.JC.J(Q))return ua.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",Q),{gOa:bb,q9b:Cb};if(this.Cmb.get(Q))({gOa:bb,q9b:Cb}=this.Wxj(Q,sa,bb,Cb));else if(this.Zw.gde&&!this.Zw.gde.J(this.Zw.gde.length-
1).YH(Q)){Cb=new jk.a;for(let dc=0;dc<sa.length;dc++){let Oc;({gOa:bb,xua:Oc}=this.EPa(Q,sa.J(dc),bb,Oc));Cb.add(Oc)}}return{gOa:bb,q9b:Cb}}UWh(Q){let sa="";Q.forEach(bb=>{sa+=bb.rCb();sa+=" ";return!0});return sa}gXh(Q){const sa=xa.a.instance.sa("Box4.IFeatureHelper"),bb=new Ho.a;bb.input.source=this.Zw.Kbe;bb.input.g2=this.Zw.g2;bb.input.F9c=()=>sa;bb.runtime.pj=this.JC;bb.runtime.yIa=this.Zw.cyh;1===Q?(bb.runtime.Aw=this.HJb,bb.runtime.wp=this.Cmb,bb.runtime.H6d=this.Zw.j1f,bb.runtime.uAe=this.Zw.n1f):
2===Q&&(bb.runtime.Aw=this.Cmb,bb.runtime.wp=this.HJb,bb.runtime.H6d=this.Zw.n1f,bb.runtime.uAe=this.Zw.j1f);bb.runtime.Qa=sa;return bb}vqk(Q,sa,bb,Cb){bb=Q;Cb=sa;var dc=this.Cmb.get(Q);if(!dc)return{gOa:bb,q9b:Cb};Cb=new jk.a;Cb.add(dc);var Oc=this.HJb.get(Q)||this.JC.J(Q);dc=new jk.a;dc.add(Oc);Oc=new jk.a;Oc.add(this.JC.J(Q));ua.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.Zw.Kbe,this.Zw.g2,this.UWh(dc),
this.UWh(Cb));var yd=this.gXh(this.Zw.g2);dc=new sr.a(yd,Oc,1===yd.input.g2?dc:Cb,1===yd.input.g2?Cb:dc,this.gXh(1),dc,Cb);Cb=new jk.a;for(Oc=0;Oc<sa.length;Oc++){this.Zw.jF("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const md=({mgb:bb,xua:yd}=dc.CCd(Q,sa.J(Oc))).returnValue;Cb.add(yd);md?ua.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Q,sa.J(Oc),
bb,yd):ua.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",Q)}return{gOa:bb,q9b:Cb}}bWk(Q,sa){let bb=0;for(let Cb=0;Cb<Q.length;Cb++)if(sa.equals(Q.J(Cb)))return bb=Cb,{returnValue:!0,NKa:bb};return{returnValue:!1,NKa:bb}}EPa(Q,sa){const bb=this.Itj&&!!this.HJb.J(Q)&&!this.JC.J(Q);let Cb=Q,dc=sa,Oc=!1,yd=!1;(bb?this.HJb:this.Cmb).forEach((md,Af)=>{this.Zw.jF("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.XYf(Af.Kb)&&this.JC.J(md)){Af=null;if(bb){Af=this.Tcd(Zg=>this.HJb.J(Zg)||this.JC.J(Zg),md);var wg=this.Qfe(Af,Q)}else wg=this.Tcd(Zg=>this.JC.J(Zg),md),wg=this.Qfe(wg,Q);if(wg&&(yd=!0,Af||(Af=this.Tcd(Zg=>this.HJb.J(Zg)||this.JC.J(Zg),md)),md=this.Tcd(Zg=>this.Cmb.J(Zg)||this.JC.J(Zg),md),wg=0,({NKa:wg}=this.bWk(Af,Q)).returnValue)){for(let Zg=wg+1;Zg<Af.length;Zg++)if(this.Qfe(md,Af.J(Zg)))return dc=0,Cb=Af.J(Zg),Oc=!0,!1;for(--wg;0<=wg;wg--)if(this.Qfe(md,Af.J(wg)))return dc=Number.MAX_VALUE,
Cb=Af.J(wg),Oc=!0,!1}}return!0});if(!Oc&&(ua.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",Q,sa,bb,yd),5===this.Zw.Kbe)){ua.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Cb);let md;({CNh:md}=this.nOk(md)).returnValue?(Cb=md,
dc=0,ua.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Cb)):ua.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Cb)}return{gOa:Cb,xua:dc}}nOk(Q){Q=ae.a.nil;let sa=new jk.a;this.Cmb.forEach((bb,Cb)=>{this.Zw.jF("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.XYf(Cb.Kb)?(sa=this.Tcd(dc=>this.Cmb.J(dc)||this.JC.J(dc),bb),!1):!0});return 0<sa.length?(Q=sa.J(0),{returnValue:!0,CNh:Q}):{returnValue:!1,CNh:Q}}XYf(Q){return 393241===Q||393250===Q||393251===Q||393252===Q}Tcd(Q,sa){var bb=Q(sa);sa=new jk.a;if(!this.XYf(bb.Kb))return sa;bb=this.Wf.getPropertyObjectIds(bb,Vn.a.$e);for(let Cb=0;Cb<bb.length;Cb++){const dc=new jk.a;this.LKf(Q,bb.J(Cb),dc);sa.my(sa.length,dc)}return sa}LKf(Q,sa,bb){var Cb=Q(sa);if(Cb)if(393230===Cb.Kb)bb.add(sa);else if(393229===
Cb.Kb)sa=this.Wf.getPropertyObjectIds(Cb,Vn.a.Tda).Ve(0),this.LKf(Q,sa,bb);else if(393250===Cb.Kb||393251===Cb.Kb||393252===Cb.Kb)for(sa=this.Wf.getPropertyObjectIds(Cb,Vn.a.$e),Cb=0;Cb<sa.length;Cb++)this.LKf(Q,sa.J(Cb),bb)}Qfe(Q,sa){for(let bb=0;bb<Q.length;bb++)if(sa.equals(Q.J(bb)))return!0;return!1}}Object(c.a)(jm,"GraphMergeSelectionRecordUpdater",null,[]);class Pn extends ri.a{constructor(Q=null,sa=null,bb=null,Cb=null,dc=null,Oc=null,yd=null,md=null,Af=-1,wg=null,Zg=null,Wh=null){super();
this.VO=Q||(()=>G.AFrameworkApplication.rootQuerySignature);sa||(sa=vh=>new ml.a(vh));this.H$g=sa;this.Wf=bb||new Kp.a;this.GPg=yd||new Fq.ChildNodeListMerge(this.Vc);this.s5a=md;this.JKi||(this.s5a=(vh,sl,qh)=>new On.a(vh,sl,qh));this.Qhc=Cb||this.vcd();this.ulb=dc||new zl.a;this.LWg=Oc||new Go(this.Vc);this.n3g=void 0===Af||null===Af||-1===Af?im.App.YBe:Af;this.iDa=wg;this.uQa=Zg;this.Ibe=this.nnk(Wh);this.PUg=()=>xa.a.instance.sa("Box4.IFeatureHelper")}nnk(Q){Q||(Q=G.AFrameworkApplication.K?G.AFrameworkApplication.K.zb("WordEditorGraphMergeBackupCasesBrowser",
0):0);return Q}OJa(){return(new Date).getTime()}eYi(Q,...sa){return String.format.apply(null,[Q].concat(sa))}PJm(Q){throw re.a.invalidOperation(Q);}G9d(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,Q.stack)}P_l(Q){if(this.iDa&&this.iDa.Sfi||!this.WGm(Q))return null;this.hAl(Q);let sa;({JVj:Cb,AJm:dc,OYm:sa}=this.Phk(Q,Object(n.a)(this,this.RCh,"createSerializedRevisionFrom")));const bb=ri.a.YOk(Q);var Cb=Rj.construct(this.VO(),Cb.K_(),dc.K_(),sa.K_(),Q.input.atc,Q.input.g2,
Q.input.Xi,Q.input.g3b,Q.input.source,bb,this.uQa.Ega);var dc=Q.output.cK;3===bb&&0<dc.length&&(Cb.MergedRevision=this.RCh(Q.output.cK.last()));return Cb}RCh(Q){const sa=Q.NY,bb=Mf.App.oa.Ca.Rb;return new Xp.a(Q,sa,bb.zc,bb.fileId,bb.RNa,bb.contextId,sa?sa.id:ae.a.nil,this.JKi,!1,!0)}Wqb(Q,sa){return(new jm(Q)).Wqb(sa)}Vqb(Q,sa,bb,Cb){return(new jm(Q)).Vqb(sa,bb,Cb)}}Object(c.a)(Pn,"GraphMerger",ri.a,[]);class Zf extends Pn{constructor(Q,sa=null,bb=null){super(Q,void 0,void 0,void 0,void 0,void 0,
void 0,void 0,void 0,sa,bb);this.la=new m.a}get Ega(){return this.uQa?this.uQa.Ega:0}get delayedMergeOperation(){return null}set delayedMergeOperation(Q){}zNj(Q){this.la.addHandler(Zf.xOf,Q)}oem(Q){this.la.removeHandler(Zf.xOf,Q)}jDc(){return!1}RXa(Q,sa,bb,Cb,dc,Oc,yd){(Q=super.RXa(Q,sa,bb,Cb,dc,Oc,yd))&&this.la.raiseEvent(Zf.xOf,new gf(Q));return Q}}Zf.xOf="GMC";Object(c.a)(Zf,"WordEditorGraphMerger",Pn,[1802,1513,1514]);class nl{constructor(){this.Z=null}get name(){return"WordEditor.GraphMerge"}Nb(Q){this.Z=
Q;this.Z.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new ej(this.Z.Fa("WordEditor.IBusinessBarController"),new yb.a(()=>Q.sa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").fa();this.Z.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new rk(this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").fa();this.Z.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new Zf(()=>G.AFrameworkApplication.rootQuerySignature,
this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").fa();this.Z.ia("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Bj(()=>G.AFrameworkApplication.rootQuerySignature,G.AFrameworkApplication.qa,this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").fa()}init(){Mf.App.Tu||
(Mf.App.Tu=ap.a.k1());const Q=this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");Mf.App.Tu.bqh(Q);this.Z.resolve("Box4.IGraphMergeBackupManager")}dispose(){let Q=this.Z.sa("Box4.IGraphMergeBackupManager");Q&&Q.dispose()}}Object(c.a)(nl,"GraphMergePackage",null,[2,3]);var Ml=b(104);class Fn{constructor(Q){this.cic=0;this.tg=Q}fEh(Q){this.cic=Math.max(0,--this.cic);this.fIi(Q);0<this.cic&&window.setTimeout(()=>{this.fEh(Q)},1E3)}fIi(Q){Q.style.backgroundColor="rgba(255,0,0,"+Math.min(1,
this.cic/20)+")"}iIi(Q){this.tg&&this.tg.NWl&&(this.cic++,this.fIi(Q),this.tg.xri=bh.a.p8d(Q,!1),1===this.cic&&window.setTimeout(()=>{this.fEh(Q)},1E3))}}Object(c.a)(Fn,"ParagraphRenderVisualizationManager",null,[1801]);class tn{constructor(Q,sa,bb,Cb,dc){this.uVc=this.JHd=this.UYc=this.tg=null;this.mLe=new fa.a;this.xVc=null;this.d5g=0;this.ea=Q;this.mE=sa;this.Qd=bb;this.Txa=Cb;this.jRg=dc}get NWl(){return this.uVc?this.uVc.checked:!1}get xri(){return this.d5g}set xri(Q){this.xVc&&(this.xVc.innerText=
String.format("Total number of child elements in last rendered paragraph: {0}",Q));this.d5g=Q}pb(){this.ea.na($b.a.Nqf,ng.a.application,Object(n.a)(this,this.showTaskPane,"showTaskPane"))}dispose(){null!==this.tg&&(this.mE.Uqb(tn.By,this.tg),this.tg=null);this.Txa.execute(Q=>{this.gLh(Q,sa=>{sa.Cem(Object(n.a)(this,this.Iwi,"onTypingSpeedMeterWindowAvailable"))})});this.jRg.execute(Q=>{this.fLh(Q,sa=>{sa.Wmg(Object(n.a)(this,this.$5b,"onCpuMeterFrameAvailable"))})})}Iwi(Q,sa){this.UYc&&(this.UYc.innerText=
sa.qIl+" CPM")}$5b(Q,sa){this.JHd&&(this.JHd.innerText=sa.sod.CP+"%",this.mLe.add(sa.sod.CP))}c3d(){const Q=new ge.CuiHelper(Ml.a.epb,Box4Intl.Box4Strings);this.tg=this.mE.d3d(tn.By,0,tn.width,"InteractivePerfTaskPaneData",Q);this.Tck();this.Qck();this.Sck()}showTaskPane(){if(!Mf.App.oa.iCb)return 16;this.tg||this.c3d();this.mE.showTaskPane(this.tg);this.tg.element.style.overflow="scroll";return 32}kIf(Q){Q=document.getElementById(Q);return bh.a.Sra(bh.a.Sra(Q,"cui-groupContainer"),"cui-groupBody")}fLh(Q,
sa){const bb=Q.iq.task;bb.continueWith(()=>{sa(bb.result)})}gLh(Q,sa){const bb=Q.iq.task;bb.continueWith(()=>{sa(bb.result)})}Tck(){const Q=this.kIf("TypingSpeedMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const sa=document.createElement("div");sa.innerText="Typing Speed";this.UYc=document.createElement("div");this.UYc.innerText="0 CPM";this.Txa.execute(bb=>{this.gLh(bb,Cb=>{Cb.iOj(Object(n.a)(this,this.Iwi,"onTypingSpeedMeterWindowAvailable"))})});Q.appendChild(sa);Q.appendChild(this.UYc)}Qck(){const Q=
this.kIf("CpuMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const sa=document.createElement("div");sa.innerText="CPU Meter";this.JHd=document.createElement("div");this.jRg.execute(dc=>{this.fLh(dc,Oc=>{Oc.SXd(Object(n.a)(this,this.$5b,"onCpuMeterFrameAvailable"))})});const bb=document.createElement("div"),Cb=document.createElement("button");Cb.innerText="View Cpu Percent";this.Qd.Ma(D.a.click,Cb,Object(n.a)(this,this.Cpk,"displayCpuPercentLogs"));bb.appendChild(Cb);Q.appendChild(sa);Q.appendChild(this.JHd);
Q.appendChild(bb)}Sck(){const Q=this.kIf("RenderGroup"),sa=document.createElement("label");sa.innerText="Enable render visualizations";this.uVc=document.createElement("input");this.uVc.setAttribute("type","checkbox");Q.appendChild(this.uVc);Q.appendChild(sa);this.xVc=document.createElement("div");this.xVc.style.margin="10px";Q.appendChild(this.xVc);xa.a.instance.ia("Box4.IParagraphRenderVisualizationManager",()=>new Fn(this))}Cpk(){const Q=la.a.Vm("","LogFile","","InteractivePerf.DisplayCpuPercentLogs").document;
Q.writeln("<HEAD>");Q.writeln('<STYLE type="text/css">');Q.writeln("* { padding: 0px; margin: 0px; font-family: monospace; }");Q.writeln("</STYLE>");Q.writeln("</HEAD>");Q.writeln("<BODY style='BACKGROUND-COLOR: #f3f8fd;'>");const sa=document.createElement("div");var bb=document.createElement("div");bb.innerText=String.format("{0}, {1}","Frame","CpuPercent");sa.appendChild(bb);for(bb=0;bb<this.mLe.count;bb++){const Cb=this.pYj(bb,this.mLe.J(bb));Cb&&sa.appendChild(Cb)}Q.writeln(sa.innerHTML);Q.writeln("</BODY>");
Q.close();return!0}pYj(Q,sa){Q=Q.toString();sa=sa.toString();const bb=document.createElement("div");bb.innerText=String.format("{0}, {1}",Q,sa);return bb}}tn.By="InteractivePerfTaskPane";tn.width=400;Object(c.a)(tn,"InteractivePerfTaskPane",null,[]);class uo{constructor(){this.tg=null}get name(){return"WordEditor.InteractivePerfTaskPane"}Nb(Q){Q.ia("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane",()=>new tn(G.AFrameworkApplication.qa,Il.a.instance,G.AFrameworkApplication.pa.iA,Q.Fa("Common.ITypingSpeedMeterProvider"),
Q.Fa("Common.ICpuMeterProvider"))).fa()}init(){if(this.tg=xa.a.instance.sa("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane"))this.tg.pb(),"1"===Hc.a.gT(document.URL,"wdShowIPerfTaskPane")&&G.AFrameworkApplication.qa.processAction($b.a.Nqf,2)}dispose(){this.tg&&(this.tg.dispose(),this.tg=null)}static main(){aa.a.instance.jc(new uo)}}Object(c.a)(uo,"InteractivePerfTaskPanePackageManager",null,[2,3]);var Lp=b(313);class Io{constructor(Q){this.oKe="FontPicker";this.tUe=null;this.Kjb=Q;this.xJd=
this.Kjb.ABa(Lp.a.b0b,Object(n.a)(this,this.k$a,"featureStateChangeCallback"));this.Kjb.isFeatureEnabled(Lp.a.b0b,!1).then(sa=>{this.tUe=sa})}get isLicensed(){return this.tUe}k$a(Q){this.tUe=Q.isEnabled;Q=appChrome.actions.updateFontPickerLicenseState(this.oKe,Q.isEnabled);appChrome.api.dispatch(Q)}dispose(){this.Kjb.WAc(Lp.a.b0b,this.xJd)}}Object(c.a)(Io,"ModernFontPickerFeatureHelper",null,[1304,13]);var km=b(485),ig=b(572),Cj=b(1364);class wm{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=
null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(c.a)(wm,"FontInfoTaskPaneProps",null,[]);class el{constructor(Q,sa,bb,Cb=null){this.g$e=this.TO=this.xJd=null;this._state=this.rhc=0;this.tXe=Q;this.Kjb=sa;this.Ygj=bb;this.jb=Cb}get Bd(){return this.tXe.value}initialize(){this.Bd.na(cb.a.Aog,Ec.a.frame,Object(n.a)(this,this.Aog,"requestFontInfo"));this.xJd=this.Kjb.ABa(Lp.a.b0b,Object(n.a)(this,this.k$a,"featureStateChangeCallback"));this.Uua()}iU(Q=!1){const sa=
Th.UISurfaces.Mt(),bb=this.Kjb.isFeatureEnabled(Lp.a.b0b,!1),Cb=[];Cb.push(sa);Cb.push(bb);Promise.all(Cb).then(dc=>{dc[0].showTaskPane(Cj.a.zUb,this.UB(dc[1]));Q&&this.jR()})}aTm(Q){Th.UISurfaces.Mt().then(sa=>{sa.updateTaskPane(Cj.a.zUb,this.UB(Q));return null})}k$a(Q){this.aTm(Q.isEnabled)}Aog(Q,sa,bb,Cb,dc){this.TO=dc.CommandValueId;this.g$e=dc.Trigger;this.rhc=dc.InputMethod;this.iU(2===this._state&&1===this.rhc);return 32}UB(Q){const sa=new wm;sa.onUpsellButtonClicked=Object(n.a)(this,this.onUpsellButtonClicked,
"onUpsellButtonClicked");sa.fontName=this.TO;sa.isLicensed=Q;sa.trigger=this.g$e;sa.helpArticleUrl=this.U$j();sa.paneId=Cj.a.zUb;Q=this.pdl();Q.contentProps=sa;return Q}pdl(){return Object.assign(new Vc.a,{title:Cj.a.Myb,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(n.a)(this,this.onOpen,"onOpen"),onClose:Object(n.a)(this,this.onClose,"onClose"),onShow:Object(n.a)(this,this.onShow,"onShow"),onHide:Object(n.a)(this,this.onHide,
"onHide")})}Uua(){if(this.jb){var Q=this.jb.ed(Cj.a.zUb);Q.parent=De.AFrame.Ho;Q.GQ=!0}}onOpen(){this._state=2;this.jR()}onShow(Q){this._state&&(this._state=2,1===Q&&(this.rhc=Q),this.jR())}onClose(){this.rhc=this._state=0;this.blur()}onHide(){this._state=1;this.rhc=0}jR(){this.jb&&1===this.rhc&&this.jb.qf(Cj.a.zUb)}blur(){this.jb&&this.jb.Bf&&this.jb.Bf.name===Cj.a.zUb&&this.jb.qf(this.jb.SV)}onUpsellButtonClicked(){this.Kjb.launchUpsellExperience(Cj.a.experienceId)}dispose(){this.Kjb.WAc(Lp.a.b0b,
this.xJd)}U$j(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&Lcid={3}",this.Ygj,this.FPk(),"WDWAENDUSER",G.AFrameworkApplication.lcid)}FPk(){switch(this.g$e){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return el.UXj(this.TO)}static UXj(Q){let sa="hlpFontInfo";for(let bb=0;bb<Q.length;++bb){const Cb=$a.a.charAt(Q,
bb);$a.a.z$h(Cb)&&(sa+=Cb)}return sa}}Object(c.a)(el,"FontInfoPane",null,[1300,13]);class Yl extends el{constructor(Q,sa,bb,Cb,dc){super(Q,sa,Cb.Oa("FontInfoHelpBaseUrl"),dc);this.mE=bb}iU(Q){this.X0();super.iU(Q)}k$a(Q){super.k$a(Q);Mf.App.oa.updateCommandUI()}X0(){this.mE.BUa()}}Object(c.a)(Yl,"WordEditorFontInfoPane",el,[]);class Sj{constructor(){this.Wfc=this.EOd=this.ZMc=this.Z=null}get name(){return"WordEditor.ModernFontPicker"}Nb(Q){this.Z=Q;Q.ia("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new Io(this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).fa();Q.ia("Common.ModernFontPicker.IFontInfoPane",()=>new Yl(new yb.a(()=>G.AFrameworkApplication.qa),this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Il.a.instance,G.AFrameworkApplication.K,yj.FocusManager.instance())).fa()}init(){this.EOd=this.Z.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.ZMc=this.Z.resolve("Common.ModernFontPicker.IFontInfoPane");
this.ZMc.initialize();G.AFrameworkApplication.K.$("IsAnonymousUser")||((this.Wfc=this.Z.sa(ig.a))?this.Wfc.initialize():ua.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Mf.App.oa.updateCommandUI()}dispose(){this.ZMc&&(this.ZMc.dispose(),this.ZMc=null);this.EOd&&(this.EOd.dispose(),this.EOd=null);this.Wfc&&(this.Wfc.Ivh(),this.Wfc=null)}static main(){Object(km.a)()&&aa.a.instance.jc(new Sj)}}Object(c.a)(Sj,"ModernFontPickerPackage",null,[2,3]);var Nl=b(123),lm=
b(7),tp=b(36),Qm=b(845);class Yj{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg,Zg,Wh=null){this.Cx=bb;this.XPd=Cb;this.Lb=Q;this.Qb=sa;this.Nd=dc;this.kQa=Oc;this.U_=yd;this.oPg=md;this.nPg=Af;this.fp=wg;this.uc=Zg;this.KHd=Wh||Yj.jx}get Yf(){return this.fp?this.fp.Yf:!1}N8h(Q){return this.Esa(Q,0)}Hfl(Q){return this.Esa(Q,1)}Esa(Q,sa){let bb=null;if(this.Yf&&this.U_&&(this.nPg.instance&&this.nPg.instance.rPa(Q),sa?1===sa&&(bb=this.U_.WWh(Q.node)):bb=this.U_.CGf(Q.node,Q.cpBegin,Q.gb),bb&&!bb.ha(Zb.a.Zbb,
!1)))return ua.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),2;const Cb=lm.GraphIterator.ey(this.Lb.ij());Cb.set(Q.node);Cb.Na(10);const dc=this.Qb.wc(15);dc.it(Cb);sa?tp.OutlineElementNavigator.Ic(Cb):(this.splitParagraph(Cb,Q),this.Cx.acc(Q.node,Ui.a.eq));Q=wk.ParagraphReader.Wo(Cb.currentNode);this.Hgl(Cb);this.Yf&&bb&&this.oPg&&(sa=new fa.a,sa.add(Cb.currentNode),this.oPg.Vhh(sa,bb.id));this.Irm(Q);dc.dispose();return 32}Irm(Q){Q=Nh.SelectionFactory.$d(Q,
0);Vl.a.instance.setSelection(Q)}Hgl(Q){this.Nd.UE(Q,!0,!0,null,!1,!1);Q=tp.OutlineElementNavigator.Cd(Q);this.Ifl(Q)}splitParagraph(Q,sa){const bb=tp.OutlineElementNavigator.Ic(Q);if(sa.cpBegin||this.Yf&&(!this.Yf||-1!==sa.gb)){of.a.instance.J(50)&&Mf.App.Ob.tk&&sa.cpBegin!==wk.ParagraphReader.textLength(sa.node)&&Mf.App.Ob.Il.HA(sa.node);this.Nd.UE(Q,!1,!0,null,!1,!0);var Cb=lm.GraphIterator.ey(this.Lb.ij());Cb.set(bb);this.Nd.iha(Cb,Q,sa,!0,!0,!0)}}Ifl(Q){Q=this.KHd(Q);this.kQa.XTf(Q)}static get characterPropertiesEditor(){return Yj.Hb||
(Yj.Hb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static yE(){return new Yj(new Cn.a,new Xo.a,xa.a.instance.resolve("Box4.IAutoCorrectScheduler"),Qm.a.instance,xa.a.instance.resolve("Box4.IOutlineElementEditor"),xa.a.instance.resolve("Box4.IBlobEditor"),xa.a.instance.sa("Box4.IContentControlReader"),xa.a.instance.sa("Box4.IContentControlEditor"),xa.a.instance.Fa("Box4.IContentControlConverter"),xa.a.instance.sa("Box4.ContentControlConfigSettings"),xa.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return Yj.ta||
(Yj.ta=Yj.yE())}static jx(Q){return ca.a.jx(Q)}}Yj.Hb=null;Yj.ta=null;Object(c.a)(Yj,"PageBreakInserter",null,[1832]);class fn{constructor(Q,sa,bb,Cb,dc,Oc,yd,md){this.ea=Q;this.hTe=sa;this.Qb=bb;this.pl=Cb;this.vVe=dc;this.sl=Oc;this.wrj=yd;this.hb=md}pb(){this.ea.na($b.a.Esa,ng.a.view,Object(n.a)(this,this.Kgl,"insertPageBreakViewHandler"));this.ea.na($b.a.Esa,ng.a.xc,Object(n.a)(this,this.Jgl,"insertPageBreakIpHandler"));this.ea.na($b.a.Esa,ng.a.table,Object(n.a)(this,this.Igl,"insertPageBreakBeforeTableHandler"));
this.ea.pc($b.a.Esa,4)}YT(){const Q=yj.FocusManager.instance().ed(Nl.AppFrame.EE);De.AFrame.Ii(Q,kf.KeyInputManager.Cb(Ui.a.eq,kf.KeyInputManager.Qh),$b.a.Esa)}Kgl(Q,sa,bb,Cb){var dc=sa.view,Oc=dc.ib.Fg;if(!Oc)return 2;if(!this.Klf(sa))return 8;if(1===bb)return 32;let yd=!0;bb=8;const md=this.vVe(Oc);Oc=this.Qb.wc(15);Oc.Wa(dc.Xc);Oc.im=Q;md||(bb=this.ea.Te(sa,ve.a.nra,2,!0,Cb,null),Q=32===bb,ua.ULS.shipAssertTag(4208012,314,Q),yd=Q);yd&&(dc=dc.ib.Fg,Q=this.vVe(dc),ua.ULS.shipAssertTag(4208013,314,
Q,"{0}",{["ContextId"]:sa.contextId}),bb=8,Q&&(bb=this.hTe.N8h(dc),ua.ULS.shipAssertTag(4208014,314,32===bb)));Oc.dispose();32===bb&&this.hb.jq(10);return bb}Nnl(Q){return this.Tv(Q.iterator)}Aql(Q){Q=Q.J(0);const sa=fk.SelectionEditor.gk(Q,!0,!1);if(this.Tv(sa.wa.iterator))return!0;Q=fk.SelectionEditor.gk(Q,!1,!1);return this.Tv(Q.wa.iterator)}Tv(Q){return Q.Na(14)}Jgl(Q,sa,bb){if(!sa||sa.contextId!==ng.a.xc)return 8;if(1===bb)return sa.contextId===ng.a.xc?32:8;if(2===bb){if(!this.Klf(sa))return 8;
Q=this.hTe.N8h(sa);32===Q&&this.hb.jq(10);return Q}return 32}Igl(Q,sa,bb){if(!sa||sa.contextId!==ng.a.table)return 8;if(1===bb)return 32;if(2===bb){if(!this.Klf(sa))return 8;Q=this.hTe.Hfl(sa);32===Q&&this.hb.jq(10);return Q}return 32}Klf(Q){let sa=null;if(Q.contextId===ng.a.view){sa=Q.view;if(!sa.features.eAd)return!1;Q=sa.ib.Fg;if(!Q)return!1}else{var bb=lm.GraphIterator.xa(Q.node);if(bb.Na(36)||bb.Na(38)||bb.Na(40)||bb.Na(14))return!1}return Q.contextId===ng.a.table?of.a.instance.J(14)&&this.sl.ynl(Q.node):
of.a.instance.J(14)&&!this.sl.wnl(Q)||this.pl&&this.pl.instance&&this.pl.instance.wQ(Q)?!1:((bb=this.vVe(Q))?this.Nnl(Q):this.Aql(sa.ib.Ia))||bb&&this.wrj(Q,!0)?!1:!0}static yE(){return new fn(G.AFrameworkApplication.qa,Yj.instance,new Xo.a,xa.a.instance.Fa("Box4.IExternalSelectionManager"),fk.SelectionEditor.Le,Ok.a.instance,Aa.HyperlinkReader.v6,xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return fn.ta||(fn.ta=fn.yE())}}fn.ta=null;Object(c.a)(fn,
"PageBreakActor",null,[1800]);class gn{constructor(){this.M0e=this.Z=null}get name(){return"WordEditor.PageBreak"}Nb(Q){this.Z=Q}init(){this.Z.resolve("Box4.IFeatureHelper").Uk.continueWith(()=>{this.Ck()})}Ck(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(140)&&(this.M0e=fn.instance,this.M0e.pb(),this.M0e.YT(),Mf.App.oa.updateCommandUI())}dispose(){}}Object(c.a)(gn,"PackageManager",null,[2,3]);var Mp=b(1081),Zj=b(75),mm=b(1082),fg=b(230),Bg=b(139),Qn=b(235),ln=b(250),jo=b(483);class Gg{constructor(Q,
sa,bb,Cb,dc,Oc,yd,md){this.JKb=null;this.la=new m.a;this.GLe=1;this.BNd=-1;this.v4a=null;this.ea=Q;this.Da=sa;this.Za=bb;this.GId=Cb;this.My=dc;this.zt=Oc;this.rH=yd;this.dMd=md;this.enable()}get l6c(){return this.GLe}mSi(Q){this.GLe!==Q&&(this.GLe=Q,this.la.raiseEvent("X"),this.eZf&&this.wHg())}get eZf(){const Q=xa.a.instance.sa("WordEditor.Pagination.IPageEndMarkers");return Q?Q.eZf:!0}get Df(){return this.My.value}get Qj(){return Re.a.instance}JMj(Q){this.la.addHandler("X",Q)}wHg(){this.Qj.Jd(()=>
{this.rH.$L(this.dMd?jo.a.yqd:jo.a.zqd)},"CPC:UPN")}enable(){this.Da.KB(Object(n.a)(this,this.Sta,"onProcessSetSelectionFinished"));this.Xjf()}Sta(){this.Xjf()}Xjf(){if(!this.v4a||1>=this.v4a.count)this.mSi(1);else{var Q=this.Da.Ia.Ra;if(Q){var sa=Q.Re?Q.hc:Q.wa;!sa||0>sa.cpBegin||(Q=sa.node)&&wk.ParagraphReader.Mb(Q)&&this.lnl(Q)&&(this.JKb&&(this.Za.xe(this.JKb),this.JKb=null),this.JKb=new kc.a(2,1,400,bb=>{this.findCurrentPageFromIp(bb,sa)},62),this.Za.Eb(this.JKb))}}}lnl(Q){Q=lm.GraphIterator.xa(Q);
return Q.Na(35)||Q.Na(37)||Q.Na(39)?!1:!0}W5i(Q){this.v4a=Q;this.N4i()}N4i(){if(-1!==this.BNd){var Q=this.Nyk(this.BNd);-1!==Q&&this.mSi(Q)}}findCurrentPageFromIp(Q,sa){this.JKb===Q&&(this.JKb=null,this.BNd=this.oFk(sa),-1!==this.BNd&&this.N4i())}Nyk(Q){if(!this.v4a)return-1;for(let sa=0;sa<this.v4a.count;sa++){const bb=this.v4a.J(sa);if(Q>bb.$gh&&Q<bb.$gh+bb.height)return bb.pageNumber}return-1}oFk(Q){var sa=this.lWk(Q);if(!sa||!sa.htmlElement)return-1;const bb=sa.getBounds();Q=this.VKk(Q,sa);if(!Q)return-1;
sa=la.a.Dab(this.GId.Yeb,sa.htmlElement).y;return Q.y+Math.floor(Q.height/2)-bb.y+sa}lWk(Q){return Q.node.wd(this.Df.Ya)}VKk(Q,sa){Q=this.zt?this.zt.Iya(Q,!0):Q.cpBegin;return ln.a.ul(sa,Q)}disable(){this.Da.EBa(Object(n.a)(this,this.Sta,"onProcessSetSelectionFinished"))}}Object(c.a)(Gg,"CurrentPageCalculator",null,[1874,1869]);class vo{constructor(Q,sa){vo.GX=Q;this.LTe=sa}get soc(){return vo.GX}get Jee(){return this.LTe}get l6c(){return this.soc.l6c}Usk(){this.LTe=!0;this.soc.enable()}Dok(){this.LTe=
!1;this.soc.disable()}}vo.GX=null;Object(c.a)(vo,"CurrentPageManager",null,[1873]);var Rn=b(108);class ko extends Sys.EventArgs{constructor(Q,sa){super();this.rqi=sa}}Object(c.a)(ko,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class mn extends Sys.EventArgs{constructor(Q,sa,bb){super();this.delta=Q;this.rqi=bb}}Object(c.a)(mn,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class nj{constructor(Q,sa){this.Q8g=this.aRd=-1;this.ZPd=null;this.la=new m.a;this.EZe=!1;this.My=Q;this.vR=sa;this.p4a=
new fa.a;this.Df.gkh(Object(n.a)(this,this.mWl,"pageViewOnAfterValidate"));this.UQf()}get Df(){return this.My.value}get Yeb(){this.ZPd||(this.ZPd=this.Df.Xc.wd(this.Df.Ya).Yeb,ua.ULS.shipAssertTag(34136386,336,!!this.ZPd));return this.ZPd}KNj(Q){this.la.addHandler("OnPageContentSizeChangeKey",Q)}mWl(Q,sa){this.EZe=this.q4j();sa.Xta||this.vR.value.measure(Object(n.a)(this,this.m4j,"checkForDocumentSizeChanges"))}m4j(){const Q=this.Yeb.clientHeight;this.l4j(Q);this.s4j(Q)}l4j(Q){Q!==this.Q8g&&(this.la.raiseEvent("OnDocumentBottomChangeKey",
new ko(Q,this.EZe)),this.Q8g=Q)}s4j(Q){Q!==this.aRd&&(-1!==this.aRd&&this.la.raiseEvent("OnPageContentSizeChangeKey",new mn(Q-this.aRd,Q,this.EZe)),this.aRd=this.Yeb.clientHeight)}q4j(){let Q=!1;for(let sa=this.p4a.count-1;0<=sa;sa--)this.p4a.J(sa).hasChildNodes()&&(this.p4a.removeAt(sa),Q=!0);return Q}UQf(){Mf.App.rh.Ej.ke(23).Dp(Object(n.a)(this,this.Ncg,"outlineGroupOnPropertyChanged"))}Ncg(Q,sa){sa.property===Rn.a.aC&&(Q=sa.node)&&Q.ha(Rn.a.aC,!1)&&(Q=Q.wd(this.Df.Ya))&&(Q=Q.htmlElement)&&this.p4a.add(Q)}}
Object(c.a)(nj,"DocumentSizeManager",null,[]);var le=b(70),bo=b(259);class lq{constructor(Q){this.My=Q}get Df(){const Q=this.My.value;ua.ULS.shipAssertTag(37820298,336,Q.Bi,"OutlineManager.PageView is not a PageView.");return Q}mve(Q,sa){const bb=le.a.Qg(lq.Fj.rD(Q),1);sa+=bb;Q.wd(this.Df.Ya).htmlElement.firstChild.style.minHeight=sa+"px"}zUh(){const Q=lm.GraphIterator.xa(this.Df.Xc);Q.to();Q.ie();ua.ULS.shipAssertTag(37820299,336,10===Q.qm.type);return Q.qm}BWh(){const Q=lm.GraphIterator.xa(this.Df.Xc);
Q.to();Q.K1();ua.ULS.shipAssertTag(37820300,336,10===Q.qm.type);return Q.qm}LXk(Q){const sa=lm.GraphIterator.xa(this.Df.Xc);sa.to();sa.ie();let bb=sa.qm,Cb=null;for(;Q!==bb&&sa.kl();)Cb=bb,bb=sa.qm;ua.ULS.shipAssertTag(37820301,336,10===sa.qm.type);return Cb}static get Fj(){return bo.a.instance}}Object(c.a)(lq,"OutlineManager",null,[1872]);class up{constructor(Q){this.uFa=0;this.B3=null;this.Za=Q}Fne(){this.B3||(this.B3=this.u5c())}T0d(){this.B3&&0<up.jad(this.B3).length&&this.Za.Eb(this.B3);this.B3=
null}u5c(){return Object.assign(new kc.a(3,1,250,Object(n.a)(this,this.Zxg,"showAdornmentTextBatched"),166),{Om:[]})}tug(Q){this.uFa=Q}Myd(Q){if(Q){Q.style.width=this.uFa+"px";if(this.B3)var sa=this.B3;else sa=this.u5c(),this.Za.Eb(sa);up.jad(sa).push(Q)}}Vfd(Q){Q&&(Q.style.width="0px",this.EQf(Q))}rCd(Q,sa){sa?this.Myd(Q):this.Vfd(Q)}Zxg(Q){for(let sa of Q.Om)this.showAdornmentText(sa)}showAdornmentText(Q){Q.style.width===this.uFa+"px"&&(this.Bad(Q).style.visibility="visible")}EQf(Q){Q&&(this.Bad(Q).style.visibility=
"hidden")}Bad(Q){Q=Q.childNodes;ua.ULS.shipAssertTag(24958351,336,1===Q.length,"Expected 1 child div in the page adornment, found "+Q.length);return Q[0]}static jad(Q){return Q.Om}}Object(c.a)(up,"PageAdornmentAnimationManager",null,[1871]);class Gq{constructor(Q){this.Xl=Q;this.zca=new Bb.a;this.Aca=new Bb.a}zIa(Q){Q=lm.GraphIterator.xa(Q);if(Q.to()&&Q.It()){Q.ie();do 10===Q.Sd&&this.efg(Q.currentNode),Q.Gu();while(8!==Q.Sd)}}bac(Q){const sa=Q.pageNumber;var bb=this.KWb(Q.Rbc);if(!this.zca.Pa(bb))return ua.ULS.sendTraceTag(24958352,
336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+bb),!1;Q=this.zca.J(bb);ua.ULS.shipAssertTag(24958353,336,this.Aca.Pa(bb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");bb=this.Aca.J(bb);return this.wQf(Q,sa,bb)}aac(Q){const sa=Q.pageNumber;var bb=this.KWb(Q.Rbc);if(!this.zca.Pa(bb))return ua.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
bb),!1;Q=this.zca.J(bb);ua.ULS.shipAssertTag(24958355,336,this.Aca.Pa(bb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");bb=this.Aca.J(bb);return this.iDf(Q,sa,bb)}RMf(Q){if(!Q)return ua.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var sa=Q.XZd;if(!sa)return ua.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.pageNumber)),
0;sa=this.Xl.wrc(sa);if(!sa)return ua.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;sa=this.Xl.nsa(sa);const bb=1===Q.pageNumber;Q=!(Q.pageNumber%2);return 1===sa?1:2===sa?bb?2:1:3===sa?Q?3:4:bb?2:Q?3:4}efg(Q){if(10===Q.type){var sa=new Bb.a,bb=this.Xl.wrc(Q);ua.ULS.shipAssertTag(24958356,336,!!bb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Cb=this.Xl.nsa(bb);Q=this.KWb(Q);
this.RHg(Q,Cb);this.QHg(Q,sa);bb=lm.GraphIterator.xa(bb);if(bb.It()){bb.ie();do Q=bb.currentNode,Cb=this.Nbd(Q),Q=this.Xl.p5h(Q),sa.add(Cb,Q),bb.Gu();while(36===bb.Sd)}}}RHg(Q,sa){this.Aca.Pa(Q)?this.Aca.W(Q,sa):this.Aca.add(Q,sa)}QHg(Q,sa){this.zca.Pa(Q)?this.zca.W(Q,sa):this.zca.add(Q,sa)}Nbd(Q){ua.ULS.shipAssertTag(24958357,336,36===Q.type,"Expected node of type HeaderFooter but received node of type "+Q.type);return Q.ha(Zb.a.Lsc,0)}KWb(Q){ua.ULS.shipAssertTag(24958358,336,10===Q.type,"Expected node of type Outline but received node of type "+
Q.type);return Q.ha(Zb.a.Oaa,0)}wQf(Q,sa,bb){const Cb=1===sa;sa=!(sa%2);switch(bb){case 2:if(Cb){if(Q.Pa(2))return Q.J(2)}else if(Q.Pa(0))return Q.J(0);break;case 3:if(sa){if(Q.Pa(1))return Q.J(1)}else if(Q.Pa(0))return Q.J(0);break;case 4:if(Cb){if(Q.Pa(2))return Q.J(2)}else if(sa){if(Q.Pa(1))return Q.J(1)}else if(Q.Pa(0))return Q.J(0);break;case 1:if(Q.Pa(0))return Q.J(0)}return!1}iDf(Q,sa,bb){const Cb=1===sa;sa=!(sa%2);switch(bb){case 2:if(Cb){if(Q.Pa(5))return Q.J(5)}else if(Q.Pa(3))return Q.J(3);
break;case 3:if(sa){if(Q.Pa(4))return Q.J(4)}else if(Q.Pa(3))return Q.J(3);break;case 4:if(Cb){if(Q.Pa(5))return Q.J(5)}else if(sa){if(Q.Pa(4))return Q.J(4)}else if(Q.Pa(3))return Q.J(3);break;case 1:if(Q.Pa(3))return Q.J(3)}return!1}}Object(c.a)(Gq,"PageAdornmentContentManager",null,[1870]);class mq{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af){this.iJg(Q,sa,bb,Oc,yd,md,Af);this._pageNumber=Q;this.xk=sa;this.Cr=bb;this.eFj=Cb;this.uhj=dc;this.Xpb=Oc;this.Msc=yd;this.xqc=md;this.eyi=Af}get pageNumber(){return this._pageNumber}get top(){return this.xk}get height(){return this.Cr}get Rbc(){return this.eFj}get XZd(){return this.uhj}Txd(Q){this.xk!==
Q&&(this.Xpb.style.top=Q+"px",this.xk=Q)}Ptg(Q){this.height!==Q&&(this.Xpb.style.height=Q+"px",this.Cr=Q)}iJg(Q,sa,bb,Cb,dc,Oc,yd){ua.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);ua.ULS.shipAssertTag(37244962,336,0<=sa,"PageAdornmentContainer: top parameter value {0} is unexpected value.",sa);ua.ULS.shipAssertTag(37244963,336,0<=bb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",bb,sa);ua.ULS.shipAssertTag(37244992,
336,!!Cb,"PageAdornmentContainer: containerDomElement parameter is null.");ua.ULS.shipAssertTag(37244993,336,!!dc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");ua.ULS.shipAssertTag(37244994,336,!!Oc,"PageAdornmentContainer: footerLabelDomElement parameter is null.");ua.ULS.shipAssertTag(37244995,336,!!yd,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(c.a)(mq,"PageAdornmentContainer",null,[1901]);class nm{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af,
wg,Zg,Wh){this.xXg="headerFooterTab";this.TUd=null;this.Z4=this.zRe=0;this.PWe=null;this.kbb=!1;this.My=Q;this.Qd=sa;this.IK=bb;this.Qna=Cb;this.ea=dc;this.ai=Oc;this.Jv=yd;this.sX=md;this.GDa=Af;this.sRa=wg;this.Za=Zg;this.ra=Wh;this.y3e=[];this.z3=new Map;this.sRa.TXd(Object(n.a)(this,this.GXb,"headerFooterDismissedEvent"));this.Fs=!!G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.U$;if(this.gMd=(this.qTe=!!this.ra&&this.ra.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.ra&&this.ra.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===
Mf.App.oa.fk.getLayoutBreakpoint()&&(this.Jv=!1),Mf.App.oa.fk.registerLayoutBreakpointChanged(this.xXg,vh=>{switch(vh){case "Small":this.K5h();break;default:this.CVi()}})}get Df(){return this.My.value}CVi(){try{this.qBm()}catch(Q){ua.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}K5h(){try{this.V$k()}catch(Q){ua.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,
Q.stack)}}jdm(){for(const Q of this.z3.keys())this.Bre(Q)}zIa(){try{this.m$j()}catch(Q){ua.ULS.shipAssertTag(37244999,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}$um(Q){this.Z4=Q}W5i(Q){try{this.VSm(Q)}catch(sa){ua.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",sa.message)}}dispose(){try{this.ePm(),this.CPm(),this.sRa&&this.sRa.BHi(Object(n.a)(this,this.GXb,"headerFooterDismissedEvent"))}catch(Q){ua.ULS.shipAssertTag(37245001,
336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}i6b(Q){this.bLl(Q.xw);return!0}bLl(Q){const sa=this.Eid(Q),bb=this.ySh(Q);bb?(Q=this.GDa.RMf(bb),this.ea.Db(sa?$b.a.aEd:$b.a.rGc,2,Q),this.kbb=!0):(ua.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ea.processAction($b.a.wtc,2))}dI(){return!0}GXb(){this.Bqf()&&(this.kbb=!1,this.lQm(),this.PWe=new Date)}l6b(Q){this.kbb||this.sX.Myd(Q.xw);
return!0}k6b(Q){this.kbb||(Q=Q.xw,this.Gxg(Q)||this.sX.Vfd(Q));return!0}ePm(){this.z3.forEach(Q=>{this.BAe(Q)})}CPm(){this.Fs&&(this.gMd&&(Mf.App.oa.fk.unregisterLayoutBreakpointChanged(this.xXg),this.gMd=!1),this.Fs=!1)}BAe(Q){if(Q){var sa=Q.Msc;Q=Q.xqc;bh.a.ZLa(sa)&&bh.a.ZLa(Q)?(this.ai.Ib(D.a.WL,sa,Object(n.a)(this,this.l6b,"onMouseHoverOver")),this.ai.Ib(D.a.WL,Q,Object(n.a)(this,this.l6b,"onMouseHoverOver")),this.ai.Ib(D.a.vG,sa,Object(n.a)(this,this.k6b,"onMouseHoverLeave")),this.ai.Ib(D.a.vG,
Q,Object(n.a)(this,this.k6b,"onMouseHoverLeave")),this.Qd.Ib(D.a.click,sa,Object(n.a)(this,this.i6b,"onHeaderFooterClickEvent")),this.Qd.Ib(D.a.click,Q,Object(n.a)(this,this.i6b,"onHeaderFooterClickEvent")),this.IK.Ib(sa,nm.Y5b),this.IK.Ib(Q,nm.Y5b),this.Qna.Ib(D.a.qz,sa,Object(n.a)(this,this.dI,"onMouseDown")),this.Qna.Ib(D.a.qz,Q,Object(n.a)(this,this.dI,"onMouseDown"))):ua.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}W4l(Q){Array.enqueue(this.y3e,
Q);this.TUd||(this.TUd=new kc.a(2,1,50,Object(n.a)(this,this.z$l,"registerEventHandlersTask")),this.Za.Eb(this.TUd))}z$l(){let Q=Array.dequeue(this.y3e);for(;Q;)this.wma(Q),Q=Array.dequeue(this.y3e);this.TUd=null}wma(Q){if(Q){var sa=Q.Msc;Q=Q.xqc;bh.a.ZLa(sa)&&bh.a.ZLa(Q)?(this.ai.Ma(D.a.WL,sa,Object(n.a)(this,this.l6b,"onMouseHoverOver")),this.ai.Ma(D.a.WL,Q,Object(n.a)(this,this.l6b,"onMouseHoverOver")),this.ai.Ma(D.a.vG,sa,Object(n.a)(this,this.k6b,"onMouseHoverLeave")),this.ai.Ma(D.a.vG,Q,Object(n.a)(this,
this.k6b,"onMouseHoverLeave")),this.Qd.Ma(D.a.click,sa,Object(n.a)(this,this.i6b,"onHeaderFooterClickEvent")),this.Qd.Ma(D.a.click,Q,Object(n.a)(this,this.i6b,"onHeaderFooterClickEvent")),this.IK.Ma(sa,nm.Y5b),this.IK.Ma(Q,nm.Y5b),this.Qna.Ma(D.a.qz,sa,Object(n.a)(this,this.dI,"onMouseDown")),this.Qna.Ma(D.a.qz,Q,Object(n.a)(this,this.dI,"onMouseDown"))):ua.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}qBm(){if(!this.Jv){for(let Q of this.z3.values())Q.Xpb.style.display=
"block";this.Jv=!0}}V$k(){this.Jv&&(this.z3.forEach(Q=>{Q.Xpb.style.display="none"}),this.Jv=!1)}m$j(){this.GDa.zIa(this.Df.Xc)}VSm(Q){this.sX.Fne();var sa=0;const bb=new fa.a;this.zIa();const Cb=this.zRk();for(var dc of Q)Q=dc.pageNumber,this.UVl(dc)||this.Bre(dc.pageNumber),this.z3.has(Q)?this.bRm(dc):this.Vdk(dc),sa=Q,bb.add(Q);for(dc=1;dc<=sa;dc++)bb.contains(dc)||this.Bre(dc);for(sa+=1;sa<=Cb;sa++)this.Bre(sa);this.sX.T0d()}UVl(Q){return this.z3.has(Q.pageNumber)?this.z3.get(Q.pageNumber).Rbc.id===
Q.Rbc.id:!1}zRk(){let Q=0;this.z3.forEach((sa,bb)=>{bb>Q&&(Q=bb)});return Q}Vdk(Q){const sa=Q.Rbc.wd(this.Df.Ya);if(sa){var bb=Q.pageNumber;Q=this.hrf(bb,Q.top,Q.height,sa.tra,Q.Rbc,Q.XZd);this.W4l(Q);this.fGg(Q);this.jIg(Q);this.gMd&&!this.Jv&&(Q.Xpb.style.display="none");this.z3.set(bb,Q)}}hrf(Q,sa,bb,Cb,dc,Oc){const yd=zj.b("div","","PageAdornmentContainer");yd.style.top=sa+"px";yd.style.height=bb+"px";Cb.appendChild(yd);this.Zjf(yd,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);
Cb=this.Csf(Q);yd.appendChild(Cb);const md=this.Vrf(Q);yd.appendChild(md);const Af=this.Lrf(Q);yd.appendChild(Af);G.AFrameworkApplication.isRtl&&(Sys.UI.DomElement.addCssClass(yd,"Rtl"),Sys.UI.DomElement.addCssClass(md,"Rtl"),Sys.UI.DomElement.addCssClass(Af,"Rtl"));return new mq(Q,sa,bb,dc,Oc,yd,md,Af,Cb)}Vrf(Q){Q=zj.b("div","h"+Q,"PageAdornmentHeaderLabel");const sa=zj.b("span","","");sa.innerText=WordEditorIntl.WordEditorStrings.l_Header;sa.style.whiteSpace="nowrap";Q.appendChild(sa);return Q}Lrf(Q){Q=
zj.b("div","f"+Q,"PageAdornmentFooterLabel");const sa=zj.b("span","","");sa.innerText=WordEditorIntl.WordEditorStrings.l_Footer;sa.style.whiteSpace="nowrap";Q.appendChild(sa);return Q}Csf(Q){const sa=zj.b("div","","PageAdornmentNumberLabel");sa.innerText=Q.toString();return sa}Zjf(Q,sa,bb){if(!this.zRe){const Cb=zj.b("p","","");Cb.innerText=sa;Cb.style.whiteSpace="nowrap";Cb.style.visibility="hidden";Q.appendChild(Cb);sa=zj.b("p","","");sa.innerText=bb;sa.style.whiteSpace="nowrap";sa.style.visibility=
"hidden";Q.appendChild(sa);this.zRe=Q.clientWidth;this.sX.tug(this.zRe);Q.removeChild(Cb);Q.removeChild(sa)}}Bre(Q){if(this.z3.has(Q)){var sa=this.z3.get(Q);this.BAe(sa);bh.a.Yq(sa.Xpb);this.z3.delete(Q)}}bRm(Q){if(this.z3.has(Q.pageNumber)){var sa=this.z3.get(Q.pageNumber);sa.Txd(Q.top);sa.Ptg(Q.height);this.fGg(sa);this.jIg(sa)}else ua.ULS.sendTraceTag(37245005,324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}lQm(){this.sX.Fne();this.zIa();this.z3.forEach(Q=>
{this.fGg(Q);this.jIg(Q)});this.sX.T0d()}fGg(Q){const sa=Q.Msc,bb=Q.xqc,Cb=this.GDa.bac(Q),dc=this.GDa.aac(Q);this.BUm(Q,Cb,dc);this.sX.rCd(sa,Cb);this.sX.rCd(bb,dc)}BUm(Q,sa=!0,bb=!0){const Cb=Q.Msc;Q=Q.xqc;3!==G.AFrameworkApplication.qa.mode?(Cb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Cb.title=sa?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=bb?WordEditorIntl.WordEditorStrings.l_EditFooter:
WordEditorIntl.WordEditorStrings.l_AddFooter)}Gxg(Q){const sa=this.ySh(Q);return sa?this.Eid(Q)?this.GDa.bac(sa):this.GDa.aac(sa):(ua.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}ySh(Q){Q=Q.id;Q=Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.z3.has(Q)?this.z3.get(Q):(ua.ULS.sendTraceTag(37245007,336,10,"Adornment container map does not contain the page number "+Q),null)}Eid(Q){return Q.id.length?"h"===Q.id.substring(0,1):(ua.ULS.sendTraceTag(37245008,
336,10,"Empty ID found for adornment"),!0)}jIg(Q){const sa=Q.height;sa<nm.tGl?(Sys.UI.DomElement.addCssClass(Q.Msc,nm.gub),Sys.UI.DomElement.addCssClass(Q.xqc,nm.gub)):(Sys.UI.DomElement.removeCssClass(Q.Msc,nm.gub),Sys.UI.DomElement.removeCssClass(Q.xqc,nm.gub));sa<nm.uGl?(Sys.UI.DomElement.addCssClass(Q.eyi,nm.gub),Sys.UI.DomElement.addCssClass(Q.Xpb,nm.gub)):(Sys.UI.DomElement.removeCssClass(Q.eyi,nm.gub),Sys.UI.DomElement.removeCssClass(Q.Xpb,nm.gub))}Bqf(){return!this.PWe||F.a.mQf(this.PWe,500)}static Y5b(){return!0}}
nm.gub="Hidden";nm.tGl=120;nm.uGl=50;Object(c.a)(nm,"PageAdornmentManager",null,[1868,13,1869]);class Np{constructor(Q,sa){this.N0e=new fa.a;this.N0e.add(Q);this.N0e.add(sa)}get Uxi(){return this.N0e}}Object(c.a)(Np,"PageElementManagerList",null,[]);var Gm=b(53);class Pk{constructor(Q){this.tl=Q;this.uic=[]}XFi(){for(let Q=0,sa=this.uic.length;Q<sa;Q++)bh.a.Yq(this.uic[Q]);Array.clear(this.uic)}MTh(Q,sa,bb,Cb,dc,Oc){let yd=Math.min(Cb.x-Oc.x,dc.x-Oc.x);Cb=Math.min(Oc.x+Oc.width-(Cb.x+Cb.width),Oc.x+
Oc.width-(dc.x+dc.width));sa+=dc.y-Oc.y;({kma:sa,leftMargin:yd,rightMargin:Cb}=this.GPj(sa,yd,Cb));Q=this.FVk(Q,yd,Cb,yd,Cb,bb);Q.style.top=sa+"px";Q.style.zIndex="0";Array.add(this.uic,Q);Gm.c(Q,!0);return Q}S$d(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):null}FVk(Q,sa,bb,Cb,dc,Oc){return Q?Pk.s1k(sa,bb,Cb,dc,Oc):Pk.QVk(Cb,dc,Oc)}GPj(Q,sa,bb){sa/=this.tl.instance.Kh;bb/=this.tl.instance.Kh;Q/=this.tl.instance.Kh;return{kma:Q,leftMargin:sa,rightMargin:bb}}Pml(Q){return this.kgi(Q)&&this.Vxi(Q)?
(Q=this.tWb(Q))&&Q.offsetParent?!1:!0:!1}Oml(Q){return!this.kgi(Q)||this.Vxi(Q)?!1:!0}zT(){}tWb(Q){if(!Q.Hdg)return null;let sa=null;Q.mvb&&!Q.Efa?(Q=this.S$d(Q.Hdg))&&(sa=Q):sa=Q.Hdg;return sa}kgi(Q){return Q.mvb&&!Q.Efa&&Q.paragraphNode?!0:!1}Vxi(Q){Q=Q.paragraphNode;return!!Q&&!!Q.anchor}cth(Q,sa){Q=la.a.N$a(Q);sa=la.a.N$a(sa);return(Q-sa)/this.tl.instance.Kh}hkf(Q,sa){Q=la.a.N$a(Q);sa=la.a.N$a(sa);return(Q-sa)/this.tl.instance.Kh}hje(){this.Y5i(!1)}gje(){this.Y5i(!0)}Y5i(Q){for(let sa=0,bb=this.uic.length;sa<
bb;sa++){const Cb=this.uic[sa];"PageEndMarker.Para"===Cb.id?Pk.a6i(Cb,Q):"PageEndMarker.Table"===Cb.id&&Pk.E6i(Cb,Q)}}static QVk(Q,sa,bb){Pk.Xkc||(Pk.Xkc=zj.b("div","PageEndMarker.Para","PageEndMarker"),Pk.Xkc.appendChild(zj.b("div","","Current FullWidth")),Pk.Xkc.appendChild(zj.b("div","","Stale LeftWing")),Pk.Xkc.appendChild(zj.b("div","","Stale RightWing")));const Cb=Pk.Xkc.cloneNode(!0);Cb.childNodes[1].style.width=Q-10+"px";Cb.childNodes[2].style.width=sa-10+"px";Pk.a6i(Cb,bb);return Cb}static s1k(Q,
sa,bb,Cb,dc){Pk.lNb||(Pk.lNb=zj.b("div","PageEndMarker.Table","PageEndMarker"),Pk.lNb.appendChild(zj.b("div","","Current LeftWing")),Pk.lNb.appendChild(zj.b("div","","Current RightWing")),Pk.lNb.appendChild(zj.b("div","","Stale LeftWing")),Pk.lNb.appendChild(zj.b("div","","Stale RightWing")));const Oc=Pk.lNb.cloneNode(!0);Oc.childNodes[0].style.width=Q+"px";Oc.childNodes[1].style.width=sa+"px";Oc.childNodes[2].style.width=bb-10+"px";Oc.childNodes[3].style.width=Cb-10+"px";Pk.E6i(Oc,dc);return Oc}static a6i(Q,
sa){sa?Pk.CCl(Q):Pk.DCl(Q)}static DCl(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="block"}static CCl(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="none"}static E6i(Q,sa){sa?Pk.GCl(Q):Pk.HCl(Q)}static HCl(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static GCl(Q){Q.childNodes[0].style.display=
"block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}Pk.Xkc=null;Pk.lNb=null;Object(c.a)(Pk,"PageEndDOMHelper",null,[]);class Jo{constructor(Q,sa){this.SKb=this.V8g=null;this.tl=Q;this.Rd=sa}TAg(Q,sa){try{this.eGm(Q,sa)}catch(bb){ua.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",bb.message)}}O9j(Q,sa,bb,Cb,dc,Oc,yd){this.Rd.Jd(()=>{try{this.P9j(Q,sa,bb,Cb,dc,Oc,
yd)}catch(md){ua.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",md.message)}},"PEMPC:CP")}eGm(Q,sa){this.V8g=Q;this.SKb=sa}P9j(Q,sa,bb,Cb,dc,Oc,yd){var md=this.V8g;if(md&&Q){var Af=md.count,wg=Q.count;if(Af&&wg){var Zg=this.gzk(md,Q);if(Zg.count){var Wh=this.tl.Kh,vh=this.xnc(Zg)/Wh,sl=this.zyh(Zg)/Wh;Q=this.m7d(md,Q);if(Q.count){md=this.xnc(Q)/Wh;Wh=this.zyh(Q)/Wh;var qh=!0;for(var Cd=0;Cd<Zg.count;Cd++)if(Zg.J(Cd)){qh=!1;break}var Mg=
Cd=0;this.SKb&&sa&&(Cd=this.L0j(this.SKb,sa),Mg=sa.count-this.SKb.count);ua.ULS.sendTraceTag(35005343,336,50,"{0}",{["FlightEnabled"]:bb,["HardPageBreakExists"]:dc,["EstimatedPageCount"]:Af,["CalculatedPageCount"]:wg,["InOrderAverageDelta"]:vh,["InOrderStandardDeviation"]:sl,["ShortestAverageDelta"]:md,["ShortestStandardDeviation"]:Wh,["PositionsShouldBeUpdated"]:Cb,["DocumentHeightChanged"]:Oc,["DeltasAllZero"]:qh,["HeaderFooterOpenSinceLastResponse"]:yd,["DeltaInViewport"]:Cd,["ChangeInViewportMarkerCount"]:Mg});
Oc||yd||qh||(ua.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),sa=Zg.toArray().toString(),bb=Q.toArray().toString(),ua.ULS.sendTraceTag(35726603,336,50,"{0} {1}",sa,bb))}}}}else ua.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}L0j(Q,sa){const bb=new fa.a;for(let Cb of Q)bb.add(Cb.top);if(!bb.count)return-1;Q=new fa.a;
for(let Cb of sa)Q.add(Cb.top);if(!Q.count)return-1;sa=this.m7d(bb,Q);return this.xnc(sa)/this.tl.Kh}xnc(Q){if(!Q.count)return 0;let sa=0;for(let bb=0;bb<Q.count;bb++)sa+=Q.J(bb);return sa/Q.count}zyh(Q){if(!Q.count)return 0;const sa=this.xnc(Q);let bb=0;for(let Cb=0;Cb<Q.count;Cb++){const dc=Q.J(Cb)-sa;bb+=dc*dc}return Math.sqrt(bb/Q.count)}gzk(Q,sa){const bb=new fa.a;if(!Q.count||!sa.count)return bb;Q.Sc((dc,Oc)=>dc-Oc);sa.Sc((dc,Oc)=>dc-Oc);const Cb=Math.min(Q.count,sa.count);for(let dc=0;dc<Cb;dc++){const Oc=
Math.abs(Q.J(dc)-sa.J(dc));bb.add(Oc)}return bb}m7d(Q,sa){const bb=new fa.a;if(!Q.count||!sa.count)return bb;var Cb=Q.count<=sa.count;const dc=Cb?Q:sa;Q=Cb?sa:Q;for(sa=0;sa<dc.count;sa++){Cb=dc.J(sa);let yd=Math.abs(Cb-Q.J(0)),md=0;for(let Af=1;Af<Q.count;Af++){var Oc=Q.J(Af);Oc=Math.abs(Cb-Oc);Oc<yd&&(yd=Oc,md=Af)}bb.add(yd);Q.removeAt(md)}return bb}}Object(c.a)(Jo,"PageEndMarkerPositionComparer",null,[1867]);var zk=b(331),Mi=b(612);class Zp{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg){this.xk=Q;this._pageNumber=
sa;this.orj=bb;this.Zrj=Cb;this.Xxj=dc;this.OTc=Oc;this.oic=yd;this.a7g=md;this.ic=Af;this.Fxj=wg}get top(){return this.xk}get pageNumber(){return this._pageNumber}get mvb(){return this.orj}get Efa(){return this.Zrj}get Hdg(){return this.Xxj}get outlineNode(){return this.OTc}get outlineGroupNode(){return this.oic}get vVl(){return this.a7g}get paragraphNode(){return this.ic}get JW(){return this.Fxj}Txd(Q){this.xk=Q}nve(Q){this._pageNumber=Q}KQi(Q){this.a7g=Q}}Object(c.a)(Zp,"PageEndMarker",null,[]);
class Pi{constructor(){this.ye=null;this.xqi=0}}Object(c.a)(Pi,"PageEndMarkerToRestore",null,[]);class wo{constructor(Q,sa,bb,Cb,dc,Oc,yd){this.My=Q;this.tl=sa;this.qSa=bb;this.Jx=Cb;this.Q0e=dc;this.w0=Oc;this.ni=yd;this.Oy=new fa.a;this.vic=new fa.a;this.hNb=new Bb.a;this.tWd=new Mi.a(new zk.a);this.p4a=new fa.a;this.yic=!!dc;this.UQf()}get Df(){const Q=this.My.value;ua.ULS.shipAssertTag(37052750,336,Q.Bi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return Q}VCd(Q){try{this.HSm(Q)}catch(sa){this.Jx.zT(sa.message+
" "+sa.stack),ua.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",sa.message)}}XKj(Q){try{this.YKj(Q)}catch(sa){this.Jx.zT(sa.message+" "+sa.stack),ua.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",sa.message)}}n1j(Q){try{return this.o1j(Q)}catch(sa){this.Jx.zT(sa.message+" "+sa.stack),ua.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",
sa.message)}return!1}Cim(){try{this.Dim()}catch(Q){this.Jx.zT(Q.message+" "+Q.stack),ua.ULS.sendTraceTag(37052753,336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",Q.message)}}sdd(){try{return this.FYk()}catch(Q){return this.Jx.zT(Q.message+" "+Q.stack),ua.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",Q.message),null}}PHg(){try{this.OTm()}catch(Q){this.Jx.zT(Q.message+" "+Q.stack),
ua.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",Q.message)}}omf(){try{return this.s5j()}catch(Q){return this.Jx.zT(Q.message+" "+Q.stack),ua.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}ygl(Q){try{this.zgl(Q)}catch(sa){this.Jx.zT(sa.message+" "+sa.stack),ua.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",
sa.message)}}HSm(Q){if(Q){this.H6j();for(let sa=0;sa<Q.length;sa++){const bb=sa+1,Cb=this.dak(Q[sa],bb);this.Oy.add(Cb);this.hNb.add(bb,Cb)}}}zgl(Q){let sa=!1;for(let bb of Q)if(bb)if(0<bb.pageCount)for(let Cb of bb.iUf)sa=this.xXd(Cb,bb.outlineGroupNode)||sa;else if(0>bb.pageCount){sa=!0;for(let Cb of bb.c4d)this.pmk(Cb.pageNumber)}sa&&this.Mng()}YKj(Q){const sa=this.ASh(Q.paragraphNode);this.xXd(Q,sa)&&this.Mng()}pmk(Q){const sa=Q-1;0>sa||this.Oy.count<=sa||(this.Oy.removeAt(sa),this.hNb.Pa(Q)&&
this.hNb.remove(Q))}FYk(){const Q=new fa.a;for(let sa of this.Oy)this.dvc(sa)&&Q.add(sa);return Q}xXd(Q,sa){if(!Q)return ua.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;sa=this.$$j(Q,sa);Q=Q.Gjl?-1:Q.pageNumber;let bb=!1,Cb;this.hNb.Pa(Q)?(Cb=this.hNb.J(Q).pageNumber,sa.nve(Cb),this.Oy.W(Cb-1,sa),this.hNb.remove(Q)):(Cb=sa.pageNumber,this.Oy.insert(Cb-1,sa),bb=!0);return bb}dak(Q,sa){return new Zp(0,sa,Q.HardBreak,!1,null,
null,null,0,null,null)}$$j(Q,sa){const bb=Q.Kyb,Cb=Q.pageNumber,dc=Q.JW,Oc=!!dc&&dc.HardBreak,yd=Q.Efa,md=Q.paragraphNode,Af=this.gYh(sa),wg=Q.outlineNode;var Zg=this.xKf(wg);if(!Zg)return ua.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Wh=null;Oc&&(Wh=this.Jx.S$d(Q.Kyb));Q=this.Jx.cth(Wh||bb,Af);Zg=this.Jx.hkf(Wh||bb,Zg);return new Zp(Zg,Cb,Oc,yd,bb,wg,sa,Q,md,dc)}o1j(Q){this.vic=new fa.a;this.yic&&this.Q0e.reset();this.Acm();
this.nDm();this.HPj();this.e1j(Q);return 0<this.vic.count}Acm(){for(let Q=0;Q<this.Oy.count;Q++){const sa=this.Oy.J(Q);this.Jx.Pml(sa)?this.tBl(sa):(this.Jx.Oml(sa)||this.dvc(sa)&&!this.xKf(sa.outlineNode))&&this.WGi(sa)}}HPj(){let Q=0,sa=null;var bb=0;let Cb=0;for(let dc=0;dc<this.Oy.count;dc++){const Oc=this.Oy.J(dc);this.dvc(Oc)&&(Oc.mvb&&(Cb+=this.$sh(Oc,bb,Cb)),sa&&sa.id===Oc.outlineNode.id||(sa=Oc.outlineNode,Cb=Q=0),Oc.mvb&&!Oc.Efa&&(Q=this.c1j(Oc)),bb=Oc.top+Q+Cb,Oc.Txd(bb))}this.$sh(null,
bb,Cb);this.ucm()}$sh(Q,sa,bb){let Cb=null;this.yic&&(Cb=this.Q0e.f1j(Q,sa,bb));return Cb?Cb.delta:0}Dim(){if(this.vic){for(let Q=0;Q<this.vic.count;Q++){const sa=this.vic.J(Q);bh.a.mqm(sa.ye,sa.xqi)}this.yic&&this.Q0e.zim()}}OTm(){if(!this.yic){var Q=this.qSa.BWh();if(this.Oy.count){var sa=this.qSa.zUh();for(let dc=0;dc<this.Oy.count;dc++){var bb=this.Oy.J(dc);if(this.dvc(bb)&&bb.Efa){bb=this.qSa.LXk(bb.outlineNode);var Cb=0<dc?this.Oy.J(dc-1).outlineNode:sa;Cb=dc&&bb.id===Cb.id?this.Oy.J(dc-1).top:
0;this.qSa.mve(bb,Cb)}}sa=this.Oy.J(this.Oy.count-1);sa.Efa?this.qSa.mve(Q,0):this.qSa.mve(Q,sa.top)}else this.qSa.mve(Q,0)}}nDm(){this.Oy.Sc((Q,sa)=>Q.pageNumber-sa.pageNumber)}Mng(){for(let Q=0;Q<this.Oy.count;Q++)this.Oy.J(Q).nve(Q+1)}c1j(Q){return Q?this.bth(Q)-Q.top:(ua.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}l1j(Q){if(!Q)return 0;const sa=this.gYh(Q.outlineGroupNode);return sa?this.Jx.cth(this.Jx.tWb(Q),sa):0}bth(Q){if(!Q)return 0;
const sa=this.Jx.tWb(Q);Q=this.xKf(Q.outlineNode);return Q?this.Jx.hkf(sa,Q):(ua.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),0)}ucm(){let Q=0,sa=!1,bb=null,Cb=!1;for(let dc=this.Oy.count-1;0<=dc;dc--){const Oc=this.Oy.J(dc);this.dvc(Oc)&&(bb&&bb.id===Oc.outlineNode.id||(sa=!bb,bb=Oc.outlineNode,Q=this.sVk(bb)),Oc.mvb?(sa=!1,Q=Oc.top):this.yic&&sa||!(Oc.top>Q)||(this.WGi(Oc),bh.a.Yq(this.Jx.tWb(Oc)),
Cb=!0))}Cb&&this.Mng()}WGi(Q){this.Oy.contains(Q)&&(this.yic&&this.w0.kdm(Q),this.Oy.remove(Q))}dvc(Q){return Q?(Q=this.Jx.tWb(Q))&&Q.offsetParent?!0:!1:(ua.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),!1)}s5j(){let Q=!1;for(let sa=this.p4a.count-1;0<=sa;sa--)this.p4a.J(sa).hasChildNodes()&&(this.p4a.removeAt(sa),Q=!0);return Q}tBl(Q){(Q=this.ASh(Q.paragraphNode))&&(this.tWd.contains(Q.id)||this.tWd.add(Q.id))}UQf(){this.ni&&this.ni.ke(23).Dp(Object(n.a)(this,
this.Ncg,"outlineGroupOnPropertyChanged"))}Ncg(Q,sa){sa.property===Rn.a.aC&&(Q=sa.node)&&Q.ha(Rn.a.aC,!1)&&this.tWd.contains(Q.id)&&(sa=Q.wd(this.Df.Ya))&&(sa=sa.htmlElement)&&(this.tWd.remove(Q.id),this.p4a.add(sa))}e1j(Q){for(let sa=this.Oy.count-1;0<=sa;sa--){const bb=this.Oy.J(sa);this.dvc(bb)&&this.d1j(bb,Q)}}d1j(Q,sa){const bb=this.bth(Q),Cb=this.l1j(Q);Q.mvb?(Q.Txd(bb),Q.KQi(Cb)):(sa=sa?bb-Q.top:Cb-Q.vVl,Q.Txd(bb-sa),Q.KQi(Cb-sa),1<Math.abs(sa)&&this.Dtm(this.Jx.tWb(Q),sa))}xKf(Q){if(!Q)return null;
Q=Q.wd(this.Df.Ya);return Q?Q.htmlElement:(ua.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}gYh(Q){return Q?(Q=Q.wd(this.Df.Ya))?Q.htmlElement:null:null}ASh(Q){Q=lm.GraphIterator.xa(Q);return Q.Na(23)?Q.Bc(23):null}rVk(Q){if(!Q)return null;Q=Q.wd(this.Df.Ya);return Q?la.a.getElementBounds(Q.htmlElement):(ua.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}sVk(Q){return(Q=this.rVk(Q))?Q.height/
this.tl.Kh:0}Dtm(Q,sa){sa=(bh.a.bNk(Q)-sa)*this.tl.Kh;this.vic.add(Object.assign(new Pi,{ye:Q,xqi:sa}))}H6j(){this.Oy=new fa.a;this.hNb=new Bb.a}}Object(c.a)(wo,"PageEndMarkerPositionUpdater",null,[1864]);var un=b(282),Ko=b(42);b(30);var ak=b(763),Tj=b(335),Zl=b(28);class pl{constructor(Q,sa,bb,Cb,dc,Oc,yd=!1,md=!1,Af=!1,wg=!1,Zg=!1){this.iJg(sa,bb,Cb,dc,Oc,Af,Zg);this.position=Q;this.pageNumber=sa;this.paragraphNode=bb;this.JW=Cb;this.Kyb=dc;this.outlineNode=Oc;this.Bcb=yd;this.Vfi=md;this.Gjl=Af;
this.Efa=wg;this.mZf=Zg}nve(Q){this.pageNumber=Q}iJg(Q,sa,bb,Cb,dc,Oc,yd){yd||(ua.ULS.shipAssertTag(38326881,336,!!dc,"PageEndDetails: outlineNode parameter value is null."),ua.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),ua.ULS.shipAssertTag(24126529,336,!!sa||Oc,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),ua.ULS.shipAssertTag(24126530,336,!!bb||Oc,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
ua.ULS.shipAssertTag(24126531,336,!!Cb||Oc,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static yfk(Q,sa){return pl.$qf(0,Q,null,sa,!0,!1)}static zfk(Q){return pl.$qf(0,0,null,Q,!1,!0)}static $qf(Q,sa,bb,Cb,dc,Oc){return new pl(Q,sa,null,null,bb,Cb,dc,Oc,!0)}static aoc(Q,sa){return new pl(0,Q,null,sa,null,null,void 0,void 0,void 0,void 0,!0)}}Object(c.a)(pl,"PageEndDetails",null,[]);class fj{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg,Zg,Wh,vh,sl,qh,Cd,Mg,
sg,Xc,$q,hp,Cs){this.kxa=!0;this.Z4=0;this.cQd=this.ARe=this.BRe=this.nNe=this.O0e=this.lRe=!1;this.PRd=this.jLb=null;this.QUe=!0;this.My=Q;this.ri=sa;this.i9=bb;this.eP=Cb;this.j7g=dc;this.t4a=Oc;fj.Jx=md;this.zWg=Af;this.GF=wg;this.Za=Zg;this.koj=Wh;this.Gc=sl;this.w0=Cd;this.S0e=Mg;this.Cic=sg;this.GX=Xc;this.Zhc=new un.a;this.wic=new fa.a;this.jxa=new fa.a;this.q4a=new un.a;this.IU=vh;this.cpa=Cs;this.qoe=this.qoe.bind(this);this.soe=this.soe.bind(this);this.rre=this.rre.bind(this);this.Uta=this.Uta.bind(this);
this.IU.N_c(Object(n.a)(this,this.gYa,"onContentDirtied"));this.P0e=!$q;this.k7g=hp;qh&&(qh.Hkh(Object(n.a)(this,this.O$f,"onHeaderFooterShow")),qh.TXd(Object(n.a)(this,this.N$f,"onHeaderFooterDismiss")));yd&&yd.KNj(Object(n.a)(this,this.CQl,"onPageContentSizeChange"));this.cpa.Q_c(this.Uta)}get eZf(){return this.QUe}get pageEnds(){return this.jxa}get Df(){return this.My.value}get uk(){return this.ri.value}gYa(){this.hje()}N$f(){this.BRe=!1}O$f(){this.ARe=this.BRe=!0}VCd(Q,sa){const bb=this.Gc.le("Task",
"UpdateMarkers");this.cGm();this.kxa=sa;fj.Jx.XFi();this.Zhc=new un.a;this.wic.clear();this.jxa.clear();this.q4a=new un.a;this.QUe=this.lRe=!1;this.eP&&this.eP.VCd(Q);this.vuk();this.Z4=Q.length+1;this.w0&&this.w0.reset(Q);this.i9&&(this.i9.$um(this.Z4),this.i9.zIa());for(let Cb of Q)this.jxa.add(Cb),this.Ang(Cb);sa&&this.eP&&this.S0e&&this.S0e.isEnabled&&(Q=this.eP.sdd(),this.S0e.R7a(Q));this.N9j();this.nNe=this.O0e=!1;this.ARe=this.BRe;og.WoncaApp.instance.rbb&&fj.QRf&&this.eP.PHg();this.t4a.USm(this.eP.sdd(),
this.jxa.count);this.QUe=!0;this.GX&&this.GX.wHg();bb.stop();ua.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:bb.eg,["TotalPageCount"]:this.Z4,["AvgDurationPerPageInMs"]:bb.eg/this.Z4})}pYh(){const Q=this.eP.sdd();if(!Q)return null;const sa=bh.a.Fka(),bb=new fa.a;for(let Cb of Q)this.wpl(Cb,sa)&&bb.add(Cb);return bb}wpl(Q,sa){if(!Q)return!1;Q=fj.Jx.tWb(Q);if(!Q)return!1;Q=la.a.N$a(Q);return 0<=Q&&Q<=sa}gQh(){const Q=new fa.a;if(!this.q4a)return ua.ULS.sendTraceTag(35005382,
336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),Q;const sa=this.q4a.keys;for(let dc=0;dc<sa.length;dc++){var bb=sa.J(dc);if(bb=this.q4a.J(bb))for(let Oc=0;Oc<bb.count;Oc++){var Cb=bb.J(Oc);Cb.JW.HardBreak||Sys.UI.DomElement.containsCssClass(Cb.Kyb,"Hidden")||(Cb=la.a.N$a(Cb.Kyb),Q.add(Cb))}}return Q}cGm(){const Q=this.gQh(),sa=this.pYh();this.j7g.TAg(Q,sa);this.Cic&&this.Cic.isEnabled&&this.Cic.TAg(sa)}N9j(){if(!(25<this.Z4)){var Q=this.gQh(),
sa=this.pYh();this.j7g.O9j(Q,sa,this.k7g,this.O0e,this.lRe,this.nNe,this.ARe);this.Cic&&this.Cic.isEnabled&&this.Cic.R7a(sa)}}Uta(){this.i9.jdm();this.DFh()}DFh(){this.cQd&&(this.Df.cem(this.qoe),this.Df.Eem(this.soe),this.Df.pem(this.rre),this.cQd=!1)}vuk(){this.cQd||(this.Df.gkh(this.qoe),this.Df.kOj(this.soe),this.Df.zkh(this.rre),this.cQd=!0)}Ang(Q){if(this.P0e)return!0;Q=this.ffm(Q);if(!Q)return!1;this.w0&&this.w0.Q7k(Q);this.eP&&(this.eP.XKj(Q),this.t4a.U5i(this.eP.sdd()),og.WoncaApp.instance.rbb&&
fj.QRf&&this.eP.PHg());return!0}ffm(Q){let sa=this.Fza(Q.ParaId);if(!sa)return null;if(!sa.anchor||!sa.nh)return this.Fjh(Q,sa),null;let bb,Cb;if(Q.HardBreak){var dc=wk.ParagraphReader.xh(sa,!0,!0,!0);this.CWl(dc)&&(sa=dc);if(!({kma:dc,outlineGroupNode:bb,Jyb:Cb}=this.bNm(Q,sa)).returnValue)return null;this.lRe=!0}else if(!({joe:dc,outlineGroupNode:bb,Jyb:Cb}=this.gfm(Q,sa,dc,bb,Cb)).returnValue)return null;return this.xXd(sa,Q,dc,bb,Cb)}CWl(Q){return Q?(Q=Q.wd(this.Df.Ya))?!!fj.Jx.S$d(Q.htmlElement):
!1:!1}gfm(Q,sa,bb,Cb,dc){var Oc=Q.PageEndType;let yd;bb=0;dc=Cb=null;if(!Oc){if(!({kma:Q,zdg:yd}=this.qYh(Q,sa)).returnValue)return{returnValue:!1,joe:bb,outlineGroupNode:Cb,Jyb:dc}}else if(!({kma:Q,Eye:yd}=this.GVk(Q,sa)).returnValue)return{returnValue:!1,joe:bb,outlineGroupNode:Cb,Jyb:dc};var md=lm.GraphIterator.xa(sa);md.lc();Cb=md.Bc(23);sa=Cb.wd(this.Df.Ya).getBounds();md=md.CZa().wd(this.Df.Ya);if(!md)return ua.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",
this.Df.Ya),{returnValue:!1,joe:bb,outlineGroupNode:Cb,Jyb:dc};dc=md.getBounds();bb=Q-sa.y;Oc=fj.Jx.MTh(Oc,bb,this.kxa,yd,sa,dc);md.tra.appendChild(Oc);return{returnValue:!0,joe:bb,outlineGroupNode:Cb,Jyb:Oc}}bNm(Q,sa){let bb=null;const Cb=sa.wd(this.Df.Ya);var dc=0;let Oc=null;if(this.ihe(Q,Cb,sa))return{returnValue:!1,kma:dc,outlineGroupNode:bb,Jyb:Oc};bb=fj.aqi(sa);const yd=bb.wd(this.Df.Ya);if(!yd)return ua.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.Df.Ya),
{returnValue:!1,kma:dc,outlineGroupNode:bb,Jyb:Oc};dc=yd.getBounds();dc=ln.a.ul(Cb,Q.CP).y-dc.y;Oc=this.nPk(sa);return{returnValue:!0,kma:dc,outlineGroupNode:bb,Jyb:Oc}}nPk(Q){return Q.wd(this.Df.Ya).htmlElement}Fza(Q){const sa=this.GF.iKa(Q);if(sa!==ae.a.nil){const bb=this.uk.Va(sa);if(bb)return bb}ua.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",Q,sa);return null}qYh(Q,sa){const bb=Q.CP;let Cb=0,dc=null;const Oc=sa.wd(this.Df.Ya);if(this.ihe(Q,
Oc,sa))return{returnValue:!1,kma:Cb,zdg:dc};dc=Oc.getBounds();Cb=bb?this.zWg(Object(pa.a)(0,Oc),bb):dc.y-this.koj(Oc);return{returnValue:!0,kma:Cb,zdg:dc}}GVk(Q,sa){let bb=null,Cb=0;var dc=Q.PageEndType;let Oc=lm.GraphIterator.xa(sa);Oc.lc();if(!Ko.TableReader.Tv(Oc))return ua.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),{returnValue:({kma:Cb,zdg:bb}=this.qYh(Q,sa)).returnValue,kma:Cb,Eye:bb};if(1===dc){Zl.returnToContainingRow(Oc);
dc=Oc.currentNode.wd(this.Df.Ya);if(this.ihe(Q,dc,sa))return{returnValue:!1,kma:Cb,Eye:bb};Cb=dc.getBounds().y}else{dc=sa.wd(this.Df.Ya);if(this.ihe(Q,dc,sa))return{returnValue:!1,kma:Cb,Eye:bb};Cb=this.zWg(Object(pa.a)(0,dc),Q.CP)}--Cb;sa=null;do Q=sa,sa=Oc.Bc(14);while(sa);Oc=lm.GraphIterator.xa(Q);Oc.lc();Zl.moveToFirstRow(Oc);bb=Oc.currentNode.wd(this.Df.Ya).getBounds();return{returnValue:!0,kma:Cb,Eye:bb}}ihe(Q,sa,bb){if(!sa||sa.dga(16))return this.Fjh(Q,bb),!0;sa=sa.getBounds();return sa.width||
sa.height?!1:(this.djh(Q),!0)}djh(Q){this.wic.contains(Q)||this.wic.add(Q)}Fjh(Q,sa){sa=sa.id;let bb;({value:bb}=this.Zhc.xb(sa)).returnValue||(bb=new fa.a,this.Zhc.W(sa,bb));bb.add(Q)}qoe(){const Q=new fa.a;for(let sa=this.wic.count-1;0<=sa;sa--){const bb=this.wic.J(sa);this.Ang(bb)||Q.add(bb)}this.wic=Q;this.omf()}omf(){this.eP&&this.eP.omf()&&this.X5i(!1)}CQl(Q,sa){1>=Math.abs(sa.delta)||(this.nNe=!0,this.X5i(!sa.rqi))}X5i(Q){this.eP&&(this.eP.n1j(Q)&&(this.O0e=!0),this.k7g&&this.eP.Cim(),this.t4a.U5i(this.eP.sdd()),
og.WoncaApp.instance.rbb&&fj.QRf&&this.eP.PHg())}soe(Q,sa){try{const bb=sa.id;if(this.Zhc.Pa(bb)){const Cb=this.Zhc.J(bb);for(Q=0;Q<Cb.count;Q++)this.djh(Cb.J(Q));this.Zhc.remove(bb)}}catch(bb){}}hje(){this.kxa&&(this.kxa=!1,fj.Jx.hje())}gje(){this.kxa||(this.kxa=!0,fj.Jx.gje())}rBm(){this.P0e=!1;this.jxa&&this.VCd(this.jxa.toArray(),this.kxa);this.i9&&this.i9.CVi()}W$k(){this.P0e=!0;fj.Jx.XFi();this.i9&&this.i9.K5h();this.w0&&this.w0.X$k()}xXd(Q,sa,bb,Cb,dc){const Oc=this.jxa.indexOf(sa)+1;if(0>
Oc)return null;const yd=Qn.WordSectionNavigator.instance.$H(Q),md=this.Efa(sa,Q);Q=new pl(bb,Oc,Q,sa,dc,yd,!Q||!sa||!dc,!1,!1,md);this.q4a.Pa(Cb.id)||this.q4a.W(Cb.id,new fa.a);this.q4a.J(Cb.id).add(Q);return Q}Efa(Q,sa){if(!Q||!Q.HardBreak)return!1;Q=lm.GraphIterator.xa(sa);Q.Na(7);if(Q.gG())return!1;Q.Bc(23);return Q.gG()?!1:!0}gkg(Q){this.kxa&&(Q.anchor&&Q.nh?!(Q=fj.aqi(Q))||this.jLb&&this.jLb.Om&&this.jLb.Om.id===Q.id||(this.jLb=Object.assign(new kc.a(3,1,500,Object(n.a)(this,this.r9l,"redrawPageEndsForOutlineGroup")),
{Om:Q}),this.Za.Eb(this.jLb)):ua.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}r9l(Q){Q===this.jLb&&(this.jLb=null);if(this.kxa){var sa=Q.Om;if(Q=this.q4a.get(sa.id))for(this.q4a.W(sa.id,new fa.a),ua.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",Q.count,sa.id),this.i9&&this.i9.zIa(),sa=0;sa<Q.count;sa++){const bb=Q.J(sa),Cb=bb.JW;Cb.HardBreak||(bh.a.Yq(bb.Kyb),this.Ang(Cb))}}}rre(){this.kxa&&
!this.PRd&&this.jxa&&0<this.jxa.count&&(this.PRd=new kc.a(3,1,500,Object(n.a)(this,this.q9l,"redrawAllPageEndsInDocument")),this.Za.Eb(this.PRd))}q9l(){this.PRd=null;this.kxa&&this.jxa&&0<this.jxa.count&&(ua.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.VCd(this.jxa.toArray(),this.kxa))}dispose(){this.Df&&this.DFh();this.cpa.fng(this.Uta);this.IU.$re(Object(n.a)(this,this.gYa,"onContentDirtied"))}static get Pva(){return G.AFrameworkApplication.K.$("WordEditorCommentImprovementIsEnabled")}static get QRf(){null==
fj.BSe&&(fj.BSe=G.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return fj.BSe}static lPk(Q){let sa=0;try{const bb=Q.htmlElement,Cb=bh.a.bO(bb.firstChild.style.marginTop);Q=0;const dc=fj.gdd(bb.parentNode);if(dc){const Oc=dc.firstChild;Oc&&Sys.UI.DomElement.containsCssClass(Oc,"ParaWrappingDiv")&&(Q=bh.a.bO(Oc.firstChild.style.marginBottom))}sa=Math.max(Cb,Q)/2}catch(bb){}return sa}static gdd(Q){let sa=Q.previousSibling;if(!sa){var bb=Q.parentNode;if(bh.a.nYf(bb))if(of.a.instance.J(45)||
fj.Pva){if(bb=bb.parentNode)sa=bb.previousSibling}else sa=bb.previousSibling}if(!sa&&(Q=Q.parentNode,Sys.UI.DomElement.containsCssClass(Q,ak.a.Mcg)||ua.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",Q.tagName,Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){sa=Q.lastChild;do{if(Sys.UI.DomElement.containsCssClass(sa,"OutlineElement")||bh.a.nYf(sa)&&Sys.UI.DomElement.containsCssClass(sa,Tj.a.lMa))break;sa=sa.previousSibling}while(sa)}if(sa){if(Sys.UI.DomElement.containsCssClass(sa,
Tj.a.lMa))return sa.lastChild.lastChild;if(bh.a.nYf(sa))return sa.lastChild}return sa}static aqi(Q){Q=lm.GraphIterator.xa(Q);return Q.Na(23)?Q.Bc(23):null}}fj.Jx=null;fj.BSe=null;Object(c.a)(fj,"PageEndMarkers",null,[1865,1866,13]);var xm=b(122);class Al{constructor(Q,sa,bb){this.tVl=".Outline";this.My=Q;this.tl=sa;this.Jx=bb}get Df(){const Q=this.My.value;ua.ULS.shipAssertTag(38416594,336,Q.Bi,"Invalid PageView.");return Q}crc(Q){return(Q=Q.outlineNode)?this.eYh(Q):(ua.ULS.shipAssertTag(38336522,
336,!0,"Error getting last Outline DOM."),null)}eYh(Q){let sa,bb;return(sa=Q.wd(this.Df.Ya))&&(bb=sa.htmlElement)?bb.querySelector(this.tVl):(ua.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}zSh(Q){Q=tp.OutlineElementNavigator.Qm(Q.paragraphNode);let sa;return Q&&(sa=Q.wd(this.Df.Ya))?sa.htmlElement:(ua.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}Rsh(Q,sa){const bb=this.y4k(Q);return this.j1j(Q,sa)-bb}ITh(Q){return this.jYh(Q.outlineNode,
Q.pageNumber)}jYh(Q,sa){if(!Q)return-1;var bb=Q.ha(Zb.a.RQ,-1);bb=le.a.Qg(bb,1);var Cb=Q.ha(Zb.a.marginTop,-1);Cb=le.a.Qg(Cb,1);Q=Q.ha(Zb.a.marginBottom,-1);Q=le.a.Qg(Q,1);return 1===sa?bb-Q:bb-(Cb+Q)}nmk(Q){Q&&bh.a.Yq(Q.Kyb)}eLf(Q){if(Q.Vfi||Q.Efa)return 0;if(Q.Bcb)return Q=this.crc(Q),la.a.getElementBounds(Q).height/this.tl.Kh;const sa=this.crc(Q);return this.Jx.hkf(this.oYh(Q),sa)}Hdk(Q,sa,bb){bb=bb.wd(this.Df.Ya).getBounds();Q=Q.wd(this.Df.Ya);const Cb=Q.getBounds();bb.y=Cb.y;sa=this.Jx.MTh(0,
sa*this.tl.Kh,!1,bb,bb,Cb);Q.tra.appendChild(sa);return sa}i9h(Q,sa){if(Q&&!Q.mZf)if(Q.Bcb)this.crc(Q).style.paddingBottom=sa+"px";else if(Q.JW&&Q.JW.HardBreak)if(Q.Efa){if(Q=this.mZh(Q))Q.style.paddingBottom=sa+"px"}else{if(Q=this.zSh(Q))Q.style.paddingTop=sa+"px"}else ua.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}wlh(Q,sa){sa=this.crc(sa);Q=this.crc(Q);return la.a.N$a(sa)-la.a.N$a(Q)}nZh(Q){Q=lm.GraphIterator.xa(Q.outlineNode);Q.Na(7);
return Q.gG()}Kdi(Q){if(!Q||Q.mZf)return!1;if(Q.Bcb||Q.Vfi)return!0;Q=this.oYh(Q);return!!Q&&bh.a.Xya(Q)}zT(Q){this.Jx.zT(Q)}mZh(Q){return(Q=this.nZh(Q))?(Q=Q.Bl(this.Df.Ya).htmlElement,Q?Q:(ua.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}oYh(Q){return Q.JW&&Q.JW.HardBreak&&!Q.Efa?this.Jx.S$d(Q.Kyb):Q.Kyb}y4k(Q){if(Q.Bcb){Q=this.crc(Q);if(!Q)return ua.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=xm.a.Uz(Q);return bh.a.Dka(Q.paddingBottom)}if(Q.JW&&Q.JW.HardBreak){if(Q.Efa)return(Q=
this.mZh(Q))?bh.a.Dka(Q.style.paddingBottom):-1;Q=this.zSh(Q);return Q?bh.a.Dka(Q.style.paddingTop):(ua.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}j1j(Q,sa){return this.eLf(Q)-sa}}Object(c.a)(Al,"PageFullHeightDOMHelper",null,[]);class om{constructor(){this.delta=this.M8i=this.pageCount=0;this.jma=null;this.gVa=this.QAi=0;this.outlineGroupNode=null;this.Lja=0;this.iUf=new fa.a;this.c4d=new fa.a;this.oIl=new fa.a}}Object(c.a)(om,"PageFullHeightInfo",null,
[]);class bp{constructor(Q,sa){this.MFa=Q;this.Kx=sa}ath(Q,sa){try{return this.g1j(Q,sa)}catch(bb){return this.Kx.zT(bb.message+" "+bb.stack),ua.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",bb.message),null}}g1j(Q,sa){ua.ULS.shipAssertTag(38416596,336,Q.Bcb||Q.JW.HardBreak);const bb=this.Kx.eLf(Q),Cb=this.Kx.Rsh(Q,sa),dc=this.MFa.Psh(Q,Cb);Q=Object.assign(new om,{Lja:Cb,gVa:dc,jma:Q});this.oSm(Q);Q.M8i=Q.gVa-Q.Lja;Q.delta=sa+dc+Q.delta-bb;return Q}oSm(Q){Q.Lja>
Q.gVa?this.pSm(Q):0>Q.Lja&&this.UGg(Q)}UGg(Q){let sa=Q.jma.pageNumber;for(;0>Q.Lja;)Q.pageCount--,Q.delta-=this.MFa.kbd(sa),Q.Lja+=this.MFa.kbd(sa-1),sa--;Q.gVa=this.MFa.kbd(sa)}pSm(Q){const sa=this.Kx.ITh(Q.jma);Q.pageCount=Math.floor((Q.Lja-Q.gVa)/sa)+1;Q.delta=Q.pageCount*sa;Q.Lja-=Q.gVa+(Q.pageCount-1)*sa;Q.gVa=sa}}Object(c.a)(bp,"PageFullHeightInfoCalculator",null,[]);class ol{constructor(Q,sa,bb,Cb){this.Z4=0;this.mTa=null;this.MFa=Q;this.uKb=sa;this.xV=bb;this.Kx=Cb;this.a$g=new fa.a}get q_(){return this.a$g}Q7k(Q){try{this.jPf(Q)}catch(sa){this.Kx.zT(sa.message+
" "+sa.stack),ua.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",sa.message)}}reset(Q){try{this.vhm(Q)}catch(sa){this.Kx.zT(sa.message+" "+sa.stack),ua.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",sa.message)}}X$k(){try{this.Y$k()}catch(Q){this.Kx.zT(Q.message+" "+Q.stack),ua.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}Agl(Q){try{this.Bgl(Q)}catch(sa){this.Kx.zT(sa.message+
" "+sa.stack),ua.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",sa.message)}}kdm(Q){try{this.ldm(Q)}catch(sa){this.Kx.zT("Pagination: "+sa.message+" "+sa.stack),ua.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",sa.message)}}eel(){var Q=this.xV.Q9d(),sa=this.xV.wWh();Q=pl.zfk(Q);sa=pl.yfk(this.Z4,sa);this.q_.W(0,Q);this.jPf(sa)}xhm(){var Q=Qn.WordSectionNavigator.instance.wWh();
(Q=this.Kx.eYh(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}Xel(Q){this.a$g=new fa.a;this.q_.add(null);for(let sa=0;sa<Q.length;sa++){const bb=pl.aoc(sa+1,Q[sa]);this.q_.add(bb)}this.q_.add(pl.aoc(Q.length+1,null))}Lel(Q){this.MFa.Chm(Q)}Shm(){if(this.q_)for(let Q of this.q_)Q&&this.cci(Q)&&this.Kx.i9h(Q,0)}jPf(Q){const sa=this.FXk(Q);if(this.Kx.Kdi(sa)){let bb=this.Kx.eLf(sa);Q.outlineNode!==sa.outlineNode&&(bb+=this.Kx.wlh(Q,sa));this.J0j(Q,bb);this.cci(Q)&&this.Bng(Q,bb)}else this.mTa.add(Q),
20<this.mTa.count&&ua.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.mTa.count);this.q_.W(Q.pageNumber,Q);this.K7k(Q)}Y$k(){this.Shm()}vhm(Q){this.Z4=Q.length+1;this.mTa=new fa.a;this.Xel(Q);this.Lel(this.Z4);this.eel();this.xhm()}Bgl(Q){this.MFa.XSm(Q);for(let sa of Q){if(!sa){ua.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<sa.pageCount){Q=sa.jma.pageNumber;for(let bb of sa.iUf)this.q_.insert(Q,bb),Q++}else if(0>sa.pageCount)for(let bb of sa.c4d)this.q_.remove(bb),
this.mTa.contains(bb)&&this.mTa.remove(bb)}this.vIi()}ldm(Q){Q=Q.pageNumber;this.MFa.mdm(Q);this.q_.removeAt(Q);for(let sa of this.mTa)sa.pageNumber===Q&&this.mTa.remove(sa);this.vIi()}J0j(Q,sa){sa=this.Kx.Rsh(Q,sa);this.MFa.Psh(Q,sa)}Bng(Q,sa){Q.JW&&Q.JW.HardBreak||this.uKb.Bng(Q,sa)}K7k(Q){Q=Q.pageNumber+1;for(let sa of this.mTa)if(sa&&sa.pageNumber===Q){this.jPf(sa);this.mTa.remove(sa);break}}vIi(){for(let Q=0;Q<this.q_.count;Q++){const sa=this.q_.J(Q);sa&&sa.nve(Q)}}cci(Q){Q=this.BVk(Q);return 2===
Q||1===Q}FXk(Q){return this.q_.J(Q.pageNumber-1)}BVk(Q){return Q.Bcb?2:Q.JW&&Q.JW.HardBreak?1:0}}Object(c.a)(ol,"PageFullHeightManager",null,[1900]);class Ih{constructor(Q,sa,bb,Cb){this.uKb=Q;this.MFa=sa;this.xV=bb;this.Kx=Cb}create(){return new ol(this.MFa,this.uKb,this.xV,this.Kx)}}Object(c.a)(Ih,"PageFullHeightManagerFactory",null,[]);var $l=b(841),ba=b(534);class na{constructor(Q,sa,bb,Cb,dc){this.xic=null;this.w0=Q;this.eP=sa;this.UTc=bb;this.uKb=Cb;this.Kx=dc}reset(){this.xic=new fa.a}f1j(Q,
sa,bb){try{return this.h1j(Q,sa,bb)}catch(Cb){return ua.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Cb.message),null}}zim(){try{this.Aim()}catch(Q){ua.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}h1j(Q,sa,bb){if(!this.w0.q_.count)return null;const Cb=this.EVk(Q,!Q);if(!Cb||Cb.mZf)return ua.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),
null;if(Cb.JW&&Cb.JW.HardBreak)return null;var dc=this.w0.q_.J(Cb.pageNumber-1);return this.Kx.Kdi(dc)&&(sa-=bb,Cb.outlineNode!==dc.outlineNode&&(sa+=this.Kx.wlh(Cb,dc)),(dc=this.UTc.ath(Cb,sa))&&1<Math.abs(dc.delta))?(dc.QAi=sa,dc.outlineGroupNode=this.qVk(Q,Cb),this.xic.add(dc),this.UGg(dc),dc):null}qVk(Q,sa){return sa&&sa.Bcb?(Q=Object(pa.a)(ba.a,wk.ParagraphReader.HL(sa.outlineNode)),Q=lm.GraphIterator.xa(Q),Q.to(),Object(pa.a)($l.a,Q.Bc(23))):Q&&Q.mvb?Q.outlineGroupNode:null}Aim(){this.xic.Sc((Q,
sa)=>sa.jma.pageNumber-Q.jma.pageNumber);for(let Q of this.xic)this.uKb.jIi(Q);this.$Sm()}$Sm(){this.eP.value.ygl(this.xic);this.w0.Agl(this.xic)}EVk(Q,sa){return sa?this.w0.q_.J(this.w0.q_.count-1):this.w0.q_.J(Q.pageNumber)}UGg(Q){let sa=Q.jma.pageNumber;const bb=-Q.pageCount;for(let Cb=0;Cb<bb;Cb++)sa--,Q.c4d.add(this.w0.q_.J(sa))}}Object(c.a)(na,"PageFullHeightPositionUpdater",null,[1899]);class nb{constructor(Q,sa,bb,Cb,dc){this.w0=Q;this.eP=sa;this.UTc=bb;this.uKb=Cb;this.Kx=dc}create(){return new na(this.w0,
this.eP,this.UTc,this.uKb,this.Kx)}}Object(c.a)(nb,"PageFullHeightPositionUpdaterFactory",null,[]);class Lb{constructor(Q,sa){this.Kx=Q;this.UTc=sa}Bng(Q,sa){try{this.jfm(Q,sa)}catch(bb){this.Kx.zT(bb.message+" "+bb.stack),ua.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",bb.message)}}jIi(Q){try{this.ifm(Q)}catch(sa){this.Kx.zT(sa.message+" "+sa.stack),ua.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",sa.message)}}jfm(Q,
sa){ua.ULS.shipAssertTag(38285913,336,Q.Bcb||Q.JW.HardBreak);Q=this.UTc.ath(Q,sa);this.jIi(Q)}ifm(Q){this.hfm(Q);this.$em(Q)}$em(Q){0<Q.pageCount?this.Lgl(Q):0>Q.pageCount&&this.omk(Q)}hfm(Q){this.Kx.i9h(Q.jma,Q.M8i)}Lgl(Q){let sa=Q.QAi+Q.gVa;for(let Cb=0;Cb<Q.pageCount;Cb++){var bb=Q.jma.pageNumber+Cb;const dc=Q.jma.Efa?this.Kx.nZh(Q.jma):Q.jma.outlineNode;bb=this.Gdk(dc,Q.outlineGroupNode,sa,bb);Q.iUf.add(bb);Q.oIl.add(sa);sa+=Q.gVa}}omk(Q){for(let sa of Q.c4d)this.Kx.nmk(sa)}Gdk(Q,sa,bb,Cb){sa=
this.Kx.Hdk(Q,bb,sa);return pl.$qf(bb,Cb,sa,Q,!1,!1)}}Object(c.a)(Lb,"PageFullHeightRenderer",null,[]);class hc{constructor(Q){this.aVc=Q}get Zig(){return this.aVc}}Object(c.a)(hc,"PageHeightDeltaResult",null,[1833]);class xc{constructor(Q,sa,bb){this.Gq=null;this.Kx=Q;this.Rd=sa;bb.execute(Cb=>{Cb.register(this)})}get w6f(){return"PageHeightDelta"}get result(){return this.Gq}get s8f(){return 1}get irg(){return 500}get isEnabled(){return!0}z8f(){this.Gq=null}R7a(Q){this.Rd.Jd(()=>{try{this.O1c(Q)}catch(sa){ua.ULS.sendTraceTag(39188045,
324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",sa.message)}},"PHDM:C")}O1c(Q){this.Gq=null;Q=this.P1c(Q);-1!==Q&&(this.Gq=new hc(Q))}P1c(Q){if(!Q.count)return-1;let sa=0,bb=0;for(let Cb of Q)Q=this.i1j(Cb),-1!==Q&&(sa+=Q,bb++);return bb?sa/bb:-1}i1j(Q){if(!Q.Fll)return-1;const sa=this.Kx.jYh(Q.XZd,Q.pageNumber);return-1===sa?-1:Math.abs(Q.height-sa)}}Object(c.a)(xc,"PageHeightDeltaMetric",null,[1804]);class hd{constructor(Q){this.o2a=null;this.Kx=Q}kbd(Q){return this.o2a.J(Q-
1)}Chm(Q){this.o2a=new fa.a;for(let sa=0;sa<Q;sa++)this.o2a.add(-1)}Psh(Q,sa){if(this.xpl(Q))return this.o2a.J(Q.pageNumber-1);sa=this.T0j(Q,sa);this.dGm(Q,sa);return sa}XSm(Q){for(let sa of Q)this.WSm(sa)}dGm(Q,sa){this.o2a.W(Q.pageNumber-1,sa)}mdm(Q){this.o2a.removeAt(Q-1)}WSm(Q){if(Q)if(0<Q.pageCount){var sa=Q.jma.pageNumber;for(var bb=0;bb<Q.pageCount;bb++)this.o2a.insert(sa,Q.gVa)}else if(0>Q.pageCount)for(sa=-Q.pageCount,Q=Q.jma.pageNumber-sa,bb=0;bb<sa;bb++)this.o2a.removeAt(Q)}xpl(Q){return-1!==
this.o2a.J(Q.pageNumber-1)}T0j(Q,sa){if(Q.Bcb||Q.JW.HardBreak)Q=this.Kx.ITh(Q),sa=sa<Q?Q:sa;return sa}}Object(c.a)(hd,"PageHeightStorage",null,[]);var id=b(201);class je{constructor(Q){this.aVc=Q}get Zig(){return this.aVc}}Object(c.a)(je,"PageLevelDeltaResult",null,[1833]);class Hf{constructor(Q,sa,bb,Cb){this.Gq=null;this.My=Q;this.lP=sa;this.Rd=bb;Cb.execute(dc=>{dc.register(this)})}get Df(){const Q=this.My.value;ua.ULS.shipAssertTag(39081438,336,Q.Bi,"PageLevelDeltaMetric.PageView is not a PageView.");
return Q}get w6f(){return"PageLevelDelta"}get result(){return this.Gq}get s8f(){return 0}get irg(){return 60}get isEnabled(){return!0}z8f(){this.Gq=null}R7a(Q){this.Rd.Jd(()=>{try{this.O1c(Q)}catch(sa){ua.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",sa.message)}},"PLDM:C")}O1c(Q){this.Gq=null;Q=this.P1c(Q);-1!==Q&&(this.Gq=new je(Q))}P1c(Q){if(!Q.count)return-1;let sa=0,bb=0;for(let Cb of Q)Q=this.k1j(Cb),-1!==Q&&(sa+=Q,bb++);return bb?sa/bb:
-1}k1j(Q){if(Q.mvb)return-1;var sa=Q.JW.CP;Q=Q.paragraphNode;ua.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.wd(this.Df.Ya);ua.ULS.shipAssertTag(39081442,324,Object(id.a)(0,Q));let bb;({UAh:sa,Ohi:Q,$Ki:bb}=this.$0j(Q,bh.a.Bw(Q.htmlElement).length,sa));return Q&&bb?Math.min(sa.x-Q.x,bb.x-sa.x):(ua.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}$0j(Q,sa,bb){let Cb,dc,Oc,yd=dc=bb,md=Oc=Cb=null;if(bb>sa)return ua.ULS.sendTraceTag(39081472,
336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{UAh:md,Jwl:yd,Ohi:Oc,ujm:dc,$Ki:Cb};md=this.lP.ul(Q,bb);for(var Af=0,wg=bb;Af<=wg;){let Zg=Math.floor((Af+wg)/2),Wh=this.lP.ul(Q,Zg);if(Af===wg){yd=Zg;Oc=Wh;break}Wh.y+Wh.height<=md.y?Af=Zg+1:wg=Zg}for(;bb<=sa;){Af=Math.ceil((bb+sa)/2);wg=this.lP.ul(Q,Af);if(bb===sa){dc=Af;Cb=wg;break}wg.y>=md.y+md.height?sa=Af-1:bb=Af}return{UAh:md,Jwl:yd,Ohi:Oc,ujm:dc,$Ki:Cb}}}Object(c.a)(Hf,"PageLevelDeltaMetric",null,[1804]);
class Ef{constructor(Q,sa,bb,Cb,dc,Oc,yd){this.pageNumber=Q;this.top=sa;this.$gh=bb;this.height=Cb;this.Rbc=dc;this.XZd=Oc;this.Fll=yd}}Object(c.a)(Ef,"Page",null,[]);class We{constructor(Q,sa,bb,Cb,dc){this.pic=null;this.rdh=0;this.My=Q;this.GId=sa;this.i7g=bb;this.qSa=Cb;this.m7g=dc;this.v4a=new fa.a}get Df(){const Q=this.My.value;ua.ULS.shipAssertTag(37007393,336,Q.Bi,"PageManager.PageView is not a PageView.");return Q}get Tm(){return this.v4a}U5i(Q){Q=this.hEi(Q);this.V5i(Q)}USm(Q,sa){this.rdh=
sa;Q=this.hEi(Q);this.V5i(Q);this.m7g.isEnabled&&this.m7g.R7a(Q)}hEi(Q){this.v4a=new fa.a;this.pic=new un.a(0);const sa=new fa.a;if(!Q)return this.Tm;var bb=0,Cb=null;for(let dc=0;dc<Q.count;dc++){const Oc=Q.J(dc);bb=Oc.pageNumber;Cb=this.Ync(bb,Cb,Oc);this.Tm.add(Cb);!We.CZe&&0>Cb.height&&sa.add(Cb);Cb=Oc}Q=this.Ync(bb+1,Cb,null);this.Tm.add(Q);!We.CZe&&0>Q.height&&sa.add(Q);for(let dc of sa)We.CZe=!0,ua.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+dc.pageNumber);
return this.Tm}Ync(Q,sa,bb){const Cb=sa?sa.outlineNode:this.qSa.zUh(),dc=bb?bb.outlineNode:this.qSa.BWh();var Oc=this.kYh(Cb);const yd=this.kYh(dc),md=sa?this.Zsh(sa):0;Oc=md+Oc;const Af=bb?this.Zsh(bb):this.GId.Yeb.clientHeight-yd;return new Ef(Q,md,Oc,Cb.id===dc.id?Af-md:Af+yd-Oc,Cb,dc,(bb?bb.pageNumber:this.rdh+1)===(sa?sa.pageNumber:0)+1)}Zsh(Q){return Q.Efa?0:Q.top}V5i(Q){if(this.i7g.Uxi)for(let sa of this.i7g.Uxi)sa&&sa.W5i(Q)}kYh(Q){this.pic||(this.pic=new un.a(0));if(this.pic.Pa(Q.id))return this.pic.J(Q.id);
var sa=Q.wd(this.Df.Ya);if(!sa)return ua.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;sa=la.a.Dab(this.GId.Yeb,sa.htmlElement).y;this.pic.W(Q.id,sa);return sa}}We.CZe=!1;Object(c.a)(We,"PageManager",null,[1863]);var Lg=b(1015),Wi=b(1021);class Xk{constructor(Q,sa,bb,Cb,dc,Oc,yd,md){this.ea=Q;this.rH=sa;this.aia=bb;this.yXe=Cb;this.Ch=dc;this.h7g=Oc;this.Ix=yd;this.dMd=md;this.lnj=!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixToBiggerCurrentPageToTotalPageCount",
!1)}get Yta(){return this.yXe.value}pb(){this.ea.La($b.a.sAc,ng.a.application,Object(n.a)(this,this.sAc,"queryTotalPageCount"),96);this.ea.La($b.a.tAc,ng.a.application,Object(n.a)(this,this.tAc,"queryViewPageEnds"),96);this.ea.La($b.a.vCb,ng.a.application,Object(n.a)(this,this.vCb,"toggleTotalPageCount"),8)}vCb(Q,sa,bb,Cb){if(1===bb)return 32;this.aia.Jee?(this.aia.Dok(),this.Yta&&this.Yta.W$k()):(this.aia.Usk(),this.Yta&&this.Yta.rBm());this.Ch.updateCommandUI();Cb.gs=this.aia.Jee?1:0;return 32}sAc(Q,
sa,bb,Cb,dc){if(1===bb)return 32;Q=this.h7g.lNf();-1===Q?Q="":this.dMd&&this.aia.Jee||1===this.Ix.Qz?(sa=this.h7g.$ad(),this.lnj&&sa>Q&&(Q=sa),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,sa,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);this.dMd?(dc[Lg.a.Visible]=!0,dc[Lg.a.LabelText]=Q):(dc[Wi.a.Visible]=!0,dc[Wi.a.Value]=Q);return 32}tAc(Q,sa,bb,Cb,dc){if(1===bb)return 32;
dc[Ik.a.On]=this.aia.Jee&&!this.Ix.Qz;return 32}static get Qa(){return Xk.va||(Xk.va=xa.a.instance.resolve("Box4.IFeatureHelper"))}}Xk.va=null;Object(c.a)(Xk,"PaginationActor",null,[]);class ym{constructor(Q){this.aVc=Q}get Zig(){return this.aVc}}Object(c.a)(ym,"PaginationDeltaResult",null,[1833]);class yi{constructor(Q,sa){this.SKb=this.BJd=null;this.Rd=Q;sa.execute(bb=>{bb.register(this)})}get w6f(){return"PaginationDelta"}get result(){return this.BJd}get s8f(){return 1}get irg(){return 200}get isEnabled(){return!0}z8f(){this.BJd=
null}R7a(Q){this.Rd.Jd(()=>{try{this.O1c(Q)}catch(sa){ua.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",sa.message)}},"PDM:C")}TAg(Q){this.SKb=Q}O1c(Q){this.BJd=null;Q=this.P1c(this.SKb,Q);-1!==Q&&(this.BJd=new ym(Q))}P1c(Q,sa){if(!(Q&&sa&&Q.count&&sa.count))return-1;const bb=new fa.a;for(let Cb of Q)bb.add(Cb.top);Q=new fa.a;for(let Cb of sa)Q.add(Cb.top);sa=this.m7d(bb,Q);return this.xnc(sa)}xnc(Q){if(!Q.count)return 0;let sa=0;for(let bb=
0;bb<Q.count;bb++)sa+=Q.J(bb);return sa/Q.count}m7d(Q,sa){const bb=new fa.a;if(!Q.count||!sa.count)return bb;var Cb=Q.count<=sa.count;const dc=Cb?Q:sa;Q=Cb?sa:Q;for(sa=0;sa<dc.count;sa++){Cb=dc.J(sa);let yd=Math.abs(Cb-Q.J(0)),md=0;for(let Af=1;Af<Q.count;Af++){var Oc=Q.J(Af);Oc=Math.abs(Cb-Oc);Oc<yd&&(yd=Oc,md=Af)}bb.add(yd);Q.removeAt(md)}return bb}}Object(c.a)(yi,"PaginationDeltaMetric",null,[1804]);var nq=b(355),Rm=b(1065);class Sm extends Pe.a{constructor(){super();this.LastKnownPaginationRevision=
this.FileId=null}pi(){return 36}static Hja(Q,sa){const bb=new Sm;bb.FileId=Q;bb.LastKnownPaginationRevision=um.a(sa);return bb}}Object(c.a)(Sm,"PaginationRequest",Pe.a,[]);class gj extends nq.a{constructor(Q,sa,bb,Cb,dc,Oc,yd,md=null){super();this.WO=null;this.jLe=0;this.Z4=-1;this.cHb=!1;this.cpa=Q;this.Uta=this.Uta.bind(this);this.cpa.Q_c(this.Uta);this.ea=sa;this.yXe=bb;this.GX=Cb;this.qH=dc;this.SQc=md||Pj.a.instance;this.yhc=this.RRa=ae.a.nil;this.Zsj=yd;Oc.CWR(()=>Oc.result.Po.ETa(Object(n.a)(this,
this.raa,"onKickedOut")));this.Zoc();this.me=new Rm.a(1E3);this.me.r1();this.qH.register(this)}get ZN(){return"Pagination"}get Yta(){return this.yXe.value}get M4d(){return this.Zsj.value}get soc(){return this.GX}get Tvl(){return this.RRa}get ODg(){return this.Z4}Jvm(Q){this.Z4!==Q&&(this.Z4=Q,this.GX.wHg())}Uta(){this.RRa=this.yhc=ae.a.nil;this.Zoc()}raa(){ua.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.lGh()}Ota(Q){this.WO=Q;this.WO.c7a(Object(n.a)(this,
this.I$f,"onGraphSpaceReplication"));this.W6a(this.WO.node)}I$f(){if(0==this.cpa.Qz){var Q=this.WO.Yk;ae.a.An(Q,this.yhc)||(this.yhc=Q,this.yPl(this.RRa,this.yhc))}}yPl(Q,sa){ae.a.An(Q,sa)?(this.Yta&&this.Yta.gje(),this.Zoc()):(this.Yta&&this.Yta.hje(),this.oFm())}btk(){this.enabled=2}Zoc(){this.enabled=0}oFm(){this.jLe=0;this.btk();this.Qq(null,null,null)}nQ(){return Mf.App.lostSession||Mf.App.Ob.Po.fm?!1:!!(this.enabled&2)&&this.me.px()}Qq(){this.me.k$();this.qH.Pu()}forceOutbound(){}kC(){return 0===
this.enabled?!1:this.Bb&&2===this.Bb.status?!0:this.nQ()}y2(){if(1===this._state)this.Bb.kk=Sm.Hja(G.AFrameworkApplication.rootQuerySignature,this.RRa),this.Bb.wv="Pagination",this.Bb.status=1,this._state=3;else if(3===this._state&&this.Bb&&2===this.Bb.status)if(G.AFrameworkApplication.ii)this._state=4;else if(this.me.Dy(),this.me.Yz(),this._state=1,this.jLe++,2!==this.Bb.statusCode)this.$oc();else if(1!==(this.Bb.yg?this.Bb.yg.length:0))this.$oc();else{var Q=this.Bb.yg[0];this.SQc.ACa(Q);104===Q.StatusCode?
this.lGh():101===Q.StatusCode?this.$oc():3===Q.StatusCode?this.$oc():Q.StatusCode?this.$oc():Q.PageEnds?(this.Jvm(Q.PageEnds.length+1),this.RRa=um.b(Q.LastKnownPaginationRevision),ua.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.Z4,this.RRa),this.Yta&&(this.Yta.VCd(Q.PageEnds,ae.a.An(this.RRa,this.yhc)),this.M4d.pageEnds=Q.PageEnds,this.soc&&this.soc.Xjf()),ua.ULS.sendTraceTag(5870302,
336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.Z4,this.RRa),this.Lok()):this.$oc()}}lGh(){this.WO&&this.WO.Zfb(Object(n.a)(this,this.I$f,"onGraphSpaceReplication"));this.Zoc()}$oc(){60<this.jLe&&this.Zoc()}Lok(){ae.a.An(this.RRa,this.yhc)&&this.Zoc()}dispose(){this.WO&&(this.WO.Zfb(Object(n.a)(this,this.I$f,"onGraphSpaceReplication")),this.WO.node&&this.vud(this.WO.node),this.WO=null);this.cpa.fng(this.Uta)}W6a(Q){Q&&
(Q.addListener(this),this.cHb=!0)}vud(Q){this.cHb&&Q&&(Q.removeListener(this),this.cHb=!1)}eBa(Q){this.vud(Q)}onBeforeLoadContent(){}onAfterLoadContent(Q){(Q=Q.zc.rj)&&this.ZMl(this.RRa,Q.id)}onAfterFirstSaveContent(){}ZMl(Q,sa){ae.a.An(Q,sa)&&this.Yta&&this.Yta.gje()}}Object(c.a)(gj,"PaginationReplicator",nq.a,[1803,13,181]);class Ol{constructor(){this.i9=this.Oy=this.GX=this.aia=this.Np=this.va=this.Z=null;this.Wwa=!1}get name(){return"WordEditor.Pagination"}get kYm(){return this.va.isFeatureEnabled(143)}get h9i(){return this.va.isFeatureEnabled(141)}get nZb(){return this.va.isFeatureEnabled(43)}get sKg(){return G.AFrameworkApplication.K.$("WordEditorPaginationIsDefaultOn")}get jYm(){return G.AFrameworkApplication.K.$("WordEditorPageEndMarkerPositionUpdaterIsEnabled")}Nb(Q){this.Z=
Q;this.va=this.Z.resolve("Box4.IFeatureHelper");this.Z.ia("WordEditor.Pagination.PageElementManagerList",()=>{const sa=this.nZb?this.Z.resolve("WordEditor.Pagination.CurrentPageCalculator"):null;return new Np(this.Z.resolve("WordEditor.Pagination.PageAdornmentManager"),sa)}).fa();this.Z.ia("WordEditor.Pagination.OutlineManager",()=>new lq(new yb.a(()=>Mf.App.oa.Ca.nc))).as("WordEditor.Pagination.IOutlineManager").fa();this.Z.ia("WordEditor.Pagination.PageManager",()=>new We(new yb.a(()=>Mf.App.oa.Ca.nc),
this.Z.resolve("WordEditor.Pagination.DocumentSizeManager"),this.Z.resolve("WordEditor.Pagination.PageElementManagerList"),this.Z.resolve("WordEditor.Pagination.OutlineManager"),this.Z.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").fa();this.Z.ia("WordEditor.IPaginationReplicator",()=>{const sa=this.nZb?this.Z.resolve("WordEditor.Pagination.CurrentPageCalculator"):null;return new gj(this.Z.resolve("WordEditor.IMainViewModeManager"),G.AFrameworkApplication.qa,
new yb.a(()=>this.h9i?this.Z.resolve("WordEditor.Pagination.IPageEndMarkers"):null),sa,im.App.rB,Mf.App.Hka(),new yb.a(()=>this.Z.resolve("WordEditor.TableOfContents.IDocumentHeadings")))}).fa();this.Z.ia("WordEditor.ICurrentPageManager",()=>{const sa=this.nZb?this.Z.resolve("WordEditor.Pagination.CurrentPageCalculator"):null;return new vo(sa,this.sKg)}).fa();this.Z.ia("WordEditor.Pagination.PageLevelDeltaMetric",()=>new Hf(new yb.a(()=>Mf.App.oa.Ca.nc),this.Z.resolve("Box4.ITextMetricsAdapter"),
Re.a.instance,this.Z.Fa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).fa();this.Z.ia("WordEditor.Pagination.PageHeightDeltaMetric",()=>new xc(this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),Re.a.instance,this.Z.Fa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).fa();this.Z.ia("WordEditor.Pagination.PaginationDeltaMetric",()=>new yi(Re.a.instance,this.Z.Fa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).fa();this.Z.ia("WordEditor.Pagination.PageHeightStorage",
()=>new hd(this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new Al(new yb.a(()=>Mf.App.oa.Ca.nc),this.Z.resolve("Common.IZoomManager"),this.Z.resolve("WordEditor.Pagination.PageEndDOMHelper"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new bp(this.Z.resolve("WordEditor.Pagination.PageHeightStorage"),this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightRenderer",
()=>new Lb(this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.Z.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new nb(this.Z.resolve("WordEditor.Pagination.PageFullHeightManager"),this.Z.Pd("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.Z.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.Z.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).fa();
this.Z.ia("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.Z.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).fa();this.Z.ia("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new wo(new yb.a(()=>Mf.App.oa.Ca.nc),this.Z.resolve("Common.IZoomManager"),this.Z.resolve("WordEditor.Pagination.OutlineManager"),this.Z.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.Z.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.Z.resolve("WordEditor.Pagination.PageFullHeightManager"),
Mf.App.rh.Ej)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").fa();this.Z.ia("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new Ih(this.Z.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.Z.resolve("WordEditor.Pagination.PageHeightStorage"),Qn.WordSectionNavigator.instance,this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightManager",()=>this.Z.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).fa();
this.Z.ia("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new Jo(this.Z.resolve("Common.IZoomManager"),Re.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").fa();this.Z.ia("WordEditor.Pagination.PaginationActor",()=>new Xk(G.AFrameworkApplication.qa,this.Z.resolve("WordEditor.IStatusBarUser"),this.Z.resolve("WordEditor.ICurrentPageManager"),new yb.a(()=>this.h9i?this.Z.resolve("WordEditor.Pagination.IPageEndMarkers"):null),G.AFrameworkApplication.pa,this.Z.resolve("WordEditor.IPageCountGetter"),
this.Z.resolve("WordEditor.IMainViewModeManager"),this.nZb)).fa();this.Z.ia("WordEditor.Pagination.DocumentSizeManager",()=>new nj(new yb.a(()=>Mf.App.oa.Ca.nc),Mp.a.get_instance())).fa();this.Z.ia("WordEditor.Pagination.CurrentPageCalculator",()=>new Gg(G.AFrameworkApplication.qa,Vl.a.instance,Zj.a.instance,this.Z.resolve("WordEditor.Pagination.DocumentSizeManager"),new yb.a(()=>Mf.App.oa.Ca.nc),this.Z.sa("Box4.CharacterPointConverter"),this.Z.resolve("WordEditor.IStatusBarUser"),this.nZb)).as("Common.ICurrentPageCalculator").fa();
this.Z.ia("WordEditor.Pagination.PageEndMarkers",()=>this.Oy=new fj(new yb.a(()=>Mf.App.oa.Ca.nc),new yb.a(()=>Mf.App.oa.Ca.Rb.zc),this.Z.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.Z.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.Z.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.Z.resolve("WordEditor.Pagination.IPageManager"),this.Z.resolve("WordEditor.Pagination.DocumentSizeManager"),this.Z.resolve("WordEditor.Pagination.PageEndDOMHelper"),
ln.a.Bsb,this.Z.resolve("WordEditor.ParagraphWordIdMapping"),Zj.a.instance,fj.lPk,this.Z.resolve("Box4.ContentEditableViewEventSource"),new mm.a,this.Z.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.Z.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.Z.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.nZb?this.Z.resolve("Common.ICurrentPageCalculator"):null,this.sKg,this.jYm,this.Z.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").fa();
this.Z.ia("WordEditor.Pagination.PageEndDOMHelper",()=>new Pk(this.Z.Fa("Common.IZoomManager"))).fa();this.Z.ia("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new up(G.AFrameworkApplication.Vb)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").fa();this.Z.ia("WordEditor.Pagination.PageAdornmentContentManager",()=>new Gq(this.Z.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").fa();this.Z.ia("WordEditor.Pagination.PageAdornmentManager",
()=>this.i9=new nm(new yb.a(()=>Mf.App.oa.Ca.nc),hm.a.instance,fg.a.instance,de.a.instance,G.AFrameworkApplication.qa,Bg.a.instance,this.sKg,this.Z.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.Z.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.Z.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Zj.a.instance,G.AFrameworkApplication.K)).as("WordEditor.Pagination.IPageAdornmentManager").fa()}init(){this.va.Uk.continueWith(()=>{this.Ck()})}Ck(){if(this.kYm){const Q=
Mf.App.oa.Ca;Q.lla?this.mmh():Q.D9(Object(n.a)(this,this.gRj,"appIsInteractiveEventHandling"))}}gRj(){this.mmh()}mmh(){this.Wwa||(this.Wwa=!0,this.aia=xa.a.instance.resolve("WordEditor.ICurrentPageManager"),this.nZb&&(this.GX=xa.a.instance.resolve("Common.ICurrentPageCalculator")),this.Np=xa.a.instance.resolve("WordEditor.IPaginationReplicator"),xa.a.instance.resolve("WordEditor.Pagination.PaginationActor").pb())}dispose(){this.i9&&(this.i9.dispose(),this.i9=null);this.Oy&&(this.Oy.dispose(),this.Oy=
null);this.Np&&(this.Np.dispose(),this.Np=null);this.GX&&(this.GX.disable(),this.GX=null);this.aia&&(this.aia=null)}}Object(c.a)(Ol,"PackageManager",null,[2,3]);class pm{constructor(){this.Z=null}Nb(Q){this.Z=Q||xa.a.instance}dispose(){}}Object(c.a)(pm,"TellMePackage",null,[2,3]);var ql=b(1115),oq=b(1116),zm=b(292),nn=b(1111),Hq=b(1023),gs=b(1171);class Bl{constructor(Q=null,sa=null,bb=null,Cb,dc=null){this.UGe=null;this.OMg=!1;this.hVg=this.Jdc=null;this.DCj=this.Ibh=this.yNg=this.iVg=!1;this.BHd=
null;this.ugj=null==sa?G.AFrameworkApplication.TOb:sa;this.oqj=null==bb?G.AFrameworkApplication.LN:bb;this.bDj=null==dc?G.AFrameworkApplication.t_a:dc;this.jpj=!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.AEj=!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.Hvm(!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.rEj=!!G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.Nvb;
this.sEj=!nn.a.Lu()&&!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");this.qEj=!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.Lmj=!!G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.sBb;this.tEj=!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.kCj=!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.hxj=this.wyd||
this.vyd;this.fxj=!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");this.gxj=this.EYf;this.gsj=!!G.AFrameworkApplication.K&&this.jib&&G.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.boj=G.AFrameworkApplication.K?G.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.Aoj=G.AFrameworkApplication.K?G.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",
1400):1400;this.zoj=G.AFrameworkApplication.K?1E-6*G.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.ServiceRankerSuppressionScore",1):1E-6;this.Snj=G.AFrameworkApplication.K?parseFloat(G.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.esj=!!G.AFrameworkApplication.K&&(G.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1));this.HDj=G.AFrameworkApplication.K?G.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.Eoj=G.AFrameworkApplication.K?G.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.zCj=!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShowOpenSearchPaneStringInZeroTerm",
!1);this.uEj=this.Nfi&&(this.jcg||this.kcg||this.fqd||this.jib&&nn.a.fXa()&&!!G.AFrameworkApplication.K&&(this.Fyd||this.lac||this.nac||this.oac||this.pac||G.AFrameworkApplication.K.$("ShowAnswerSearchResults")||G.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||G.AFrameworkApplication.K.$("ShowEntitySearchResults")||G.AFrameworkApplication.K.$("ShowWolframSearchResults")));this.Rdl(Q||{});this.C5e="2918242107";this.B5e="1454393937";this.FKb={};this.nob=[];this.Zak=[nn.a.gAe]}get application(){return this.Jdc}get TOb(){return this.ugj}get Klm(){return this.C5e}get Jlm(){return this.B5e}get OBf(){return this.hVg}get UMh(){return this.iVg}get LN(){return this.oqj}get t_a(){return this.bDj}get n7a(){return this.yNg}get H$k(){return this.jpj}get $Im(){return this.AEj}get Nfi(){return!0}get RIm(){return this.uEj}get Rxm(){return this.Ibh}Hvm(Q){this.Ibh=
Q}get jib(){return this.rEj}get OAd(){return this.sEj}get MAd(){return this.qEj}get Kxk(){return this.Lmj}get PIm(){return this.tEj}get Lze(){return!1}get fqd(){return this.hxj}get jcg(){return this.fxj}get kcg(){return this.gxj}get Ucb(){return!1}get Rge(){return!1}get I_f(){return this.gsj}get qwe(){return this.DCj}get Fyd(){return!1}get sUi(){return!1}get Mhi(){return""}get EYf(){return!1}get IL(){return 2}get zZh(){return 4}get fei(){return!1}get AZh(){return 5}get qfi(){return!1}get $Lf(){return""}get JNk(){return this.boj}get O_h(){return this.Aoj}get C_h(){return 1E3}get I_k(){return this.zoj}get CGm(){return this.HDj}get gBg(){return!1}get LYi(){return!1}get Kei(){return!1}get AYf(){return!1}get $ci(){return!1}get Zci(){return!1}get Vcb(){return!1}get Ofi(){return!1}get a7d(){return!1}get i_a(){return!1}get lac(){return!1}get nac(){return!1}get oac(){return!1}get pac(){return!1}get wyd(){return this.kCj}get vyd(){return!1}get HGf(){return null}get shb(){return!1}get vge(){return!1}get LXh(){return 0}get mJk(){return this.Snj}get k0h(){return this.Eoj}get Trl(){return this.esj}get Nym(){return this.zCj}get hXa(){return!!G.AFrameworkApplication.pa&&
G.AFrameworkApplication.pa.mb.Eo}get Eo(){return!!G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.Eo}get Bol(){return!!G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.rhb}get CIl(){return Om.getImageClass("OfficeAssistant_32x32x32")}ehe(Q){return this.Eo?Array.contains(appChrome.selectors.getVisibleControlIds(),Q):!!gs.a.instance.RHf(Q)}$hd(Q){return(Q=gs.a.instance.RHf(Q))?Q.enabled:!1}pFi(){}y8d(){return null}get eub(){return"NoOpHeaderUi"}get Vak(){return this.BHd}get parameterData(){return this.FKb}get HNm(){return this.nob}Tuk(){if(this.UGe&&
!this.OMg&&(this.OMg=!0,this.ohb(this.UGe),this.Eo)){var Q=xa.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Q=(new Hq.a(Q)).Lqc(this.UGe.VG);appChrome.api.dispatch(Q)}}get xrg(){return""}ohb(){}Enk(Q){const sa=[];for(let bb=0;bb<Q.length;++bb)Q[bb].tzm?sa.push(new zm.a(Q[bb].alternate,nn.a.I2i+bb.toString())):sa.push(new zm.a(Q[bb].standard,nn.a.gAe+bb.toString()));return sa}Rdl(Q){const sa={};for(let bb in Q){const Cb=bb,dc=Q[bb];for(let Oc in dc){const yd=Oc,md=dc[Oc];(sa[yd]||
(sa[yd]={}))[Cb]=md}}this.BHd=sa}get m_i(){return""}get l_i(){return""}get k_i(){return""}get zVi(){return!1}}Object(c.a)(Bl,"TellMeApplicationData",null,[1309]);class lo{constructor(Q,sa=null,bb=!1){this.standard=Q;this.alternate=sa;this.tzm=bb}}Object(c.a)(lo,"TryQuerySet",null,[]);class Qg{get AZa(){return 18}H5(Q){return ji.a(String.format("{0}|{1}|",3,$a.a.ve(Q.value)),cb.a.mld.toString(),Qg.MKl)}}Qg.MKl="Explore Office Store";Object(c.a)(Qg,"AppsForOfficeQueryMenuItemFactory",null,[1332]);var Yk=
b(1099);class am{constructor(){this.icon=this.description=this.assetId=this.name=null;this.installed=!1;this.storeId=this.currentStoreType=this.assetStoreId=this.appVersion=null;this.targetType=0}}Object(c.a)(am,"OfficeAppItem",null,[]);class si{constructor(){this.WFd=null}get j7a(){this.WFd||(this.WFd={},this.I3l());return this.WFd}u_j(Q){if(Q)for(let sa of Q)Q=sa[1],Q in this.j7a&&(Q=this.j7a[Q],Q.installed=!0,Q.name=sa[0],Q.description=sa[2],Q.targetType=sa[3],Q.appVersion=sa[4],Q.currentStoreType=
sa[6],Q.icon=sa[9],Q.storeId=sa[11],Q.assetStoreId=sa[12])}$uk(Q,sa,bb,Cb,dc){!Yk.b(Q)&&Q in this.j7a&&(Q=this.j7a[Q],Q.installed=!0,Q.appVersion=sa,Q.storeId=bb,Q.assetStoreId=Cb,Q.targetType=dc)}N0(Q,sa,bb,Cb){const dc=new am;dc.assetId=sa;dc.name=Q;dc.icon=bb;dc.description=Cb;dc.installed=!1;this.WFd[sa]=dc}I3l(){this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_Translator,"WA104124372",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_Translator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_Translator);
this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_TextMaster,"WA104079622",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_TextMaster,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_TextMaster);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ConsistencyChecker,"WA104041485",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ConsistencyChecker,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ConsistencyChecker);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_EFax,
"WA102919521",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_EFax,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_EFax);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ProWordCloud,"WA104038830",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ProWordCloud,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ProWordCloud);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_FontFinder,"WA104211266",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_FontFinder,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_FontFinder);
this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_PicHit,"WA104178141",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_PicHit,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_PicHit);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_IMGEffector,"WA104070070",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_IMGEffector,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_IMGEffector);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_LucidChart,"WA103633427",
WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_LucidChart,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_LucidChart);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_DocuSign,"WA104218065",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_DocuSign,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_DocuSign);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_GeoGebraTube,"WA104199813",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_GeoGebraTube,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_GeoGebraTube);
this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordCalc,"WA103699714",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordCalc,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordCalc);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_QR4Office,"WA104051163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_QR4Office,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_QR4Office);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_SymbolsCharacters,"WA104379279",
WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_SymbolsCharacters,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_SymbolsCharacters);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordToHTML,"WA104320163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordToHTML,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordToHTML);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_MapIt,"WA104374368",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_MapIt,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_MapIt);
this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_AbbreviationList,"WA104043061",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_AbbreviationList,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_AbbreviationList);this.N0(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_HandyCalculator,"WA104379673",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_HandyCalculator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_HandyCalculator)}static get instance(){return si.ta}}si.ta=
new si;Object(c.a)(si,"AppData",null,[]);const Yg=(Q,sa,bb,Cb=null)=>{const dc=$a.a.ve(Q.name);var Oc="TellMe_OfficeAddin_Control";bb.Rfe()?Oc="TellMe_OfficeAddin_SingleFlyoutLayout":bb.xdi()&&(Oc="TellMe_OfficeAddin_StandaloneFlyoutLayout");bb=Q.installed?String.format("{0}|{1}|{2}|{3}|{4}|{5}|{6}",Q.assetId,Q.appVersion,Q.storeId,Q.assetStoreId,Q.targetType,$a.a.ve(Q.name),Oc):String.format("{0}|{1}||{2}",2,Q.assetId,Oc);Oc=$a.a.ve(Q.description);return ji.b(bb,Q.installed?cb.a.Ade.toString():cb.a.mld.toString(),
dc,Q.icon,sa?"cui-img-16by16":"cui-img-32by32",null,Cb?Cb.sessionId+"|"+Cb.hla+"|"+Q.name:"",dc,sa?"Menu16":"Menu32",null,cb.a.f_i.toString(),Oc,null,null)},vn=(Q,sa,bb,Cb,dc)=>ji.h(Q,null,null,null,!1,!0,null,null,"Image16by16",sa,bb,Cb,null,Cb,null,!1,!1,!0,dc);class Op{constructor(Q){this.tc=Q}get AZa(){return 17}H5(Q,sa=null){if(this.tc.Rfe()){var bb=[];Q=Q.value.split("|");for(let Cb of Q)if(!Yk.b(Cb)){let dc=Yg(si.instance.j7a[Cb],!1,this.tc,sa);bb.push(dc)}sa=CommonUIStrings.l_TellMeAppsForOfficeMenuSectionTitle;
bb=ji.e("TellMeDropdownControlsForApps_SingleFlyoutLayout",bb);sa=ji.j("TellMeDropdownMenuSectionForApps_SingleFlyoutLayout",bb,"Menu32",sa);Q=String.format(CommonUIStrings.l_TellMeAppsForOfficeFlyoutAnchorTitle,Q.length-1);return vn("TellMeFlyoutAnchorForApps_SingleFlyoutLayout",G.AFrameworkApplication.Hp,Om.getImageClass("AppForOfficeLogo_16x16x32"),Q,[sa])}Q=si.instance.j7a[Q.value];return this.tc.xdi()?(sa=[Yg(Q,!1,this.tc,sa)],sa=ji.e("TellMeControlsForApps_StandardFlyoutLayout",sa),sa=ji.j("TellMeMenuSectionForApps_StandardFlyoutLayout",
sa,"Menu32"),bb=String.format(CommonUIStrings.l_TellMeAppsForOfficeInsertAppHint,$a.a.ve(Q.name)),vn("TellMeFlyoutAnchorForApps_StandardFlyoutLayout"+Q.assetId,Q.icon,"cui-img-16by16",bb,[sa])):Yg(Q,!0,this.tc,sa)}}Object(c.a)(Op,"AppsForOfficeRecommendationMenuItemFactory",null,[1332]);var Hm=b(1128);class Dj{constructor(){this.WJc=0;this.jNg=!1}Uhg(){this.jNg||(this.MAc(),this.jNg=!0);if(!this.WJc||4===this.WJc){const Q=new kc.a(2,1,0,Object(n.a)(this,this.Pim,"retrieveData"));G.AFrameworkApplication.Vb.Eb(Q);
this.WJc=1}}MAc(){const Q={};Q.callback=Object(n.a)(this,this.DLl,"onAppForOfficeActivated");G.AFrameworkApplication.qa.Db(cb.a.MAc,2,Q)}Pim(){const Q={};Q.callback=Object(n.a)(this,this.lNl,"onDataReady");G.AFrameworkApplication.qa.Db(cb.a.usd,2,Q)}DLl(Q,sa){si.instance.$uk(sa[0],sa[1],sa[2],sa[3],sa[4])}lNl(Q){Q?(Q.errorCode||si.instance.u_j(Q.value),this.WJc=Q.errorCode&&-1!==Q.errorCode?-2147208619===Q.errorCode?4:3:2):this.WJc=3}static get instance(){return Dj.ta}}Dj.ta=new Dj;Object(c.a)(Dj,
"AppEntitlementQuery",null,[]);class cp{constructor(Q){this.JYc=this.A9g=null;this.tc=Q}initialize(){Dj.instance.Uhg();this.tc.Rfe()&&(this.A9g=[]);this.JYc=null}zTm(Q,sa){Q in si.instance.j7a&&(si.instance.j7a[Q].installed?sa.eJ(new Hm.a(Q,16)):(this.JYc||(this.JYc=Q),this.tc.Rfe()&&this.A9g.push(Q)))}eMj(Q,sa){this.JYc&&!Yk.b(sa)&&(Q.eJ(new Hm.a(this.JYc,17)),Q.eJ(new Hm.a(sa,18)))}}Object(c.a)(cp,"AppsForOfficeResultsProvider",null,[1902]);class qm{constructor(){this.Z3g=this.$3g=null}get OGl(){return this.Z3g}H5(Q){this.$3g=
Q;return this.osf(Q)}CJl(){this.Z3g=this.$3g}k$d(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.bF):Q.bF}cGf(Q){return Q.bF}}Object(c.a)(qm,"ParameterizedCommand",null,[]);class tr extends qm{constructor(Q){super();this.ekd=Q}get commandId(){return this.ekd?"DefinitionsParameterized":"DefinitionButton"}get Gdg(){return"Definition"}osf(Q){const sa=$a.a.ve(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.bF));return ji.a(nn.a.Htf(Q.value),
cb.a.$uf.toString(),sa,nn.a.kUf,null,$a.a.ve(nn.a.eoc(Q.bF)),sa,null,null)}k$d(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.bF)}cGf(Q){return nn.a.eoc(Q.bF)}}Object(c.a)(tr,"DefinitionsParameterizedCommand",qm,[]);class Uh extends qm{constructor(Q){super();this.ekd=Q}get commandId(){return this.ekd?G.AFrameworkApplication.pa.mb.Sll?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get Gdg(){return"Find"}osf(Q){const sa=$a.a.ve(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,
Q.bF));return ji.a(nn.a.Htf(Q.value),cb.a.findInDocument.toString(),sa,"Find_16x16x32",null,$a.a.ve(Q.bF),sa,null,null)}k$d(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.bF)}}Object(c.a)(Uh,"FindParameterizedCommand",qm,[]);class hj{constructor(Q){this.tc=Q}get AZa(){return 16}H5(Q,sa=null){return Yg(si.instance.j7a[Q.value],!0,this.tc,sa)}}Object(c.a)(hj,"InstalledAppsForOfficeMenuItemFactory",null,[1332]);class tf extends qm{constructor(Q){super();this.ekd=Q}get commandId(){return this.ekd?
"SynonymsParameterized":"SynonymButton"}get Gdg(){return"Synonym"}osf(Q){const sa=$a.a.ve(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,Q.bF));return ji.a(nn.a.Htf(Q.value),cb.a.$uf.toString(),sa,nn.a.kUf,null,$a.a.ve(nn.a.eoc(Q.bF)),sa,null,null)}k$d(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.bF)}cGf(Q){return nn.a.eoc(Q.bF)}}Object(c.a)(tf,"SynonymsParameterizedCommand",qm,[]);class Zk extends Bl{constructor(Q){super({});
this.zHe=null;this.Jdc="Word";this.moj=Q;G.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.iVg=!0,this.hVg=this.a7d?"FindWithMatchesParameterized":"FindParameterized");this.yNg=G.AFrameworkApplication.K.$("SearchOfficeAddinIsEnabled")&&!G.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled");Q=new tr(this.hXa);const sa=new tf(this.hXa);this.parameterData[Q.commandId]=Q;this.parameterData[sa.commandId]=sa;G.AFrameworkApplication.K.$("WordEditorTellMeParameterizedFindIsEnabled")&&
(Q=new Uh(this.hXa),this.parameterData[Q.commandId]=Q);G.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(Q=[new lo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new lo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new lo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new lo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,"",!1),new lo(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.nob=this.Enk(Q))}get EZa(){return Nl.AppFrame.B2}get eub(){return Nl.AppFrame.vsa}y8d(){this.n7a&&
!this.zHe&&(this.zHe=new cp(this));return this.zHe}pFi(Q){this.n7a&&(Q.ia(new hj(this)),Q.ia(new Op(this)),Q.ia(new Qg))}get xrg(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}ohb(Q){var sa=G.AFrameworkApplication.K;Q=Q.VG;Q.WordCountFlyout=!this.moj();Q.SelectAllButton=!sa.$("TellMeSelectAllResultIsEnabled");const bb=sa.$("TellMeDesktopUpSellIsEnabled");let Cb=G.AFrameworkApplication.Osl;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",
!Cb));Cb=!1;Q.TextBoxUpSellButton=!bb||Cb;Q.TableOfContentsUpSellButton=!bb||Cb;Q.SmartArtUpSellButton=!bb||Cb;Q.WordArtUpSellButton=!bb||Cb;Q.MultiColumnLayoutUpSellButton=!bb||Cb;Q.InsertEquationUpSellButton=!bb||Cb;Q.TrackChangesUpSellButton=!bb||Cb;Q.ShapesUpSellButton=!bb||Cb;Q.LabelsUpSellButton=!bb||Cb;Q.InsertCitationUpSellButton=!bb||Cb;Q.TextBoxUpSellButtonEnterprise=!bb||!Cb;Q.TableOfContentsUpSellButtonEnterprise=!bb||!Cb;Q.SmartArtUpSellButtonEnterprise=!bb||!Cb;Q.WordArtUpSellButtonEnterprise=
!bb||!Cb;Q.MultiColumnLayoutUpSellButtonEnterprise=!bb||!Cb;Q.InsertEquationUpSellButtonEnterprise=!bb||!Cb;Q.TrackChangesUpSellButtonEnterprise=!bb||!Cb;Q.ShapesUpSellButtonEnterprise=!bb||!Cb;Q.LabelsUpSellButtonEnterprise=!bb||!Cb;Q.InsertCitationUpSellButtonEnterprise=!bb||!Cb;sa=!sa.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!G.AFrameworkApplication.LN;Q.SynonymButton=sa;Q.DefinitionButton=sa}Rfe(){return G.AFrameworkApplication.K.zb("OfficeAddInSearchResultLayoutVariant",Zk.Ori)===
Zk.HKl}xdi(){return G.AFrameworkApplication.K.zb("OfficeAddInSearchResultLayoutVariant",Zk.Ori)===Zk.IKl}get m_i(){return G.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermModelName","")}get l_i(){return G.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get gBg(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get k_i(){return G.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName",
"")}get Fyd(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get EYf(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get IL(){return G.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get zVi(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get Rge(){return G.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&
G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get Kei(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRuleBasedSorting",!1)}get zZh(){return G.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.QueryLengthThresholdForPrefixMatch",4)}get AZh(){return G.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.QueryLengthThresholdForSubstringMatch",5)}get fei(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePrefixMatch",
!1)}get qfi(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSubstringMatch",!1)}get sUi(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldShowLearningUIResults",!1)}get Mhi(){return G.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.LearningUIQuery","")}get AYf(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get C_h(){return G.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",
1E3)}get $ci(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get Zci(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get $Lf(){return G.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get Vcb(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNotesSuggestionIsEnabled",
!1)}get Ofi(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get LXh(){return G.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get Nfi(){return G.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get Lze(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get Ucb(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",
!1)}get qwe(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get LYi(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get shb(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.ShowFindInDocumentInZeroTerm",!1)}get vge(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",
!1)}get lac(){return G.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get nac(){return G.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get oac(){return G.AFrameworkApplication.K.$("ShowEntitySearchResults")}get pac(){return G.AFrameworkApplication.K.$("ShowWolframSearchResults")}get HGf(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1)?{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Zk.Ori=1;Zk.IKl=2;Zk.HKl=3;Object(c.a)(Zk,
"WordEditorTellMeApplicationData",Bl,[]);var Gn=b(1196),Tm=b(82),dp=b(1722),Pp=b(1707),Gi=b(1133),Sn=b(1143),Yq=b(1637),ur=b(188),Kk=b(1281),ag=b(1709);class Cg extends ag.a{constructor(Q){super();this.RGj=Q}T9c(){this.RGj.update()}}Object(c.a)(Cg,"TellMeFindStatusManager",ag.a,[]);class Tf{constructor(Q){this.gob=this.UOg=null;this.If=0;this.KLd="TellMeWAC.";const sa=Q.OBf;this.tc=Q;this.KJd=sa;this.LNd=Object.assign(new Gn.a,{landingTab:"Indoc",data:null});Q=new Cg(this);this.VUd=Yq.FindManager.createInstance(Q,
dp.a.instance,Kk.a.instance,!0,!0)}C$(){return"WordFindInDocument"}hsa(){return this.tc.IL?1===this.tc.IL?1:3:0}H6(Q,sa){this.Ptl(Q)?(this.gob=Q,this.UOg=sa,Q=Pp.a.createQuery(Q.Oh,0),this.If=window.performance.now(),this.VUd.find(Q)):sa.resultsUpdated(new Gi.a(Q))}update(){this.Pnm(Math.round(window.performance.now()-this.If));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.gob.Oh);var sa=G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.i_a?nn.a.vqb(this.gob.Oh,15,this.LNd):
$a.a.ve(this.gob.Oh);const bb=[];bb.push(appChrome.actions.setControlLabel(this.KJd,Q));bb.push(appChrome.actions.setCompoundButtonCommandValueId(this.KJd,sa));bb.push(appChrome.actions.updateCompoundButtonDescription(this.KJd,this.kNf()));appChrome.api.dispatch(bb);Q=new Hm.a(this.KJd,8,this.gob.Oh,this.VUd.Dj.qCa.toString());sa=new Sn.a(2);sa.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;sa.eJ(Q);const Cb=new Gi.a(this.gob);Cb.NF(sa);window.requestAnimationFrame(()=>{this.UOg.resultsUpdated(Cb)});
this.VUd.hQb(!0);this.Qnm(Math.round(window.performance.now()-this.If))}kNf(){const Q=this.VUd.Dj.qCa.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,Q)}Ptl(Q){return!!Q&&!!Q.Oh&&""!==Q.Oh.trim()}Pnm(Q){const sa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.gob.Oh.length};this.sendActivityEvent(sa,Q)}Qnm(Q){const sa=
{["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.gob.Oh.length};this.sendActivityEvent(sa,Q)}sendActivityEvent(Q,sa){Q=Tm.a.BSb(Q);vi.a.TZa(Object.assign(new ur.a,{name:"Latency",dataFields:Q,durationMs:sa}),this.KLd)}}Object(c.a)(Tf,"WordFindInDocumentWithMatchesProvider",null,[1334]);class Ie{constructor(Q,sa){this.Bd=Q;this.Ahl=sa}Ibb(Q,sa,bb){return this.Ahl.Ibb(0,Q,sa,bb)}insertHtmlText(Q){return Q?
32===this.PTf(Q):!1}PTf(Q){return this.executeCommand(ve.a.OTa,Q)}executeCommand(Q,sa){const bb=new Jl.DictionaryPropertySet;bb.setValue(Kl.a.l_,sa);bb.setValue(Kl.a.OZa,!1);sa=this.Bd.processAction(Q,1);32===sa&&(sa=this.Bd.Db(Q,2,bb));return sa}}Object(c.a)(Ie,"WordInsertContentHandler",null,[1806]);class hh extends pm{constructor(){super()}get name(){return"WordEditor.TellMe"}init(){G.AFrameworkApplication.K.Do(Object(n.a)(this,this.ux,"onFullAppSettingsReady"))}ux(){if(G.AFrameworkApplication.Qye){var Q=
Mf.App.oa.mb.Jae(cb.a.tellMe);Q.Vee?this.Wzi():Q.fJ(Object(n.a)(this,this.xlm,"scriptResource_LoadFinished"));var sa=new Zk(()=>!1);ql.TellMeActor.instance.initialize(sa,null,null,null,null,null,Object(n.a)(Mf.App.oa,Mf.App.oa.FDf,"forceUpdateRibbonControls"),G.AFrameworkApplication.K,this.Z.Fa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.Fa("Common.IActionContextProvider"));ql.TellMeActor.instance.Q9l(Q);ql.TellMeActor.instance.jam(new Ie(G.AFrameworkApplication.qa,this.Z.sa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
sa.UMh&&sa.a7d&&ql.TellMeActor.instance.L0(new Tf(sa),oq.a.tellMe)}}Wzi(){Mf.App.oa.updateCommandUI()}xlm(){this.Wzi()}}Object(c.a)(hh,"WordEditorTellMePackage",pm,[]);class Ej{constructor(){this.Z=null}get name(){return"WordEditor.TestFeature"}init(){this.Z.resolve("Box4.IFeatureHelper").Uk.continueWith(()=>{this.Ck()})}dispose(){}Ck(){if(this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(221)){G.AFrameworkApplication.qa.La($b.a.wordTestFeature,ng.a.view,Object(n.a)(this,this.ZIm,"testFeature"),
96);var Q=yj.FocusManager.instance().ed(Nl.AppFrame.EE);De.AFrame.Ii(Q,kf.KeyInputManager.Cb(Ui.a.sDb,5|kf.KeyInputManager.Qh),$b.a.wordTestFeature)}}ZIm(Q,sa,bb){2===bb&&(Q=new wd.StandardDialog,Q.Jc=0,Q.Yma(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}Nb(Q){this.Z=Q}static main(){aa.a.instance.jc(new Ej)}}Object(c.a)(Ej,"WordEditorTestFeaturePackage",null,[2,3]);var rl=b(102);class Am{constructor(Q,sa){this.uLi=
Q;this.Bd=sa;this.Ntd()}Ntd(){this.Bd.na($b.a.Jwd,Ec.a.frame,Object(n.a)(this,this.Jwd,"sendTrackChangeSettingUpdateNotification"));this.uLi.j5(Object(n.a)(this,this.m7,"onUpdateNotificationReceived"))}Jwd(Q,sa,bb,Cb,dc){if(1===bb)return 32;this.uLi.$Q(9,dc,!1);return 32}m7(Q,sa){if(9===sa.type){var bb;(Q=sa.l8)?("string"===typeof Q?bb=Q:"data"===Q.type&&(bb=rl.a.ctf(Q.E0l,Q.newState,Q.Kvm)),bb&&Am.Y6a(bb)):ua.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}}dispose(){}static Y6a(Q){Q=
Mf.App.oa.notificationBar.Kya(Q,!1);Q.image=5;Q.xsa="CoAuth_AuthorStatus_16x16x32";Mf.App.oa.notificationBar.Nz(Q)}}Object(c.a)(Am,"TrackChangeNotificationActor",null,[]);class Um{constructor(){this.Gh=this.X9e=this.Z=null}get name(){return"WordEditor.TrackChangeNotificationActor"}Nb(Q){this.Z=Q}init(){this.Z.resolve("Box4.IFeatureHelper").Uk.continueWith(()=>{this.Ck()})}Ck(){Mf.App.wsc().continueWith(Object(n.a)(this,this.w6b,"onRtcProxyReady"))}w6b(){if(this.Gh=Mf.App.wsc().result)this.Z.ia("WordEditor.TrackChange.TrackChangeNotificationActor",
()=>new Am(this.Gh,G.AFrameworkApplication.qa)).fa(),this.X9e=this.Z.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}dispose(){this.X9e&&this.X9e.dispose()}}Object(c.a)(Um,"WordEditorTrackChangeNotificationActorPackageManager",null,[2,3]);var vr=b(64),Iq=b(1700),Lo=b(1701);class qj{}qj.ZFg="UnsavedChanges";qj.Rkm="SavedChanges";qj.N3i="UnsavedChangesOpenPipe";qj.M3i="UnsavedChangesClosePipe";qj.MPm="UnsavedChanges";qj.$Fg="UnsavedChangesIndicatorPositionRef";Object(c.a)(qj,"UnsavedChangesHighlightUtils",
null,[]);class Zq extends Iq.a{constructor(Q){super();this.qia=Q;this.$ba=[new Lo.a(qj.ZFg,qj.MPm)]}get Wza(){return!0}get Vsc(){return 4}get LXb(){return this.$ba}bNa(Q,sa){if(this.qia){var bb=this.qia.N6f;if(bb&&bb.count&&bb.contains(Q.id))for(Q=sa.$7b("span"),sa=0;sa<Q.length;sa++)bb=Q[sa],sa||bh.a.Kc(bb,qj.N3i),sa===Q.length-1&&bh.a.Kc(bb,qj.M3i),bh.a.Kc(bb,qj.ZFg)}}wWb(){}}Object(c.a)(Zq,"UnsavedChangesHighlightActor",Iq.a,[]);var Vm=b(831);class ep{constructor(Q){this.ILe=null;this.qia=Q;this.pUe=
!1}get key(){return"UnsavedChangesHighlight"}get Zx(){return"UnsavedChanges"}reset(Q){if(this.qia){Q=Q.node;if(wk.ParagraphReader.Mb(Q)){const sa=this.qia.N6f;if(sa&&sa.contains(Q.id)){this.pUe=!0;this.ILe=Q.id;return}}this.pUe=!1;this.ILe=ae.a.nil}}Z_a(){let Q=null;return this.pUe?(Q=Object.assign(new Vm.a,{FG:this.key,contentObject:this.ILe,description:null}),{returnValue:!0,SM:Q}):{returnValue:!1,SM:Q}}}Object(c.a)(ep,"UnsavedChangesHighlightCpContentDetailsProvider",null,[565,566]);var fp=b(1077);
class vp{constructor(Q,sa,bb,Cb,dc){this.Y3g=null;this.tX=Q;this.wh=sa;this.su=bb;this.Hx=Cb;this.Beh=dc;this.wh.ETa(Object(n.a)(this,this.raa,"onKickedOut"))}get N6f(){return this.Y3g}kal(){if(this.tX){if(1===this.tX.nnc){if(this.tX.Ene()){this.Y3g=this.tX.Lxb;const Q=this.tX.UFc;this.tX.pMi.forEach(Object(n.a)(this,this.tok,"dimSavedGraphNodes"));Q.forEach(Object(n.a)(this,this.lal,"highlightUnsavedGraphNodes"));0<Q.length&&this.Kpk(this.su);return 0}ua.ULS.sendTraceTag(561309320,306,50,"Unsaved Changes Highlighter: Either no unsaved change at all or changes outside canvas body");
return 3}return 5}return 1}Usc(Q,sa){if(Q){var bb=Q.wd(im.App.oa.Ca.nc.Ya);if(bb&&(bb=bb.htmlElement))if(sa){sa=bb.querySelectorAll("span");for(let Cb=0;Cb<sa.length;Cb++){const dc=sa[Cb];Cb||bh.a.Kc(dc,qj.N3i);Cb===sa.length-1&&bh.a.Kc(dc,qj.M3i);bh.a.Kc(dc,qj.ZFg)}bh.a.Kc(bb,qj.$Fg);(Q=this.C2k(Q))&&this.Hx.pcc(Q)}else bh.a.Kc(bb,qj.Rkm)}}C2k(Q){return this.Beh&&(Q=this.Beh.ibe(Q))&&Q&&(Q=Q.wd(im.App.oa.Ca.nc.Ya))?Q:null}kUa(){const Q=this.tX.kUa(2);ua.ULS.sendTraceTag(570828103,306,Q?15:50,"Collect Unsaved Changes Result:{0}",
Q);return Q}lal(Q){this.Usc(Q,!0);return!0}tok(Q){this.Usc(Q,!1);return!0}Kpk(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingIsEnabled",0)})}raa(Q,sa){sa===Sys.EventArgs.Empty?ua.ULS.sendTraceTag(572364513,306,15,"HighlightUnsavedChanges Not Run: Empty Event Args"):sa&&sa.errorCode?(Q=fp.a.lC,Q.lC()&&(G.AFrameworkApplication.Vn("WordUch;WordUchcf"),G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UnsavedChangesHighlightIsEnabled",
!1)&&(ua.ULS.sendTraceTag(572364515,306,50,'HighlightUnsavedChanges: {{"UnsavedClientChanges":"{0}", "UnsavedServerChanges":"{1}"}}',Q.TFc,Q.VFc),Q=this.kal(),ua.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q)))):ua.ULS.sendTraceTag(572364514,306,15,"HighlightUnsavedChanges Not Run: No {0}",sa?"Error Code":"Kickout Event Args")}dispose(){this.wh.agb(Object(n.a)(this,this.raa,"onKickedOut"))}}Object(c.a)(vp,"UnsavedChangesHighlighter",null,[13]);var Ka=b(562),Va=b(300),
ub=b(1076);class Ub extends ub.a{constructor(Q){super();this.qia=Q}$$b(Q){if(!this.qia)return!1;const sa=this.qia.N6f;return sa?sa.contains(Q.Aa.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}Vsh(Q){const sa=Q.leftMargin;return 1440<=sa?-(sa/1440*96):Q.S7a(0,96,this.zoom)}s1j(Q,sa){return Sys.UI.DomElement.getBounds(Q).y-sa.zWa[0].y}X0j(Q){return Sys.UI.DomElement.getBounds(Q).height}uCh(Q,sa,bb,Cb){Cb=Cb?Cb:this.Vsh(sa);sa=this.s1j(Q,sa);Q=this.X0j(Q);bb=Ka.a.createElement(bb,Va.a.div);
bb.className="UnsavedChangesIndicator";bb.style.left=Cb+"px";bb.style.top=sa+"px";bb.style.height=Q+"px";return bb}tRb(Q){const sa=this.Vsh(Q),bb=[];var Cb=Q.uga;const dc=Cb.Hd.ownerDocument;var Oc=Cb.htmlElement;Cb=Oc.querySelectorAll("."+qj.$Fg);if(0===Cb.length&&Sys.UI.DomElement.containsCssClass(Oc,qj.$Fg))Q=this.uCh(Oc,Q,dc,sa),Array.add(bb,Q);else for(Oc=0;Oc<Cb.length;Oc++){let yd=this.uCh(Cb[Oc],Q,dc,sa);Array.add(bb,yd)}return bb}}Object(c.a)(Ub,"UnsavedChangesIndicatorActor",ub.a,[]);class pc{constructor(){this.mH=
this.AB=this.kRa=this.Hx=this.wLd=this.qia=null}get name(){return"WordEditor.UnsavedChangesHighlight"}Nb(){}init(){G.AFrameworkApplication.K.$("WordUnsavedChangesHighlightingPackageIsEnabled")&&(this.Hx=xa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,this.qia=new vp(xa.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),ug.SessionStatusManager.instance,ek.a.Jp(xa.a.instance.Fa("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.Hx,xa.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache")),
G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UnsavedChangesHighlightIsEnabled",!1)&&(this.kRa=xa.a.instance.Fa("Box4.Accessibility.IAccessibilityContextManager"),this.mH=xa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.wLd=new Ub(this.qia),this.Hx.PNa(this.wLd),this.kRa&&this.kRa.execute(Q=>{Q.B7(new ep(this.qia))}),this.AB=new Zq(this.qia),this.mH.mZa(this.AB)))}dispose(){G.AFrameworkApplication.K.$("WordUnsavedChangesHighlightingPackageIsEnabled")&&
(G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UnsavedChangesHighlightIsEnabled",!1)&&(this.Hx&&this.wLd&&this.Hx.EAe(this.wLd),this.mH&&this.AB&&this.mH.DAe(this.AB)),vr.a.kB(this.qia))}static main(){aa.a.instance.jc(new pc)}}Object(c.a)(pc,"WordEditorUnsavedChangesHighlightPackage",null,[2,3,13]);var Wc=b(131),jd=b(317);class Ed{constructor(Q,sa,bb,Cb){const dc=new wordVersionHistory.AppBootSettings;dc.RenderServiceBase="";dc.IsRtl=!1;dc.Logger=new jd.a;dc.UseReactPdf=
Q.JKg;dc.forcePdfDevEnv=Cb.Lu;dc.UserSessionId=G.AFrameworkApplication.userSessionId;dc.publicScriptPath=G.AFrameworkApplication.eM;dc.IsInHighContrastMode=!1;sa&&(dc.IsInHighContrastMode=sa.fnl);dc.IsInHighContrastMode&&(dc.ClientColorSettings=sa.Ssc.T7d+"_"+sa.Ssc.backgroundColor+"_"+sa.Ssc.linkColor);this.vaf=new wordVersionHistory.AppVersionControllerImpl(dc,bb)}onVersionSelected(Q,sa,bb,Cb,dc){void 0!==sa&&null!==sa?""===sa.downloadUrl&&ua.ULS.sendTraceTag(593377155,3005,10,"baseVersionInfo is not null and baseVersionInfo.DownloadUrl is empty string, RevisionID: "+
Q.revisionID):bb||ua.ULS.sendTraceTag(593377154,3005,10,"baseVersionInfo is null or undefined selecting a non-first version, RevisionID: "+Q.revisionID);this.vaf.onVersionSelected(Q,sa,Cb,dc)}getRenderFailureEvent(){return this.vaf.getRenderFailureEvent()}getLoadFinishEvent(){return this.vaf.getLoadFinishEvent()}}Object(c.a)(Ed,"AppVersionControllerImplWrapper",null,[1835]);class Te{create(Q,sa,bb,Cb){return new Ed(Q,sa,bb,Cb)}}Object(c.a)(Te,"AppVersionControllerImplWrapperFactory",null,[1810]);
class Ue{getVersionHistoryControllerInstance(Q){return versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Q)}}Object(c.a)(Ue,"VersionHistoryControllerFactory",null,[1808]);class Ig{static addAppPLTEventToLog(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Q)}catch(sa){}}static setIsPageLoadForFirstTime(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Q)}catch(sa){}}}Object(c.a)(Ig,"VersionHistoryLogConnector",null,[]);var zg=
b(80),sk=b(535);class ff{constructor(){this.appName=0;this.fileExtension=null;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=this.wdEnableShowVersionEvents=null;this.wdEnableDownloadVersion=
!1;this.wdLoadBlankVersionOnOpen=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdEnableAppColorUpdate=null}}Object(c.a)(ff,"AppSettings",null,[]);class kk{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}}Object(c.a)(kk,"ControllerFactoryParameters",null,[]);var zi;(function(Q){Q[Q.none=0]="none";Q[Q.vhUnknown=1]="vhUnknown";Q[Q.vhFailedToLoadVersionList=100]="vhFailedToLoadVersionList";
Q[Q.vhFailedToGetDownloadToken=101]="vhFailedToGetDownloadToken";Q[Q.vhFailedToParseVersionList=102]="vhFailedToParseVersionList";Q[Q.vhFetchFailed=103]="vhFetchFailed";Q[Q.vhVersioningNotEnabled=104]="vhVersioningNotEnabled";Q[Q.vhFileNotFound=105]="vhFileNotFound";Q[Q.vhVersionTooOld=106]="vhVersionTooOld";Q[Q.vhFetchException=107]="vhFetchException";Q[Q.vhServiceUnavailable=108]="vhServiceUnavailable";Q[Q.vhBadGateway=109]="vhBadGateway";Q[Q.vhUnauthorized=110]="vhUnauthorized";Q[Q.vhInternalServerError=
111]="vhInternalServerError";Q[Q.vhEmptyVersionMetadatas=112]="vhEmptyVersionMetadatas";Q[Q.vhFailedHostDownload=113]="vhFailedHostDownload";Q[Q.vhFailedToAddDownloadToVersionStore=114]="vhFailedToAddDownloadToVersionStore";Q[Q.vhFailedToCacheParts=115]="vhFailedToCacheParts";Q[Q.vhFailedToDownloadVersionMetadata=116]="vhFailedToDownloadVersionMetadata";Q[Q.vhFailedToDownloadParts=117]="vhFailedToDownloadParts";Q[Q.vhInvalidDocID=118]="vhInvalidDocID";Q[Q.vhMissingDocID=119]="vhMissingDocID";Q[Q.vhNullDocID=
120]="vhNullDocID";Q[Q.vhNullHashedDocID=121]="vhNullHashedDocID";Q[Q.vhNullGetDownloadAccessTokenRequest=122]="vhNullGetDownloadAccessTokenRequest";Q[Q.vhFailedToDownloadVersionFromHost=123]="vhFailedToDownloadVersionFromHost";Q[Q.vhNullResponseFromFetch=124]="vhNullResponseFromFetch";Q[Q.vhGetTipVersionException=125]="vhGetTipVersionException";Q[Q.vhGetVersionsException=126]="vhGetVersionsException";Q[Q.vhGetDownloadTokenException=127]="vhGetDownloadTokenException";Q[Q.vhFetchRetryException=128]=
"vhFetchRetryException";Q[Q.vhNullResponseFromRequestVersionHistory=129]="vhNullResponseFromRequestVersionHistory";Q[Q.vhNullResponseFromRequestDownloadToken=130]="vhNullResponseFromRequestDownloadToken";Q[Q.vhXhrJsonParseFailed=131]="vhXhrJsonParseFailed";Q[Q.vhXhrException=132]="vhXhrException";Q[Q.vhNullResponseFromXhr=133]="vhNullResponseFromXhr";Q[Q.vhFileGone=134]="vhFileGone";Q[Q.vhNullRevisionIDs=135]="vhNullRevisionIDs";Q[Q.vhRequestDeleteVersionsException=136]="vhRequestDeleteVersionsException";
Q[Q.vhNullResponseFromRequestDeleteVersions=137]="vhNullResponseFromRequestDeleteVersions";Q[Q.vhVersionInfoFromTipVersionException=138]="vhVersionInfoFromTipVersionException"})(zi||(zi={}));Object(c.b)("VersionHistoryFullAppErrorCode",zi);var qe=b(769);class Ud{constructor(){this.revisionId=null;this.tpg=0}}Object(c.a)(Ud,"ForceSaveData",null,[]);class af extends Pe.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}pi(){return 106}static construct(Q,sa,bb){const Cb=
new af;Cb.FileId=Q;Cb.VersionToken=sa;Cb.ExclusiveLockId=um.a(bb);return Cb}}Object(c.a)(af,"RestoreVersionRequest",Pe.a,[]);class Uf{constructor(Q,sa,bb,Cb,dc,Oc,yd,md,Af,wg,Zg,Wh,vh,sl,qh){this.ea=Q;this.ql=sa;this.jb=bb;this.Oj=Cb;this.Qd=dc;this.Anj=Oc;this.Ae=yd;this.v2g=md;this.kHa=Af;this.Cc=wg;this.rGj=Zg;this.ra=Wh;this.agj=vh;this.zU=sl;this.pTa=qh;this.DZc=this.NMc=this.iXc=this.LTd=this.Y6e=this.n$e=this.Oic=this.hEb=this.LDa=this.$m=null;this.JSd=0;this.oWd=null;this.C5g="";this.cDa=
null;this.saf=0;this.Amj={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",3:"InvalidPermission",4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.$5a={};this.Hk={};this.NTd=!1;this.Fs=!!G.AFrameworkApplication.pa&&G.AFrameworkApplication.pa.mb.U$;this.kTa=this.ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryVetoes",!1)}Web(Q,sa=!0,bb=null){zg.d(Q,sa,void 0,void 0,void 0,void 0,bb)}Kab(){return(new Date).getTime()}h0d(){null==
this.NMc&&(this.NMc=this.Kab())}LQb(Q){const sa=new qd.a;sa.durationMs=this.Kab()-Q;sa.extendedProperties=new Map;return sa}oTf(){null==this.DZc&&(this.DZc=this.Kab());Ra.Health.instance.recordKpiUsageForAlertableKpi("WordVersionHistorySelectVersion","vhwordonline",null)}Ljg(){const Q=[],sa=Object.assign(new qd.a,{extendedProperties:new Map});if(null!=this.LTd&&null!=this.Y6e){var bb=this.LTd-this.Y6e;Array.add(Q,Object.assign(new pb.a,{name:"showPaneDuration",string:bb.toString()}));sa.extendedProperties.set("showPaneDuration",
bb.toString())}null!=this.NMc&&null!=this.iXc&&(bb=this.NMc-this.iXc,Array.add(Q,Object.assign(new pb.a,{name:"firstActionDuration",string:bb.toString()})),sa.extendedProperties.set("firstActionDuration",bb.toString()));(bb=0===this.saf)?Ra.Health.instance.recordKpiSuccess("WordVersionHistory",sa):Ra.Health.instance.recordKpiFailure("WordVersionHistory",zi[this.saf],!1,!1,sa);this.Web($b.a.Vwh,bb,Q)}pb(){this.ea.na(cb.a.gxe,Ec.a.frame,Object(n.a)(this,this.Kyg,"showVersionHistoryDialogAction"));this.ea.na(cb.a.mvd,
Ec.a.frame,Object(n.a)(this,this.Fgm,"reportVersionHistorySaveACopySuccessAction"));this.ea.na(cb.a.Ese,Ec.a.frame,Object(n.a)(this,this.Egm,"reportVersionHistorySaveACopyFailureAction"))}Kyg(Q,sa,bb){if(1===bb)return ug.SessionStatusManager.instance.Kj?8:32;2===bb&&(this.oWd=sd.a.create().toString(),ua.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.oWd),G.AFrameworkApplication.Lf("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings"),
G.AFrameworkApplication.Vn("WoVer882;WoVer882cf"),Object(qe.a)(),this.Web($b.a.hxi,!0),this.$5a.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.Hk.VersionHistoryLaunchSessionId=this.oWd,this.Oic=[],this.$m||(this.$m=this.rGj.getVersionHistoryControllerInstance(Object.assign(new kk,{ulsLogger:new jd.a,serviceBase:this.ra.appSettings.VersionHistoryWebServiceBase,docId:G.AFrameworkApplication.yk,appSettings:Object.assign(new ff,{appName:110,wdEnableDownloadTokens:this.kHa.$$i,wdEnableSaveACopy:!0,
wdEnableRestore:this.kHa.Y$i,userSessionId:G.AFrameworkApplication.userSessionId,wacCluster:this.ra.Oa("WacCluster"),uiLocale:G.AFrameworkApplication.uiCulture?G.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:G.AFrameworkApplication.K.Oa("VHSDisabledChangeGates"),wdEnableDownloadVersion:this.kHa.GEd,wdEnableSaveACopyOverFlowMenu:this.kHa.Z$i,isRtl:G.AFrameworkApplication.isRtl,wdEnableAppColorUpdate:this.ra.$("AppColorUpdateIsEnabled"),
useXhr:Ga.a.Lu}),perfTelemetryInfos:this.Oic}))),this.$m&&this.$m.setDisableSaveACopy(this.lxm()||this.jxm()),this.jCm());return 32}Fgm(Q,sa,bb){if(1===bb)return ug.SessionStatusManager.instance.QN?32:8;2===bb&&(Q=this.LQb(this.JSd),Ra.Health.instance.recordKpiSuccess("WordVersionHistorySaveACopy",Q),this.Ljg());return 32}Egm(Q,sa,bb,Cb,dc){var Oc,yd,md;if(1===bb)return ug.SessionStatusManager.instance.QN?32:8;2===bb&&(Q="Unknown",sa="",dc&&(Q=null!==(Oc=dc.FailureReason)&&void 0!==Oc?Oc:Q,dc=null!==
(yd=dc.ExtraInfo)&&void 0!==yd?yd:"",sa=null!==(md=this.Amj[dc])&&void 0!==md?md:dc),yd=this.LQb(this.JSd),""!==sa&&yd.extendedProperties.set("ExtraInfo",sa),Ra.Health.instance.recordKpiFailure("WordVersionHistorySaveACopy",Q,!1,!1,yd),this.kTa&&this.pTa.GXa(Q,3),ua.ULS.sendTraceTag(592197004,3005,10,"Save failed with result: "+Q));return 32}jCm(){this.Y6e=this.Kab();this.NMc=this.iXc=this.LTd=null;Ra.Health.instance.recordKpiUsageForAlertableKpi("WordVersionHistory","vhwordonline",null);if(document.getElementById("VersionHistoryOverlay"))this.JA();
else{this.R$l();this.S$l();this.E$l();this.J$l();this.P$l();this.I$l();this.kHa.aaj&&this.H$l();this.O$l();this.Q$l();const Q=document.createElement("div");let sa=Q.id="VersionHistoryOverlay",bb=null;this.ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryCtrlCTelemetry",!1)&&this.K$l(Q);if(this.Fs&&(bb=G.AFrameworkApplication.pa.fk?G.AFrameworkApplication.pa.fk.getRegion(G.AFrameworkApplication.pa.fk.WQ.J("Header")):null)){const Cb=document.getElementById("AppHeaderPanel");sa=Cb&&
"none"===Cb.style.display?String.format("{0} {1} {2}",sa,"RegionComposer","NoAppHeader"):String.format("{0} {1}",sa,"RegionComposer")}bb||(bb=document.getElementById("WACInnerFrame"));Q.className=sa;bb.appendChild(Q);this.n$e=this.$m.createVersionHistoryDialog(Q);this.Uua()}document.getElementById("VersionHistoryOverlay").style.display="block";this.$m.getVersions("")}lxm(){if(G.AFrameworkApplication.tma)return ua.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),
!0;if(this.ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotUseVersionHistorySaveACopyImprovements",!1))if(G.AFrameworkApplication.jXa){if(!this.ra.$("SaveACopyBrsIsEnabled"))return ua.ULS.sendTraceTag(570770273,3005,50,"Version History is disabling Save a Copy because SaveACopyBrsIsEnabled is false."),!0}else{if(!this.ra.$("SaveToAnotherFolderBrsIsEnabled"))return ua.ULS.sendTraceTag(570770274,3005,50,"Version History is disabling Save a Copy because SaveToAnotherFolderBrsIsEnabled is false."),
!0;if(!this.ra.$("SupportsGetMoreInfoForPersonalStorage"))return ua.ULS.sendTraceTag(570770275,3005,50,"Version History is disabling Save a Copy because SupportsGetMoreInfoForPersonalStorage is false."),!0}else{const Q=32==this.ea.processAction(cb.a.RBc,1);let sa=32==this.ea.processAction(cb.a.SBc,1);if(!Q&&!sa)return ua.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0}return!1}jxm(){if(this.ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotUseVersionHistorySaveACopyImprovements",
!1)){if(this.kHa.GEd&&G.AFrameworkApplication.H1i)return ua.ULS.sendTraceTag(570770304,3005,50,"Version History is disabling download version because it is trimmed."),!0}else if(this.kHa.GEd){if(G.AFrameworkApplication.tma)return ua.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0;if(32!=this.ea.processAction(cb.a.downloadACopy,1))return ua.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),
!0}return!1}J$l(){this.$m.getFullAppErrorEvent().addListener(Q=>{let sa=Q?zi[Q]:"";this.Hk[Uf.d0j]=sa;this.saf=Q;this.kTa&&this.pTa.GXa(sa,0);ua.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",sa,this.oWd)})}R$l(){this.$m.getVersionsReadyEvent().addListener(Q=>{this.LTd=this.Kab();this.jhm(Q.containerDiv);Q.versions&&(this.C5g=Uf.ZZh(Q.versions[Q.versions.length-1]));this.JA();try{if(this.LDa&&""!==this.LDa.downloadUrl&&this.cDa){this.RKg();const sa=
!this.NTd;this.oTf();this.cDa.onVersionSelected(this.LDa,this.hEb,this.zdi(this.LDa),this.$5a,sa);this.Oic=[];this.$5a={}}}catch(sa){ua.ULS.sendTraceTag(592196996,3005,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",sa)}})}S$l(){this.$m.getVersionSelectedEvent().addListener(Q=>{this.LDa=Q.currentVersion;this.hEb=Q.baseVersion;if(this.cDa)try{this.RKg();if(""!==(this.hEb?this.hEb.DownloadUrl:"")||Q.noBaseToCompareTo)this.oTf(),this.cDa.onVersionSelected(Q.currentVersion,
Q.baseVersion,Q.noBaseToCompareTo,this.$5a,!this.NTd);this.Oic=[];this.$5a={}}catch(sa){ua.ULS.sendTraceTag(592196997,3005,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",sa)}})}H$l(){this.$m.getDownloadTokenReadyEvent().addListener(Q=>{try{ua.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.p7k(Q)}catch(sa){ua.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",
sa)}})}p7k(Q){Q&&Q.versionSelected?(this.LDa=Q.versionSelected.currentVersion,this.hEb=Q.versionSelected.baseVersion,this.oTf(),this.cDa.onVersionSelected(this.LDa,this.hEb,!Q.versionSelected.noBaseToCompareTo,this.$5a,!this.NTd)):ua.ULS.sendTraceTag(591697922,3005,10,"VersionHistoryPaneActor: HandleGetDownloadTokenReadyEvent_Optimized: downloadTokenReadyObject.VersionSelected was null")}E$l(){this.$m.getCloseSelectedEvent().addListener(()=>{this.S7j();this.xwl()})}Hel(Q){const sa={};sa.FileDownloadUrl=
Q;sa.SaveEntryPoint="VersionHistory";return sa}LZk(Q){let sa="Dialog Failure - ActionResponse "+Q.toString();2===Q?sa="DialogNotHandled":8===Q&&(sa="DialogFailed");return sa}P$l(){this.$m.getSaveACopySelectedEvent().addListener(Q=>{this.JSd=this.Kab();Ra.Health.instance.recordKpiUsage("WordVersionHistorySaveACopy",0,"vhwordonline",null);this.h0d();ua.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.mri();var sa=this.Hel(Q);Q=32==this.ea.processAction(cb.a.RBc,
1);this.ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotUseVersionHistorySaveACopyImprovements",!1)&&(Q=this.kHa.k9i);sa=this.ea.Db(Q?cb.a.RBc:cb.a.SBc,2,sa);const bb=this.LQb(this.JSd),Cb=32===sa;if(!Cb){const dc=this.LZk(sa);Ra.Health.instance.recordKpiFailure("WordVersionHistorySaveACopy",dc,!1,!1,bb);this.kTa&&this.pTa.GXa(dc,2);ua.ULS.sendTraceTag(578033103,3005,10,Q?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+sa.toString())}this.Web($b.a.zwh,Cb)})}I$l(){this.$m.getDownloadVersionSelectedEvent().addListener(Q=>
{if(this.kHa.GEd){var sa=this.Kab();Ra.Health.instance.recordKpiUsage("WordVersionHistoryDownloadVersion",0,"vhwordonline",null);this.h0d();Q=new ij.QueryStringBuilder(Q);Q.te("fn",G.AFrameworkApplication.fileName);Q=this.ea.Db(cb.a.downloadACopy,2,{["FileDownloadUrl"]:Q.toString()});sa=this.LQb(sa);const bb=32===Q;bb?Ra.Health.instance.recordKpiSuccess("WordVersionHistoryDownloadVersion",sa):(this.kTa&&this.pTa.GXa("",4),Ra.Health.instance.recordKpiFailure("WordVersionHistoryDownloadVersion",Q.toString(),
!1,!1,sa),ua.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result : "+Q.toString()));this.Web($b.a.ywh,bb)}})}Rhe(){this.mri();this.Ljg();this.Ae&&this.Ae.refreshDocument(null)}d8k(Q,sa){2===Q.statusCode&&Q.yg&&0<Q.yg.length&&Q.yg[0]?(Q=Q.yg[0],sa=this.LQb(sa),this.v2g&&Q.ShouldAvoidLockRelease&&this.v2g.$ga(!1,"VersionHistory"),191===Q.StatusCode?(Ra.Health.instance.recordKpiFailure("WordVersionHistoryRestore","multipleClientsInCoauthSession",!0,!1,sa),this.kTa&&this.pTa.GXa("MultipleClientsInCoauthSession",
5),this.Web($b.a.anc,!1),ua.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.$m.setCoauthRestoreError(),Uf.ywl()):Q.StatusCode?(sa.extendedProperties.set("status",sk.a[Q.StatusCode]),Ra.Health.instance.recordKpiFailure("WordVersionHistoryRestore","restoreVersionResponseFailed",!1,!1,sa),this.kTa&&this.pTa.GXa("ServerOperationFailed",5),this.Web($b.a.anc,!1),ua.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+sk.a[Q.StatusCode]),
this.$m.setRestoreFailedAtServer(Object(n.a)(this,this.Rhe,"launchSurveyRefreshDocument"))):(Ra.Health.instance.recordKpiSuccess("WordVersionHistoryRestore",sa),this.Web($b.a.anc,!0),ua.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.Rhe())):(Ra.Health.instance.recordKpiFailure("WordVersionHistoryRestore","serverOperationFailed",!1,!1,null),this.kTa&&this.pTa.GXa("ServerOperationFailed",5),ua.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+Mj.a[Q.statusCode]),
this.$m.setRestoreFailedAtServer(Object(n.a)(this,this.Rhe,"launchSurveyRefreshDocument")))}XCk(Q){ua.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var sa=Q.revisionId;const bb=ae.a.create();sa=af.construct(G.AFrameworkApplication.rootQuerySignature,sa,bb);const Cb=Object.assign(new Qd.a,{kk:sa,status:1,wv:"RestoreVersion"});sa=this.zU.Y5(0,()=>{this.d8k(Cb,Q.tpg)});sa.IB(Cb);sa.xJ()}forceSaveFailed(Q,sa){const bb=this.LQb(Q.tpg);bb.extendedProperties.set("status",sk.a[sa]);Ra.Health.instance.recordKpiFailure("WordVersionHistoryRestore",
"forceSaveFailed",!1,!1,bb);this.kTa&&this.pTa.GXa("ForceSaveFailed",5);this.Web($b.a.anc,!1);ua.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+sk.a[sa]+"for version "+Q);this.$m.setRestoreFailedAtServer(Object(n.a)(this,this.Rhe,"launchSurveyRefreshDocument"))}O$l(){this.$m.getRestoreVersionSelectedEvent().addListener(Q=>{this.h0d();const sa=this.Kab();Ra.Health.instance.recordKpiUsage("WordVersionHistoryRestore",0,"vhwordonline",null);let bb=null;Q&&(bb=Q.split("-")[0]);bb&&""!==
bb?(Q=Object.assign(new Ud,{revisionId:bb,tpg:sa}),ua.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",bb),this.$m.setRestoreInProgress(),this.Anj(19,!1,Object(n.a)(this,this.XCk,"forceSaveSucceeded"),Object(n.a)(this,this.forceSaveFailed,"forceSaveFailed"),Q,null,null)):(Ra.Health.instance.recordKpiFailure("WordVersionHistoryRestore","invalidRevisionId",!1,!1,null),this.kTa&&this.pTa.GXa("InvalidRevisionId",5),this.Web($b.a.anc,!1),ua.ULS.shipAssertTag(592197012,
3005,!1))})}T$l(){this.cDa.getRenderFailureEvent().addListener(Q=>{this.kTa&&this.pTa.GXa(Q,1);Ra.Health.instance.recordKpiFailure("WordVersionHistorySelectVersion",Q,!1,!1,null);try{this.Hk.ViewerErrorCode="ViewerErrorCode"in this.Hk?this.Hk.ViewerErrorCode+("; "+Q):Q,this.$m.setViewerError(!0),"Failed to fetch"===Q&&this.ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.LogNetworkConnectivityOnVersionSelectFailure",!1)&&ua.ULS.sendTraceTag(544792730,3005,10,"disconnected network:{0}, expired token:{1}, emergency mode:{2}, kicked out:{3}, lost:{4}",
!ug.SessionStatusManager.instance.QN,ug.SessionStatusManager.instance.yuc,ug.SessionStatusManager.instance.Kj,ug.SessionStatusManager.instance.fm,Mf.App.lostSession),ua.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",Q)}catch(sa){ua.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",sa)}})}L$l(){this.cDa.getLoadFinishEvent().addListener(()=>{null==this.iXc&&(this.iXc=this.Kab());let Q=null;null!=this.DZc&&(Q=this.LQb(this.DZc),Q.extendedProperties.set("UseReactPdf",
this.kHa.JKg.toString()),this.DZc=null);Ra.Health.instance.recordKpiSuccess("WordVersionHistorySelectVersion",Q);this.$m.setVersionLoadComplete()})}Q$l(){this.$m.getShowVersionChangesToggledEvent().addListener(Q=>{this.NTd=!Q;this.JA();try{this.LDa&&""!==this.LDa.DownloadUrl&&this.cDa&&(this.RKg(),this.cDa.onVersionSelected(this.LDa,this.hEb,this.zdi(this.LDa),this.$5a,Q),this.Oic=[],this.$5a={})}catch(sa){ua.ULS.sendTraceTag(592197016,3005,10,"VersionHistoryPaneActor: Exception in ShowVersionChangesToggledEvent callback: {0}",
sa)}})}JA(){this.Oj.yu(Nl.AppFrame.B2);this.Oj.yu(De.AFrame.Qn);this.Oj.yu(Nl.AppFrame.cna);this.jb.aM("VersionHistoryViewer",!1);this.Oj.JA("VersionHistoryViewer");this.jb.aM("VersionHistoryHeader",!0);this.Oj.JA("VersionHistoryHeader");this.jb.aM("VersionHistoryOverlay",!0);this.Oj.JA("VersionHistoryOverlay")}yu(){this.Oj.JA(Nl.AppFrame.B2);this.Oj.JA(De.AFrame.Qn);this.Oj.JA(Nl.AppFrame.cna);this.Oj.yu("VersionHistoryOverlay");this.jb.TQ("VersionHistoryOverlay");this.Oj.yu("VersionHistoryHeader");
this.jb.TQ("VersionHistoryHeader");this.Oj.yu("VersionHistoryViewer");this.jb.TQ("VersionHistoryViewer")}S7j(){this.Ljg();document.getElementById("VersionHistoryOverlay").style.display="none";this.Hk.browser=Ga.a.nJ;Ga.a.W1&&(this.Hk.electronBrowserVersion=Ga.a.nsk);this.yu();ua.ULS.sendTraceTag(592197017,3005,50,Ia.c(this.Hk))}RKg(){for(let Q of this.Oic){const sa=Q.TelemetryEventKey?Q.TelemetryEventKey:Q.telemetryEventKey?Q.telemetryEventKey:"",bb=Q.TelemetryEventData?Q.TelemetryEventData:Q.telemetryEventData?
Q.telemetryEventData:"";""!==sa&&""!==bb&&(this.$5a[sa]=bb)}}jhm(Q){try{this.cDa?Ig.setIsPageLoadForFirstTime(!1):(Ig.setIsPageLoadForFirstTime(!0),this.cDa=this.agj.create(this.kHa,this.ql,Q,this.Cc),this.T$l(),this.L$l())}catch(sa){ua.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",sa)}}Jrf(Q){const sa=this.jb.ed(Q);sa.parent=De.AFrame.Ho;this.Oj.dya(Q);sa.GQ=!0;return sa}Uua(){this.Jrf("VersionHistoryOverlay").K0((Q,
sa)=>{try{"VersionHistoryOverlay"===sa.name&&this.n$e.then(bb=>{bb.enterFocusTrapZone();return null})}catch(bb){ua.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",bb)}});this.Qd.V6a("VersionHistoryOverlay",document.getElementById("VersionHistoryOverlay"));this.Jrf("VersionHistoryHeader").K0((Q,sa)=>{try{"VersionHistoryHeader"===sa.name&&this.n$e.then(bb=>{bb.enterHeaderFocusTrapZone();return null})}catch(bb){ua.ULS.sendTraceTag(592197020,3005,10,
"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",bb)}});this.Qd.V6a("VersionHistoryHeader",document.getElementById("vhHeader"));this.Jrf("VersionHistoryViewer").K0((Q,sa)=>{try{"VersionHistoryViewer"===sa.name&&yj.FocusManager.jR(document.getElementById("vhViewer"))}catch(bb){ua.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",bb)}});this.Qd.V6a("VersionHistoryViewer",document.getElementById("vhViewer"))}xwl(){const Q=xa.a.instance.sa("Common.ISystemInitiatedFeedback");
Q?(Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),Q.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):ua.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}mri(){const Q=xa.a.instance.sa("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):ua.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static ZZh(Q){return Q.RevisionID?Q.RevisionID:Q.revisionID?Q.revisionID:
""}static ywl(){const Q=xa.a.instance.sa("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):ua.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}K$l(Q){Q&&Q.addEventListener("keydown",sa=>{sa.ctrlKey&&"KeyC"===sa.code&&(this.h0d(),Ra.Health.instance.recordKpiUsage("WordVersionHistoryCopyText",0,"vhwordonline",null));sa.ctrlKey&&"KeyF"===sa.code&&Ra.Health.instance.recordKpiUsage("WordVersionHistorySearchText",
0,"vhwordonline",null)})}zdi(Q){return Uf.ZZh(Q)===this.C5g}}Uf.d0j="ErrorCode";Object(c.a)(Uf,"VersionHistoryPaneActor",null,[1809]);class Hg{constructor(){this.JKg=this.Z$i=this.k9i=this.GEd=this.Y$i=this.aaj=this.$$i=!1}}Object(c.a)(Hg,"WordVersionHistorySettings",null,[]);class Wg{GXa(Q,sa){Ra.Health.instance.recordQosError(this.g4k(Q,sa),["VersionHistoryExperienceDegraded"],!1,!1,!0,!1,null)}g4k(Q,sa){if(0==sa)return"VersionHistoryLaunchFailed";if(1==sa)return Q.includes("Failed to fetch")?"SelectVersionFailedBecauseFetchFailed":
Q.includes("Unexpected server response (500) while retrieving PDF")?"SelectVersionFailedServerResponseInternalError":Q.includes("Unexpected server response (400) while retrieving PDF")?"SelectVersionFailedServerResponseBadRequest":Q.includes("Unexpected server response (413) while retrieving PDF")?"SelectVersionFailedServerResponseRequestEntityTooLarge":"SelectVersionFailed";if(2==sa)return"SaveVersionFailed"+Q;if(3==sa)return Q=this.VPk(Q),""!=Q?"SaveVersionFailedServerResponse"+Q:"SaveVersionFailed";
if(5==sa)return"RestoreVersionFailed"+Q;if(4==sa)return"DownloadVersionFailed"+Q}VPk(Q){switch(Q){case "400":return"BadRequest";case "401":return"Unauthorized";case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}Object(c.a)(Wg,"WordVersionHistoryVetoHelper",null,[1807]);class Ah{constructor(){this.ra=this.Z=null}get name(){return"WordEditor.VersionHistory"}init(){G.AFrameworkApplication.rgi()?(ua.ULS.sendTraceTag(39966528,
3005,50,"WordVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),Wc.a.get_instance().Lk(7,()=>{const Q=this.Z.resolve("Common.IDynamicScriptLoaderProvider").qA;(G.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("wordVersionHistory"):Q.loadScript("wordVersionHistory")).catch(sa=>ua.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",sa)).then(()=>this.bUl()).catch(sa=>ua.ULS.sendTraceTag(39966530,
3005,10,"Failed to initialize the versionHistory feature: {0}",sa))})):ua.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}bUl(){this.Z.resolve("IVersionHistoryPaneActor").pb();return null}dispose(){}Nb(Q){this.Z=Q;this.ra=this.Z.resolve("Common.IAppSettingsManager");if(this.ra.$("AppSupportsVersionHistory")){var sa=this.Z.resolve("Common.IBrowserUtils");Q=G.AFrameworkApplication.jXa;var bb=
!G.AFrameworkApplication.jXa&&this.ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryDownloadVersionIsEnabled",!1),Cb=new Hg;Cb.$$i=this.ra.$("WordWdDownloadTokenIsEnabled");Cb.aaj=this.ra.$("WordWdDownloadTokenRegisterIsEnabled");Cb.Y$i=this.ra.$("WordVersionHistoryEnableRestore");Cb.GEd=Q||bb;Cb.k9i=Q;Cb.Z$i=this.ra.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");Cb.JKg=!0;this.Z.ia("IVersionHistoryPaneActor",()=>new Uf(G.AFrameworkApplication.qa,G.AFrameworkApplication.pa.FKa,
yj.FocusManager.instance(),ph.a.instance,hm.a.instance,qk.a.DJ,Mf.App.oa,Mf.App.jA,Cb,sa,new Ue,G.AFrameworkApplication.K,new Te,new Vi.a,new Wg)).fa()}}static main(){let Q=!1;G.AFrameworkApplication.K&&G.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&(Q=!0);aa.a.instance.jc(new Ah,0,Q)}}Object(c.a)(Ah,"WordVersionHistoryPackage",null,[2,3]);var Qi=b(125);class Sf{constructor(Q,sa,bb){this.ea=Q;this.tl=sa;this.ra=bb}pb(){this.ra.$("ZoomPopupDialogIsEnabled")&&(this.ea.na(cb.a.KDc,Ec.a.frame,
Object(n.a)(this.tl,this.tl.KDc,"showZoomDialog")),this.ea.La(cb.a.Q4l,Ec.a.frame,Object(n.a)(this.tl,this.tl.uvi,"onQueryZoomText"),96),this.ea.na(cb.a.NGc,Ec.a.frame,Object(n.a)(this.tl,this.tl.uaj,"zoomDialogTabFocusHandler")),this.ea.na(cb.a.MGc,Ec.a.frame,Object(n.a)(this.tl,this.tl.uaj,"zoomDialogTabFocusHandler")));this.ra.$("ZoomSliderIsEnabled")&&(this.ea.na(cb.a.P4l,Ec.a.frame,Object(n.a)(this.tl,this.tl.kRl,"onQueryZoomPercentage")),this.ea.na(cb.a.QYm,Ec.a.frame,Object(n.a)(this.tl,this.tl.mUl,
"onZoomToPercentage")))}}Object(c.a)(Sf,"CommonZoomActor",null,[1301]);class rc extends Sf{constructor(Q,sa,bb){super(Q,sa,bb);this.Xxa=sa}pb(){super.pb();this.ra.$("ZoomPopupDialogIsEnabled")&&(this.ea.na($b.a.fLg,Ec.a.frame,Qi.ActionManager.Ne),this.ea.na($b.a.PGc,Ec.a.frame,Object(n.a)(this.Xxa,this.Xxa.PYm,"zoomTo100")));this.ea.na(cb.a.wbb,Ec.a.frame,Object(n.a)(this.Xxa,this.Xxa.wbb,"increaseZoom"));this.ea.na(cb.a.s9a,Ec.a.frame,Object(n.a)(this.Xxa,this.Xxa.s9a,"decreaseZoom"));this.ea.na($b.a.uwd,
Ec.a.frame,Object(n.a)(this.Xxa,this.Xxa.zvm,"setZoomLevelFromRibbon"));this.ea.La($b.a.PYa,Ec.a.frame,Object(n.a)(this.Xxa,this.Xxa.uvi,"onQueryZoomText"),96);this.ea.La($b.a.Ysd,ng.a.application,Object(n.a)(this.Xxa,this.Xxa.jRl,"onQueryZoomLevelLabelText"),96);this.ea.na(ve.a.tDh,Ec.a.frame,Qi.ActionManager.Ne);this.ea.na(ve.a.sDh,Ec.a.frame,Qi.ActionManager.Ne);this.ea.na(ve.a.wDh,Ec.a.frame,Qi.ActionManager.Ne);this.ea.na(ve.a.uDh,Ec.a.frame,Qi.ActionManager.Ne);this.ea.na($b.a.zha,Ec.a.frame,
Qi.ActionManager.Ne)}}Object(c.a)(rc,"WordEditorZoomActor",Sf,[]);var $k=b(260);class Im{constructor(Q,sa){this.zoom=Q;this.qQj=sa}}Object(c.a)(Im,"SetCustomZoomArgs",null,[]);var Jq=b(911);class Wm{constructor(Q,sa){this.Akk=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.Bkk=[Wm.bwf,Wm.m4d,"200","150","100","75","50"];this.kra=3;this.delta=.1;this.Y1f=0;this.ph=new m.a;this.Ad=this.aZe=null;this.K=Q;this.Bd=sa;this.uF=1}get Kh(){return this.uF}get p6c(){return Math.round(100*
this.Kh)}get vIl(){return Math.floor(this.p6c/10)/10+this.delta}get uIl(){return Math.ceil(this.p6c/10)/10-this.delta}get ea(){return G.AFrameworkApplication.qa}get iGl(){this.aZe||(G.AFrameworkApplication.Vn("WoZoo372;WoZoo372cf"),G.AFrameworkApplication.K&&(this.aZe=G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ZoomDialogBoxInReactIsEnabled",!1)));return this.aZe}TOj(Q){this.ph.addHandler("ZoomChanged",Q)}Nem(Q){this.ph.removeHandler("ZoomChanged",Q)}Iaa(Q){this.TOj(Q)}T8b(Q){this.Nem(Q)}glg(){}smg(){}flg(){}rmg(){}OGc(Q){this.vaj(Q,
this.Kh)}vaj(Q,sa){null!==Q&&xm.a.Rtm(Q,sa)}Rve(Q,sa=!0){let bb=Q*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(bb=new Im(Q,sa));this.vPi(bb)}yvm(Q,sa=!1){this.zha(Q,3|(sa?0:4))}kUl(Q,sa,bb){if(1===Q)return 32;Q=bb/100;Q<this.Knd?Q=this.Knd:Q>this.wnd&&(Q=this.wnd);this.zha(Q);sa&&(sa.gs=Math.floor(100*Q));return 32}uvi(Q,sa,bb,Cb,dc){if(1===bb)return 32;Q=$a.a.mza(this.p6c,6,G.AFrameworkApplication.numberFormat);dc.Value=Q;dc.LabelText=Q;return 32}mUl(Q,sa,bb,Cb,dc){return 1===bb?
32:this.kUl(bb,Cb,dc.value)}kRl(Q,sa,bb,Cb,dc){dc.MinValue=100*this.Knd;dc.MaxValue=100*this.wnd;dc.value=this.p6c;return 32}i2h(){return this.Akk}j2h(){return this.Bkk}ALk(){let Q=Math.floor(100*this.Kh).toString();1===this.kra?Q=Wm.bwf:2===this.kra&&(Q=Wm.m4d);return Q}wbb(Q,sa,bb){if(1===bb)return 32;this.Mmd(this.Bd?this.Bd.LV:0,"IncreaseZoom");this.kra=0;this.zha(this.vIl);return 32}s9a(Q,sa,bb){if(1===bb)return 32;this.Mmd(this.Bd?this.Bd.LV:0,"DecreaseZoom");this.kra=0;this.zha(this.uIl);return 32}zvm(Q,
sa,bb,Cb,dc){if(1===bb)return 32;this.Mmd(this.Bd?this.Bd.LV:0,"SetZoomLevelFromRibbon");Q=dc.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new kc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),Zj.a.instance.Eb(Q),32;Q=parseInt(Q)/100;if(isNaN(Q))return 2;this.kra=0;this.zha(Q);return 32}Mmd(Q,sa){ua.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",Q,sa,G.AFrameworkApplication.pa.mb.Eo)}KDc(Q,sa,bb){if(1===bb)return 32;ua.ULS.sendTraceTag(7176728,
353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.ALk();this.Ad=new Jq.a(this.i2h(),this.j2h(),Object(n.a)(this,this.P8k,"handleZoomDialogResult"),yj.FocusManager.instance(),this.iGl);this.Ad.KDc(CommonUIStrings.l_ZoomDialogTitle,Q)}Tkl(Q){return Q.toLowerCase()===Wm.bwf.toLowerCase()}Ukl(Q){return Q.toLowerCase()===Wm.m4d.toLowerCase()}P8k(Q){if(this.Tkl(Q)){this.kra=1;var sa=32}else if(this.Ukl(Q))this.kra=2,sa=this.zoomToPageWidth(0,null,
2,null,null);else if(sa=Number.parseInvariant(Q)){this.kra=0;let bb=sa;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(bb=new Im(sa,!0));sa=this.vPi(bb)}else sa=8;32===sa?ua.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):ua.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}p6l(){this.ph.raiseEvent("ZoomChanged",null)}kDi(){}Rig(){}uaj(Q){if(!this.Ad)return 2;var sa=this.Ad.Ji.Zj().Ci.FS;if(sa===this.Ad.jw&&Q===cb.a.NGc||sa===this.Ad.sF&&
Q===cb.a.MGc)this.Ad.G0||this.Ad.pNi(),this.Ad.Ji.Zj().Ci.hw(this.Ad.G0);else if(sa.id.startsWith(this.Ad.fZa)||sa.className.startsWith(this.Ad.Bqe))sa=null,Q===cb.a.NGc?sa=this.Ad.sF:Q===cb.a.MGc&&(sa=this.Ad.jw),this.Ad.Ji.Zj().Ci.hw(sa),Sys.UI.DomElement.removeCssClass(this.Ad.G0.parentNode,this.Ad.CAc);else if(Q===cb.a.NGc)this.Ad.Ji.Zj().UXa();else if(Q===cb.a.MGc)this.Ad.Ji.Zj().TXa();else return 2;return 32}}Wm.bwf="FullPage";Wm.m4d="PageWidth";Object(c.a)(Wm,"ZoomManager",null,[1163]);var mo=
b(321),Kq=b(933);class Xm extends Wm{constructor(Q,sa,bb,Cb,dc,Oc,yd){super(Q,sa);this.fYm=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.gYm=[Wm.m4d,"200","150","125","100","75","50"];this.$$e=this.VJi=!1;this.VNg="AutoFitForAdaptiveLayout";this.knj="FitPageWidthFailure";this.SFj="UpdateZoomFailure";this.bHj="wwf";this.rH=this.pbf=null;this.xV=bb;this.ai=Cb;this.jb=dc;this.Qd=Oc;this.rNc=yd;this.N0g=Q.$("KeepViewAfterZoomIsEnabled");this.cHj=Q.$("ZoomShortCutIsEnabled");
this.aHj=Q.$("ZoomCtrlScrollIsEnabled");this.dGj=Q.$("DoNotAutoScrollAfterPinchIsEnabled");this.Gqj=(this.qTe=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");this.blj=Q.$("DoNotProcessUpdateZoomActionIsEnabled");this.dHj=Q.$("ZoomSliderIsEnabled");this.wz()}get appName(){return"WordEditor"}get wnd(){return 4}get Knd(){return.1}get xjk(){return wacBoot.CtrlWheelMetrics}qOj(Q){this.ph.addHandler("PinchStart",Q)}Hem(Q){this.ph.removeHandler("PinchStart",Q)}pOj(Q){this.ph.addHandler("PinchEnd",
Q)}Gem(Q){this.ph.removeHandler("PinchEnd",Q)}get zz(){return this.rH||(this.rH=xa.a.instance.sa("WordEditor.IStatusBarUser"))}M6i(Q){return Q&4?!1:(Q={SelectZoomOption:"ComboBoxModel"},Mf.App.oa&&Mf.App.oa.YG(Q),this.MUm(),!0)}zha(Q,sa=0){let bb=!0;this.blj||G.AFrameworkApplication.qa.processAction($b.a.zha,2);if(this.Kh===Q)return this.$$e||(this.$$e=this.M6i(sa)),bb;Q>this.wnd?Q=this.wnd:Q<this.Knd&&(Q=this.Knd);1===Q||sa&1||G.AFrameworkApplication.qa.processAction($b.a.fLg,2);try{let Cb=null;
Mf.App.oa&&Object(id.a)(Kq.PageView,Mf.App.oa.Ca.nc)&&(Cb=Mf.App.oa.Ca.nc);let dc=-1,Oc=-1,yd=-1;const md=!(sa&2);this.N0g&&md&&(dc=fk.SelectionEditor.f4k(Vl.a.instance.Ia.Ra,Cb),Oc=Cb.oI.scrollLeft,yd=Cb.oI.scrollTop);const Af=this.Kh;this.uF=Q;this.p6l();this.$$e=this.M6i(sa);md&&this.LTm(Cb,dc,Oc,yd,Af)}catch(Cb){bb=!1,ua.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",Cb)}return bb}LTm(Q,sa,bb,Cb,dc){Q&&Q.isActive?this.N0g?0<=sa&&100>=sa?Q.zda.JBa(100-sa,!0,!0):Q.zda.avl(bb,Cb,dc,this.Kh):
Q.zda.JBa():ua.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}PYm(Q,sa,bb){2===bb&&(this.Mmd(this.Bd?this.Bd.LV:0,"ZoomTo100"),this.kra=0,this.zha(1));return 32}vPi(Q){this.kra=0;let sa,bb=!0;if(this.dGj){if(!Object(id.a)(Im,Q))return ua.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;sa=Q.zoom/100;bb=Q.qQj}else sa=Number.parseInvariant(String.format("{0}",Q))/100;ua.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",
sa);Q=0;bb||(Q=2);this.zha(sa,Q);return 32}zoomToPageWidth(){ua.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");this.kra=2;this.Buk();return this.zCf()}jRl(Q,sa,bb,Cb,dc){if(1===bb)return 32;Q=$a.a.mza(this.p6c,6,G.AFrameworkApplication.numberFormat);dc[$k.a.labelText]=Q;return 32}i2h(){return this.fYm}j2h(){return this.gYm}Buk(){this.VJi||(Mf.App.oa?(Mf.App.oa.E9(Object(n.a)(this,this.mkg,"refitToPageWidth")),this.VJi=!0):ua.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}zCf(){var Q=
Mf.App.oa?Mf.App.oa.Ca.nc:null;if(Q&&Mf.App.oa.yv){var sa=null;(Q=this.xLk(Q))&&(sa=this.xV.$H(Q));sa||(sa=this.xV.Q9d());if(null!==sa)return sa=bo.a.instance.Lt(sa),sa=le.a.Qg(sa,0),Q=this.rNc(),sa+=Q&&Q.Awg()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,this.zha((Mf.App.oa.yv.offsetWidth-2*mo.a.yEd)/sa),32;ua.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else ua.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");
return 8}xLk(Q){return Q&&Q.ib&&Q.ib.Ia.Ra&&Q.ib.Ia.Ra.wa&&Q.ib.Ia.Ra.wa.node?Q.ib.Ia.Ra.wa.node:null}mkg(){2===this.kra&&this.zCf()}MUm(){this.zz&&(this.dHj?(this.zz.$L(jo.a.waj),this.zz.$L(jo.a.xaj)):this.zz.$L(jo.a.yaj))}NFm(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var sa=Q.ctrlWheelOccurred;if("boolean"!==typeof sa)ua.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{ua.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",sa);try{Q.stop()}catch(bb){ua.ULS.sendTraceTag(594346946,
326,15,"Exception: {0}",bb)}}}else ua.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}wz(){this.NFm(this.xjk);if(this.ai){var Q=document.getElementById(Nl.AppFrame.S7c);Q&&this.ai.Ma(D.a.Oxb,Q,Object(n.a)(this,this.wjk,"ctrlScrollZoomHandler"))}this.jb&&(Q=this.jb.ed(Nl.AppFrame.EE),this.cHj&&(Q.bindAction(kf.KeyInputManager.Cb(Ui.a.yBe,kf.KeyInputManager.Qh),cb.a.wbb),Q.bindAction(kf.KeyInputManager.Cb(Ui.a.bJg,kf.KeyInputManager.Qh),cb.a.wbb),Q.bindAction(kf.KeyInputManager.Cb(Ui.a.zBe,
kf.KeyInputManager.Qh),cb.a.s9a),Q.bindAction(kf.KeyInputManager.Cb(Ui.a.BBe,kf.KeyInputManager.Qh),cb.a.s9a),Q.bindAction(kf.KeyInputManager.Cb(Ui.a.hFd,kf.KeyInputManager.Qh),$b.a.PGc)));this.Qd&&(this.pbf=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.Qd.Ma(D.a.click,this.pbf,Object(n.a)(this,this.lUl,"onZoomLabelClickEvent"));this.Gqj&&(Mf.App.oa.fk.registerLayoutBreakpointChanged("canvas",sa=>{this.Ahf(sa)}),Mf.App.oa.fk.registerBoundingWindowRectsChanged("canvas",()=>{this.Ahf(Mf.App.oa.fk.getLayoutBreakpoint())}))}Ahf(Q){let sa=
!0,bb="";if(3!==this.kra)return sa;Ra.Health.instance.recordKpiUsage(this.VNg,0,this.bHj,null);switch(Q){case "Small":8===this.zCf()&&(bb=this.knj,sa=!1);break;default:1===this.Kh||this.zha(1)||(bb=this.SFj,sa=!1)}sa||Ra.Health.instance.recordKpiFailure(this.VNg,bb,!0,!0,null);return sa}wjk(Q){if(Q.ctrlKey&&(G.AFrameworkApplication.qa.processAction(ve.a.uDh,2),this.aHj)){Q=Q.GXm;if(!Q)return!1;this.zha(this.Kh-Q);this.Mmd(6,"CtrlScroll");return!0}return!1}lUl(){ua.ULS.sendTraceTag(42341578,353,50,
"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0}glg(Q){this.qOj(Q)}smg(Q){this.Hem(Q)}flg(Q){this.pOj(Q)}rmg(Q){this.Gem(Q)}kDi(){this.ph.raiseEvent("PinchStart",null)}Rig(){this.ph.raiseEvent("PinchEnd",null)}}Object(c.a)(Xm,"WordEditorZoomManager",Wm,[1780,1163]);class Wn{constructor(){this.Z=null}get name(){return"WordEditor.Zoom"}init(){if(G.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const Q=this.Z.resolve("WordEditor.Zoom.WordEditorZoomActor"),sa=this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager");
Q.pb();Sys.UI.DomElement.overrideGetBounds=!0;G.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&G.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&sa&&Wc.a.get_instance().Lk(4,()=>{sa.Ahf(Mf.App.oa.fk.getLayoutBreakpoint())||ua.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}Nb(Q){this.Z=Q;G.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.Z.ia("WordEditor.Zoom.WordEditorZoomManager",()=>new Xm(G.AFrameworkApplication.K,
G.AFrameworkApplication.qa,Qn.WordSectionNavigator.instance,Bg.a.instance,yj.FocusManager.instance(),hm.a.instance,()=>Q.sa("Box4.IFloatingObjectUpdater"))).fa().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.Z.ia("WordEditor.Zoom.WordEditorZoomActor",()=>new rc(G.AFrameworkApplication.qa,this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager"),G.AFrameworkApplication.K)).fa())}static main(){aa.a.instance.jc(new Wn)}}Object(c.a)(Wn,"ZoomPackage",null,[2,3]);var Ym=window.FormatPictureTaskPaneData=
{name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",
ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},
{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",
attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",
Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",
For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",
Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",
HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},Mo=window.InteractivePerfTaskPaneData={name:"CommandUI",
attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InteractivePerfTaskPane",Title:"Interactive Perf TaskPane",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"TypingSpeedMeterGroup"}},{name:"Group",attrs:{Id:"CpuMeterGroup"}},{name:"Group",attrs:{Id:"RenderGroup"}}]}]}]};class Cl extends cf.a{constructor(Q){super(!1,!1,!0);this.xFd=Q}start(){const Q={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.xFd.lRf}};
this.qh("",Object(n.a)(this,this.Fim,"resultHandler"),Q)}Fim(Q,sa){1===Q&&(this.xFd.lRf=sa.tooltipPersistenceEnabled)}}Object(c.a)(Cl,"AccessibilitySettingsDialog",cf.a,[]);class Vh{constructor(Q,sa){this.ea=Q;this.xFd=sa}pb(){this.ea.na(cb.a.Hzm,Ec.a.frame,Object(n.a)(this,this.Izm,"showAccessibilitySettingsDialogHandler"))}Izm(){(new Cl(this.xFd)).start();return 32}}Object(c.a)(Vh,"AccessibilitySettingsDialogActor",null,[1813]);const bk=Q=>{const sa=new t.a;G.AFrameworkApplication.he.Hi(wp(Q),1,
null,null,!0,2,bb=>{200===bb.data.ff?sa.We("true"===bb.data.od.toLowerCase()):sa.We(!1)},()=>{sa.We(!1)},null,void 0,void 0,void 0,void 0,"7");return sa.task},wp=Q=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",G.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,G.AFrameworkApplication.yk);class Qr{constructor(){this.tgc=null}get lRf(){return!!this.tgc}set lRf(Q){Q!==this.tgc&&(this.tgc=Q,vf.apiExists("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),
this.Hei()&&G.AFrameworkApplication.he.Hi(wp("saveHoverableRibbonTooltipIsEnabled"),2,Q.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}eyl(){const Q=new t.a;if(this.tgc)Q.We(this.tgc);else if(this.Hei()){const sa=bk("getHoverableRibbonTooltipIsEnabled");sa.continueWith(()=>{this.tgc=sa.result;vf.apiExists("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(sa.result);Q.We(sa.result)},8)}else Q.We(!1)}Hei(){const Q=G.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),
sa=G.AFrameworkApplication.K.$("IsAnonymousUser");return Q&&!sa}}Object(c.a)(Qr,"AccessibilitySettingsInfo",null,[1815]);class lk{constructor(){this.Z=null}get name(){return"Common.App.AccessibilitySettings"}Nb(Q){this.Z=Q;lk.hfe()&&(this.Z.register(Vh,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").zd(()=>new Vh(G.AFrameworkApplication.qa,this.Z.resolve("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).fa(),
this.Z.register(Qr,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").zd(()=>new Qr).fa())}init(){lk.hfe()&&(this.Z.resolve("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").pb(),this.Z.resolve("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").eyl())}dispose(){}static main(){aa.a.instance.jc(new lk)}static hfe(){lk.bUe||(lk.bUe=G.AFrameworkApplication.K?G.AFrameworkApplication.K.$("AccessibilitySettingsDialogIsEnabled")&&
G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AccessibilitySettingsDialogIsEnabled",!1):!1);return lk.bUe}}lk.bUe=null;Object(c.a)(lk,"AccessibilitySettingsPackage",null,[2,3]);class Zm{constructor(){this.events=[];this.xog=!1}static Y0f(Q){return Q.ctrlKey&&"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!Zm.evl[Q.key]}static oZj(Q){return{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),["key"]:Zm.Y0f(Q)?Q.key:" "===Q.key?"Space":"CharacterKey",
["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static Zdi(Q){return window.performance&&window.performance.now&&Q.timeStamp<performance.now()}static YKh(Q){return!!Q&&Zm.Zdi(Q)&&Zm.Y0f(Q)}static ZKh(Q){return!!Q&&Zm.Zdi(Q)&&!Zm.Y0f(Q)}keyPressedEventHandlerStart(Q){Zm.ZKh(Q)&&this.MXi(Q)}keyPressedEventHandlerEnd(Q){Zm.ZKh(Q)&&this.cYi(Q)}keyDownEventHandlerStart(Q){Zm.YKh(Q)&&this.MXi(Q)}keyDownEventHandlerEnd(Q){Zm.YKh(Q)&&this.cYi(Q)}MXi(Q){this.events.push({["metadata"]:Zm.oZj(Q),
["timeStamp"]:Q.timeStamp,["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:performance.now()-Q.timeStamp,["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0});this.Yam()}cYi(Q){if(0!==this.events.length)for(let sa=this.events.length-1;0<=sa;--sa){const bb=this.events[sa];if(bb.timeStamp===Q.timeStamp){bb.timeToHandlerFinishMs=performance.now()-Q.timeStamp;bb.eventDurationMs=bb.timeToHandlerFinishMs-bb.timeToHandlerStartMs;break}}}Yam(){if(!this.xog){const Q=document.createEvent("CustomEvent");
Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);requestAnimationFrame(()=>{this.xog=!1;const sa=performance.now();this.events.forEach(Cb=>{Cb.timeToRequestAnimationFrameMs=sa-Cb.timeStamp});var bb=document.createEvent("CustomEvent");bb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(bb);this.events=[];bb=document.createEvent("CustomEvent");bb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(bb)});this.xog=!0}}}Zm.evl=
{SYm:!0,TYm:!0,UYm:!0,VYm:!0,WYm:!0,Delete:!0,End:!0,hZm:!0,kZm:!0,nZm:!0,yZm:!0,zZm:!0,Tab:!0};class gp{constructor(){this.Fse=this.Tdb=this.Hhe=this.Mwc=null;this.Fvc=!1;this.fog=null;this.O$c=[];this.oHg=()=>{gp.ypl()&&null==this.Tdb?(this.Hhe=null,this.Tdb=requestAnimationFrame(this.Nni)):null!=this.Tdb&&(cancelAnimationFrame(this.Tdb),this.Tdb=null)};this.Nni=Q=>{if(null!=this.Hhe){const sa=Q-this.Hhe;if(null==this.Mwc||this.Mwc<sa)this.Mwc=sa;for(let bb=0;bb<gp.ntd.length;++bb)if(sa<gp.ntd[bb]){++this.O$c[bb];
break}}this.Hhe=Q;this.Tdb=requestAnimationFrame(this.Nni)};this.XIi=()=>{if(null!=this.Mwc){var Q={};for(var sa=0;sa<gp.ntd.length;++sa)Q[gp.ntd[sa]]=this.O$c[sa],this.O$c[sa]=0;sa=performance.now();Q={["intervalStart"]:this.fog,["intervalEnd"]:sa,["maxFrameLengthMs"]:this.Mwc,["frameData"]:Q};var bb=document.createEvent("CustomEvent");bb.initCustomEvent("reportframetiming",!1,!1,Q);dispatchEvent(bb);this.Mwc=null;this.fog=sa}}}static Upl(){return!!window.performance&&!!window.performance.now}start(Q){!this.Fvc&&
gp.Upl()&&(this.Ovm(),this.Fse=setInterval(this.XIi,1E3*Q),this.fog=performance.now(),this.oHg(),document.addEventListener("visibilitychange",this.oHg),this.Fvc=!0)}stop(){this.Fvc&&(document.removeEventListener("visibilitychange",this.oHg),null!=this.Fse&&(clearInterval(this.Fse),this.Fse=null),null!=this.Tdb&&(cancelAnimationFrame(this.Tdb),this.Tdb=null),this.XIi(),this.Fvc=!1)}get Tjd(){return this.Fvc}Ovm(){this.O$c=[];for(let Q=0;Q<gp.ntd.length;++Q)this.O$c.push(0)}}gp.ypl=()=>"visible"===
document.visibilityState;gp.ntd=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");
Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");
Type.registerNamespace("WordEditor.VersionHistory");aa.a.instance.jc(new Ah);gm.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");f;Type.registerNamespace("CACPU");Ha.main();Type.registerNamespace("CAEventTimingMeter");X.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");va.main();Type.registerNamespace("Common.App.GestureInput");fb.main();Type.registerNamespace("Common.App.GestureManager");tb.main();Type.registerNamespace("Common.ModernFontPicker");
Type.registerNamespace("Common.App.OfflineLogger");aa.a.instance.jc(new ld);Type.registerNamespace("Common.App.O365Shell");nc.main();Type.registerNamespace("Common.App.SensitiveLogging");pj.main();Type.registerNamespace("Common.App.Rename");aa.a.instance.jc(new Ag,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");aa.a.instance.jc(new Yc);Type.registerNamespace("Common.App.SaveAsToHost");ue.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Ti.main();Type.registerNamespace("Common.App.SaveACopy");
Si.main();Type.registerNamespace("Common.App.SaveToSharePoint");Sh.main();Type.registerNamespace("Common.App.SharedFilePicker");Di.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");lc.main();jl;sp.main();aa.a.instance.jc(new Ol);Jp.main();Ym;Fm.main();aa.a.instance.jc(new ll);Sj.main();Pc.a.prototype.toString=Vd.a.prototype.toString;
Kd.a.h3h=new zl.a;aa.a.instance.jc(new nl);Wn.main();aa.a.instance.jc(new xi);aa.a.instance.jc(new gn);aa.a.instance.jc(new hh);Ej.main();Lc.main();yh.main();pc.main();Type.registerNamespace("NLRT");aa.a.instance.jc(new Gh);Type.registerNamespace("Common.App.AccessibilitySettings");lk.main();Mo;uo.main();aa.a.instance.jc(new Um);window.EventTiming={EventTimingMeter:Zm,FrameTimingMeter:gp}},269:function(z,H,b){b.d(H,"a",function(){return f});const f={RIa:null,Jh:1}},911:function(z,H,b){z=b(0);var f=
b(40),c=b(136),n=b(6),m=b(50),x=b(22),y=b(16),v=b(14);class t{static get cLg(){return t.dLg}}t.dLg="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(z.a)(t,"ZoomDialogHtml",null,[]);b.d(H,"a",function(){return A});class A extends c.a{constructor(D,U,F,E,P=!1){super(!1,!1,P);this.nHa=this.mHa=this.Z=
this.C0a=null;this.YKg="ZoomDialogBoxGroup";this.g5=D;this.L6a=U;this.WZc=F;this.jb=E;this.lf=this.hjf();this.Jc=1;this.mf="ZoomDialog"}get h8b(){return"ListRadioBox"}get fZa(){return"radiobox"}get Bqe(){return"WACZoomDialogRadioRow"}get CAc(){return"WACZoomDialogRadioRow-highlight"}get Ji(){return this.jb}get G0(){return this.C0a}KDc(D,U){if(this.kS)this.Lyg(D,U);else{const F={};for(let E=0;E<this.g5.length;E++)F[this.fZa+E]=this.L6a[E]===U?!0:!1;this.qh(D,Object(f.a)(this,this.$Kg,"zoomDialogHandler"),
F);this.nua();this.Utd()}}Lyg(D,U){var F=Array(this.g5.length);let E="";for(let P=0;P<this.g5.length;P++){const G=P.toString();F[P]={["key"]:G,["text"]:this.g5[P]};U===this.L6a[P]&&(E=G)}U={};U.dialogChoiceGroupProps={["id"]:this.YKg,["defaultSelectedKey"]:E,["options"]:F};F={["id"]:"OptionsDialog",["bodyControls"]:U};this.qh(D,Object(f.a)(this,this.eLg,"zoomDialogReactHandler"),F)}pNi(){this.C0a=document.getElementsByName(this.h8b)[0];this.w$a(this.G0)}yda(){this.Z||(this.Z=document.getElementById("WACDialogText"));
this.Z&&(this.mHa||(this.mHa=Object(f.a)(this,this.ZKg,"zoomDialogClickHandler"),this.uo.Ma(n.a.click,this.Z,this.mHa)),this.nHa||(this.nHa=Object(f.a)(this,this.aLg,"zoomDialogKeyDownHandler"),this.nd.Ma(n.a.jh,this.Z,this.nHa)));super.yda();this.Ac&&this.nd.Ma(n.a.kh,this.Ac,Object(f.a)(this,this.pN,"dialogDefaultEnterKeyHandler"))}nua(){this.Ji.Zj().scope.aq(m.FocusManager.instance().LM);this.Ji.Zj().scope.aq(m.FocusManager.instance().MM);this.Ji.Zj().scope.bindAction(m.FocusManager.instance().LM,
v.a.NGc);this.Ji.Zj().scope.bindAction(m.FocusManager.instance().MM,v.a.MGc)}Utd(){const D=document.getElementsByName(this.h8b);for(let U=0;U<D.length;U++){const F=D[U];x.a.addHandler(F,n.a.focus,Object(f.a)(this,this.BAc,"radioButtonFocusHandler"));F.checked&&(this.C0a=F)}}$Kg(D,U){if(1===D)for(D=0;D<this.g5.length;D++)if(U[this.fZa+D]){this.WZc(this.L6a[D]);break}}BAc(D){this.w$a(D.target)}ZKg(D){D=D.oe;if(!D||!D.parentNode||"label"!==D.tagName.toLowerCase()&&!D.className.startsWith(this.Bqe))return!1;
D=this.Zbd(D);D=document.getElementById(this.fZa+D);this.w$a(D);return!0}eLg(D,U){1===D&&(D=Number.parseInvariant(U.selectedOption.toString()),this.WZc(this.L6a[D]))}aLg(D){D=D.$a.keyCode;if(D!==Sys.UI.Key.down&&D!==Sys.UI.Key.right&&D!==Sys.UI.Key.up&&D!==Sys.UI.Key.left)return!1;let U=this.Zbd(this.G0);const F=this.g5.length-1;if(D===Sys.UI.Key.down||D===Sys.UI.Key.right)U=U<F?U+1:0;else if(D===Sys.UI.Key.up||D===Sys.UI.Key.left)U=0<U?U-1:F;D=document.getElementById(this.fZa+U);this.w$a(D);return!0}pN(D){return D.eventName===
n.a.kh&&D.$a.keyCode===Sys.UI.Key.enter?(super.pN(D),!0):!1}w$a(D){D&&(D.checked=!0,this.Ji.Bf&&this.Ji.Bf.name===this.LH||this.Ji.qf(this.LH),this.Ji.Zj().Ci.hw(D),D.focus(),this.G0&&Sys.UI.DomElement.removeCssClass(this.G0.parentNode,this.CAc),Sys.UI.DomElement.addCssClass(D.parentNode,this.CAc),this.C0a=D)}Zbd(D){return Number.parseInvariant(y.a.substr(D.id,D.id.length-1,1))}oO(){super.oO();const D=document.getElementById(this.Sg("WACDialogPanel"));D.style.minWidth=String.format("{0}px",200);D.style.width=
String.format("{0}px",200)}hjf(){let D="";for(let U=0;U<this.g5.length;U++)D+=c.a.Qv(A.bLg,U.toString(),this.g5[U],this.h8b);return D}dispose(){this.Z&&(this.uo&&this.mHa&&this.uo.Ib(n.a.click,this.Z,this.mHa),this.nd&&this.nHa&&this.nd.Ib(n.a.jh,this.Z,this.nHa));this.uo&&this.Ac&&this.nd.Ib(n.a.kh,this.Ac,Object(f.a)(this,this.pN,"dialogDefaultEnterKeyHandler"));super.dispose()}}A.bLg=t.cLg;Object(z.a)(A,"ZoomDialog",c.a,[388])}}]);

//# sourceMappingURL=https://wordwebclientbuilds.blob.core.windows.net/ooui/04cb24867ec47a2e5a95fc7fedf79aa260ead425/WordEditorDS.box4.dll2.js.map