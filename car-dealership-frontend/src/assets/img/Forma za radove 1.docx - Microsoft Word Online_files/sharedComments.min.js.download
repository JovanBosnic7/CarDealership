var sharedComments=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[84],{1092:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},1093:function(e,t,n){var a=n(1379);e.exports=function(e,t,n){if(a(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,a){return e.call(t,n,a)};case 3:return function(n,a,o){return e.call(t,n,a,o)}}return function(){return e.apply(t,arguments)}}},1094:function(e,t,n){var a=n(1095),o=n(1097),r=n(1380);e.exports=function(e){return function(t,n,i){var s,c=a(t),d=o(c.length),l=r(i,d);if(e&&n!=n){for(;d>l;)if((s=c[l++])!=s)return!0}else for(;d>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}}},1095:function(e,t,n){var a=n(876),o=n(877);e.exports=function(e){return a(o(e))}},1096:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},1097:function(e,t,n){var a=n(1098),o=Math.min;e.exports=function(e){return e>0?o(a(e),9007199254740991):0}},1098:function(e,t){var n=Math.ceil,a=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?a:n)(e)}},1099:function(e,t,n){var a=n(875)("wks"),o=n(874),r=n(566).Symbol,i="function"==typeof r;(e.exports=function(e){return a[e]||(a[e]=i&&r[e]||(i?r:o)("Symbol."+e))}).store=a},1100:function(e,t,n){var a=n(1093),o=n(876),r=n(1101),i=n(1097),s=n(1383);e.exports=function(e,t){var n=1==e,c=2==e,d=3==e,l=4==e,m=6==e,u=5==e||m,p=t||s;return function(t,s,f){for(var C,h,v=r(t),b=o(v),g=a(s,f,3),y=i(b.length),T=0,I=n?p(t,y):c?p(t,0):void 0;y>T;T++)if((u||T in b)&&(h=g(C=b[T],T,v),e))if(n)I[T]=h;else if(h)switch(e){case 3:return!0;case 5:return C;case 6:return T;case 2:I.push(C)}else if(l)return!1;return m?-1:d||l?l:I}}},1101:function(e,t,n){var a=n(877);e.exports=function(e){return Object(a(e))}},1105:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"Group",transform:"translate(-1.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},a.createElement("path",{d:"M7.4375,24.8349609 C7.875,24.8349609 8.29654745,24.8919265 8.70214844,25.0058594 C9.10774942,25.1197922 9.48827947,25.2815745 9.84375,25.4912109 C10.1992205,25.7008474 10.522785,25.9514959 10.8144531,26.2431641 C11.1061213,26.5348322 11.3567698,26.8583967 11.5664062,27.2138672 C11.7760427,27.5693377 11.937825,27.9498678 12.0517578,28.3554688 C12.1656907,28.7610697 12.2226562,29.1826172 12.2226562,29.6201172 C12.2226562,30.2444693 12.1030285,30.8471651 11.8637695,31.4282227 C11.6245105,32.0092802 11.2838564,32.5208311 10.8417969,32.9628906 L5.12011719,38.6777344 L4.50488281,38.0625 L10.2197266,32.3408203 C10.5797544,31.9807925 10.8577464,31.5649438 11.0537109,31.0932617 C11.2496755,30.6215797 11.3476562,30.1305364 11.3476562,29.6201172 C11.3476562,29.0869114 11.2439789,28.5833357 11.0366211,28.109375 C10.8292633,27.6354143 10.5478533,27.2207049 10.1923828,26.8652344 C9.83691229,26.5097638 9.42220289,26.2283539 8.94824219,26.0209961 C8.47428148,25.8136383 7.97070579,25.7099609 7.4375,25.7099609 C6.94531004,25.7099609 6.51123235,25.7840162 6.13525391,25.9321289 C5.75927546,26.0802416 5.41178545,26.2762032 5.09277344,26.5200195 C4.77376143,26.7638359 4.46728663,27.0406886 4.17333984,27.3505859 C3.87939306,27.6604833 3.57063964,27.9794905 3.24707031,28.3076172 L6.125,28.3076172 L6.125,29.1826172 L1.75,29.1826172 L1.75,24.8076172 L2.625,24.8076172 L2.625,27.6855469 C2.87565229,27.4303373 3.11604703,27.1831067 3.34619141,26.9438477 C3.57633579,26.7045886 3.80647671,26.479005 4.03662109,26.2670898 C4.26676547,26.0551747 4.50146365,25.8614918 4.74072266,25.6860352 C4.97998167,25.5105785 5.23518745,25.3601894 5.50634766,25.2348633 C5.77750787,25.1095371 6.07145024,25.0115563 6.38818359,24.940918 C6.70491695,24.8702796 7.05468559,24.8349609 7.4375,24.8349609 Z",id:"Reopen"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1368:function(e,t,n){n(1369),e.exports=n(391).Array.includes},1369:function(e,t,n){"use strict";var a=n(565),o=n(1094)(!0);a(a.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(878)("includes")},1370:function(e,t,n){var a=n(1371),o=n(1372),r=n(1374),i=Object.defineProperty;t.f=n(668)?Object.defineProperty:function(e,t,n){if(a(e),t=r(t,!0),a(n),o)try{return i(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},1371:function(e,t,n){var a=n(667);e.exports=function(e){if(!a(e))throw TypeError(e+" is not an object!");return e}},1372:function(e,t,n){e.exports=!n(668)&&!n(669)((function(){return 7!=Object.defineProperty(n(1373)("div"),"a",{get:function(){return 7}}).a}))},1373:function(e,t,n){var a=n(667),o=n(566).document,r=a(o)&&a(o.createElement);e.exports=function(e){return r?o.createElement(e):{}}},1374:function(e,t,n){var a=n(667);e.exports=function(e,t){if(!a(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!a(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!a(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!a(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},1375:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},1376:function(e,t,n){var a=n(566),o=n(873),r=n(1092),i=n(874)("src"),s=n(1377),c=(""+s).split("toString");n(391).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var d="function"==typeof n;d&&(r(n,"name")||o(n,"name",t)),e[t]!==n&&(d&&(r(n,i)||o(n,i,e[t]?""+e[t]:c.join(String(t)))),e===a?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[i]||s.call(this)}))},1377:function(e,t,n){e.exports=n(875)("native-function-to-string",Function.toString)},1378:function(e,t){e.exports=!1},1379:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},1380:function(e,t,n){var a=n(1098),o=Math.max,r=Math.min;e.exports=function(e,t){return(e=a(e))<0?o(e+t,0):r(e,t)}},1381:function(e,t,n){n(1382),e.exports=n(391).Array.find},1382:function(e,t,n){"use strict";var a=n(565),o=n(1100)(5),r=!0;"find"in[]&&Array(1).find((function(){r=!1})),a(a.P+a.F*r,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(878)("find")},1383:function(e,t,n){var a=n(1384);e.exports=function(e,t){return new(a(e))(t)}},1384:function(e,t,n){var a=n(667),o=n(1385),r=n(1099)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),a(t)&&null===(t=t[r])&&(t=void 0)),void 0===t?Array:t}},1385:function(e,t,n){var a=n(1096);e.exports=Array.isArray||function(e){return"Array"==a(e)}},1386:function(e,t,n){n(1387),e.exports=n(391).String.trimRight},1387:function(e,t,n){"use strict";n(1388)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},1388:function(e,t,n){var a=n(565),o=n(877),r=n(669),i=n(1389),s="["+i+"]",c=RegExp("^"+s+s+"*"),d=RegExp(s+s+"*$"),l=function(e,t,n){var o={},s=r((function(){return!!i[e]()||"​"!="​"[e]()})),c=o[e]=s?t(m):i[e];n&&(o[n]=c),a(a.P+a.F*s,"String",o)},m=l.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=l},1389:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},1396:function(e,t,n){n(1397),e.exports=n(391).Array.findIndex},1397:function(e,t,n){"use strict";var a=n(565),o=n(1100)(6),r="findIndex",i=!0;r in[]&&Array(1)[r]((function(){i=!1})),a(a.P+a.F*i,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(878)(r)},1398:function(e,t,n){n(1399),e.exports=n(391).Object.assign},1399:function(e,t,n){var a=n(565);a(a.S+a.F,"Object",{assign:n(1400)})},1400:function(e,t,n){"use strict";var a=n(668),o=n(1401),r=n(1405),i=n(1406),s=n(1101),c=n(876),d=Object.assign;e.exports=!d||n(669)((function(){var e={},t={},n=Symbol(),a="abcdefghijklmnopqrst";return e[n]=7,a.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||Object.keys(d({},t)).join("")!=a}))?function(e,t){for(var n=s(e),d=arguments.length,l=1,m=r.f,u=i.f;d>l;)for(var p,f=c(arguments[l++]),C=m?o(f).concat(m(f)):o(f),h=C.length,v=0;h>v;)p=C[v++],a&&!u.call(f,p)||(n[p]=f[p]);return n}:d},1401:function(e,t,n){var a=n(1402),o=n(1404);e.exports=Object.keys||function(e){return a(e,o)}},1402:function(e,t,n){var a=n(1092),o=n(1095),r=n(1094)(!1),i=n(1403)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),c=0,d=[];for(n in s)n!=i&&a(s,n)&&d.push(n);for(;t.length>c;)a(s,n=t[c++])&&(~r(d,n)||d.push(n));return d}},1403:function(e,t,n){var a=n(875)("keys"),o=n(874);e.exports=function(e){return a[e]||(a[e]=o(e))}},1404:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},1405:function(e,t){t.f=Object.getOwnPropertySymbols},1406:function(e,t){t.f={}.propertyIsEnumerable},1407:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("path",{fill:"currentColor",d:"M 192 768 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1408:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:0}),a.createElement("path",{className:"OfficeIconColors_m22",fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:1})])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1409:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("path",{fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850"}))}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1410:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),a.createElement("path",{type:"path",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}o.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1411:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("path",{fill:"currentColor",d:"M 1920 128 v 1280 h -256 v 512 l -512 -512 h -1024 v -512 h 128 v 384 h 949 l 331 331 v -331 h 256 v -1024 h -1024 v -128 m 128 384 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1412:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("path",{fill:"currentColor",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 m 1024 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -640 h 128 v 512 h 256 v 331 l 331 -331 h 949 v -1024 h -1024 v -128 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1413:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),a.createElement("path",{type:"path",fill:"currentColor",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}o.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1414:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("path",{fill:"currentColor",d:"M0,7.93,1.32,4,0,0,11.9,4ZM2,3.59H8.41L1.18,1.18ZM1.18,6.75,8.41,4.34H2Z"}))}o.defaultProps={viewBox:"-0.25 0.5 11.9 7.93",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1415:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("defs",{key:0},a.createElement("style",null,".cls-1{fill:currentColor;}")),a.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},a.createElement("path",{className:"cls-1",d:"M9.75,2.25H9v8.63a1,1,0,0,1-.09.43,1.1,1.1,0,0,1-.6.6,1,1,0,0,1-.43.09h-6a1,1,0,0,1-.44-.09,1.1,1.1,0,0,1-.6-.6,1,1,0,0,1-.09-.43V2.25H0V1.5H3V.75A.68.68,0,0,1,3.06.46.78.78,0,0,1,3.22.22.78.78,0,0,1,3.46.06.68.68,0,0,1,3.75,0H6a.68.68,0,0,1,.29.06.78.78,0,0,1,.24.16.78.78,0,0,1,.16.24.68.68,0,0,1,.06.29V1.5h3Zm-1.5,0H1.5v8.63a.38.38,0,0,0,.11.26.39.39,0,0,0,.27.11h6a.38.38,0,0,0,.37-.37Zm-4.5,7.5H3v-6h.75Zm0-8.25H6V.75H3.75Zm1.5,8.25H4.5v-6h.75Zm1.5,0H6v-6h.75Z"})))])}o.defaultProps={viewBox:"0 0 9.75 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1416:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("defs",{key:0},a.createElement("style",null,".cls-1{fill:currentColor;}")),a.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},a.createElement("path",{className:"cls-1",d:"M12,2a1.93,1.93,0,0,1-.15.75,1.87,1.87,0,0,1-.42.65L3.71,11.07,0,12,.93,8.29,8.64.57A1.87,1.87,0,0,1,9.29.15,1.93,1.93,0,0,1,10,0a1.79,1.79,0,0,1,.76.16,1.79,1.79,0,0,1,.62.42,1.79,1.79,0,0,1,.42.62A1.79,1.79,0,0,1,12,2ZM1,11,3,10.49A1.84,1.84,0,0,0,2.77,10a2.29,2.29,0,0,0-.32-.43A2.29,2.29,0,0,0,2,9.23,1.84,1.84,0,0,0,1.51,9Zm.88-2.6a2.64,2.64,0,0,1,1.72,1.72L10,3.75,8.25,2ZM10.5,3.22l.28-.28A2,2,0,0,0,11,2.67a1.34,1.34,0,0,0,.17-.31A1.14,1.14,0,0,0,11.25,2a1,1,0,0,0-.1-.47A1.2,1.2,0,0,0,10.5.85,1,1,0,0,0,10,.75a1.14,1.14,0,0,0-.39.06A1.34,1.34,0,0,0,9.33,1a2,2,0,0,0-.27.24l-.28.28Z"})))])}o.defaultProps={viewBox:"0 0 12 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1417:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("defs",{key:0},a.createElement("style",null,".cls-1{fill:currentColor;}")),a.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},a.createElement("path",{className:"cls-1",d:"M0,5,.53,4.5,3.64,7.61,11.25,0l.53.53L3.64,8.67Z"})))])}o.defaultProps={viewBox:"0 0 10 10",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1418:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("path",{className:"OfficeIconColors_HighContrast",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 m 1547 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -73 -31 q -38 -14 -80 -22 l 75 -75 z",key:0}),a.createElement("path",{className:"reopenThreadIconShading",fillOpacity:"1.000",d:"M 1073 1344 h -203 l -422 422 v -422 h -256 v -561 l 384 385 l 195 -196 l -25 46 m 1110 -826 v 1152 h -723 l 105 -160 q 52 -79 79 -168 q 27 -90 27 -184 q 0 -115 -39 -220 q -40 -105 -109 -188 q -69 -84 -164 -141 q -95 -58 -206 -80 l 11 -11 z",key:1}),a.createElement("path",{className:"reopenThreadIconArrow",fillOpacity:"1.000",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -74 -31 q -38 -14 -79 -22 l 75 -75 z",key:2}),a.createElement("path",{className:"reopenThreadIconBubble",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 z",key:3})])}o.defaultProps={width:"14",height:"14",viewBox:"200,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1419:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("defs",{key:0},a.createElement("style",null,".cls-1{fill:currentColor;}")),a.createElement("path",{className:"cls-1",d:"M7.5 0C8.19271 0 8.85677 0.0885417 9.49219 0.265625C10.1328 0.442708 10.7318 0.695312 11.2891 1.02344C11.8464 1.34635 12.3516 1.73698 12.8047 2.19531C13.263 2.64844 13.6536 3.15365 13.9766 3.71094C14.3047 4.26823 14.5573 4.86719 14.7344 5.50781C14.9115 6.14323 15 6.80729 15 7.5C15 8.19271 14.9115 8.85938 14.7344 9.5C14.5573 10.1354 14.3047 10.7318 13.9766 11.2891C13.6536 11.8464 13.263 12.3542 12.8047 12.8125C12.3516 13.2656 11.8464 13.6562 11.2891 13.9844C10.7318 14.3073 10.1328 14.5573 9.49219 14.7344C8.85677 14.9115 8.19271 15 7.5 15C6.80729 15 6.14062 14.9115 5.5 14.7344C4.86458 14.5573 4.26823 14.3073 3.71094 13.9844C3.15365 13.6562 2.64583 13.2656 2.1875 12.8125C1.73438 12.3542 1.34375 11.8464 1.01562 11.2891C0.692708 10.7318 0.442708 10.1354 0.265625 9.5C0.0885417 8.85938 0 8.19271 0 7.5C0 6.80729 0.0885417 6.14323 0.265625 5.50781C0.442708 4.86719 0.692708 4.26823 1.01562 3.71094C1.34375 3.15365 1.73438 2.64844 2.1875 2.19531C2.64583 1.73698 3.15365 1.34635 3.71094 1.02344C4.26823 0.695312 4.86458 0.442708 5.5 0.265625C6.14062 0.0885417 6.80729 0 7.5 0ZM7.5 14C8.09375 14 8.66667 13.9219 9.21875 13.7656C9.77604 13.6094 10.2943 13.3906 10.7734 13.1094C11.2578 12.8281 11.6979 12.4896 12.0938 12.0938C12.4896 11.6979 12.8281 11.2604 13.1094 10.7812C13.3906 10.2969 13.6094 9.77865 13.7656 9.22656C13.9219 8.67448 14 8.09896 14 7.5C14 6.90625 13.9219 6.33333 13.7656 5.78125C13.6094 5.22396 13.3906 4.70573 13.1094 4.22656C12.8281 3.74219 12.4896 3.30208 12.0938 2.90625C11.6979 2.51042 11.2578 2.17188 10.7734 1.89062C10.2943 1.60938 9.77604 1.39062 9.21875 1.23438C8.66667 1.07812 8.09375 1 7.5 1C6.90104 1 6.32552 1.07812 5.77344 1.23438C5.22135 1.39062 4.70312 1.60938 4.21875 1.89062C3.73958 2.17188 3.30208 2.51042 2.90625 2.90625C2.51042 3.30208 2.17188 3.74219 1.89062 4.22656C1.60938 4.70573 1.39062 5.22396 1.23438 5.78125C1.07812 6.33333 1 6.90625 1 7.5C1 8.09375 1.07812 8.66927 1.23438 9.22656C1.39062 9.77865 1.60938 10.2969 1.89062 10.7812C2.17188 11.2604 2.51042 11.6979 2.90625 12.0938C3.30208 12.4896 3.73958 12.8281 4.21875 13.1094C4.70312 13.3906 5.22135 13.6094 5.77344 13.7656C6.32552 13.9219 6.90104 14 7.5 14ZM7 4H8V9H7V4ZM7 10H8V11H7V10Z",fill:"#252423",key:1})])}o.defaultProps={width:"15",height:"15",viewBox:"0 0 15 15",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1420:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"Group",transform:"translate(0.000000, 0.648438)",fill:"currentColor",fillRule:"nonzero"},a.createElement("polygon",{id:"Reassign",points:"7.52636719 0 13.9589844 6.43261719 7.52636719 12.8652344 6.91113281 12.25 12.2910156 6.87011719 0 6.87011719 0 5.99511719 12.2910156 5.99511719 6.91113281 0.615234375"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 14 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1421:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"Group",transform:"translate(-32.000000, -2.351562)",fill:"currentColor",fillRule:"nonzero"},a.createElement("polygon",{id:"Resolve",points:"42.5673828 2.625 43.1826172 3.24023438 35.875 10.5546875 32.0673828 6.74023438 32.6826172 6.125 35.875 9.31054688"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 9",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1422:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"Group",transform:"translate(-62.000000, -26.351562)",fill:"currentColor",fillRule:"nonzero"},a.createElement("polygon",{id:"Cancel",points:"73.5888672 27.0839844 68.8720703 31.8076172 73.5888672 36.53125 72.9736328 37.1464844 68.25 32.4296875 63.5263672 37.1464844 62.9111328 36.53125 67.6279297 31.8076172 62.9111328 27.0839844 63.5263672 26.46875 68.25 31.1855469 72.9736328 26.46875"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 11",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1423:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"Group",transform:"translate(-30.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},a.createElement("path",{d:"M44.625,27.0976562 C44.625,27.398439 44.5680344,27.6901028 44.4541016,27.9726562 C44.3401687,28.2552097 44.1738292,28.5058583 43.9550781,28.7246094 L34.9521484,37.7275391 L30.625,38.8076172 L31.7050781,34.4804688 L40.7080078,25.4775391 C40.9267589,25.258788 41.1774074,25.0924485 41.4599609,24.9785156 C41.7425144,24.8645828 42.0341782,24.8076172 42.3349609,24.8076172 C42.6494156,24.8076172 42.9456366,24.8680007 43.2236328,24.9887695 C43.501629,25.1095384 43.7443023,25.2735992 43.9516602,25.480957 C44.159018,25.6883148 44.3230788,25.9309882 44.4438477,26.2089844 C44.5646165,26.4869806 44.625,26.7832016 44.625,27.0976562 Z M32.8535156,34.5693359 C33.336591,34.7288419 33.7524397,34.9829084 34.1010742,35.331543 C34.4497088,35.6801775 34.7037752,36.0960262 34.8632812,36.5791016 L42.2529297,29.1826172 L40.25,27.1796875 L32.8535156,34.5693359 Z M31.828125,37.6044922 L34.0771484,37.0439453 C34.0315753,36.8343088 33.95752,36.6360686 33.8549805,36.4492188 C33.7524409,36.2623689 33.6282559,36.0960294 33.4824219,35.9501953 C33.3365878,35.8043612 33.1702483,35.6801763 32.9833984,35.5776367 C32.7965485,35.4750971 32.5983083,35.4010419 32.3886719,35.3554688 L31.828125,37.6044922 Z M42.875,28.5605469 C42.9889329,28.446614 43.0983068,28.3395187 43.203125,28.2392578 C43.3079432,28.1389969 43.4013668,28.0330409 43.4833984,27.9213867 C43.5654301,27.8097325 43.6303709,27.6889655 43.6782227,27.559082 C43.7260745,27.4291986 43.75,27.2776701 43.75,27.1044922 C43.75,26.9085277 43.7124027,26.7250985 43.637207,26.5541992 C43.5620113,26.3832999 43.4594733,26.2329108 43.3295898,26.1030273 C43.1997064,25.9731439 43.0493173,25.8706058 42.878418,25.7954102 C42.7075187,25.7202145 42.5240895,25.6826172 42.328125,25.6826172 C42.1549471,25.6826172 42.0034186,25.7065427 41.8735352,25.7543945 C41.7436517,25.8022463 41.6228847,25.8671871 41.5112305,25.9492188 C41.3995763,26.0312504 41.2936203,26.124674 41.1933594,26.2294922 C41.0930985,26.3343104 40.9860032,26.4436843 40.8720703,26.5576172 L42.875,28.5605469 Z",id:"Edit"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",x:"0",y:"0",viewBox:"0 0 15 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1424:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("path",{d:"M1 4L3.5 6.5L9 1"}))}o.defaultProps={viewBox:"0 0 10 8",focusable:"false",fill:"none",fillOpacity:"0.0"},e.exports=o,o.default=o},1425:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:0}),a.createElement("path",{fill:"currentColor",fillOpacity:"1.000",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:1})])}o.defaultProps={width:"12",height:"12",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1426:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,a.createElement("g",{id:"***-Symbols",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("path",{d:"M14.5,5 C14.703126,5 14.8958324,5.03906211 15.078125,5.1171875 C15.2604176,5.19531289 15.4205722,5.30208266 15.5585938,5.4375 C15.6966153,5.57291734 15.8046871,5.73176992 15.8828125,5.9140625 C15.9609379,6.09635508 16,6.29166562 16,6.5 C16,6.6666675 15.9739586,6.82552008 15.921875,6.9765625 L13.921875,12.9765625 C13.8697914,13.1276049 13.7968755,13.2669264 13.703125,13.3945312 C13.6093745,13.5221361 13.5,13.6302079 13.375,13.71875 C13.2499994,13.8072921 13.113282,13.8763018 12.9648438,13.9257812 C12.8164055,13.9752607 12.6614591,14 12.5,14 L8.5,14 C7.56770367,14 6.66927516,13.8203143 5.8046875,13.4609375 C5.42968563,13.3098951 5.0533873,13.1953129 4.67578125,13.1171875 C4.2981752,13.0390621 3.90625203,13 3.5,13 L0,13 L0,6 L3.2578125,6 C3.59635586,6 3.91536309,5.93750062 4.21484375,5.8125 C4.51432441,5.68749938 4.78385297,5.50520953 5.0234375,5.265625 L9.8828125,0.4140625 C10.0130215,0.283853516 10.1432285,0.182292031 10.2734375,0.109375 C10.4036465,0.0364579688 10.5624991,0 10.75,0 C10.9218759,0 11.0833326,0.0325517578 11.234375,0.09765625 C11.3854174,0.162760742 11.5182286,0.252603594 11.6328125,0.3671875 C11.7473964,0.481771406 11.8372393,0.614582578 11.9023438,0.765625 C11.9674482,0.916667422 12,1.07812414 12,1.25 C12,1.67187711 11.9531255,2.07421684 11.859375,2.45703125 C11.7656245,2.83984566 11.6276051,3.21874813 11.4453125,3.59375 C11.3411453,3.81770945 11.2526045,4.04557176 11.1796875,4.27734375 C11.1067705,4.50911574 11.0572918,4.74999875 11.03125,5 L14.5,5 Z M1,12 L3.5,12 C3.9734466,12 4.4332293,12.0458255 4.87838685,12.1379271 C5.31513303,12.2282884 5.74859274,12.3602761 6.18851278,12.5375318 C6.93158683,12.8463999 7.69958736,13 8.5,13 L12.5,13 C12.5548236,13 12.602973,12.9923123 12.648616,12.977098 C12.7042395,12.9585568 12.7526835,12.9341041 12.7969807,12.9027269 C12.8337665,12.8766702 12.8664285,12.8443971 12.8972432,12.8024548 C12.9312256,12.7562009 12.9571761,12.7066171 12.9731917,12.6603347 L14.976502,6.65057182 C14.9920216,6.60556505 15,6.55689677 15,6.5 C15,6.42541757 14.9877526,6.36418032 14.9636675,6.3079818 C14.9365874,6.244795 14.9025618,6.19478151 14.8582531,6.15130876 C14.8093393,6.10331783 14.7532414,6.06591924 14.6842057,6.03633253 C14.6271661,6.01188698 14.5685237,6 14.5,6 L9.92167262,6 L10.0366316,4.89639392 C10.0695629,4.58025353 10.1325645,4.27353503 10.2257814,3.97723847 C10.311817,3.70376821 10.4161404,3.43528887 10.5459446,3.15655729 C10.6976958,2.8443835 10.8114223,2.53217213 10.8880777,2.21916252 C10.9624237,1.91558304 11,1.59305299 11,1.25 C11,1.21274116 10.9946165,1.18603901 10.9840197,1.16145435 C10.9688056,1.12615764 10.9504819,1.09907042 10.9257057,1.07429428 C10.9009296,1.04951814 10.8738424,1.03119444 10.8385457,1.01598034 C10.813961,1.0053835 10.7872588,1 10.75,1 C10.7324276,1 10.7311357,0.999063781 10.7416579,0.993076126 L10.7490693,0.989479263 C10.7056707,1.01597571 10.651885,1.05920353 10.5893502,1.12173792 L5.73054428,5.97273178 C5.3997463,6.30352976 5.02122029,6.55953769 4.60002886,6.73533933 C4.17716132,6.91184057 3.72718088,7 3.2578125,7 L1,7 L1,12 Z",fill:"#2B5C9C",fillRule:"nonzero"})))}o.defaultProps={width:"16px",height:"14px",viewBox:"0 0 16 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1427:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("path",{d:"M1.08001 9.31998L1.28001 8.63998H4.28001C4.60001 8.13998 4.96001 7.59998 5.36001 7.03998C6.16001 5.91998 6.72001 5.21998 7.06001 4.93998C7.96001 4.23998 8.52001 3.77998 8.76001 3.57998C9.66001 2.77998 10.16 2.17998 10.24 1.75998C10.32 1.31998 10.46 0.999976 10.64 0.799976C10.76 0.659976 10.9 0.599976 11.04 0.599976C11.3 0.599976 11.56 0.779976 11.8 1.11998C12.16 1.59998 12.16 2.27998 11.82 3.11998C11.6 3.65998 11.38 4.09998 11.16 4.43998C10.86 4.87998 10.68 5.15998 10.62 5.29998C10.44 5.65998 10.36 6.05998 10.42 6.47998C11.08 6.51998 11.76 6.61998 12.42 6.79998C13.76 7.13998 14.42 7.67998 14.42 8.37998C14.42 8.59998 14.38 8.77998 14.32 8.97998C14.24 9.17998 14.14 9.25998 14.04 9.25998L14.34 9.47998C14.54 9.71998 14.64 10.04 14.64 10.44C14.64 10.66 14.54 10.84 14.34 11.02C14.24 11.1 14.14 11.18 14.04 11.22L14.2 11.52C14.3 11.78 14.3 12.08 14.22 12.42C14.18 12.62 14.06 12.8 13.86 12.98C13.68 13.14 13.54 13.2 13.42 13.2V13.94C13.36 14.46 13.16 14.82 12.82 14.98C12.1 15.34 11.7 15.52 11.62 15.56C11.06 15.72 10.26 15.76 9.22001 15.68C8.22001 15.6 7.12001 15.42 5.92001 15.16C5.32001 15.02 4.82001 14.9 4.42001 14.78H1.42001C1.32001 14.54 1.22001 14.24 1.12001 13.86C0.920014 13.12 0.820015 12.42 0.820015 11.76C0.880015 10.78 0.960014 9.97998 1.08001 9.31998Z",fill:"#FDCE4C",key:0}),a.createElement("path",{d:"M9.78002 9.59995C10.04 9.65995 10.2 10.0399 10.22 10.7599C10.24 11.3599 10.2 11.9799 10.06 12.5799C10.02 12.8199 10.02 13.2999 10.06 14.0199C10.08 14.4599 9.98002 14.6599 9.76002 14.6199C9.44002 14.5399 9.10002 14.2399 8.78002 13.6799C8.42002 13.0999 8.30002 12.5799 8.40002 12.0999C8.54002 11.4799 8.72002 10.9199 8.96002 10.4199C9.24002 9.83995 9.52002 9.55995 9.78002 9.59995Z",fill:"url(#paint0_linear)",key:1}),a.createElement("path",{d:"M10.34 8.84C10.5 8.58 10.4 8.86 10.06 9.72C9.69999 10.58 9.09999 11.08 8.23999 11.22C7.37999 11.38 6.71999 11.38 6.27999 11.22C7.43999 11 8.29999 10.56 8.79999 9.92C9.31999 9.28 9.59999 8.62 9.63999 7.94C9.93999 8.8 10.18 9.1 10.34 8.84Z",fill:"url(#paint1_linear)",key:2}),a.createElement("path",{d:"M11 8.89995C11.12 9.07995 11.28 9.21995 11.48 9.31995C10.98 9.69995 10.8 10.1599 10.94 10.6999C11 10.9599 11.12 11.1999 11.3 11.3799C10.76 11.7799 10.54 12.2199 10.66 12.6799C10.72 12.9199 10.82 13.0999 10.98 13.2599C10.68 13.5399 10.54 13.9799 10.54 14.5999C10.54 14.8999 10.58 15.1799 10.64 15.4199C10.08 15.2199 9.75998 14.7999 9.67998 14.1599L9.71998 13.2599C9.41998 12.8599 9.33998 12.3999 9.49998 11.8999L9.79998 11.2799C9.43998 10.9999 9.33998 10.5999 9.45998 10.0399L9.73998 9.29995C9.61998 8.85995 9.81998 8.47995 10.36 8.17995C10.64 8.01995 10.92 7.89995 11.22 7.81995C10.84 8.19995 10.76 8.55995 11 8.89995Z",fill:"#FDCE4C",key:3}),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.619 13.18C13.619 13.0701 13.5299 12.981 13.42 12.981H9.82C9.71008 12.981 9.62098 13.0701 9.62098 13.18C9.62098 13.2899 9.71008 13.379 9.82 13.379H13.42C13.5299 13.379 13.619 13.2899 13.619 13.18Z",fill:"#AC8662",key:4}),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.239 11.22C14.239 11.11 14.1499 11.0209 14.04 11.0209H9.83999C9.73008 11.0209 9.64097 11.11 9.64097 11.22C9.64097 11.3299 9.73008 11.419 9.83999 11.419H14.04C14.1499 11.419 14.239 11.3299 14.239 11.22Z",fill:"#AC8662",key:5}),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.239 9.23997C14.239 9.13006 14.1499 9.04095 14.04 9.04095H9.83999C9.73008 9.04095 9.64097 9.13006 9.64097 9.23997C9.64097 9.34989 9.73008 9.43899 9.83999 9.43899H14.04C14.1499 9.43899 14.239 9.34989 14.239 9.23997Z",fill:"#AC8662",key:6}),a.createElement("defs",{key:7},[a.createElement("linearGradient",{x1:"8.14689",y1:"8.32298",x2:"11.0687",y2:"8.28505",gradientUnits:"userSpaceOnUse",key:0},[a.createElement("stop",{stopColor:"#B8895A",stopOpacity:"0.2",key:0}),a.createElement("stop",{offset:"1",stopColor:"#B57E4A",key:1})]),a.createElement("linearGradient",{x1:"4.86538",y1:"9.62116",x2:"7.60127",y2:"8.17258",gradientUnits:"userSpaceOnUse",key:1},[a.createElement("stop",{stopColor:"#F0C194",stopOpacity:"0.4",key:0}),a.createElement("stop",{offset:"1",stopColor:"#CBA37C",stopOpacity:"0.502",key:1})])])])}o.defaultProps={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e.exports=o,o.default=o},1428:function(e,t,n){var a=n(0);function o(e){return a.createElement("svg",e,[a.createElement("defs",{key:0},a.createElement("style",null,".cls-1{fill:currentColor;}")),a.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},a.createElement("path",{className:"cls-1",d:"M 2048 1216 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -512 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 64 v 128 h -64 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -64 v -128 h 64 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 m -640 -384 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -512 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 512 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 z"})))])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1754:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n(330);n(1368),n(1381),n(1386);var r=n(144);n(494);var i=n(309),s=n(6),c=n(83),d=n(57),l=n(4),m=n(173),u=n(22),p=(n(1396),n(1398),n(766)),f=n(436),C=n(1180),h=n(610),v=n(9),b=function(){function e(){this._listeners=[]}return e.prototype.add=function(e){this._listeners.push(e)},e.prototype.remove=function(e){var t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var e=this;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e._listeners.forEach((function(e){return e.apply(void 0,Object(a.j)(t))}))}},enumerable:!1,configurable:!0}),e}(),g=function(){function e(){var e=this;this.changedEvent=new b,this.fireEvent=function(t){e.changedEvent.invoke(t)}}return e.prototype.registerForViewContainerEvents=function(e){this.changedEvent.add(e)},e.prototype.unregisterForViewContainerEvents=function(e){this.changedEvent.remove(e)},e}(),y=function(){function e(e,t,n){this.viewContainerBase=e,this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.identifier=e.identifier}return e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.moveFocusToCanvas_donotuse=function(){this.viewContainerBase.moveFocusToCanvas_donotuse&&this.viewContainerBase.moveFocusToCanvas_donotuse()},e}(),T=n(365),I=n(0),O=n(56),S=n(76),j=n(61);function E(e,t){return e+"-"+t}var D,x=n(123),w=n(446);!function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(D||(D={}));var A={sendCodeMarker:function(e){},onStartEvent:new w.EventImpl((function(){})),onStopEvent:new w.EventImpl((function(){}))},P=function(e){this.onMockUIAction=new w.EventImpl((function(){}))},k=n(698),R=n(231),N=n(411),M=n(44),V=function(e,t){var n=this;this.commentViewManager=e,this.correlationId=t,this.visit=function(e){e.attachContext(n.commentViewManager.apiContext),n.correlationId&&e.addDataField("InstanceCorrelationId",n.correlationId,l.d.SystemMetadata)}};function _(e){return new V(F(e),e.correlationId)}var F=function(){throw new Error("ViewManagerFactory not set")};var L=new(function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(e){var t=this,n=this.instanceMap.get(e);return n||{visit:function(n){var a=t.instanceMap.get(e);if(!a)return n.attachContext(e),void n.addDataField("MissingInstanceTelemetry",!0,l.d.SystemMetadata);a.visit(n)}}},e.prototype.closeViewManager=function(e){var t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))},e.prototype.doesViewManagerExist=function(e){return this.instanceMap.has(e)},e.prototype.ensureViewManager=function(e){var t=e.apiContext,n=e.displayMode,a=e.contentNavigationAPI;this.initialized||this.ensureInitialized();var o=this.instanceMap.get(t);return o?this.updateInstanceObject(o,n):(this.initializeContentNavigationAPI(t,a),o=_(e),this.instanceMap.set(t,o)),o.commentViewManager},e.prototype.getCorrelationId=function(e){var t=this.instanceMap.get(e);return t&&t.correlationId},e.prototype.getStore=function(e){var t=this.instanceMap.get(e);if(!t)throw new M.a("Instance is not initialized",s.e.reserveTag(589103622),-2130957512);return t.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(e){var t=this.tryGetViewManager(e);if(!t)throw new M.a("Instance is not initialized",s.e.reserveTag(589103623),-2130957512);return t},e.prototype.tryGetViewManager=function(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager},e.prototype.ensureInitialized=function(){var e=this;v.w()&&A.onStartEvent.subscribe((function(t){e.initializeContentNavigationAPI(t.context,void 0),e.initializeViewManager(t.context,t.correlationId,t.useMockMode)})),A.onStopEvent.subscribe((function(t){e.closeViewManager(t.context),Object(x.e)(t.context)})),this.initialized=!0},e.prototype.initializeViewManager=function(e,t,n){var a=this.instanceMap.get(e);if(a)a.correlationId=t;else{var o=void 0;n&&v.o()&&(Object(l.i)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),l.a.None,l.b.FullEvent).successTag(592511450),o=new P(e)),this.instanceMap.set(e,_({apiContext:e,correlationId:t,initializationReason:N.a.PaneOpen,displayMode:R.b.FullPane,foldableLayoutState:k.a.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:o}))}},e.prototype.updateInstanceObject=function(e,t){var n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)},e.prototype.initializeContentNavigationAPI=function(e,t){Object(x.g)(e)||Object(x.h)(t||new x.b(e),e)},e}()),H=n(117),B=n(291),U=function(){function e(e,t,n){var a=this;this.viewContainerBase=e,this.context=t,this.viewContainerProvider=n,this.rootNode=null,this.lastRenderFailed=!1,this.processVisibilityEvent=function(e){switch(e.viewContainerVisibilityState){case H.a.Visible:a.viewContainerBase.identifier?a.rootNode=document.getElementById(a.viewContainerBase.identifier):Object(l.i)().assertConditionTag(!1,"View container base identifier expected",558401364),a.providerPromise.then((function(e){a.renderIntoView(e)})).catch(Object(j.a)(s.e.reserveTag(558401365)));break;case H.a.Closed:a.viewContainerBase.identifier&&a.rootNode&&(Object(O.unmountComponentAtNode)(a.rootNode),a.rootNode=null);break;case H.a.Hidden:Object(l.i)().assertConditionTag(!1,"ViewContainerVisibilityState.Hidden is not currently supported for web.",558401366);break;default:Object(s.n)(e.viewContainerVisibilityState)}},this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.onViewEventReceived=this.onViewEventReceived.bind(this),this.onProviderStateChange=this.onProviderStateChange.bind(this);var o=E("SharedCommentPane",t);this.viewContainerProvider&&(this.viewContainerProvider.registerForViewContainerEvents(this.onViewEventReceived),this.providerPromise=Object(T.c)().getComponent(o),this.providerPromise.then((function(e){e.onStateChanged.subscribe(a.onProviderStateChange)})).catch(Object(j.a)(s.e.reserveTag(558401359))))}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.viewContainerBase.identifier},enumerable:!1,configurable:!0}),e.prototype.renderIntoView=function(e){this.renderPane(e)},e.prototype.renderPane=function(e){var t=this,n=e.component,a=Object(l.i)().createActivityObject("RenderPaneIntoView",L.getTelemetryVisitor(this.context),l.a.None,l.b.NecessaryServiceDataEvent);if(!n)return this.lastRenderFailed&&a.failTag(558401360,-2130957502),void(this.lastRenderFailed=!0);Object(O.render)(I.createElement(n,{resource:{id:"CommentPane"}}),this.rootNode,(function(){var e=document.getElementById(S.w());e&&e.focus(),t.lastRenderFailed=!1})),a.successTag(558401361)},e.prototype.onProviderStateChange=function(e){var t=this;this.rootNode&&(e===T.a.Registered?this.providerPromise.then((function(e){t.renderIntoView(e)})).catch((function(e){Object(l.i)().assertConditionTag(!1,"Unexpected promise rejection from component provider promise",558401362)})):e===T.a.Unregistered&&Object(O.unmountComponentAtNode)(this.rootNode))},e.prototype.onViewEventReceived=function(e){var t;switch(e.eventType){case B.a.VisibilityChanged:this.processVisibilityEvent(e);break;case B.a.ViewContainerChanged:e.newViewContainer!==this&&(null===(t=this.viewContainerProvider)||void 0===t||t.unregisterForViewContainerEvents(this.onViewEventReceived));break;case B.a.FoldableLayoutStateChanged:case B.a.FocusTriggered:break;default:Object(s.n)(e)}},e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.closeView=function(){this.viewContainerBase.closeView()},e.prototype.moveFocusToCanvas_donotuse=function(){},e}(),q=function(e){function t(t,n){var a=e.call(this)||this;return a.viewContainerProvider=n,a.apiContext=t,n.registerForViewContainerEvents(a.fireEvent),a}return Object(a.d)(t,e),t.prototype.getViewContainer=function(){return this.currentContainer||(v.Z()?this.currentContainer=new y(this.viewContainerProvider.getViewContainer(),this.apiContext,this):this.currentContainer=new U(this.viewContainerProvider.getViewContainer(),this.apiContext,this)),this.currentContainer},t.prototype.changeViewContainerType=function(e){},t}(g);var z=n(213),W=n(12),G=Object(W.c)((function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}}})),Y=function(e){function t(t){var n=e.call(this,t)||this;return n.state={liveRegionUpdate:t.liveRegionUpdate,liveRegionCounter:0},n}return Object(a.d)(t,e),t.prototype.appendLiveRegionUpdate=function(e){var t=this,n=this.state.liveRegionCounter+1;this.setState({liveRegionUpdate:e,liveRegionCounter:n}),setTimeout((function(){t.state.liveRegionCounter===n&&t.setState({liveRegionUpdate:void 0,liveRegionCounter:0})}),1e3)},t.prototype.render=function(){var e=G();return I.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",style:e.offscreenLiveRegion},this.state.liveRegionUpdate)},t}(I.PureComponent);function K(){var e=document.createElement("div");document.body.appendChild(e),O.render(I.createElement(Y,{ref:Q}),e),Object(z.c)({announceToScreenReader:function(e){var t=Z;t&&Object(c.f)(e)&&t.appendLiveRegionUpdate(e)}})}var Z=void 0;function Q(e){Z=e}n(38);var X={LivePersonaPicker:{webSettingName:"LivePersonaPicker"},PersonaFeature:{webSettingName:"PersonaColor"},NewCommentButton:{webSettingName:"NewCommentButton"},DiscreteHostedComments:{webSettingName:"DiscreteHostedComments"},CommentsFluentUI:{webSettingName:"CommentsFluentUI"},RenderDHCInPane:{},CommentTasks:{webSettingName:"CommentTasks"},NoDiscardOnFocusLoss:{webSettingName:"NoDiscardOnFocusLoss"},NewDraftingUI:{webSettingName:"DiscreteHostedComments"},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure"},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply"},NewModelState:{webSettingName:"NewModelState"},HeadlessBoot:{},HyperlinksInComments:{webSettingName:"HyperlinksInComments"},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText"},ContentNavigation:{webSettingName:"ContentNavigation"},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey"},ExtendedDrafting:{webSettingName:"ExtendedDrafting"},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb"},SmartReplies:{webSettingName:"SmartReplies"},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair"},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration"},NewSelectionInteractions:{webSettingName:"NewSelectionInteractions"},CommentReactions:{webSettingName:"CommentReactions"},LinkToComment:{webSettingName:"LinkToComment"},WebThemeIntegration:{webSettingName:"WebThemeIntegration"},TruncationUIWithReadMoreText:{webSettingName:"TruncationUIWithReadMoreText"},QuickEdit:{},QuillInitializationTelemetry:{webSettingName:"QuillInitializationTelemetry"},CtrlEnterTip:{},LPPVerboseLogging:{},PersonaIconImageForWeb:{webSettingName:"PersonaIconImageForWeb"},FluentSVRefreshWin32:{},HighlightsAndFontColorInWebComments:{webSettingName:"HighlightsAndFontColorInWebComments"},UnresponsivePaneWorkaround:{}},J=n(3);var $={name:"OfficeSharedComments",version:n(1106).a},ee=n(122);function te(){if(!v.o())throw new M.a(ee.o,s.e.reserveTag(589103628),-2130957516);return L.getViewManager(i.a)}function ne(){te().beginInitialization()}var ae,oe=n(136),re=n(247),ie=n(608),se=function(){function e(e,t,n,a,o){var r=this;this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=a,this._insertIndex=o,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(e){e.draftId===r.sessionConfiguration.draftId&&(e.anchorHintText&&(r._anchorHintText=e.anchorHintText),void 0!==e.insertIndex&&(r._insertIndex=e.insertIndex))},this.handleCommentEvents=function(e,t){e===re.e.CommentContextChanged&&Object(ie.b)(t)&&t.contextDrafts?t.contextDrafts.forEach((function(e){return r.updateDraft(e)})):e===re.e.UpdateDraftThread&&Object(ie.d)(t)&&r.updateDraft(t)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(e,t){this._propertiesToUpdate[e]=Object(a.a)({},t)},e.prototype.commit=function(e){if(!this.hostCommentAPI.commit)throw new M.a(ee.h,s.e.reserveTag(589103689),-2130957526);if(!this._active)throw new M.a(ee.b,s.e.reserveTag(589103690),-2130957525);var t=v.b()&&this.sessionConfiguration.sessionType===re.i;if(void 0===e&&!t||t&&void 0!==e)throw new M.a(ee.c,s.e.reserveTag(589103691),-2130957507);return v.b()||v.a()?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}(),ce=function(){function e(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.resolveSupported=e.resolveSupported.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),v.D()&&(this.presentLinkToComment=e.presentLinkToComment.bind(e)),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e)),!v.kb()&&e.diagnosticHeartbeat&&setInterval((function(){var t;null===(t=e.diagnosticHeartbeat)||void 0===t||t.call(e)}),1e3)}return e.prototype.beginDraftingAsync=function(e){var t=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new M.a("Drafting APIs are undefined on Host Comment API",s.e.reserveTag(589103700),-2130957527);var n=Object(c.c)(),o=Object(a.a)(Object(a.a)({},e),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(o).then((function(e){return new se(t.hostCommentAPI,Object(oe.b)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||o,e.insertIndex)}))},e}(),de=n(36),le={themeId:1,palette:{ApplePaneTopBorder:de.a.GRAY_C,ButtonBorder:de.a.GRAY_B,CardAccent:de.a.GRAY_B,CardBackground:de.a.WHITE,CardHoveredBackground:de.a.GRAY_20,CardDraftBoxBackgroundHovered:de.a.WHITE,CardDraftBoxBorderHovered:de.a.GRAY_160,CardDraftBoxBorder:de.a.GRAY_110,CardDraftBoxBackground_HalfPane:de.a.WHITE,CardDraftBoxBackground:de.a.GRAY_A,CardExpandButtonBorder:de.a.GRAY_B,CardHeroBarBackground_HalfPane:de.a.GRAY_A,CardHeroBarBackground:de.a.WHITE,CardReplyBackground_HalfPane:de.a.GRAY_A,CardReplyBackground:de.a.GRAY_A,CardReplyTopBorder:de.a.GRAY_B,CardSelectionColor:de.a.COMMENTS_PURPLE,CardShadowColor:de.a.BLACK,CardBorder:de.a.GRAY_B,CardBorderEmphasis:de.a.COMMENTS_PURPLE,CommandBarBorder:de.a.GRAY_B,CommandBarTopBorder:de.a.GRAY_B,IconButtonDisabledTint:de.a.GRAY_C,IconButtonFocusedTint:de.a.GRAY_I,NavigationBarBackground:de.a.WHITE,NavigationBarBorder:de.a.GRAY_B,PaneBackground_HalfPane:de.a.WHITE,PaneBackground:de.a.GRAY_A,UnreadDotColor:de.a.DOT_BLUE,UnreadDotBorderColor:de.a.WHITE,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:de.a.GRAY_150,CardPlaceholderColor:de.a.GRAY_130,ResolvedCardBackground:de.a.GRAY_20}},me=function(){function e(){}return e.prototype.getTheme=function(){return Object(l.i)().assertConditionTag(!1,"Should not be called",592986821),le},e.prototype.registerForThemeChange=function(e){},e.prototype.unregisterForThemeChange=function(e){},e}(),ue=n(185),pe=n(271),fe=n(23),Ce=n(43),he=n(502),ve=n(13),be=n(172),ge=n(46),ye=n(40),Te=n(11),Ie=n(63),Oe=n(245),Se=n(229);!function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"}(ae||(ae={}));var je,Ee=n(20),De=n(398),xe=n(94),we=n(137);function Ae(e,t){return{type:je.DispatchAction,action:t,causedBy:e,priorityArgs:{priority:1}}}function Pe(e){return e.type===je.FocusComponent&&void 0!==e.component}function ke(e,t,n){return void 0===n&&(n={priorityArgs:{priority:1}}),Object(a.a)({type:je.FocusComponent,component:t,causedBy:e},n)}!function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"}(je||(je={}));var Re=n(42);function Ne(e,t,n){return t?n?{type:je.Compound,priorityArgs:{priority:1},first:t,then:n,causedBy:e}:t:n}function Me(e,t,n){if(!e)return ae.NoCommand;var a=ae.Handled;if(Pe(e)){var o=e.component;o.componentType===Re.a.Card&&"ios"===Object(xe.a)()&&(pe.a&&Object(s.j)("Switching focus command from Card to Post to workaround iOS platform difference with card container focus"),o.componentType=Re.a.Post),a=function(e,t){return t?(pe.a&&Object(s.j)("Calling focus for componentType: "+e.component.componentType),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),ae.Handled):function(e){return 1!==e.priorityArgs.priority&&0!==e.priorityArgs.phase}(e)?ae.ShouldRetry:ae.ComponentNotFound}(e,Object(Re.c)(o)?t.getComponentById(o):t.getComponent(o.componentType))}else if(function(e){return e.type===je.DispatchAction&&void 0!==e.action}(e))n.dispatch(e.action);else if(function(e){return e.type===je.Compound&&void 0!==e.first&&void 0!==e.then}(e)){var r=Me(e.first,t,n),i=Me(e.then,t,n);Object(l.i)().assertConditionTag(r!==ae.ShouldRetry&&i!==ae.ShouldRetry,"Compound command failed with status FocusManagerResult.ShouldRetry. No retry will occur.",559748948)}return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),a}var Ve=n(216),_e=n(26),Fe=n(454);function Le(e,t){if(n=Object(_e.b)(e),!("win32"===Object(xe.a)()||"ios"===Object(xe.a)()&&n===Ee.a.FullPane||"web"===Object(xe.a)()&&v.Z())&&Object(we.b)(n)){var n;if(e.getComponent(Re.a.ClosePaneButton))return ke(void 0,{componentType:Re.a.ClosePaneButton},{priorityArgs:t});Object(l.i)().assertConditionTag(!1,"cant find close button on platform where we should be able to find it",579086371)}}function He(e,t,n){var a,o;if(void 0===n&&(n={priority:1}),Object(we.b)(Object(_e.b)(e))){var r=null!==(o=null!==(a=function(e,t,n){if(v.H()&&Object(_e.b)(e)===Ee.a.FullPane){var a=t.getState();if(v.J()?Te.l(a).newThread:Object(Fe.a)(Te.h(a),Te.g(a))){if(e.getComponent(Re.a.NewCommentButton))return ke(void 0,{componentType:Re.a.NewCommentButton},{priorityArgs:n});Object(l.i)().assertConditionTag(!1,"cant find new comment button, but its enabled",579086400)}}}(e,t,n))&&void 0!==a?a:Le(e,n))&&void 0!==o?o:function(e){if("ios"!==Object(xe.a)()&&"web"!==Object(xe.a)())return ke(void 0,{componentType:Re.a.CommentsList},{priorityArgs:e})}(n);if(r)return r;Object(l.i)().assertConditionTag("ios"===Object(xe.a)()&&Object(_e.b)(e)===Ee.a.FullPane,"Couldn't find a focus target",576337158)}else Object(l.i)().assertConditionTag(!1,"Shouldn't be called with renderContextType: "+Object(_e.b)(e),576337157)}var Be=function(e){function t(t){var n=e.call(this,t)||this,a=t.nativeEvent,o=a.altKey,r=a.shiftKey,i=a.ctrlKey,s=a.metaKey,c=a.key;return n.altKey=o,n.shiftKey=r,n.ctrlKey=i,n.metaKey=s,n.key=Object(ue.f)(c),n}return Object(a.d)(t,e),t}(function(){function e(e){this._sourceEvent=e,this.eventPhase=e.eventPhase}return e.prototype.isEventTarget=function(e){return e===this._sourceEvent.target},e.prototype.stopPropagation=function(){this._sourceEvent.stopPropagation()},e.prototype.preventDefault=function(){this._sourceEvent.preventDefault()},e}());function Ue(e,t,n,o){var r=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return n.apply(void 0,Object(a.j)([e],t))},i=function(n){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var c=r.apply(void 0,Object(a.j)([n],i));o(c,n,e(),t)};return i.processCommand=r,i}function qe(e,t,n,o,r){var i=function(t,n){var o,i=Object(a.h)(n),c=i[0],d=i.slice(1),l=c();r(s.apply(void 0,Object(a.j)([(o=t,new Be(o)),l],d)),l,e(),(function(){}))},s=function(e,r){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];if(n(r)){var c=Object(ue.d)(Object(ue.f)(e.key),t),d=o[ue.b[c]];return d?d.handler.apply(d,Object(a.j)([e,r],i)):void 0}},c=Object.keys(o).map((function(e){return{key:e,eventPhase:o[e].phase}})),d=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{onKeyDown:function(t){return i(t,e)},getKeyDownEvents:function(){return c}}};return d.processEvent=s,d}var ze,We,Ge=n(197),Ye=n(167),Ke=n(84),Ze=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.model[this.pointer]){var t=Object(Ke.b)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find((function(e){return e.commentId===t}))}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.model.length&&e&&e.commentFlags&re.f.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&re.f.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),Qe=n(375),Xe=n(88),Je=n(244),$e=n(193),et=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.items[this.pointer]){var t=Xe.i(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(var n=this.pointer;n>=0;--n){var a=this.items[n];if(Object($e.a)(a)&&a.commentModel.commentId===t)return a.commentModel}for(n=this.pointer+1;n<this.items.length;++n){a=this.items[n];if(Object($e.a)(a)&&a.commentModel.commentId===t)return a.commentModel}}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.items.length&&e&&e.commentFlags&Je.a.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&Je.a.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),tt=function(){function e(e,t){this.commentStore=e,this.telemetryVisitor=t}return e.prototype.selectThreadInCurrentContext=function(e,t,n,a,o){return Ae(e,fe.selectComment(t,n,void 0,a?fe.SelectActionType.ExpandCard:fe.SelectActionType.SelectCard,o))},e.prototype.collapseThreadInCurrentContext=function(e,t,n){return Ae(e,fe.collapseCard(t,n))},e.prototype.selectPost=function(e,t,n,a,o){return Ae(e,fe.selectComment(t,n,a,fe.SelectActionType.SelectPost,o))},e.prototype.selectFirstThreadInCurrentContext=function(e,t,n,a,o){if(v.ub()){var r=Te.g(this.commentStore.getState(),!0,a);if(r&&0===r.index)return this.selectThreadInCurrentContext(e,{renderContextType:a,trackback:s.e.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},r.newComment.commentId,!v.sb(),n)}var i=void 0;o?i=new Qe.a(Te.d(this.commentStore.getState()),-1,o).next().value:i=Te.d(this.commentStore.getState())[0];if(i)return this.selectThreadInCurrentContext(e,{renderContextType:a,trackback:s.e.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},i.commentId,t,n)},e.prototype.selectLastThreadInCurrentContext=function(e,t,n,a,o){var r=Te.d(this.commentStore.getState());if(v.ub()){var i=Te.g(this.commentStore.getState(),!0,a);if(i&&i.index===r.length)return this.selectThreadInCurrentContext(e,{renderContextType:a,trackback:s.e.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},i.newComment.commentId,!v.sb(),n)}if(Object(ve.d)(r,o)){var c=new Qe.a(r,r.length,o).previous().value;if(c)return this.selectThreadInCurrentContext(e,{renderContextType:a,trackback:s.e.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},c.commentId,t,n);Object(l.i)().assertConditionTag(!1,"Unable to find last thread",593278812)}},e.prototype.focusAndCollapseSelectedThread=function(e,t,n){var a=Te.p(this.commentStore.getState());if(a){if(v.ub()){var o=Te.g(this.commentStore.getState());if(o&&o.newComment.commentId===a.selectedCardId)return}var r=a.selectionDetails,i=Te.i(this.commentStore.getState());if(v.sb()?Object(De.a)(a.selectedCardId,i,n,Object(ge.h)())===Oe.a.Expanded:!Object(ye.c)(r)||Object(ye.c)(r)&&r.expanded_deprecated){var c={renderContextType:n,trackback:s.e.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor};return Ne(e,ke(e,{componentType:Re.a.Card,id:a.selectedCardId,renderContextType:n}),v.sb()?this.collapseThreadInCurrentContext(e,c,a.selectedCardId):this.selectThreadInCurrentContext(e,c,a.selectedCardId,!1,t))}}},e.prototype.selectNextOrPreviousThread=function(e,t,n,a,o){var r=this.commentStore.getState(),i=Te.p(r);if(v.rb()&&(!i||a===Ee.a.DiscreteIntegrated||a===Ee.a.None&&Ie.e(r)!==H.a.Visible)){if(void 0!==n)return Ae(e,fe.selectContent({renderContextType:a,trackback:s.e.reserveTag(578352064),telemetryVisitor:this.telemetryVisitor},t.direction,t.iterableContentTypes,!!t.restrictToCurrentContext,!!t.restrictToCurrentContext,i?{contentId:i.selectedCardId,contentType:u.b.CommentThread}:void 0,n));Object(l.i)().assertConditionTag(!1,"contentNavigationReason undefined when expecting to use content navigation",560756106)}var c=Te.d(r),d=Te.f(r).nextPopulatedContextDetails;if(void 0!==i){var m=Te.g(r,!0,a),p=void 0;p=v.ub()&&m&&i.selectedCardId===m.newComment.commentId?m.index+(t.direction===x.d.Next?-1:0):this.getSelectedThreadIndex();var f=new Qe.a(c,p,o),C=t.direction===x.d.Next?f.next():f.previous();if(v.ub()&&m&&i.selectedCardId!==m.newComment.commentId)if(t.direction===x.d.Next?p<m.index&&(C.done||f.currentIndex()>=m.index):p>=m.index&&(C.done||f.currentIndex()<m.index))return this.selectThreadInCurrentContext(e,{renderContextType:a,trackback:s.e.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},m.newComment.commentId,!v.sb(),t.source);if(!C.done)return this.selectThreadInCurrentContext(e,{renderContextType:a,trackback:s.e.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},C.value.commentId,t.expandCard,t.source);if(!t.restrictToCurrentContext)return this.selectAcrossContexts(e,t,a,d,o)}else{if(Object(ve.d)(c,o))return this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,a,o);if(!t.restrictToCurrentContext&&d!==Ye.a.NoComments)return this.selectAcrossContexts(e,t,a,d,o)}},e.prototype.selectAcrossContexts=function(e,t,n,a,o){return v.o()&&v.rb()&&!Ie.a(this.commentStore.getState())&&Object(l.i)().assertConditionTag(!1,"This method should only be called if pane is closed, DHCs are on, and content navigation is off.",560551957),t.direction===x.d.Next?a===Ye.a.OnlyCommentsInCurrent?this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,n,o):Ae(e,fe.selectFirstThreadInNextCommentContext({renderContextType:n,trackback:s.e.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):a===Ye.a.OnlyCommentsInCurrent?this.selectLastThreadInCurrentContext(e,t.expandCard,t.source,n,o):Ae(e,fe.selectLastThreadInPreviousCommentContext({renderContextType:n,trackback:s.e.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor}))},e.prototype.selectNextPost=function(e,t,n){var a;if(v.b()){if(n){var o=new et(n,this.getSelectedIndexFromRenderableItems(n),t===Ee.a.DiscreteIntegrated).next();if(!o.done)return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278850),telemetryVisitor:this.telemetryVisitor},Xe.i(o.value),Xe.e(o.value),Ce.a.SharedComments);if(v.rb()&&t===Ee.a.DiscreteIntegrated){var r=Te.p(this.commentStore.getState());p=r?{contentId:r.selectedCardId,contentType:u.b.CommentThread}:void 0;return Ae(e,fe.selectContent({renderContextType:t,trackback:s.e.reserveTag(593278851),telemetryVisitor:this.telemetryVisitor},x.d.Next,void 0,!0,!0,p,x.c.Keyboarding))}var i=new Qe.a(Te.d(this.commentStore.getState()),this.getSelectedThreadIndex(),t===Ee.a.DiscreteIntegrated).next();return i.done?void 0:this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278852),telemetryVisitor:this.telemetryVisitor},Object(Ke.b)(i.value),i.value.commentId,Ce.a.SharedComments)}Object(l.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278849)}else{var c=new Ze(Te.d(this.commentStore.getState()),this.getSelectedIndex(),t===Ee.a.DiscreteIntegrated).next();if(!c.done){var d=null===(a=Te.p(this.commentStore.getState()))||void 0===a?void 0:a.selectedCardId,m=Object(Ke.b)(c.value);if(v.rb()&&t===Ee.a.DiscreteIntegrated&&d!==m){var p=d?{contentId:d,contentType:u.b.CommentThread}:void 0;return Ae(e,fe.selectContent({renderContextType:t,trackback:s.e.reserveTag(593278819),telemetryVisitor:this.telemetryVisitor},x.d.Next,void 0,!0,!0,p,x.c.Keyboarding))}return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278848),telemetryVisitor:this.telemetryVisitor},m,c.value.commentId,Ce.a.SharedComments)}}},e.prototype.selectNextPostWithinCard=function(e,t,n){if(void 0!==Te.p(this.commentStore.getState())){if(!v.b()){var a=Te.d(this.commentStore.getState()),o=this.getSelectedIndex(),r=new Ze(a,o).next(),i=a[o];return!r.done&&r.value.parentId&&r.value.parentId===Object(Ke.b)(i)?this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},r.value.parentId,r.value.commentId,Ce.a.SharedComments):void 0}if(n){var c=this.getSelectedIndexFromRenderableItems(n);if(!(c<0)){var d=new et(n,c).next(),m=n[c],u=Xe.i(m);return d.done||Xe.i(d.value)!==u?void 0:this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},Xe.i(d.value),Xe.e(d.value),Ce.a.SharedComments)}Object(l.i)().assertConditionTag(!1,"Selection not found in renderableItems",571777352)}else Object(l.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278855)}else Object(l.i)().assertConditionTag(!1,"Expected selectedComment",593278853)},e.prototype.selectPreviousPostWithinCard=function(e,t,n){if(void 0!==Te.p(this.commentStore.getState()))if(v.b())if(n){var a=this.getSelectedIndexFromRenderableItems(n);if(a<0)Object(l.i)().assertConditionTag(!1,"Selection not found in renderableItems",571777353);else{var o=n[a],r=Xe.g(o);if(r)if(!(i=new et(n,a).previous()).done&&Xe.i(i.value)===r)return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},Xe.i(i.value),Xe.e(i.value),Ce.a.SharedComments)}}else Object(l.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278859);else{var i,c=Te.d(this.commentStore.getState()),d=this.getSelectedIndex(),m=c[d];if(m.parentId&&!(i=new Ze(c,d).previous()).done&&Object(Ke.b)(i.value)===m.parentId)return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},Object(Ke.b)(i.value),i.value.commentId,Ce.a.SharedComments)}else Object(l.i)().assertConditionTag(!1,"Expected selectedComment",593278857)},e.prototype.selectRootPostOfSelectedThread=function(e,t){var n=Te.p(this.commentStore.getState());if(n&&Object(ye.c)(n.selectionDetails)){var a=this.getSelectedIndex(),o=Te.d(this.commentStore.getState())[a];return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},o.commentId,o.commentId,Ce.a.SharedComments)}},e.prototype.focusAndSelectSiblingThread=function(e,t){if(!(t<0)){var n,a=Te.d(this.commentStore.getState()).filter((function(e){return!e.parentId}));if(0!==a.length)if(!(t-1<0&&t+1>=a.length))return n=t-1>=0?t-1:t+1,Ne(void 0,ke(void 0,{componentType:Re.a.Card,id:a[n].commentId,renderContextType:e}),Ae(void 0,fe.selectComment({renderContextType:e,trackback:s.e.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},a[n].commentId,void 0,fe.SelectActionType.SelectCard,Ce.a.SharedComments)))}},e.prototype.getSelectedIndex=function(){return Object(ve.p)(Te.d(this.commentStore.getState()),Te.p(this.commentStore.getState()))},e.prototype.getSelectedThreadIndex=function(){var e=this.commentStore.getState();return Object(ve.L)(Te.d(e),Te.p(e))},e.prototype.getSelectedIndexFromRenderableItems=function(e){var t=Te.p(this.commentStore.getState());if(!t)return-1;var n=Object(ye.b)(t);return e.findIndex((function(e){return Object($e.a)(e)?e.commentModel.commentId===n:e.historyItem.records[0].recordId===n}))},e}(),nt=function(){function e(e,t){var n,a,o,r=this;this.isRTL=e,this.telemetryVisitor=t,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecutor=(n=50,a=[je.FocusComponent],(o=function(e,t,r,i){if(!a||!e||-1===a.indexOf(e.type)||3===e.priorityArgs.priority)return e&&-1!==(null==a?void 0:a.indexOf(e.type))&&(pe.a&&(null==e?void 0:e.type)===je.FocusComponent&&Object(s.j)("Executing non-debounced focus command "+JSON.stringify(e)),void 0!==o.pendingCommand&&clearTimeout(o.pendingCommand),o.pendingCommand=void 0),void i(e,Me(e,t,r));void 0!==o.pendingCommand&&clearTimeout(o.pendingCommand),pe.a&&e.type===je.FocusComponent&&Object(s.j)("Caching debounced command "+JSON.stringify(e)),o.pendingCommand=setTimeout((function(){pe.a&&e.type===je.FocusComponent&&Object(s.j)("Executing debounced command "+JSON.stringify(e)),i(e,Me(e,t,r)),o.pendingCommand=void 0}),n)}).pendingCommand=void 0,o),this.pendingOnComponentFocusedRequest=void 0,this.clearPendingOnComponentFocusedRequest=function(){r.pendingOnComponentFocusedRequest&&(pe.a&&Object(s.j)("Pending component focused request cleared."),clearTimeout(r.pendingOnComponentFocusedRequest.token),r.pendingOnComponentFocusedRequest=void 0)},this.commandExecuteCallback=function(e,t){e&&Pe(e)&&(t===ae.ShouldRetry?r.focusToRetry={command:e,timestamp:Date.now()}:t===ae.Handled&&(r.focusToRetry=void 0,r.clearPendingOnComponentFocusedRequest()))},this.commentContentsKeyDown=qe((function(){return r.commentStore}),this.isRTL,(function(e){var t=Te.h(r.commentStore.getState());if(v.ub()){var n=Object(ve.I)(t);if(n&&e.isFocusOnOrWithin({componentType:Re.a.CardEditor,id:n,renderContextType:t.drafts[t.cardIdToDraftIdMap[n]].renderContextType}))return!1;var a=Object(ve.J)(t);if(a&&e.isFocusOnOrWithin({componentType:Re.a.PostEditor,id:a,renderContextType:t.drafts[t.postIdToDraftIdMap[a]].renderContextType}))return!1}else if(Object(ge.c)(t))return!1;return!e.isFocusOn({componentType:Re.a.GhostCard})&&!e.isFocusOn({componentType:Re.a.NewCommentButton})}),{ArrowDown:{handler:function(e,t,n){var a=r.onDownKey(e,t,n?n():void 0);return a&&(a.stopPropagation=!0,a.preventDefault=!0),a},phase:ue.a.Bubbling},ArrowUp:{handler:function(e,t,n){var a=r.onUpKey(e,t,n?n():void 0);return a&&(a.stopPropagation=!0,a.preventDefault=!0),a},phase:ue.a.Bubbling},ArrowRight:{handler:function(e,t,n){if(!v.sb()||Object(_e.b)(t)!==Ee.a.HalfPane){var a=r.onRightKey(e,t,n?n():void 0);return a&&(a.stopPropagation=!0,a.preventDefault=!0),a}},phase:ue.a.Bubbling},ArrowLeft:{handler:function(e,t){if(!v.sb()||Object(_e.b)(t)!==Ee.a.HalfPane){var n=r.onLeftKey(e,Object(_e.b)(t));return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:ue.a.Bubbling},Home:{handler:function(e,t){if(Object(_e.b)(t)===Ee.a.FullPane){var n=r.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,Ce.a.SharedComments,Object(_e.b)(t),!1);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:ue.a.Capturing},End:{handler:function(e,t){if(Object(_e.b)(t)===Ee.a.FullPane){var n=r.selectionCommandFactory.selectLastThreadInCurrentContext(e,!0,Ce.a.SharedComments,Object(_e.b)(t),!1);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:ue.a.Capturing},F12:{handler:function(e,t){var n=r.handleMoveFocusEvent(e,t);return n&&(n.stopPropagation=!0),n},phase:ue.a.None}},this.commandExecutor),this.focusCommentCardCommand=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e,t){var n=Te.h(r.commentStore.getState()),a=Object(ve.K)(n),o=void 0;return(o=r.checkForRetryOfEditorFocus(e,n))||!v.ub()&&(null==a?void 0:a.threadId)===t&&(o=r.checkForActiveEditorFocus(void 0,Object(_e.b)(e),n))?o:ke(void 0,{componentType:Object(Ve.b)(t,Te.g(r.commentStore.getState())),id:t,renderContextType:Object(_e.b)(e)},{priorityArgs:{priority:1},preventScroll:Object(_e.b)(e)===Ee.a.DiscreteIntegrated})}),this.commandExecutor),this.focusCommentPostCommand=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e,t){var n=Te.h(r.commentStore.getState());if(!v.ub()&&n.postIdToDraftIdMap[t]){var a=r.checkForActiveEditorFocus(void 0,Object(_e.b)(e),n);if(a)return a}return ke(void 0,{componentType:Re.a.Post,id:t,renderContextType:Object(_e.b)(e)},{priorityArgs:{priority:2,phase:1}})}),this.commandExecutor),this.focusCommentPaneCommand=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e){if(Object(we.b)(Object(_e.b)(e))){var t=Te.h(r.commentStore.getState()),n=Te.p(r.commentStore.getState()),a=void 0;if(a=r.checkForRetryOfEditorFocus(e,t))return a;if(!v.ub()&&(a=r.checkForActiveEditorFocus(void 0,Object(_e.b)(e),t)))return a;if(a=r.checkForCommentSelectionFocus(Object(_e.b)(e),n,Te.g(r.commentStore.getState())))return a;if(!v.H()&&!e.getComponent(Re.a.ClosePaneButton)){var o=Te.d(r.commentStore.getState());return o.length>0?r.focusCommentCardCommand.processCommand(e,o[0].commentId):void Object(l.i)().assertConditionTag("win32"===Object(xe.a)()||"ios"===Object(xe.a)()&&Object(_e.b)(e)===Ee.a.FullPane,"Shouldn't be reached on current config",575239243)}return He(e,r.commentStore)}Object(l.i)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242)}),this.commandExecutor),this.focusActiveEditorCommand_deprecated=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e){var t=Te.h(r.commentStore.getState());return r.checkForActiveEditorFocus(void 0,Object(_e.b)(e),t)}),this.commandExecutor),this.commentCardMounted=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e,t){var n,a={componentType:Object(Ve.b)(t.id,Te.g(r.commentStore.getState())),id:t.id,renderContextType:Object(_e.b)(e)};if(n=r.handleFocusRetry(e,a,Te.h(r.commentStore.getState()),1))return n;if(t.selected&&!e.isFocusWithin(a)){var o=Object(we.b)(Object(_e.b)(e));if((!o||e.isFocusWithinPane())&&(o||e.isFocusWithinAny(Re.a.Card)||e.isFocusWithinAny(Re.a.DraftCard)))return r.focusCommentCardCommand.processCommand(e,t.id)}}),this.commandExecutor),this.commentCardEditorMounted=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e,t){return r.handleFocusRetry(e,{componentType:Re.a.CardEditor,id:t,renderContextType:Object(_e.b)(e)},Te.h(r.commentStore.getState()),1)}),this.commandExecutor),this.commentPostMounted=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e,t){return r.handleFocusRetry(e,{componentType:Re.a.Post,id:t,renderContextType:Object(_e.b)(e)},Te.h(r.commentStore.getState()),1)}),this.commandExecutor),this.commentPostEditorMounted=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e,t){return r.handleFocusRetry(e,{componentType:Re.a.PostEditor,id:t,renderContextType:Object(_e.b)(e)},Te.h(r.commentStore.getState()),1)}),this.commandExecutor),this.commentPanePropsUpdated=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e,t,n){var a=void 0;if(a=r.checkForRetryCommandOnPropsUpdated(e,n.draftState,!1))return a;var o=t.draftState,i=n.draftState,s=t.selectedCommentInfo&&t.selectedCommentInfo.selectedComment,c=n.selectedCommentInfo&&n.selectedCommentInfo.selectedComment;return(a=r.checkForDiscard(e,o,i,s,c))||(a=r.checkForHalfPaneFullTransition(e,t,n))?a:e.isFocusWithinPane()?(a=r.checkForLowFidelityWarning(e,s,c))||(a=r.checkForSelectionChange(e,i,s,c))||(a=r.checkForCardPendingChange(e,t.cardViewStates,n.cardViewStates,n.createdCommentLie))||(a=r.checkForReplyFinished(e,c,t.draftState,n.draftState,c&&n.cardViewStates[c.selectedCardId]))?a:r.checkForLowFidelityWarning(e,s,c):void 0}),this.commandExecutor),this.discreteCommentCardRootRefMounted=function(e){},this.discreteCommentCardPropsUpdated=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e,t,n){var a=void 0;return(a=r.checkForRetryCommandOnDiscreteCardPropsUpdated(e,n))||(a=r.checkForDiscard(e,t.draftState,n.draftState,t.selectedState,n.selectedState))?a:e.isFocusWithinAny(Re.a.Card)||e.isFocusWithinAny(Re.a.DraftCard)?r.shouldFocusFromCardPendingStateChange(t.cardState,n.cardState)?ke(void 0,{renderContextType:Object(_e.b)(e),componentType:Object(Ve.b)(n.isDraftThread),id:n.threadId}):(a=r.checkForLowFidelityWarning(e,t.selectedState,n.selectedState))||(a=r.checkForSelectionChange(e,n.draftState,t.selectedState,n.selectedState))||(a=r.checkForReplyFinished(e,n.selectedState,t.draftState,n.draftState,n.cardState))?a:r.checkForLowFidelityWarning(e,t.selectedState,n.selectedState):void 0}),this.commandExecutor),this.paneContainerKeyDown=qe((function(){return r.commentStore}),this.isRTL,(function(e){return!!Object(we.b)(Object(_e.b)(e))||(Object(l.i)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1)}),{Escape:{handler:function(e,t){return Ae(e,fe.requestClosePane({renderContextType:Object(_e.b)(t),trackback:s.e.reserveTag(575239245),telemetryVisitor:r.telemetryVisitor}))},phase:ue.a.Capturing},Tab:{handler:function(e,t){return r.paneContainerTabHandling(e,t)},phase:ue.a.None}},this.commandExecutor),this.commentEditorKeyDown=qe((function(){return r.commentStore}),this.isRTL,(function(){return!0}),{F12:{handler:function(e,t){var n=r.handleMoveFocusEvent(e,t);return n&&(n.stopPropagation=!0),n},phase:ue.a.None}},this.commandExecutor),this.onUserAction=Ue((function(){return r.commentStore}),this.commandExecuteCallback,(function(e,t){var n;switch(t.userAction){case Ge.a.RequestNewCommentFromHost:if(!Object(we.b)(Object(_e.b)(e)))return;return He(e,r.commentStore);case Ge.a.CancelReplyDraft:return ke(void 0,{componentType:Re.a.Card,id:t.cardId,renderContextType:Object(_e.b)(e)});case Ge.a.DeleteThread:case Ge.a.CancelNewThreadDraft:if(!Object(we.b)(Object(_e.b)(e)))return;if(Object(_e.b)(e)===Ee.a.HalfPane&&t.userAction===Ge.a.CancelNewThreadDraft)return;return null!==(n=He(e,r.commentStore,{priority:3,phase:0}))&&void 0!==n?n:r.selectionCommandFactory.focusAndSelectSiblingThread(Object(_e.b)(e),t.threadIndex);case Ge.a.ResolveThread:if("android"!==Object(xe.a)()&&"ios"!==Object(xe.a)())return;return ke(void 0,{componentType:Re.a.ReopenThreadButton,id:t.cardId,renderContextType:Object(_e.b)(e)},{priorityArgs:{priority:2,phase:3}});default:Object(s.n)(t)}}),this.commandExecutor)}return e.prototype.postOnComponentFocusedRequest=function(e){this.clearPendingOnComponentFocusedRequest();var t=setTimeout(e,500);this.pendingOnComponentFocusedRequest={callback:e,token:t}},e.prototype.initialize=function(e,t){if(this._commentStore)throw new M.a("FocusManager already initialized",s.e.reserveTag(575239239),-2130957489);this._commentStore=e,this.selectionCommandFactory=null!=t?t:new tt(e,this.telemetryVisitor)},Object.defineProperty(e.prototype,"commentStore",{get:function(){if(!this._commentStore)throw new M.a("FocusManager not initialized",s.e.reserveTag(575239240),-2130957490);return this._commentStore},enumerable:!1,configurable:!0}),e.prototype.setDeferredActiveEditorFocusCommand=function(e){this.draftToFocus={draftId:e,timestamp:Date.now(),isPendingSetFocus:!0}},e.prototype.handleFocusRetry=function(e,t,n,a){var o;if(o=this.checkForRetryOfEditorFocus(e,n))return o;if(this.focusToRetry&&t&&this.shouldRetryFocusForPhase(this.focusToRetry,a)){var r=Date.now()-this.focusToRetry.timestamp;if(r>15e3)return Object(l.i)().assertConditionTag(!1,"Took too long to mount component for focus retry: "+r+" ms",575239241),void(this.focusToRetry=void 0);var i=this.focusToRetry.command.component;if(Object(Re.b)(i,t)){var s=this.focusToRetry.command;return this.focusToRetry=void 0,s}}},e.prototype.shouldArrowNavigatePosts=function(e,t,n){if(v.sb()?Object(De.a)(e.selectedCardId,t,Object(_e.b)(n),Object(ge.h)())===Oe.a.Collapsed:Object(ye.c)(e.selectionDetails)&&!e.selectionDetails.expanded_deprecated)return!1;var a=Te.g(this.commentStore.getState());if(e.selectedCardId===(null==a?void 0:a.newComment.commentId))return!1;var o={componentType:Re.a.Post,id:Object(ye.b)(e),renderContextType:Object(_e.b)(n)};return n.isFocusOnOrWithin(o)},e.prototype.onDownKey=function(e,t,n){if(Te.d(this.commentStore.getState()).length){var a=v.o()&&!Ie.a(this.commentStore.getState()),o=Te.p(this.commentStore.getState()),r=Te.i(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,r,t)){if(Object(_e.b)(t)===Ee.a.DiscreteIsolated)return;var i={direction:x.d.Next,source:Ce.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,x.c.Keyboarding,Object(_e.b)(t),a)}return this.selectionCommandFactory.selectNextPostWithinCard(e,Object(_e.b)(t),n)}if(Object(_e.b)(t)!==Ee.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,Ce.a.SharedComments,Object(_e.b)(t),a);Object(l.i)().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249)}},e.prototype.onUpKey=function(e,t,n){if(Te.d(this.commentStore.getState()).length){var a=v.o()&&!Ie.a(this.commentStore.getState()),o=Te.p(this.commentStore.getState()),r=Te.i(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,r,t)){if(Object(_e.b)(t)===Ee.a.DiscreteIsolated)return;var i={direction:x.d.Previous,source:Ce.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,x.c.Keyboarding,Object(_e.b)(t),a)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,Object(_e.b)(t),n)}if(Object(_e.b)(t)!==Ee.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,Ce.a.SharedComments,Object(_e.b)(t),a);Object(l.i)().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250)}},e.prototype.onRightKey=function(e,t,n){if(Te.d(this.commentStore.getState()).length){var a=Te.p(this.commentStore.getState());if(v.ub()){var o=Te.g(this.commentStore.getState());if(a&&o&&a.selectedCardId===o.newComment.commentId)return}var r=this.selectionCommandFactory.selectRootPostOfSelectedThread(e,Object(_e.b)(t));return r||(a&&!Object(ye.c)(a.selectionDetails)&&t.isFocusOn({componentType:Re.a.Card,id:a.selectedCardId,renderContextType:Object(_e.b)(t)})&&(r=this.focusCommentPostCommand.processCommand(t,a.selectionDetails.selectedPostId)),r||(Object(_e.b)(t)===Ee.a.DiscreteIsolated?this.selectionCommandFactory.selectNextPostWithinCard(e,Object(_e.b)(t),n):this.selectionCommandFactory.selectNextPost(e,Object(_e.b)(t),n)))}},e.prototype.onLeftKey=function(e,t){if(Te.d(this.commentStore.getState()).length)return this.selectionCommandFactory.focusAndCollapseSelectedThread(e,Ce.a.SharedComments,t)},e.prototype.onTabKeyInPane=function(e,t){return void 0===Te.p(this.commentStore.getState())&&Te.d(this.commentStore.getState()).length>0?this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,Ce.a.SharedComments,t,!1):v.ub()?void 0:this.checkForActiveEditorFocus(e,t,Te.h(this.commentStore.getState()))},e.prototype.isDraftInOtherContext=function(){var e=Te.r(this.commentStore.getState());return e&&!e.isInCurrentContext},e.prototype.logEditorRetryError=function(e,t,n){var o,r,i;null===(r=(o=Object(l.i)()).logDiagnosticTrace)||void 0===r||r.call(o,Object(c.q)(ze||(ze=Object(a.f)(["CommentsEditorFocusRetry"],["CommentsEditorFocusRetry"]))),n,l.h.Info,l.c.ProductServiceUsage,this.telemetryVisitor,Object(l.l)("RenderContextType",Object(_e.b)(t),l.d.SystemMetadata),Object(l.l)("IsDraftInCurrentContext",!!e&&e.isInCurrentContext,l.d.SystemMetadata),Object(l.l)("DraftRenderContextType",null!==(i=null==e?void 0:e.renderContextType)&&void 0!==i?i:Ee.a.None,l.d.SystemMetadata))},e.prototype.checkForRetryOfEditorFocus=function(e,t){var n=this;if(void 0!==this.draftToFocus){if(!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:je.PreserveFocus,priorityArgs:{priority:1}};var o=t.drafts[this.draftToFocus.draftId],r=Date.now()-this.draftToFocus.timestamp;if(r>15e3)return Object(l.i)().assertConditionTag(!1,"Took too long to focus draft editor: "+r+" ms, expected draft still exists: "+!!o,575239251),this.draftToFocus=void 0,void this.logEditorRetryError(o,e,s.e.reserveTag(556607431));if(o&&o.renderContextType===Object(_e.b)(e)){var i=this.checkForActiveEditorFocus(void 0,Object(_e.b)(e),t,{priority:3,phase:0});if(i&&Object(_e.a)(e,i.component))return this.draftToFocus=Object(a.a)(Object(a.a)({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout((function(){return n.draftToFocus=void 0})),this.clearPendingOnComponentFocusedRequest(),i;this.logEditorRetryError(o,e,s.e.reserveTag(556794947))}else this.logEditorRetryError(o,e,s.e.reserveTag(556794945))}},e.prototype.checkForActiveEditorFocus=function(e,t,n,a){if(void 0===a&&(a={priority:1}),!this.isDraftInOtherContext()){var o=Object(ve.J)(n);if(o)return ke(e,{componentType:Re.a.PostEditor,id:o,renderContextType:t},{priorityArgs:a});var r=Object(ve.I)(n);return r?ke(e,{componentType:Re.a.CardEditor,id:r,renderContextType:t},{priorityArgs:a}):void 0}},e.prototype.handleMoveFocusEvent=function(e,t){if(e.altKey){var n=Te.p(this.commentStore.getState()),a=n?{contentId:null==n?void 0:n.selectedCardId,contentType:u.b.CommentThread}:void 0;return Ae(e,fe.moveFocusToCanvas({renderContextType:Object(_e.b)(t),trackback:s.e.reserveTag(575239252),telemetryVisitor:this.telemetryVisitor},a))}},e.prototype.checkForCommentSelectionFocus=function(e,t,n){if(v.ub()||!this.isDraftInOtherContext())return t&&t.selectedCardId?ke(void 0,{componentType:Object(Ve.b)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e},{priorityArgs:{priority:2,phase:1}}):void 0},e.prototype.checkForDiscard=function(e,t,n,a,o){if("web"!==Object(xe.a)()&&a&&o){var r=a.selectionDetails,i=o.selectionDetails;if(Object(ge.j)(t)&&!Object(ge.c)(n))return this.focusCommentCardCommand.processCommand(e,o.selectedCardId);if(Object(ye.c)(r)===Object(ye.c)(i)&&a.selectedCardId===o.selectedCardId&&Object(ge.m)(t,n)){if(Object(ye.c)(r)||Object(ye.c)(i))return ke(void 0,{componentType:Re.a.CardEditor,id:o.selectedCardId,renderContextType:Object(_e.b)(e)},{priorityArgs:{priority:3,phase:1}});if(r.selectedPostId===i.selectedPostId)return ke(void 0,{componentType:Re.a.PostEditor,id:i.selectedPostId,renderContextType:Object(_e.b)(e)},{priorityArgs:{priority:3,phase:1}})}}},e.prototype.paneContainerTabHandling=function(e,t){if("win32"!==Object(xe.a)()){var n=this.commentStore.getState(),a=Object(ve.N)(Te.l(n),Te.u(n));if(!Object(he.a)({commentData:Te.d(n),pendingCommentLoad:Te.m(n),virtualized:a}))return(c=ke(e,{componentType:Re.a.ClosePaneButton})).stopPropagation=!0,c.preventDefault=!0,c;var o=t.getComponent(Re.a.ClosePaneButton),r=t.getComponent(Re.a.NewCommentButton),i=!v.o()&&Object(ge.c)(Te.h(n))||!r?o:r;if(v.l()){var s=Te.p(n),c=void 0;return s?v.ub()||t.isFocusWithin({componentType:Object(Ve.b)(s.selectedCardId,Te.g(this.commentStore.getState())),id:s.selectedCardId,renderContextType:Object(_e.b)(t)})||(c=this.checkForActiveEditorFocus(e,Object(_e.b)(t),Te.h(n))):i&&e.isEventTarget(i)&&!e.shiftKey&&(c=this.onTabKeyInPane(e,Object(_e.b)(t))),c&&(c.stopPropagation=!0,c.preventDefault=!0),c}if(o&&e.isEventTarget(o)&&e.shiftKey)return(c=this.onTabKeyInPane(e,Object(_e.b)(t)))&&(c.preventDefault=!0,c.stopPropagation=!0),c;if(i&&e.isEventTarget(i)&&!e.shiftKey)return(c=this.onTabKeyInPane(e,Object(_e.b)(t)))&&(c.preventDefault=!0,c.stopPropagation=!0),c}},e.prototype.checkForSelectionChange=function(e,t,n,a){if(a&&((!n||Object(ye.b)(n)!==Object(ye.b)(a)||Object(ye.c)(n.selectionDetails)!==Object(ye.c)(a.selectionDetails))&&(this.clearPendingOnComponentFocusedRequest(),(v.ub()||!Object(ge.d)(t))&&!e.isFocusOn({componentType:Re.a.NextCommentButton})&&!e.isFocusOn({componentType:Re.a.PreviousCommentButton})))){if(Object(ye.c)(a.selectionDetails)){if(e.isFocusOnOrWithin({componentType:Re.a.CardEditor,id:a.selectedCardId,renderContextType:Object(_e.b)(e)}))return;return this.focusCommentCardCommand.processCommand(e,a.selectedCardId)}if(!e.isFocusOnOrWithin({componentType:v.nb()?Re.a.Post:Re.a.PostEditor,id:a.selectionDetails.selectedPostId,renderContextType:Object(_e.b)(e)}))return this.focusCommentPostCommand.processCommand(e,a.selectionDetails.selectedPostId)}},e.prototype.checkForReplyFinished=function(e,t,n,a,o){var r=Object(ve.I)(n),i=Object(ve.I)(a);if(o&&o.pending!==be.a.Editor)return r&&!i&&(null==t?void 0:t.selectedCardId)===r&&e.isFocusWithin({componentType:Re.a.Card,id:r,renderContextType:Object(_e.b)(e)})?this.focusCommentCardCommand.processCommand(e,r):void 0},e.prototype.checkForHalfPaneFullTransition=function(e,t,n){if(Object(_e.b)(e)===Ee.a.HalfPane&&Object(r.i)(n.displayConfigurationState)&&n.displayConfigurationState.displayMode===r.e.Normal&&(!Object(r.i)(t.displayConfigurationState)||t.displayConfigurationState.displayMode===r.e.Variable))return ke(void 0,{componentType:Re.a.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(e,t){return!!e&&(e.pending!==t.pending&&t.pending!==be.a.Editor)},e.prototype.checkForCardPendingChange=function(e,t,n,a){var o=this,r=Object.entries(n).find((function(e){var n=t[e[0]];return o.shouldFocusFromCardPendingStateChange(n,e[1])}));if(r)return ke(void 0,{renderContextType:Object(_e.b)(e),componentType:Object(Ve.b)(r[0],a),id:r[0]})},e.prototype.checkForRetryCommandOnPropsUpdated=function(e,t,n){var a=!n&&this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&Object(_e.a)(e,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(e,a,t,2)},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(e,t){var n=this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&(!Object(Re.c)(this.focusToRetry.command.component)||!Object(Re.d)(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===t.threadId),a=this.draftToFocus&&(t.cardRelativeDraftingState===Se.a.InCard||t.cardRelativeDraftingState===Se.a.InChildPost);if(n||a)return this.checkForRetryCommandOnPropsUpdated(e,t.draftState,!n)},e.prototype.checkForLowFidelityWarning=function(e,t,n){if(n&&(v.l()?Object(ye.i)(n):Object(ye.h)(n))){var a=t?Object(ye.b)(t):void 0,o=Object(ye.b)(n);if(o!==a||n.selectionDetails.lowFidelityWarningType!==(null==t?void 0:t.selectionDetails.lowFidelityWarningType))return ke(void 0,{componentType:Re.a.Post,renderContextType:Object(_e.b)(e),id:o})}},e.prototype.shouldRetryFocusForPhase=function(e,t){return 1!==e.command.priorityArgs.priority&&0!=(e.command.priorityArgs.phase&t)},e}(),at=n(151),ot=n(585),rt=function(){return function(e){return function(t){return Object(O.unstable_batchedUpdates)((function(){return e(t)}))}}},it=function(){return function(e){return function(t){var n="string"==typeof t.type?t.type:t.name||"Unknown Action",a=Object(s.l)(s.c.Redux,n),o=e(t);return null==a||a.end(),o}}},st=n(367),ct=n(138),dt=n(114),lt=n(427),mt=n(152),ut=n(230),pt=n(343);!function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.UIAAnnotationPattern=256]="UIAAnnotationPattern"}(We||(We={}));var ft=n(369),Ct=n(102);var ht,vt=n(653),bt={parentId:"",commentId:"",author:{UserId:"",Provider:"",DisplayName:"",Email:void 0,IsCurrentUser:void 0},anchorHintText:"",commentFlags:0,commentBody:(ht=new vt.a,ht.insert(""),ht.toJSON())};function gt(e,t){for(var n=null==t?void 0:t(),a=[],o=0,r=void 0;o<e.length;){if(e[o].type===Ct.a.Thread){var i=e[o].id;r=i,a.push(yt(i,void 0,n))}else a.push(yt(e[o].id,r,n));o++}return a}function yt(e,t,n){var o=void 0;n&&(o=n.commentData.find((function(t){return t.commentId===e})));return o||Object(a.a)(Object(a.a)({},bt),{commentId:e,parentId:t||""})}var Tt,It,Ot=n(595),St=n(596),jt=n(526);function Et(e,t,n,o){var r,i;if(Object(ge.e)(t)<Object(ge.e)(e)){if(!v.n()){var d=Object(l.i)().createActivityObject("SilentDiscardOnMerge",Object(l.j)(l.g.GlobalAPI),l.a.None,l.b.NecessaryServiceDataEvent);return d.addDataField("DiscardReason",n,l.d.SystemMetadata),d.addDataField("MergeSource",o,l.d.SystemMetadata),void d.successTag(592007882)}null===(i=(r=Object(l.i)()).logDiagnosticTrace)||void 0===i||i.call(r,Object(c.q)(Tt||(Tt=Object(a.f)(["SilentDiscardOnMerge"],["SilentDiscardOnMerge"]))),s.e.reserveTag(545630305),St.a.Info,Ot.a.ProductServiceUsage,Object(l.j)(l.g.GlobalAPI),Object(jt.b)("MergeSource",o,l.d.SystemMetadata),Object(jt.b)("DiscardReason",n,l.d.SystemMetadata))}}function Dt(e,t,n){var o,r;if(Object(ge.e)(t)<Object(ge.e)(e)){if(!v.n()){var i=Object(l.i)().createActivityObject("SilentDiscardOnViewChange",Object(l.j)(l.g.GlobalAPI),l.a.None,l.b.NecessaryServiceDataEvent);return i.addDataField("ViewChangeSource",n,l.d.SystemMetadata),void i.successTag(591661013)}null===(r=(o=Object(l.i)()).logDiagnosticTrace)||void 0===r||r.call(o,Object(c.q)(It||(It=Object(a.f)(["SilentDiscardOnViewChange"],["SilentDiscardOnViewChange"]))),s.e.reserveTag(545630306),St.a.Info,Ot.a.ProductServiceUsage,Object(l.j)(l.g.GlobalAPI),Object(jt.b)("ViewChangeSource",n,l.d.SystemMetadata))}}function xt(e,t,n){if(v.E()){var a=Object(l.i)().createActivityObject("MarkCommentCreation",n,l.a.None,l.b.NecessaryServiceDataEvent);a.addDataField("DraftId",e,l.d.SystemMetadata),a.addDataField("CommentId",t,l.d.SystemMetadata),a.addDocumentMetadata(l.f.Basic),a.successTag(591152859)}}var wt=n(290);function At(e,t,n,o){if(v.b()){var r=Object(a.a)({},e),i=Object(a.a)({},t),s=!1,c=!1,d=!1;if(n.changes.forEach((function(n){var m,u,p,f,C,h,v,b;if(n.type!==ct.d.Unknown){var g=n.model.commentId;switch(n.type){case ct.d.Delete:if(delete r[g],void 0!==e[g])if(Object.keys(e).includes(g)){c=!0;try{for(var y=Object(a.l)(e[g].history),T=y.next();!T.done;T=y.next()){var I=T.value;try{for(var O=(p=void 0,Object(a.l)(I.records)),S=O.next();!S.done;S=O.next()){var j=S.value;delete i[j.recordId]}}catch(e){p={error:e}}finally{try{S&&!S.done&&(f=O.return)&&f.call(O)}finally{if(p)throw p.error}}}}catch(e){m={error:e}}finally{try{T&&!T.done&&(u=y.return)&&u.call(y)}finally{if(m)throw m.error}}}break;case ct.d.Load:case ct.d.Insert:case ct.d.Modify:Object(l.i)().assertConditionTag(n.type===ct.d.Modify||!r[n.model.commentId],"Task should not already be populated on initial load",554836097);var E=n.task;if(E){if(!function(e){return 0===e.history.length||e.history[0].records.length>0&&e.history[0].records[0].type===wt.a.Create}(E))return void Object(l.i)().assertConditionTag(!1,"Invalid task payload - dropping task data",554836098);0===E.history.length&&(d=!0);try{for(var D=Object(a.l)(E.history),x=D.next();!x.done;x=D.next()){I=x.value;try{for(var w=(v=void 0,Object(a.l)(I.records)),A=w.next();!A.done;A=w.next()){j=A.value;t[j.recordId]||(s=!0,i[j.recordId]=Object(ve.o)(Object(ve.j)(j.time,void 0,o.dataCulture)))}}catch(e){v={error:e}}finally{try{A&&!A.done&&(b=w.return)&&b.call(w)}finally{if(v)throw v.error}}}}catch(e){C={error:e}}finally{try{x&&!x.done&&(h=D.return)&&h.call(D)}finally{if(C)throw C.error}}r[g]=E}else if(""===n.model.parentId&&r[g]){r[g].history.forEach((function(e){return e.records.forEach((function(e){return delete i[e.recordId]}))})),delete r[g],c=!0}}}else Object(l.i)().assertConditionTag(!1,"Unknown change type",554836096)})),c||s||d)return{updatedTasks:r,updatedHistoryRecordViewState:i}}}function Pt(e){if(e){var t={};if(void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length)return t}}var kt=n(146),Rt=n(296),Nt=n(501),Mt=n(370),Vt=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e[n]);return t};function _t(e){return Ht(Object(Re.c)(e)?Object(Ve.a)(e):Object(Ve.c)(e.componentType))}function Ft(e){var t=document.activeElement;return!!e&&t===e}function Lt(e,t){var n=document.activeElement,a=t!==Re.a.CardEditor&&t!==Re.a.PostEditor;return!!e&&(n&&e.contains(n)||a&&function(e){return e===document.body||null===e||0===Object.keys(e).length}(n))}function Ht(e){var t=document.getElementById(e);return null!=t?t:void 0}var Bt=function(){function e(e,t,n){this.renderContextType=e,this.contextIdentifier=t,this.componentTreeId={renderContextType:e,contextIdentifier:t}}return e.prototype.getComponent=function(e){return Ht(Object(Ve.c)(e))},e.prototype.getComponentById=function(e){return Ht(Object(Ve.a)(e))},e.prototype.isEventTarget=function(e,t){return e===t},e.prototype.isFocusOn=function(e){return Ft(_t(e))},e.prototype.isFocusWithin=function(e){return Lt(_t(e),e.componentType)},e.prototype.isFocusOnOrWithin=function(e){var t=_t(e);return Ft(t)||Lt(t,e.componentType)},e.prototype.isFocusWithinAny=function(e){var t=void 0;switch(e){case Re.a.Card:t=Vt(document.querySelectorAll("[id*='"+S.h({id:"",renderContextType:this.renderContextType},!1)+"']"));break;case Re.a.DraftCard:t=Vt(document.querySelectorAll("[id*='"+S.h({id:"",renderContextType:this.renderContextType},!0)+"']"));break;case Re.a.PostEditor:t=Vt(document.querySelectorAll("[id*='"+S.t(S.E({id:"",renderContextType:this.renderContextType}))+"']"));break;case Re.a.CardEditor:t=Vt(document.querySelectorAll("[id*='"+S.t(S.e({id:"",renderContextType:this.renderContextType}))+"']"));break;case Re.a.Post:t=Vt(document.querySelectorAll("[id*='"+S.G({id:"",renderContextType:this.renderContextType})+"']"))}if(t)for(var n=0;n<t.length;++n){if(Lt(t[n],e))return!0}return!1},e.prototype.isFocusWithinPane=function(){return Lt(document.getElementById(S.w()),Re.a.PaneRoot)},e.prototype.getCurrentlyFocused=function(){return this.isFocusWithinPane()?[document.activeElement]:[]},e}();function Ut(e,t){switch(void 0===e&&(e={extensions:{}}),void 0===t&&(t=fe.EMPTY_ACTION),t.type){case"ADD_CONTENT_EXTENSION":return function(e,t){var n;Object(l.i)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var o=t.payload.extension;return Object(a.a)(Object(a.a)({},e),{extensions:Object(a.a)(Object(a.a)({},e.extensions),(n={},n[t.payload.extension.provider.scope.renderMode]={controller:o,priority:o.priority},n))})}(e,t);case"REMOVE_CONTENT_EXTENSION":return function(e,t){var n,o,r=Object(a.a)({},e.extensions);try{for(var i=Object(a.l)(t.payload.renderModes),s=i.next();!s.done;s=i.next()){var c=s.value;delete r[c]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return Object(a.a)(Object(a.a)({},e),{extensions:r})}(e,t);case"UPDATE_EXTENSION_PRIORITY":return function(e,t){var n=Object(a.a)({},e.extensions);for(var o in t.payload.updates)n[o]&&(n[o]=Object(a.a)(Object(a.a)({},n[o]),{priority:t.payload.updates[o]}));return Object(a.a)(Object(a.a)({},e),{extensions:n})}(e,t);default:return e}}function qt(e){return{commentData:[],cardViewState:{},postViewState:{},selectedComment:void 0,expandedComments:[],pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:Ye.a.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,virtualized:!1,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Object(ge.h)(),atMentionState_deprecated:{capability:Nt.a.Unknown},capabilities_deprecated:{resolve:!0},modelCapabilities:Object(ve.n)(),localizationDetails:e,suggestionsDetails:void 0,tasks:{},historyRecordViewState:{}}}function zt(e,t,n,a){return function(e,t,n,a){return{paneState:{viewContainer:e,componentTree:new Bt(Object(ft.a)(e.containerType),a),visibilityState:t?H.a.Visible:H.a.Closed,initializationStatus:Mt.a.NotInitialized,viewContainerDisplayConfiguration:void 0},contentExtensions:{extensions:{}},commentState:qt(n)}}(e,t,n,a)}var Wt={isRightToLeft:!1,dataCulture:"",uiCulture:""};function Gt(e,t){switch(void 0===e&&(e=qt(Wt)),void 0===t&&(t=st.a),t.type){case"HIGHLIGHT_COMMENT":return function(e,t){var n=ve.U(t.payload.commentId);if(n===e.highlightedCommentId)return e;return Object(a.a)(Object(a.a)({},e),{highlightedCommentId:n})}(e,t);case"APPLY_COMMENT_CHANGES":return function(e,t){var n,o,r,i,c;if(!t.payload.changes.length)return e;var d,m={commentData:Object(a.j)(e.commentData),cardViewState:Object(a.a)({},e.cardViewState),postViewState:Object(a.a)({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,expandedComments:e.expandedComments,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState},u=e.createdCommentLie,p=ve.Q(u,e.draftState),f=null==u?void 0:u.index;try{for(var C=Object(a.l)(t.payload.changes),h=C.next();!h.done;h=C.next())if((d=h.value).type===dt.b.Load&&(d=void 0!==m.postViewState[d.model.commentId]?Object(a.a)(Object(a.a)({},d),{type:dt.b.Modify}):Object(a.a)(Object(a.a)({},d),{type:dt.b.Insert})),d.type===dt.b.Insert){if((b=d.model.parentId)&&(m.cardViewState[b]=Object(a.a)(Object(a.a)({},m.cardViewState[b]),{pending:be.a.None})),m.commentData.splice(d.index,0,d.model),d.tempId){if(!b)(v={})[d.model.commentId]=ve.h(d.tempId),m.cardViewState=Object(a.a)(Object(a.a)({},ve.Y(m.cardViewState,[d.tempId])),v);m.postViewState=Object(a.a)(Object(a.a)({},ve.Z(m.postViewState,[d.tempId])),ve.u([d.model])),u&&u.newComment.commentId===d.tempId&&(f=void 0),m.selectedComment&&m.selectedComment.selectedCardId===d.tempId&&(m.selectedComment=ve.C(d.model),d.model.parentId||(m.expandedComments=ve.a(m.expandedComments,m.selectedComment,m.draftState)))}else{var v;Object(l.i)().assertConditionTag(!m.postViewState[d.model.commentId],"Received insert for existing comment "+d.model.commentId,594122589),(v={})[d.model.commentId]=ve.h(void 0),m.cardViewState=Object(a.a)(Object(a.a)({},m.cardViewState),v),m.postViewState=Object(a.a)(Object(a.a)({},m.postViewState),ve.u([d.model]))}p&&void 0!==f&&d.index<=f&&f++}else if(d.type===dt.b.Modify){if((T=m.commentData[d.index]).commentId===d.model.commentId){m.commentData[d.index]=d.model;var b=Object(Ke.b)(d.model);m.cardViewState[b]=Object(a.a)(Object(a.a)({},m.cardViewState[b]),{pending:be.a.None,loadState:{state:kt.a.Loaded}});var g=T.displayDate===d.model.displayDate&&T.date===d.model.date?m.postViewState[d.model.commentId].displayDate:ve.j(d.model.date,d.model.displayDate,e.localizationDetails.dataCulture);if(m.postViewState=Object(a.a)(Object(a.a)({},m.postViewState),((r={})[d.model.commentId]=Object(a.a)(Object(a.a)({},m.postViewState[d.model.commentId]),{pending:Rt.a.None,displayDate:g}),r)),d.model.commentFlags&Je.a.Resolved&&!(T.commentFlags&Je.a.Resolved)){var y=m.draftState;m.selectedComment&&m.selectedComment.selectedCardId===d.model.commentId&&(m.selectedComment=ve.B(m.selectedComment)),m.draftState=ve.X(m.draftState,d.model.commentId,m.commentData),Et(y,m.draftState,1,2),m.expandedComments=ve.bb(d.model.commentId,m.expandedComments,m.draftState,m.selectedComment)}}else Object(l.i)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Object(s.j)("changeIndex did not match comment for "+d.model.commentId)}else if(d.type===dt.b.Delete){var T;y=m.draftState;if(m.selectedComment=ve.w(m.selectedComment,m.commentData,d.index,d.index+1),(T=m.commentData[d.index]).commentId===d.model.commentId&&m.commentData.splice(d.index,1),m.highlightedCommentId===d.model.commentId&&(m.highlightedCommentId=void 0),m.topVisibleThreadId===d.model.commentId&&(m.topVisibleThreadId=void 0),m.draftState=ve.ab(m.draftState,d.model.commentId),m.draftState=ve.fb(m.draftState,d.model.commentId),Et(y,m.draftState,""===T.parentId?3:2,2),m.cardViewState=Object(a.a)({},ve.Y(m.cardViewState,[d.model.commentId])),m.postViewState=Object(a.a)({},ve.Z(m.postViewState,[d.model.commentId])),d.model.commentId===m.selectedThreadIdBeforeCommentSession){var I=d.index;m.commentData.length?(I>=m.commentData.length&&(I=m.commentData.length-1),m.selectedThreadIdBeforeCommentSession=Object(Ke.b)(m.commentData[I])):m.selectedThreadIdBeforeCommentSession=void 0}p&&void 0!==f&&d.index<f&&f--}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=C.return)&&o.call(C)}finally{if(n)throw n.error}}p&&(void 0===f?u=void 0:u&&f!==u.index&&(u=Object(a.a)(Object(a.a)({},u),{index:f})));var O=At(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(a.a)(Object(a.a)({},e),{createdCommentLie:u,draftState:m.draftState,selectedComment:m.selectedComment,expandedComments:ve.cb(m.expandedComments,m.cardViewState,m.draftState),commentData:m.commentData,cardViewState:m.cardViewState,postViewState:m.postViewState,highlightedCommentId:m.highlightedCommentId,topVisibleThreadId:m.topVisibleThreadId,selectedThreadIdBeforeCommentSession:m.selectedThreadIdBeforeCommentSession,tasks:null!==(i=null==O?void 0:O.updatedTasks)&&void 0!==i?i:e.tasks,historyRecordViewState:null!==(c=null==O?void 0:O.updatedHistoryRecordViewState)&&void 0!==c?c:e.historyRecordViewState})}(e,t);case"LOAD_COMMENT":return function(e,t){var n,o,r,i,s,c,d,l=Object(a.j)(e.commentData,t.payload.commentData),m=ve.N(e.modelCapabilities,e.virtualized),u=ve.V(e,l,m),p=u.pendingCommentLoad,f=u.selectedComment,C=u.expandedComments;d=ve.i(t.payload.commentData,m?kt.a.Placeholder:kt.a.Loaded);var h={},b={};if(v.b()&&t.payload.tasks)try{for(var g=Object(a.l)(t.payload.tasks),y=g.next();!y.done;y=g.next()){var T=y.value;try{for(var I=(r=void 0,Object(a.l)(T.history)),O=I.next();!O.done;O=I.next()){var S=O.value;try{for(var j=(s=void 0,Object(a.l)(S.records)),E=j.next();!E.done;E=j.next()){var D=E.value;b[D.recordId]=ve.o(ve.j(D.time,void 0,e.localizationDetails.dataCulture))}}catch(e){s={error:e}}finally{try{E&&!E.done&&(c=j.return)&&c.call(j)}finally{if(s)throw s.error}}}}catch(e){r={error:e}}finally{try{O&&!O.done&&(i=I.return)&&i.call(I)}finally{if(r)throw r.error}}h[T.commentId]=T}}catch(e){n={error:e}}finally{try{y&&!y.done&&(o=g.return)&&o.call(g)}finally{if(n)throw n.error}}return Object(a.a)(Object(a.a)({},e),{commentData:l,pendingCommentLoad:p,selectedComment:f,expandedComments:C,localizationDetails:e.localizationDetails,cardViewState:Object(a.a)(Object(a.a)({},e.cardViewState),d),postViewState:Object(a.a)(Object(a.a)({},e.postViewState),ve.u(t.payload.commentData)),tasks:h,historyRecordViewState:b})}(e,t);case"VIRTUALIZE_COMMENTS":return function(e,t){var n=(r=t.payload.threadInfo.map((function(e){return e.threadId})),r.map((function(e){return yt(e,void 0,void 0)}))),o=Object(a.j)(e.commentData,n);var r;if(!ve.N(e.modelCapabilities,e.virtualized))throw new M.a("virtualizeCommentsReducer requires virtualization",s.e.reserveTag(589103643),-2130957500);var i=ve.V(e,o,!0),c=i.pendingCommentLoad,d=i.selectedComment,l=i.expandedComments;return Object(a.a)(Object(a.a)({},e),{commentData:o,pendingCommentLoad:c,selectedComment:d,expandedComments:l,cardViewState:Object(a.a)(Object(a.a)({},e.cardViewState),ve.M(t.payload.threadInfo)),postViewState:Object(a.a)(Object(a.a)({},e.postViewState),ve.u(n)),localizationDetails:e.localizationDetails})}(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return function(e,t){var n;if(!e.createdCommentLie)return e;var o,r=e.createdCommentLie.draftId,i=ve.Y(e.cardViewState,[r]),s=ve.Z(e.postViewState,[r]);(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)!==r?o=e.selectedComment:e.selectedThreadIdBeforeCommentSession&&(o={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{expanded_deprecated:!v.sb()||void 0,lowFidelityWarningType:void 0}});var c=ve.ab(e.draftState,e.createdCommentLie.draftId);return Object(a.a)(Object(a.a)({},e),{createdCommentLie:void 0,selectedComment:o,expandedComments:o?ve.a(e.expandedComments,o,c):ve.W(e.expandedComments,o,c),cardViewState:i,postViewState:s,selectedThreadIdBeforeCommentSession:void 0,draftState:c})}(e);case"CANCEL_COMMENT_POST_EDIT":return function(e,t){var n=ve.x(e,t.payload.commentId),o=ve.fb(e.draftState,t.payload.commentId);return Object(a.a)(Object(a.a)({},e),{selectedComment:n,expandedComments:ve.W(e.expandedComments,n,o),selectedThreadIdBeforeCommentSession:void 0,draftState:o})}(e,t);case"CANCEL_COMMENT_REPLY":return function(e,t){var n=ve.ab(e.draftState,t.payload.commentId),o=ve.z(e.selectedComment,n,t.payload.commentId);return Object(a.a)(Object(a.a)({},e),{selectedComment:o,expandedComments:ve.W(e.expandedComments,o,n),selectedThreadIdBeforeCommentSession:void 0,draftState:n})}(e,t);case"COLLAPSE_CARD":return function(e,t){var n=ve.K(e.draftState);if((null==n?void 0:n.threadId)===t.payload.cardId)return e;var o=ve.E(t.payload.cardId,e.selectedComment,e.draftState);return Object(a.a)(Object(a.a)({},e),{selectedComment:o,expandedComments:ve.bb(t.payload.cardId,e.expandedComments,e.draftState,o)})}(e,t);case"SELECT_COMMENT":return function(e,t){var n,o=!1,r=e.draftState,i=e.selectedComment;if(!ve.gb(r,i,t))return e;if(!t.payload.selectedCard)throw new M.a(ee.d,s.e.reserveTag(589103644),-2130957536);var c=void 0,d=ve.jb(e.selectedComment,r,t);if(e.commentData.filter((function(e){return Object(Ke["b"])(e)===d.selectedCardId})).forEach((function(t){e.postViewState[t.commentId].displayDate||(c||(c=Object(a.a)({},e.postViewState)),c[t.commentId]=ve.t(e.postViewState[t.commentId].displayDate||ve.j(t.date,t.displayDate,e.localizationDetails.dataCulture),e.postViewState[t.commentId].displayingErrorUI),o=!0)})),!v.sb()){var l=ve.K(r);if(l&&!l.forceCardExpanded_deprecated&&l.threadId===d.selectedCardId&&(!Object(ye.c)(d.selectionDetails)||d.selectionDetails.expanded_deprecated)){var m=l.commentDraft.sessionConfiguration.draftId;r=Object(a.a)(Object(a.a)({},r),{drafts:(n={},n[m]=Object(a.a)(Object(a.a)({},r.drafts[m]),{forceCardExpanded_deprecated:!0}),n)})}}var u=Object(fe.shouldSelectActionExpandCard)(t.payload.selectType)?ve.a(e.expandedComments,d,r):ve.W(e.expandedComments,d,r);return Object(a.a)(Object(a.a)({},e),{draftState:r,selectedComment:d,expandedComments:u,postViewState:o&&c?c:e.postViewState})}(e,t);case"REQUEST_THREAD_RESOLVE":return function(e,t){var n;return Object(a.a)(Object(a.a)({},e),{cardViewState:Object(a.a)(Object(a.a)({},e.cardViewState),(n={},n[t.payload.commentId]=Object(a.a)(Object(a.a)({},e.cardViewState[t.payload.commentId]),{pending:be.a.Card,loadState:{state:kt.a.Loaded}}),n)),selectedComment:ve.A(e.selectedComment,t)})}(e,t);case"RELOAD_COMMENTS":return function(e,t){var n,o,r,i,s={},c={},d=e.selectedComment,m=e.expandedComments,u=d&&!Object(ye.c)(d.selectionDetails),p=!1,f=!1,C=!1,h=e.selectedThreadIdBeforeCommentSession,b=e.draftState,g=ve.N(e.modelCapabilities,e.virtualized),y=null===(n=ve.K(b))||void 0===n?void 0:n.threadId,T={};e.commentData.forEach((function(e){T[e.commentId]=e}));var I=!1,O=!1;if(t.payload.comments.forEach((function(n){if(n.commentId===e.highlightedCommentId&&(I=!0),n.commentId===e.topVisibleThreadId&&(O=!0),v.P()&&d&&(n.commentId===d.selectedCardId&&(f=!0),d.selectedCardId!==Object(Ke.b)(n)||Object(ye.c)(d.selectionDetails)||d.selectionDetails.selectedPostId!==n.commentId||(p=!0)),n.commentId in T){if(""===n.parentId){e.cardViewState[n.commentId]&&Object(l.i)().assertConditionTag(e.cardViewState[n.commentId].pending!==be.a.Delete,"Card pending delete remained after a reload.",593762527);var o=e.cardViewState[n.commentId];if(!o||o.pending!==be.a.None||g){var r=null==o?void 0:o.loadState;c[n.commentId]=Object(a.a)(Object(a.a)({},o),{pending:be.a.None,loadState:r&&r.state===kt.a.Placeholder?{state:kt.a.Placeholder,initialItemCount:r.initialItemCount}:{state:kt.a.NeedsReload}})}else c[n.commentId]=o}if(e.postViewState[n.commentId]&&Object(l.i)().assertConditionTag(e.postViewState[n.commentId].pending!==Rt.a.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[n.commentId]&&e.postViewState[n.commentId].pending===Rt.a.None?s[n.commentId]=e.postViewState[n.commentId]:s[n.commentId]=Object(a.a)(Object(a.a)({},e.postViewState[n.commentId]),{pending:Rt.a.None}),!v.P()&&d&&(d.selectedCardId===n.commentId&&(f=!0),d.selectedCardId!==Object(Ke.b)(n)||Object(ye.c)(d.selectionDetails)||d.selectionDetails.selectedPostId!==n.commentId||(p=!0)),n.commentFlags&Je.a.Resolved&&(!T[n.commentId]||!(T[n.commentId].commentFlags&Je.a.Resolved))){if(d&&d.selectedCardId===n.commentId&&(d=ve.B(d)),n.commentId===y)Et(b,b=ve.X(b,n.commentId,t.payload.comments),1,1);m=ve.bb(n.commentId,m,b,d)}h&&h===n.commentId&&(C=!0)}else{if(""===n.parentId){var i=n.commentId,u=g?{state:kt.a.Placeholder,initialItemCount:1}:{state:kt.a.Loaded};c[n.commentId]=ve.q(i,u)}s[n.commentId]=ve.t(n.displayDate,!1)}})),i=ve.b(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState,!0)){var S=i.newComment.commentId;d&&i.newComment.commentId===d.selectedCardId&&(f=!0),c[S]=e.cardViewState[S],s[S]=e.postViewState[S]}f?u&&!p&&d&&!g&&(d={selectedCardId:d.selectedCardId,selectionDetails:{expanded_deprecated:!v.sb()||void 0,lowFidelityWarningType:void 0}}):d=void 0;var j=ve.I(b),E=ve.T(b);if(j&&!c[j]&&j!==(null==i?void 0:i.draftId)&&E){var D=b;b=ve.ab(b,j),Et(D,b,3,1)}var x=ve.J(b);if(x&&!s[x]&&E){D=b;b=ve.fb(b,x),Et(D,b,2,1)}if(!C&&h){var w=e.commentData.findIndex((function(e){return e.commentId===h}));if(w<0&&(Object(l.i)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),w=0),t.payload.comments.length){w>=t.payload.comments.length&&(w=t.payload.comments.length-1);var A=t.payload.comments[w];h=Object(Ke.b)(A)}else h=void 0}var P=function(e,t,n,o){var r,i,s,c,d,l,m,u,p;if(v.b()&&n.tasks){var f=!1,C=!1,h=!1,b={},g={},y=new Set,T=Object.keys(e);n.comments.forEach((function(e){""===e.parentId&&y.add(e.commentId)}));try{for(var I=Object(a.l)(T),O=I.next();!O.done;O=I.next()){var S=O.value;if(!y.has(S)){C=!0;break}}}catch(e){r={error:e}}finally{try{O&&!O.done&&(i=I.return)&&i.call(I)}finally{if(r)throw r.error}}T.length!==(null===(p=n.tasks)||void 0===p?void 0:p.length)&&(C=!0);try{for(var j=Object(a.l)(n.tasks),E=j.next();!E.done;E=j.next()){var D=E.value;0===D.history.length&&(h=!0);try{for(var x=(d=void 0,Object(a.l)(D.history)),w=x.next();!w.done;w=x.next()){var A=w.value;try{for(var P=(m=void 0,Object(a.l)(A.records)),k=P.next();!k.done;k=P.next()){var R=k.value;t[R.recordId]?g[R.recordId]=t[R.recordId]:(f=!0,g[R.recordId]=Object(ve.o)(Object(ve.j)(R.time,void 0,o.dataCulture)))}}catch(e){m={error:e}}finally{try{k&&!k.done&&(u=P.return)&&u.call(P)}finally{if(m)throw m.error}}}}catch(e){d={error:e}}finally{try{w&&!w.done&&(l=x.return)&&l.call(x)}finally{if(d)throw d.error}}b[D.commentId]=D}}catch(e){s={error:e}}finally{try{E&&!E.done&&(c=j.return)&&c.call(j)}finally{if(s)throw s.error}}if(C||f||h)return{updatedTasks:b,updatedHistoryRecordViewState:g}}}(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(a.a)(Object(a.a)({},e),{draftState:b,commentData:Object(a.j)(t.payload.comments),cardViewState:c,postViewState:s,selectedComment:d,expandedComments:ve.cb(m,c,b),pendingCommentLoad:void 0,highlightedCommentId:I?e.highlightedCommentId:void 0,topVisibleThreadId:O?e.topVisibleThreadId:void 0,createdCommentLie:i,selectedThreadIdBeforeCommentSession:h,tasks:null!==(o=null==P?void 0:P.updatedTasks)&&void 0!==o?o:e.tasks,historyRecordViewState:null!==(r=null==P?void 0:P.updatedHistoryRecordViewState)&&void 0!==r?r:e.historyRecordViewState})}(e,t);case"REQUEST_REOPEN_THREAD":return function(e,t){var n,o=Object(a.a)(Object(a.a)({},e.cardViewState),((n={})[t.payload.commentId]=Object(a.a)(Object(a.a)({},e.cardViewState[t.payload.commentId]),{pending:be.a.Card}),n));return Object(a.a)(Object(a.a)({},e),{cardViewState:o})}(e,t);case"REQUEST_DELETE_POST":return function(e,t){var n,o=Object(a.a)(Object(a.a)({},e.postViewState),((n={})[t.payload.commentId]=Object(a.a)(Object(a.a)({},e.postViewState[t.payload.commentId]),{pending:Rt.a.Delete}),n));return Object(a.a)(Object(a.a)({},e),{postViewState:o})}(e,t);case"REQUEST_DELETE_THREAD":return function(e,t){var n,o=Object(a.a)(Object(a.a)({},e.cardViewState),((n={})[t.payload.commentId]=Object(a.a)(Object(a.a)({},e.cardViewState[t.payload.commentId]),{pending:be.a.Delete}),n));return Object(a.a)(Object(a.a)({},e),{cardViewState:o})}(e,t);case"DISPATCH_LOAD_THREADS":return function(e,t){var n=Object(a.a)({},e.cardViewState);return t.payload.threadIds.forEach((function(e){var t=n[e].loadState;n[e]=Object(a.a)(Object(a.a)({},n[e]),{loadState:t.state===kt.a.Placeholder?{state:kt.a.Loading,initialItemCount:t.initialItemCount}:{state:kt.a.Loading}})})),Object(a.a)(Object(a.a)({},e),{cardViewState:n})}(e,t);case"BEGIN_DRAFTING_SUCCESS":return function(e,t){var n,o,r,i,c;if(ve.H(e.draftState))throw new M.a("Draft already active!",s.e.reserveTag(589103640),-2130957551);var d=e.selectedThreadIdBeforeCommentSession;if(!Object(ut.a)(t.payload.draftDetails))throw new M.a("Invalid comment draft!",s.e.reserveTag(589103641),-2130957545);var m=t.payload.draftDetails;switch(m.sessionConfiguration.sessionType){case"CREATE":var u={parentId:"",commentId:m.sessionConfiguration.draftId,author:m.author,anchorHintText:m.anchorHintText},p=ve.D(e.commentData,m),f=Object(a.a)(Object(a.a)({},e.draftState),{drafts:Object(a.a)(Object(a.a)({},e.draftState.drafts),(n={},n[m.sessionConfiguration.draftId]={commentDraft:m,forceCardExpanded_deprecated:!0,isDraftEmpty:!0,isInCurrentContext:!0,pendingState:ge.a.None,renderContextType:t.payload.draftRenderContextType,threadId:m.sessionConfiguration.draftId},n)),cardIdToDraftIdMap:Object(a.a)(Object(a.a)({},e.draftState.cardIdToDraftIdMap),(o={},o[m.sessionConfiguration.draftId]=m.sessionConfiguration.draftId,o)),pendingDraft:void 0});return Object(a.a)(Object(a.a)({},e),{createdCommentLie:{index:m.insertIndex,newComment:u,draftId:m.sessionConfiguration.draftId},cardViewState:Object(a.a)(Object(a.a)({},ve.Y(e.cardViewState,[Object(S.v)()])),ve.k(u)),postViewState:Object(a.a)(Object(a.a)({},ve.Z(e.postViewState,[Object(S.v)()])),ve.l(u)),selectedComment:p,expandedComments:ve.a(e.expandedComments,p,f),selectedThreadIdBeforeCommentSession:d,draftState:f});case"EDIT":case"REPLY":if(!Object(pt.b)(m.sessionConfiguration)&&!Object(pt.c)(m.sessionConfiguration))throw Object(l.i)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new M.a(ee.c,s.e.reserveTag(589103642),-2130957532);var C=void 0;C=!e.selectedComment||Object(pt.c)(m.sessionConfiguration)&&m.sessionConfiguration.threadId!==e.selectedComment.selectedCardId||mt.e(m.sessionConfiguration)&&(Object(ye.c)(e.selectedComment.selectionDetails)||m.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId)?ve.D(e.commentData,m):Object(a.a)(Object(a.a)({},e.selectedComment),{selectionDetails:Object(a.a)(Object(a.a)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})});var h,b=e.draftState.cardIdToDraftIdMap,g=e.draftState.postIdToDraftIdMap,y="",T=void 0;if(mt.f(m.sessionConfiguration))b=Object(a.a)(Object(a.a)({},b),((r={})[m.sessionConfiguration.threadId]=m.sessionConfiguration.draftId,r)),y=m.sessionConfiguration.threadId,T=!(Object(ye.c)(C.selectionDetails)&&!C.selectionDetails.expanded_deprecated||C.selectedCardId!==m.sessionConfiguration.threadId),h=!0;else if(mt.e(m.sessionConfiguration)){var I=m.sessionConfiguration.commentId;g=Object(a.a)(Object(a.a)({},g),((i={})[I]=m.sessionConfiguration.draftId,i)),T=!0,h=!1,e.commentData.some((function(e){if(e.commentId===I){var t=Object(vt.d)(e.commentBody);return h=0===t.length||"web"===Object(xe.a)()&&"\n"===t,y=Object(Ke.b)(e),!0}return!1}))}else Object(s.n)(m.sessionConfiguration);var O={drafts:Object(a.a)(Object(a.a)({},e.draftState.drafts),(c={},c[m.sessionConfiguration.draftId]={commentDraft:m,forceCardExpanded_deprecated:v.sb()?void 0:T,isDraftEmpty:h,isInCurrentContext:!0,pendingState:ge.a.None,renderContextType:t.payload.draftRenderContextType,threadId:y},c)),cardIdToDraftIdMap:b,postIdToDraftIdMap:g,pendingDraft:void 0},j=ve.Y(e.cardViewState,[Object(S.v)()]),E=ve.Z(e.postViewState,[Object(S.v)()]);return Object(a.a)(Object(a.a)({},e),{selectedComment:C,expandedComments:T?ve.a(e.expandedComments,C,O):ve.W(e.expandedComments,C,O),selectedThreadIdBeforeCommentSession:d,draftState:O,cardViewState:j,postViewState:E,createdCommentLie:void 0});default:return e}}(e,t);case"BEGIN_DRAFTING_FAILURE":return function(e,t){if(void 0===e.selectedComment)return Object(l.i)().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=Object(a.a)(Object(a.a)({},e.selectedComment),{selectionDetails:Object(a.a)(Object(a.a)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{expanded_deprecated:!!v.sb()&&void 0,lowFidelityWarningType:void 0}});var o=ve.Y(e.cardViewState,[Object(S.v)()]),r=ve.Z(e.postViewState,[Object(S.v)()]),i=Object(a.a)(Object(a.a)({},e.draftState),{pendingDraft:void 0});return Object(a.a)(Object(a.a)({},e),{selectedComment:n,expandedComments:ve.W(e.expandedComments,n,i),selectedThreadIdBeforeCommentSession:void 0,cardViewState:o,postViewState:r,createdCommentLie:void 0,draftState:i})}(e,t);case"SESSION_REQUEST_STARTED":return function(e,t){var n,o=void 0,r=e.cardViewState,i=e.postViewState;if(e.createdCommentLie)return Object(l.i)().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(mt.f(t.payload.params))n=t.payload.params.threadId;else if(mt.e(t.payload.params)){var s=t.payload.params.commentId,c=e.commentData.find((function(e){return e.commentId===s}));if(!c)return Object(l.i)().assertConditionTag(!1,"Could not lock selection on missing comment "+s,593764357),e;n=Object(Ke.b)(c)}else{var d={commentId:n=Object(S.v)()};o={index:-1,newComment:d,draftId:n},r[n]&&Object(l.i)().assertConditionTag(!1,"Unexpectedly already found card view state for lie when starting session request",593764358),r=Object(a.a)(Object(a.a)({},r),ve.k(d)),i[n]&&Object(l.i)().assertConditionTag(!1,"Unexpectedly already found post view state for lie when starting session request",593764359),i=Object(a.a)(Object(a.a)({},i),ve.l(d))}var m=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(m=e.selectedComment.selectedCardId);var u=Object(a.a)(Object(a.a)({},e.draftState),{pendingDraft:t.payload.params}),p=ve.G(e.selectedComment,u,t,n),f=Object(ye.k)(p.selectionDetails)||p.selectedCardId===Object(S.v)()?ve.a(e.expandedComments,p,u):e.expandedComments;return Object(a.a)(Object(a.a)({},e),{postViewState:i,cardViewState:r,selectedThreadIdBeforeCommentSession:m,selectedComment:p,expandedComments:f,draftState:u,createdCommentLie:o})}(e,t);case"COMMENT_CONTEXT_CHANGED":return function(e,t){var n,o=Object(ge.h)(),r={},i={},s=void 0,c=void 0;n=t.payload.contextDetails?Object(a.a)(Object(a.a)({},Pt(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:Ye.a.Unknown,isReadOnly:v.H()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var d=t.payload.contextDrafts;if(d){var m=ve.db(e.draftState);if(Object(ge.e)(m)>0){var u={},p=void 0,f=void 0,C=!v.ub();if(Object(ge.f)(m).forEach((function(t){var n,o=d.find((function(e){return e.draftId===t}));u[t]=Object(a.a)(Object(a.a)({},m.drafts[t]),{isInCurrentContext:!!o}),o&&e.createdCommentLie&&e.createdCommentLie.draftId===t&&(p=o.insertIndex,f=o.anchorHintText),!C&&o&&u[t].threadId===(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)&&(C=!0)})),o=Object(a.a)(Object(a.a)({},e.draftState),{drafts:u}),C&&(s=e.selectedComment),e.createdCommentLie&&(c=e.createdCommentLie,ve.Q(c,o))){Object(l.i)().assertConditionTag(void 0!==p,"Index unknown for lie in latest context",587309136);var h=null!=p?p:0;h!==c.index&&(c=Object(a.a)(Object(a.a)({},c),{index:h})),void 0!==f&&f!==c.newComment.anchorHintText&&(c=Object(a.a)(Object(a.a)({},c),{newComment:Object(a.a)(Object(a.a)({},c.newComment),{anchorHintText:f})}));var b=c.draftId;r=ve.r(b),i=ve.s(b),c.index>-1&&(r[b].pending=be.a.None,i[b].pending=Rt.a.None)}}}v.n()&&n.isReadOnly&&(ve.Q(c,o)&&(c=void 0),o=ve.eb(o));return Dt(e.draftState,o,2),Object(a.a)(Object(a.a)({},e),{virtualized:!!t.payload.virtualized,commentData:[],cardViewState:r,postViewState:i,selectedComment:s,expandedComments:ve.W(e.expandedComments,s,o),pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfComments:t.payload.numberOfComments,numberOfThreads:t.payload.numberOfThreads,selectedThreadIndex:t.payload.selectedThreadIndex},contextState:n,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?ve.U(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:c,selectedThreadIdBeforeCommentSession:void 0,draftState:o,tasks:{},historyRecordViewState:{}})}(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return function(e,t){return Object(a.a)(Object(a.a)({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}(e,t);case"SHOW_LOW_FIDELITY_WARNING":return function(e,t){var n,o=t.payload,r=o.commentId,i=o.lowFidelityWarningType,s=e.commentData.find((function(e){return e.commentId===r}));if(!s)return Object(l.i)().assertConditionTag(!1,"Comment not found",593762530),e;if(Object(ge.d)(e.draftState))return Object(l.i)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;var c=e.expandedComments;i===ye.a.DeleteThread?n={selectedCardId:r,selectionDetails:{lowFidelityWarningType:i,expanded_deprecated:v.sb()?void 0:ve.O(r,e.selectedComment,e.draftState)}}:(n={selectedCardId:Object(Ke.b)(s),selectionDetails:{selectedPostId:r,lowFidelityWarningType:i}},c=ve.a(c,n,e.draftState));return Object(a.a)(Object(a.a)({},e),{selectedComment:n,expandedComments:c})}(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return function(e,t){var n=e.selectedComment;if(!n||void 0===n.selectionDetails.lowFidelityWarningType)return e;return Object(a.a)(Object(a.a)({},e),{selectedComment:Object(a.a)(Object(a.a)({},n),{selectionDetails:{expanded_deprecated:v.sb()?void 0:ve.O(n.selectedCardId,n,e.draftState),lowFidelityWarningType:void 0}})})}(e);case"CLEAR_COMMENT_SELECTION":return function(e,t){if(!ve.gb(e.draftState,e.selectedComment,t))return e;return Object(a.a)(Object(a.a)({},e),{selectedComment:void 0,expandedComments:v.sb()?e.expandedComments:ve.W(e.expandedComments,void 0,e.draftState)})}(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return function(e,t){if(void 0!==t.payload.commentId&&t.payload.commentId!==e.highlightedCommentId)return e;return Object(a.a)(Object(a.a)({},e),{highlightedCommentId:void 0})}(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return function(e,t){return Object(a.a)(Object(a.a)({},e),{topVisibleThreadId:t.payload.threadId})}(e,t);case"UPDATE_CONTEXT_DETAILS":return function(e,t){var n=!1,o=Object(a.a)({},e.contextState),r=e.createdCommentLie,i=e.draftState;void 0!==t.payload.contextState.commentThreadCounts&&(n=!0,o.commentThreadCounts=t.payload.contextState.commentThreadCounts);void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n=!0,o.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails);void 0!==t.payload.contextState.isReadOnly&&(n=!0,o.isReadOnly=t.payload.contextState.isReadOnly,v.n()&&o.isReadOnly&&(i=ve.eb(e.draftState),ve.Q(r,e.draftState)&&(r=void 0)));if(v.n()&&!n)return e;return Dt(e.draftState,i,3),Object(a.a)(Object(a.a)({},e),{draftState:i,contextState:o,createdCommentLie:r})}(e,t);case"BEGIN_PROCESSING_COMMIT":return function(e,t){var n;if(!Object(ge.b)(e.draftState))return Object(l.i)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var o=e.draftState,r=ve.K(e.draftState);r&&(o=Object(a.a)(Object(a.a)({},o),{drafts:Object(a.a)(Object(a.a)({},o.drafts),(n={},n[r.commentDraft.sessionConfiguration.draftId]=Object(a.a)(Object(a.a)({},r),{pendingState:ge.a.Commit}),n))}));return Object(a.a)(Object(a.a)({},e),{draftState:o})}(e);case"COMMIT_FAILURE":return function(e,t){var n;if(!Object(ge.i)(e.draftState))return Object(l.i)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var o=e.draftState,r=ve.K(e.draftState);r&&(o=Object(a.a)(Object(a.a)({},o),{drafts:Object(a.a)(Object(a.a)({},o.drafts),(n={},n[r.commentDraft.sessionConfiguration.draftId]=Object(a.a)(Object(a.a)({},r),{pendingState:ge.a.None,savedDraftContent:v.pb()&&void 0!==t.payload.commitText?{editorContent:Promise.resolve(t.payload.commitText),editorCursorPosition:Promise.resolve(void 0)}:r.savedDraftContent}),n))}));return Object(a.a)(Object(a.a)({},e),{draftState:o})}(e,t);case"BEGIN_PROCESSING_DISCARD":return function(e){var t;if(!Object(ge.b)(e.draftState)&&!Object(ye.h)(e.selectedComment))return Object(l.i)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var n=e.draftState,o=ve.K(e.draftState);o&&(n=Object(a.a)(Object(a.a)({},n),{drafts:Object(a.a)(Object(a.a)({},n.drafts),(t={},t[o.commentDraft.sessionConfiguration.draftId]=Object(a.a)(Object(a.a)({},o),{pendingState:ge.a.Discard}),t))}));return Object(a.a)(Object(a.a)({},e),{draftState:n})}(e);case"CANCEL_DISCARD":return function(e){var t;if(!Object(ge.j)(e.draftState))return Object(l.i)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var n=e.draftState,o=ve.K(e.draftState);o&&(n=Object(a.a)(Object(a.a)({},n),{drafts:Object(a.a)(Object(a.a)({},n.drafts),(t={},t[o.commentDraft.sessionConfiguration.draftId]=Object(a.a)(Object(a.a)({},o),{pendingState:ge.a.None}),t))}));return Object(a.a)(Object(a.a)({},e),{draftState:n})}(e);case"LOAD_PERSONA_ICON_PROPERTIES":return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;var n=Object(a.a)(Object(a.a)({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return Object(a.a)(Object(a.a)({},e),{personaIconPropertiesMap:n})}(e,t);case"COMMIT_DRAFT":return function(e,t){var n=ve.H(e.draftState);if(void 0===n)return Object(l.i)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){if(!e.createdCommentLie)return e;var n=t.temporaryCommentId;if(!n)throw Object(l.i)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new M.a(ee.c,s.e.reserveTag(589103637),-2130957545);var o={parentId:"",commentId:n,commentBody:t.commentBody,author:e.createdCommentLie.newComment.author},r=Object(a.a)(Object(a.a)({},e.cardViewState),ve.r(n)),i=Object(a.a)(Object(a.a)({},e.postViewState),ve.s(n)),c=e.selectedComment&&{selectedCardId:n,selectionDetails:{expanded_deprecated:!v.sb()||void 0,lowFidelityWarningType:void 0}},d=ve.ab(e.draftState,e.createdCommentLie.draftId);return Object(a.a)(Object(a.a)({},e),{selectedComment:c,expandedComments:ve.a(e.expandedComments,c,d),createdCommentLie:Object(a.a)(Object(a.a)({},e.createdCommentLie),{newComment:o}),cardViewState:r,postViewState:i,selectedThreadIdBeforeCommentSession:void 0,draftState:d})}(e,t.payload.data);case"REPLY":return function(e,t){var n;if(!t.parentId)throw new M.a(ee.d,s.e.reserveTag(589103638),-2130957536);var o=Object(a.a)(Object(a.a)({},e.cardViewState),((n={})[t.parentId]=Object(a.a)(Object(a.a)({},e.cardViewState[t.parentId]),{pending:be.a.Editor,loadState:{state:kt.a.Loaded}}),n)),r=ve.y(e,t),i=ve.ab(e.draftState,t.parentId);return Object(a.a)(Object(a.a)({},e),{cardViewState:o,selectedComment:r,expandedComments:ve.W(e.expandedComments,r,i),selectedThreadIdBeforeCommentSession:void 0,draftState:i})}(e,t.payload.data);case"EDIT":return function(e,t){var n,o=ve.x(e,t.commentId),r=Object(a.a)(Object(a.a)({},e.postViewState[t.commentId]),{pending:Rt.a.Post}),i=ve.fb(e.draftState,t.commentId);return Object(a.a)(Object(a.a)({},e),{postViewState:Object(a.a)(Object(a.a)({},e.postViewState),(n={},n[t.commentId]=r,n)),selectedComment:o,expandedComments:ve.W(e.expandedComments,o,i),selectedThreadIdBeforeCommentSession:void 0,draftState:i})}(e,t.payload.data);default:throw new M.a("Unexpected session type for commit",s.e.reserveTag(589103639),-2130957532)}}(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return function(e,t){return Object(a.a)(Object(a.a)({},e),{atMentionState_deprecated:{capability:t.payload.capability},modelCapabilities:Object(a.a)(Object(a.a)({},e.modelCapabilities),{atMention:t.payload.capability})})}(e,t);case"SAVE_DRAFT":return function(e,t){var n,o=e.draftState.drafts;if(void 0===o[t.payload.draftId])return Object(l.i)().assertConditionTag(!Object(ge.c)(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;var r=Object(a.a)(Object(a.a)({},o),((n={})[t.payload.draftId]=Object(a.a)(Object(a.a)({},o[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),n));return Object(a.a)(Object(a.a)({},e),{draftState:Object(a.a)(Object(a.a)({},e.draftState),{drafts:r})})}(e,t);case"DRAFT_EMPTINESS_CHANGED":return function(e,t){var n,o=e.draftState.drafts;if(void 0===o[t.payload.draftId])return Object(l.i)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var r=Object(a.a)(Object(a.a)({},o),((n={})[t.payload.draftId]=Object(a.a)(Object(a.a)({},o[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),n));return Object(a.a)(Object(a.a)({},e),{draftState:Object(a.a)(Object(a.a)({},e.draftState),{drafts:r})})}(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return function(e,t){var n=ve.ib(e.draftState,(function(n){var a=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?a.renderContextType:t.payload.isClaimingLock&&a.renderContextType===Ee.a.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||a.renderContextType!==t.actionDetail.renderContextType?a.renderContextType:Ee.a.None}));return Object(a.a)(Object(a.a)({},e),{draftState:n})}(e,t);case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=ve.ib(e.draftState,(function(n){var a=e.draftState.drafts[n];return Object(we.b)(a.renderContextType)?Object(ft.a)(t.payload.viewContainer.containerType):a.renderContextType}));return Object(a.a)(Object(a.a)({},e),{draftState:n})}(e,t);case"DISPLAY_DRAFT_WARNING":return function(e,t){var n,o,r=ve.H(e.draftState);if(void 0===r)return Object(l.i)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var i=r.sessionConfiguration.draftId,s=e.draftState.drafts;if(!s[i])return Object(l.i)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var c=s[i].draftWarningState,d=Object(a.a)(Object(a.a)({},s[i]),{draftWarningState:{warningCounter:c?c.warningCounter+1:0,type:t.payload.draftWarningType}}),m=Object(a.a)(Object(a.a)({},s),((n={})[i]=d,n)),u=v.ub()&&(Object(pt.b)(d.commentDraft.sessionConfiguration)||(null===(o=e.selectedComment)||void 0===o?void 0:o.selectedCardId)!==d.threadId)?ve.F(d):e.selectedComment,p=Object(a.a)(Object(a.a)({},e.draftState),{drafts:m});return Object(a.a)(Object(a.a)({},e),{draftState:p,selectedComment:u,expandedComments:ve.W(e.expandedComments,u,p)})}(e,t);case"UPDATE_CAPABILITIES":return function(e,t){return Object(a.a)(Object(a.a)({},e),{capabilities_deprecated:t.payload.capabilities})}(e,t);case"UPDATE_MODEL_STATE":return function(e,t){var n={atMention:t.payload.modelCapabilityFlags&We.AtMentionKnown?t.payload.modelCapabilityFlags&We.AtMentionEnabled?ct.b.Enabled:ct.b.Disabled:ct.b.Unknown,newThread:!!(t.payload.modelCapabilityFlags&We.NewThread),resolve:!!(t.payload.modelCapabilityFlags&We.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&We.Virtualized),tasks:t.payload.modelCapabilityFlags&We.TasksKnown?t.payload.modelCapabilityFlags&We.TasksEnabled?lt.a.Enabled:lt.a.Disabled:lt.a.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&We.PresentLinkToComment),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&We.UIAAnnotationPattern)};return Object(a.a)(Object(a.a)({},e),{modelCapabilities:n})}(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return function(e,t){var n,o=ve.H(e.draftState);if(void 0===o)return Object(l.i)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var r=o.sessionConfiguration;if(Object(pt.b)(r))return e;var i=e.draftState.drafts[r.draftId];if(!i)return Object(l.i)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var s=i.currentMentionees,c={};for(var d in s)c[d]={mentionee:Object(a.a)({},s[d].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(d)};var m=i.selectedTaskAssignee;if(m){var u=Object(oe.e)(m);c[u]&&c[u].stillInDraft||(m=void 0)}var p=Object(a.a)(Object(a.a)({},e.draftState),{drafts:Object(a.a)(Object(a.a)({},e.draftState.drafts),(n={},n[r.draftId]=Object(a.a)(Object(a.a)({},e.draftState.drafts[r.draftId]),{currentMentionees:c,selectedTaskAssignee:m}),n))});return Object(a.a)(Object(a.a)({},e),{draftState:p})}(e,t);case"ADD_TO_CURRENT_MENTIONEES":return function(e,t){var n,o=ve.H(e.draftState);if(void 0===o)return Object(l.i)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var r=o.sessionConfiguration;if(Object(pt.b)(r))return e;var i=e.draftState.drafts[r.draftId];if(!i)return Object(l.i)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var s=i.currentMentionees,c=Object(oe.e)(t.payload.mentionee);if(s&&s[c])return e;var d={};for(var m in s)d[m]={mentionee:Object(a.a)({},s[m].mentionee),stillInDraft:s[m].stillInDraft};d[c]={mentionee:Object(a.a)({},t.payload.mentionee),stillInDraft:!0};var u=Object(a.a)(Object(a.a)({},e.draftState),{drafts:Object(a.a)(Object(a.a)({},e.draftState.drafts),(n={},n[r.draftId]=Object(a.a)(Object(a.a)({},e.draftState.drafts[r.draftId]),{currentMentionees:d}),n))});return Object(a.a)(Object(a.a)({},e),{draftState:u})}(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEE":return function(e,t){var n,o=ve.H(e.draftState);if(void 0===o)return Object(l.i)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var r=o.sessionConfiguration;if(Object(pt.b)(r))return e;var i=r.draftId,s=e.draftState.drafts;if(!s[i])return Object(l.i)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var c=Object(a.a)(Object(a.a)({},s),((n={})[i]=Object(a.a)(Object(a.a)({},s[i]),{selectedTaskAssignee:t.payload.selectedAssignee}),n));return Object(a.a)(Object(a.a)({},e),{draftState:Object(a.a)(Object(a.a)({},e.draftState),{drafts:c})})}(e,t);case"POPULATE_SMART_REPLY":return function(e,t){return Object(a.a)(Object(a.a)({},e),{draftState:ve.m(e.draftState,t.payload)})}(e,t);case"SHOW_POST_ERROR_STATE":return function(e,t){var n=Object(a.a)(Object(a.a)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),o=Object(a.a)({},e.postViewState);return o[t.payload.commentId]=n,Object(a.a)(Object(a.a)({},e),{postViewState:o})}(e,t);case"CLEAR_POST_ERROR_STATE":return function(e,t){var n=Object(a.a)(Object(a.a)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),o=Object(a.a)({},e.postViewState);return o[t.payload.commentId]=n,Object(a.a)(Object(a.a)({},e),{postViewState:o})}(e,t);case"UPDATE_DRAFT_THREAD":return function(e,t){if(!e.createdCommentLie)return e;if(e.createdCommentLie.draftId!==t.payload.draftId)return Object(l.i)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;var n=e.createdCommentLie;void 0!==t.payload.insertIndex&&t.payload.insertIndex!==n.index&&(n=Object(a.a)(Object(a.a)({},n),{index:t.payload.insertIndex}));void 0!==t.payload.anchorHintText&&t.payload.anchorHintText!==n.newComment.anchorHintText&&(n=Object(a.a)(Object(a.a)({},n),{newComment:Object(a.a)(Object(a.a)({},n.newComment),{anchorHintText:t.payload.anchorHintText})}));return Object(a.a)(Object(a.a)({},e),{createdCommentLie:n})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){var n=e.draftState,o=e.selectedComment,r=e.expandedComments;if(t.payload.visibilityState!==H.a.Visible&&!v.o()&&(n=ve.db(n),e.selectedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0)){var i=ve.I(e.draftState);i&&(o=ve.z(e.selectedComment,n,i),v.sb()&&(r=ve.W(e.expandedComments,o,n)))}return n=ve.ib(n,(function(n){var a=e.draftState.drafts[n];return ve.hb(a.renderContextType,t.payload.visibilityState)})),Dt(e.draftState,n,1),Object(a.a)(Object(a.a)({},e),{selectedComment:o,expandedComments:v.sb()?r:ve.W(e.expandedComments,o,n),draftState:n})}(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return function(e,t){return Object(a.a)(Object(a.a)({},e),{suggestionsDetails:t.payload.details})}(e,t);default:return e}}function Yt(){Object(l.i)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function Kt(e,t){switch(void 0===e&&(e={viewContainer:{closeView:Yt,openView:Yt,containerType:R.b.FullPane,moveFocusToCanvas_donotuse:Yt},componentTree:new Bt(Ee.a.FullPane,i.a),visibilityState:H.a.Closed,initializationStatus:Mt.a.NotInitialized,viewContainerDisplayConfiguration:void 0}),void 0===t&&(t=fe.EMPTY_ACTION),t.type){case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return Object(a.a)(Object(a.a)({},e),{viewContainer:t.payload.viewContainer,componentTree:n?new Bt(Object(ft.a)(t.payload.viewContainer.containerType),e.componentTree.contextIdentifier,e.componentTree):e.componentTree})}(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return function(e,t){if(t.payload.displayConfiguration===e.viewContainerDisplayConfiguration)return e;return Object(a.a)(Object(a.a)({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){return Object(a.a)(Object(a.a)({},e),{initializationStatus:t.payload.visibilityState!==H.a.Closed||v.w()?e.initializationStatus:Mt.a.NotInitialized,visibilityState:t.payload.visibilityState})}(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return function(e,t){var n=Object(a.a)(Object(a.a)({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return Object(a.a)(Object(a.a)({},e),{viewContainer:n})}(e,t);case"BEGIN_VIEW_INIT":return function(e){return Object(a.a)(Object(a.a)({},e),{initializationStatus:Mt.a.Initializing})}(e);case"END_VIEW_INIT":return function(e){return Object(a.a)(Object(a.a)({},e),{initializationStatus:Mt.a.Initialized})}(e);default:return e}}var Zt=void 0;function Qt(e,t){void 0===t&&(t=st.a),Zt||(Zt=Object(at.combineReducers)({paneState:Kt,contentExtensions:Ut,commentState:Gt}));var n=Zt(e,t);return n}var Xt=n(139),Jt=function(){return{threadIdRequests:new Map,sequenceId:0}};function $t(e){return e&&(e.loadState.state===kt.a.Placeholder||e.loadState.state===kt.a.NeedsReload)}var en=function(e,t,n){return void 0===n&&(n=20),Object(c.p)(function(e){return function(t,n){var o,r,i=Te.c(e.getState());try{for(var s=Object(a.l)(n),c=s.next();!c.done;c=s.next()){var d=c.value;$t(i[d])&&t.threadIdRequests.set(d,t.sequenceId++)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}return t}}(e),function(e,t,n){return function(o){for(var r=Array.from(o.threadIdRequests.entries()).sort((function(e,t){var n=Object(a.h)(e,2),o=(n[0],n[1]),r=Object(a.h)(t,2);r[0];return o-r[1]})),i=[],c=Te.c(e.getState()),d=r.pop();d&&i.length<n;d=r.pop()){var l=Object(a.h)(d,1)[0];o.threadIdRequests.delete(l),$t(c[l])&&i.push(l)}if(i.length&&e.dispatch(Object(fe.dispatchLoadThreads)({renderContextType:Ee.a.None,telemetryVisitor:t,trackback:s.e.reserveTag(594888212)},{threadIds:i})),o.threadIdRequests.size>0)return o}}(e,t,n),Jt,500)},tn=n(283),nn=n(671);function an(e,t,n){var a=e.getState(),o=nn.a(a)[u.e.Isolated];return!!o&&(n(t),o.controller.triggerUpdate(),!0)}function on(e,t,n,a){return"CREATE"===a&&an(e,t,n)}function rn(e,t){return 0===Te.f(t).lastContextChangeIncrement?u.d.Disabled:e===u.e.TaskPane||v.qb()&&e===u.e.TaskPaneItem?Ie.a(t)?u.d.Primary:u.d.Disabled:Te.m(t)?u.d.Disabled:rn(u.e.TaskPane,t)!==u.d.Primary?u.d.Primary:e===u.e.Integrated?u.d.Disabled:u.d.Secondary}function sn(e,t){var n=nn.a(e)[t];n&&(n.controller.priority=n.priority)}var cn=function(e){return function(t){return function(n){var a=e.getState().commentState.draftState.drafts;t(n);var o=e.getState().commentState.draftState.drafts;Object.keys(a).forEach((function(e){void 0===o[e]&&a[e].commentDraft.endDrafting()}))}}},dn=n(176),ln=n(517),mn=n(710);function un(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:"ApplyCommentChangesAction",aggregationMode:l.a.OnSuccess,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"BEGIN_PROCESSING_COMMIT":return{name:"BeginProcessingCommitAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_CREATE_THREAD":return{name:"CancelCommentCreateThreadAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_POST_EDIT":return{name:"CancelCommentPostEditAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_REPLY":return{name:"CancelCommentReplyAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"CLEAR_COMMENT_SELECTION":return{name:"ClearCommentSelectionAction",aggregationMode:l.a.OnSuccess,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"COLLAPSE_CARD":return{name:"CollapseCardAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"COMMIT_DRAFT":return{name:"CommitDraftAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"DISPLAY_DRAFT_WARNING":return{name:"DisplayDraftWarningAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"RELOAD_COMMENTS":return{name:"ReloadCommentsAction",aggregationMode:l.a.OnSuccess,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_POST":return{name:"DeletePostAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_THREAD":return{name:"DeleteThreadAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent,logDocumentMetadata:l.f.Basic};case"DISPATCH_LOAD_THREADS":return{name:"LoadThreadsAction",aggregationMode:l.a.OnSuccess,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"REQUEST_REOPEN_THREAD":return{name:"ReopenThreadAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"REQUEST_THREAD_RESOLVE":return{name:"ResolveThreadAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent,logDocumentMetadata:l.f.Basic};case"SELECT_COMMENT":return{name:"SelectCommentAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:"SelectFirstThreadInNextCommentContextAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:"SelectLastThreadInPreviousCommentContextAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"SESSION_REQUEST_STARTED":return{name:"SessionRequestStartedAndLockSelectionAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"SHOW_LOW_FIDELITY_WARNING":return{name:"ShowLowFidelityWarningAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"CLEAR_LOW_FIDELITY_WARNING":return{name:"ClearLowFidelityWarningAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:"UpdateDraftRenderContext",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};case"PRESENT_LINK_TO_COMMENT":return{name:"PresentLinkToCommentAction",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent};default:return}}var pn=function(){return function(e){return function(t){try{return e(t)}catch(e){if(void 0===un(t)){var n=Object(l.i)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,l.a.None,l.b.NecessaryServiceDataEvent);n.addDataField("OperationType",t.type,l.d.SystemMetadata),n.addDataField("Trackback",t.actionDetail.trackback,l.d.SystemMetadata),n.failTag(593278723,Object(dn.a)(e))}!function(e){if(Object(ln.a)(e))throw e;if(!Object(M.b)(e))throw Object(l.i)().assertConditionTag(!1,"Unknown error encountered, rethrowing: "+Object(s.m)(e),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:Object(l.i)().assertConditionTag(!1,"Comments Error (tag="+e.tag+"): "+e,e.tag)}}(e)}}}};var fn=n(169),Cn=n(641);function hn(e){return void 0!==e&&0!=(e.commentFlags&r.c.Resolved)}function vn(e,t){e.addDataField("IsCommentResolved",t,l.d.SystemMetadata)}var bn;function gn(e){e.timerHandle&&clearTimeout(e.timerHandle)}!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(bn||(bn={}));var yn=function(){function e(e){var t=this;this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=function(e,n,a){var o=t.performanceActivities[e];o&&(o.activity.failTag(n,void 0!==a?a:-2130957541),gn(o),delete t.performanceActivities[e])},this.timeoutTracker=function(e,n,a){var o=t.performanceActivities[e];o&&(gn(o),o.activity.addDataField("Timeout",!0,l.d.SystemMetadata),n.failOnTimeout?o.activity.failTag(a,-2130957491):o.activity.successTag(a),delete t.performanceActivities[e])}}return e.prototype.beginTracking=function(e,t,n,a,o){var r=this;void 0===o&&(o={timeout:5e3,failOnTimeout:!0});var i=a||Object(l.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,l.a.None,l.b.NecessaryServiceDataEvent);i.addDataField("OperationType",n,l.d.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&(Object(l.i)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,s.e.reserveTag(595907678)));var c={activity:i,expectedChangeType:t};c.timerHandle=setTimeout((function(){return r.timeoutTracker(e,o,s.e.reserveTag(575484417))}),o.timeout),this.performanceActivities[e]=c},e.prototype.updateTrackerId=function(e,t){if(e!==t){this.performanceActivities.hasOwnProperty(t)&&(Object(l.i)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,s.e.reserveTag(595132705)));var n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}},e.prototype.failAllTrackers=function(e,t){var n=this;Object.keys(this.performanceActivities).forEach((function(a){var o=n.performanceActivities[a];gn(o),o.activity.failTag(e,void 0!==t?t:-2130957541)})),this.performanceActivities={}},e.prototype.endTracker=function(e,t,n){var a=this.performanceActivities[e];a&&(gn(a),a.activity.addDataField("ExpectedChangeArrived",a.expectedChangeType===t?bn.Yes:bn.No,l.d.SystemMetadata),a.activity.successTag(n),delete this.performanceActivities[e])},e.prototype.endAllTrackers=function(e){for(var t in this.performanceActivities){var n=this.performanceActivities[t];gn(n),n.activity.addDataField("ExpectedChangeArrived",bn.Unknown,l.d.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}},e.prototype.getTracker=function(e,t){var n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n},e}(),Tn=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(e){var t=Object(ye.b)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",l.d.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=Object(l.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,l.a.None,l.b.NecessaryServiceDataEvent),this.selectedCommentId=t)},e.prototype.endTrackingIfWarningDismissed=function(e,t){var n=Object(ye.b)(t);!this.activity||n===this.selectedCommentId&&Object(ye.i)(t)||(this.activity.addDataField("OperationType",e.type,l.d.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function In(e,t){t?e.addDataField("AffectingTaskMetadata",!0,l.d.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,l.d.SystemMetadata)}function On(e,t,n){var a=t.find((function(e){return e.commentId===n})),o=(null==a?void 0:a.parentId)||(null==a?void 0:a.commentId);t.some((function(e){return(e.commentId===o||e.parentId===o)&&0!=(e.commentFlags&ct.e.IsNew)}))&&o&&e.addDataField("CommentIsNew",o,l.d.SystemMetadata)}var Sn=function(e){var t=new yn(e),n=new Tn(e),o=Object(c.o)((function(e){Object(l.i)().createActivityObject("PostButtonTeachingCallout",e.actionDetail.telemetryVisitor,l.a.None,l.b.NecessaryServiceDataEvent).successTag(573687565)}));return function(e){return function(r){return function(i){var c,d,m=function(){var t,n,a,o,s,c,d=un(i);if(!d)return Object(l.i)().assertConditionTag(!1,"Event name not defined for action type: "+i.type,595616738),r(i);var m=Object(l.i)().createActivityObject(d.name,i.actionDetail.telemetryVisitor,d.aggregationMode,d.diagnosticLevel);m.addDataField("Trackback",i.actionDetail.trackback,l.d.SystemMetadata),m.addDataField("RenderContextType",i.actionDetail.renderContextType,l.d.SystemMetadata),d.logDocumentMetadata&&m.addDocumentMetadata(d.logDocumentMetadata);var u,p=function(e,t){m.addDataField("CommentId",t,l.d.SystemMetadata);var n=Object(ve.f)(e,t);n.valid&&(m.addDataField("MatchesCommentAuthor",n.matchesCurrentUser,l.d.SystemMetadata),m.addDataField("ThreadCreationDeltaMs",n.timeElapsed,l.d.SystemMetadata)),On(m,e,t)},f=e.getState(),C=tn.b(e.getState());switch(i.type){case"COMMENT_CONTEXT_CHANGED":m.addDataField("NumberOfThreads",i.payload.numberOfThreads,l.d.SystemMetadata),i.payload.virtualized||m.addDataField("NumberOfComments",i.payload.numberOfComments,l.d.SystemMetadata);break;case"COMMIT_DRAFT":var h=function(e){if("COMMIT_DRAFT"===e.type)return{name:"CommitDraft"+Object(mn.b)(e.payload)+"Action",aggregationMode:l.a.None,diagnosticLevel:l.b.NecessaryServiceDataEvent}}(i);if(!h)return Object(l.i)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),r(i);var v=Object(l.i)().createActivityObject(h.name,i.actionDetail.telemetryVisitor,l.a.None,l.b.NecessaryServiceDataEvent);v.addDataField("RenderContextType",i.actionDetail.renderContextType,l.d.SystemMetadata),v.successTag(595903074);var b=mt.b[i.payload.sessionType];m.addDataField("SessionType",b,l.d.SystemMetadata),"REPLY"===i.payload.sessionType&&On(m,Te.d(f),i.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":m.addDataField("DraftWarningType",i.payload.draftWarningType,l.d.SystemMetadata),m.addDataField("DraftWarningReason",i.payload.draftWarningReason,l.d.SystemMetadata);var g=Object(ve.K)(f.commentState.draftState);g&&(m.addDataField("IsDraftInCurrentContext",g.isInCurrentContext,l.d.SystemMetadata),m.addDataField("DraftId",g.commentDraft.sessionConfiguration.draftId,l.d.SystemMetadata));break;case"UPDATE_DRAFT_RENDER_CONTEXT":m.addDataField("IsClaimingDraftLock",i.payload.isClaimingLock,l.d.SystemMetadata),m.addDataField("IsUpdatingAllDraftLocks",!i.payload.draftId,l.d.SystemMetadata);break;case"SELECT_COMMENT":m.addDataField("SelectType",fe.SelectActionType[i.payload.selectType],l.d.SystemMetadata),m.addDataField("ActionSource",Ce.a[i.payload.source],l.d.SystemMetadata);var y=Te.p(f),T=!(!y||y.selectedCardId!==i.payload.selectedCard);m.addDataField("IsCurrentCard",T,l.d.SystemMetadata),T||On(m,Te.d(f),i.payload.selectedCard),i.payload.source!==Ce.a.Canvas&&(u=i.payload.selectType,Object(fe.shouldSelectActionExpandCard)(u))&&vn(m,hn(Te.e(f,i.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":In(m,i.payload.isTask),p(Te.d(f),i.payload.commentId);var I=void 0;if(i.payload.isTask){I="REQUEST_THREAD_RESOLVE"===i.type?"ResolveThreadWithTask":"ReopenThreadWithTask",m.addDataField(I,!0,l.d.SystemMetadata,l.e.Critical);var O=null===(a=null===(n=null===(t=C[i.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===a?void 0:a.time;m.addDataField("TaskCreationTimeDeltaMs",O?Date.now()-O.getTime():0,l.d.SystemMetadata,l.e.Critical)}vn(m,hn(Te.e(f,i.payload.commentId)));break;case"REQUEST_DELETE_THREAD":if(In(m,i.payload.isTask),i.payload.isTask){m.addDataField("DeleteThreadWithTask",!0,l.d.SystemMetadata,l.e.Critical);O=null===(c=null===(s=null===(o=C[i.payload.commentId])||void 0===o?void 0:o.history[0])||void 0===s?void 0:s.records[0])||void 0===c?void 0:c.time;m.addDataField("TaskCreationTimeDeltaMs",O?Date.now()-O.getTime():0,l.d.SystemMetadata,l.e.Critical)}vn(m,hn(Te.e(f,i.payload.commentId))),p(Te.d(f),i.payload.commentId);break;case"REQUEST_DELETE_POST":p(Te.d(f),i.payload.commentId)}try{var S=e.getState(),j=r(i),E=e.getState(),D=Te.h(S),x=Te.h(E);switch(i.type){case"UPDATE_DRAFT_RENDER_CONTEXT":var w=i.payload.draftId?D.drafts[i.payload.draftId]:Object(ve.K)(D),A=i.payload.draftId?x.drafts[i.payload.draftId]:Object(ve.K)(x),P=void 0!==w&&void 0!==A&&w.renderContextType!==A.renderContextType;m.addDataField("DidDraftLockUpdate",P,l.d.SystemMetadata)}return m.successTag(595616739),j}catch(e){throw m.failTag(595616768,Object(dn.a)(e,-2130957541)),e}};switch(i.type){case"BEGIN_PROCESSING_COMMIT":var u=Object(l.i)().createActivityObject(t.trackerActivityName,i.actionDetail.telemetryVisitor,l.a.None,l.b.NecessaryServiceDataEvent);try{m()}catch(e){throw u.failTag(595687567,Object(dn.a)(e,-2130957541)),e}if(!(f=Te.r(e.getState()))){u.failTag(595687569,-2130957541);break}var p=f.commentDraft.sessionConfiguration;t.beginTracking(p.draftId,mt.a[p.sessionType],p.sessionType,u);break;case"COMMIT_FAILURE":var f=Te.r(e.getState());Object(l.i)().assertConditionTag(!!f,"Draft should exist when failing a commit.",595132701),f&&t.failTracker(f.commentDraft.sessionConfiguration.draftId,s.e.reserveTag(595132702)),r(i);break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":t.beginTracking(i.payload.commentId,dt.a.Modify,i.type);try{m()}catch(e){throw t.failTracker(i.payload.commentId,s.e.reserveTag(595907670),Object(dn.a)(e,-2130957541)),e}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":t.beginTracking(i.payload.commentId,dt.a.Delete,i.type);try{m()}catch(e){throw t.failTracker(i.payload.commentId,s.e.reserveTag(595907671),Object(dn.a)(e,-2130957541)),e}break;case"COMMENT_CONTEXT_CHANGED":try{r(i)}catch(e){throw t.failAllTrackers(s.e.reserveTag(595731294),Object(dn.a)(e,-2130957541)),e}break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":if(("LOAD_COMMENT"===i.type?i.payload.commentData:i.payload.threadInfo).length>0&&!t.getTracker("LoadCommentTracker",dt.a.Load)){u=Object(l.i)().createActivityObject(t.trackerActivityName,i.actionDetail.telemetryVisitor,l.a.None,l.b.NecessaryServiceDataEvent);t.beginTracking("LoadCommentTracker",dt.a.Load,i.type,u,{timeout:1e6,failOnTimeout:!1})}r(i);break;case"RELOAD_COMMENTS":try{m()}catch(e){throw t.failAllTrackers(s.e.reserveTag(595907672),Object(dn.a)(e,-2130957541)),e}t.endAllTrackers(s.e.reserveTag(595907673));break;case"ON_INITIAL_RENDER":var C=t.getTracker("LoadCommentTracker",dt.a.Load);C&&(i.payload.commentId&&C.activity.addDataField("AssociatedCommentId",i.payload.commentId,l.d.SystemMetadata),C.activity.addDataField("RenderContextType",i.payload.renderContextType,l.d.SystemMetadata),t.endTracker("LoadCommentTracker",dt.a.Load,s.e.reserveTag(595646476))),r(i);break;case"APPLY_COMMENT_CHANGES":try{m()}catch(e){throw t.failAllTrackers(s.e.reserveTag(595907674),Object(dn.a)(e,-2130957541)),e}try{for(var h=Object(a.l)(i.payload.changes),v=h.next();!v.done;v=h.next()){var b=v.value;if(b.type===dt.a.Load||b.type===dt.a.Unknown)break;if(b.type!==dt.a.Delete&&b.type!==dt.a.Modify){if(b.type===dt.a.Insert){void 0!==b.tempId&&""===b.model.parentId&&xt(b.tempId,b.model.commentId,i.actionDetail.telemetryVisitor);var g=b.tempId||b.model.parentId;void 0!==g&&t.endTracker(g,b.type,s.e.reserveTag(595857620))}}else t.endTracker(b.model.commentId,b.type,s.e.reserveTag(595907675))}}catch(e){c={error:e}}finally{try{v&&!v.done&&(d=h.return)&&d.call(h)}finally{if(c)throw c.error}}break;case"COMMIT_DRAFT":f=Te.r(e.getState());if(m(),i.payload.data.temporaryCommentId&&f){var y=void 0;switch((p=f.commentDraft.sessionConfiguration).sessionType){case"CREATE":!function(e,t,n){xt(e,t,n)}(p.draftId,i.payload.data.temporaryCommentId,i.actionDetail.telemetryVisitor),y=i.payload.data.temporaryCommentId;break;case"REPLY":y=i.payload.data.temporaryCommentId;break;case"EDIT":y=p.commentId;break;case"METADATA":y=p.threadId;break;default:Object(s.n)(p)}y&&t.updateTrackerId(p.draftId,y)}break;case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"CLEAR_COMMENT_SELECTION":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":m();break;case"SHOW_LOW_FIDELITY_WARNING":m();var T=Te.p(e.getState());T&&n.beginTracking(T);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":var I="";switch(i.payload.visibilityState){case H.a.Closed:I="ViewContainerClosed";break;case H.a.Hidden:I="ViewContainerHidden";break;case H.a.Visible:I="ViewContainerVisible";break;default:Object(s.n)(i.payload.visibilityState)}var O=Object(l.i)().createActivityObject(I,i.actionDetail.telemetryVisitor,l.a.Always,l.b.NecessaryServiceDataEvent);r(i),O.successTag(592241220);break;case"DRAFT_EMPTINESS_CHANGED":var S=Te.h(e.getState()).drafts[i.payload.draftId].commentDraft.sessionConfiguration.sessionType;S!==ct.c&&S!==ct.h||o(i),r(i);break;default:r(i)}var j=Te.p(e.getState());j&&n.endTrackingIfWarningDismissed(i,j)}}}},jn=n(272),En=n(410),Dn=n(414),xn=n(460),wn=function(e,t){return function(e){return function(n){return function(a){switch(a.type){case"REQUEST_SHOW_PANE":(r=Ie.d(e.getState())).openView();break;case"REQUEST_CLOSE_PANE":(r=Ie.d(e.getState())).closeView();break;case"MOVE_FOCUS_TO_CANVAS":if(!v.rb())(r=Ie.d(e.getState())).moveFocusToCanvas_donotuse();break;case"REQUEST_MODAL_CONFIRMATION":(r=Ie.d(e.getState())).invokeModalConfirmationDialog?r.invokeModalConfirmationDialog(a.payload.onConfirm,a.payload.onCancel,a.payload.displayStrings):(Object(l.i)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),r.closeView());break;case"READY_TO_RENDER":(r=Ie.d(e.getState())).onReadyToRender&&r.onReadyToRender();break;case"RESOLVE_ATMENTION_CAPABILITY":if(v.B()&&v.C()){var o=a.payload.capability===Nt.a.Enabled;t.initializeController(o)}break;case"BEGIN_DRAFTING_SUCCESS":var r=Ie.d(e.getState());if(Object(En.a)(r)){if("CREATE"===(Object(ut.a)(a.payload.draftDetails)?a.payload.draftDetails.sessionConfiguration.sessionType:a.payload.draftDetails.sessionType)&&(Pn(e.dispatch,a.actionDetail,{displayMode:jn.a.Variable,desiredHeight:0}),!v.x()))return void n(a)}An(e.getState(),r);break;case"DISPLAY_DRAFT_WARNING":An(e.getState());break;case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":if(a.payload.closeOnDiscard){r=Ie.d(e.getState());return n(a),void r.closeView()}break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(v.w()&&"ios"===Object(xe.a)()&&a.payload.visibilityState===H.a.Closed){var i=Te.h(e.getState());Object(ge.c)(i)&&(c=e.dispatch,d=a.actionDetail,c(Object(Dn.a)(d,Ce.a.SharedComments,!0)).catch(Object(j.a)(s.e.reserveTag(546104259))))}}var c,d,m=e.getState(),u=n(a),p=e.getState();return function(e,t,n,a){var o=Ie.d(a);if(!Object(En.a)(o))return;var r=Te.h(a),i=Te.h(n),s=Object(ge.c)(r),c=Object(ge.c)(i),d=Te.g(a),l=Te.g(n);if(s!==c||!Object(En.a)(Ie.d(n))||!d&&l){if(!s)return d?void Pn(e,t,{displayMode:jn.a.Variable,desiredHeight:0}):void Pn(e,t,{displayMode:jn.a.Normal});var m=Te.p(a);if(m&&d&&m.selectedCardId===d.draftId)return;Pn(e,t,{displayMode:jn.a.FullScreen})}}(e.dispatch,a.actionDetail,m,p),u}}}};function An(e,t){(function(e){var t=Ie.e(e);return v.w()&&(v.o()?t===H.a.Hidden:t!==H.a.Visible)})(e)&&(t||Ie.d(e)).openView()}function Pn(e,t,n){e(Object(xn.a)(t,n)).catch(Object(j.a)(s.e.reserveTag(578426776)))}function kn(e,t,n,o,r,i,c,d){var m=Object(at.compose)(Object(at.applyMiddleware)(it,rt,ot.default,pn,Sn(o),function(e,t){return function(n){var a=en(n,t);return function(t){return function(o){var r=n.getState();switch(o.type){case"COMMENT_CONTEXT_CHANGED":case"RELOAD_COMMENTS":a.reset();break;case"COMMIT_DRAFT":var i=tn.b(r),c=Te.r(r);if(void 0!==c){var d=c.commentDraft;if(o.payload.metadataUpdates&&o.payload.metadataUpdates.Task){var m=void 0;d.sessionConfiguration.sessionType!==Xt.a&&d.sessionConfiguration.sessionType!==Xt.b&&(m=i[d.sessionConfiguration.threadId]&&i[d.sessionConfiguration.threadId].id),o.payload.metadataUpdates.Task.taskId=m,d.updateProperties("Task",o.payload.metadataUpdates.Task)}o.payload.data.temporaryCommentId=d.commit(o.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":return ve.N(Te.l(r),Te.u(r))?void a(o.payload.threadIds):void Object(l.i)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case"DISPATCH_LOAD_THREADS":if(!ve.N(Te.l(r),Te.u(r)))return;e.loadThreads(o.payload.threadIds);break;case"HIGHLIGHT_COMMENT":o.payload.actionSource===Ce.a.SharedComments&&e.highlightComment(o.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":var u=Te.h(r);if(Object(ge.d)(u))return;e.deleteComment(o.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":if(v.b())(g=e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId})).then((function(e){var t=tn.b(r)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()})).catch(Object(j.a)(s.e.reserveTag(593768922)));else e.setThreadResolvedState(o.payload.commentId,!0);break;case"REQUEST_REOPEN_THREAD":if(v.b())(g=e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId})).then((function(e){var t=tn.b(r)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()})).catch(Object(j.a)(s.e.reserveTag(593768924)));else e.setThreadResolvedState(o.payload.commentId,!1);break;case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":e.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":e.selectLastThreadInPreviousCommentContext();break;case"PRESENT_LINK_TO_COMMENT":e.presentLinkToComment(o.payload.commentId)}var p=t(o),f=n.getState(),C=Te.p(r),h=Te.p(f),b=void 0;switch("LOAD_COMMENT"===o.type||"VIRTUALIZE_COMMENTS"===o.type||"SELECT_COMMENT"===o.type&&o.payload.source!==Ce.a.SharedComments||!h||h.selectedCardId===(null==C?void 0:C.selectedCardId)||h.selectedCardId===Object(S.v)()||(b=h.selectedCardId),o.type){case"CLEAR_COMMENT_HIGHLIGHT":o.payload.actionSource===Ce.a.SharedComments&&void 0!==r.commentState.highlightedCommentId&&void 0===f.commentState.highlightedCommentId&&e.highlightComment("");break;case"DISPLAY_DRAFT_WARNING":var g;if(v.I()&&!v.rb())(g=Te.r(f))&&(b=g.threadId)}return b&&e.selectComment(b),p}}}}(e,o),cn,function(e){return function(t){return function(n){return function(a){var o,r,i=t.getState(),s=n(a),c=t.getState();switch(a.type){case"BEGIN_DRAFTING_SUCCESS":if(!Object(ut.a)(a.payload.draftDetails))break;var d=Te.h(c),l=a.payload.draftDetails.sessionConfiguration.draftId;(m=d.drafts[l])&&e.setDeferredActiveEditorFocusCommand(l);break;case"DISPLAY_DRAFT_WARNING":if(a.payload.draftWarningType===fn.a.CommitFailed)break;var m;d=Te.h(c);(m=Object(ve.H)(d))&&e.setDeferredActiveEditorFocusCommand(m.sessionConfiguration.draftId)}return(null===(o=Te.p(c))||void 0===o?void 0:o.selectedCardId)===(null===(r=Te.p(i))||void 0===r?void 0:r.selectedCardId)&&Te.h(c)===Te.h(i)||e.clearPendingOnComponentFocusedRequest(),s}}}}(c),wn(0,d),function(e){return function(t){return function(t){return function(n){switch(n.type){case"DISPLAY_DRAFT_WARNING":if(!v.I())break;var a=Cn.f(e,n.payload.draftWarningType);Object(z.b)(n.payload.draftWarningType===fn.a.ReturnToDraft?e.formatString(230,a):a)}return t(n)}}}}(i),function(e){return function(t){return function(n){return function(o){var r,i,c,d;switch(o.type){case"ADD_CONTENT_EXTENSION":o.payload.extension.priority=rn(o.payload.extension.provider.scope.renderMode,t.getState());break;case"REMOVE_CONTENT_EXTENSION":try{for(var l=Object(a.l)(o.payload.renderModes),m=l.next();!m.done;m=l.next()){var p=m.value,f=nn.a(t.getState())[p];f&&f.controller.unregisterExtension()}}catch(e){r={error:e}}finally{try{m&&!m.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}break;case"UPDATE_EXTENSION_PRIORITY":n(o),sn(t.getState(),u.e.TaskPane),v.qb()&&sn(t.getState(),u.e.TaskPaneItem),sn(t.getState(),u.e.Integrated),sn(t.getState(),u.e.Isolated);break;case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(an(t,o,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":return n(o),void t.dispatch(Object(fe.updateExtensionPriority)({renderContextType:Ee.a.None,telemetryVisitor:e,trackback:s.e.reserveTag(594834319)},v.qb()?(c={},c[u.e.TaskPane]=rn(u.e.TaskPane,t.getState()),c[u.e.TaskPaneItem]=rn(u.e.TaskPaneItem,t.getState()),c[u.e.Integrated]=rn(u.e.Integrated,t.getState()),c[u.e.Isolated]=rn(u.e.Isolated,t.getState()),c):(d={},d[u.e.TaskPane]=rn(u.e.TaskPane,t.getState()),d[u.e.Integrated]=rn(u.e.Integrated,t.getState()),d[u.e.Isolated]=rn(u.e.Isolated,t.getState()),d)));case"BEGIN_DRAFTING_SUCCESS":var C=o.payload.draftDetails,h=Object(ut.a)(C)?C.sessionConfiguration:C;if(on(t,o,n,h.sessionType))return;break;case"BEGIN_DRAFTING_FAILURE":if(on(t,o,n,o.payload.beginDraftingParams.sessionType))return;break;case"UPDATE_DRAFT_RENDER_CONTEXT":if(o.payload.isClaimingLock||o.actionDetail.renderContextType===Ee.a.DiscreteIsolated)break;var b=Te.r(t.getState());if(b&&on(t,o,n,b.commentDraft.sessionConfiguration.sessionType))return}return n(o)}}}}(o),function(e){return function(t){return function(n){return function(a){var o;if(!v.rb())return n(a);var r=t.getState(),i=n(a),s=t.getState();switch(a.type){case"DISPLAY_DRAFT_WARNING":var c=Te.p(r),d=Te.p(s),l=!d||d.selectedCardId===(null==c?void 0:c.selectedCardId);if(v.I()&&l){var m=Te.r(s);m&&e.bringContentIntoView({contentIdentifier:{contentId:m.threadId,contentType:u.b.CommentThread}})}break;case"SELECT_COMMENT":var p=Te.p(s);a.payload.source===Ce.a.SharedComments&&a.payload.selectType!==fe.SelectActionType.Polite&&Object(we.b)(a.actionDetail.renderContextType)&&p&&e.bringContentIntoView({contentIdentifier:{contentId:p.selectedCardId,contentType:u.b.CommentThread}});break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(Ie.a(s))break;var f=Te.r(s),C=f&&f.isInCurrentContext&&(null===(o=Te.p(s))||void 0===o?void 0:o.selectedCardId)===f.threadId?f.threadId:void 0;C&&e.bringContentIntoView({contentIdentifier:{contentId:C,contentType:u.b.CommentThread}});break;case"SELECT_CONTENT":e.selectNextOrPreviousContent(a.payload);break;case"MOVE_FOCUS_TO_CANVAS":e.moveFocus({region:x.a.Canvas,resource:a.payload.resource})}return i}}}}(r))),p=Object(at.createStore)(Qt,n,m);return c.initialize(p),p}var Rn=n(409),Nn=n(142),Mn=n(171),Vn=n(140),_n=n(105),Fn=n(270),Ln=function(){function e(e,t){this.commentStore=e,this.commandFactory=new tt(this.commentStore,t)}return e.prototype.selectNextOrPreviousThread=function(e,t,n){var a=v.o()&&!Ie.a(this.commentStore.getState()),o=Ie.c(this.commentStore.getState());return Me(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,n,a),o,this.commentStore)===ae.Handled},e.prototype.selectAcrossContexts=function(e,t){var n=Ie.c(this.commentStore.getState()),a=Te.f(this.commentStore.getState()),o=v.o()&&!Ie.a(this.commentStore.getState());Me(this.commandFactory.selectAcrossContexts(void 0,{direction:e,source:Ce.a.SharedComments,expandCard:!0,iterableContentTypes:void 0},t,a.nextPopulatedContextDetails,o),n,this.commentStore)},e}(),Hn=n(1010),Bn=n(802),Un={PostHeight:69,ExpandButtonHeight:26,ReplyDraftHeight:44,TaskTopper:29};function qn(e){var t=e.itemCount,n=e.readOnly,a=e.isTask,o=Un.PostHeight;return t>1&&(o+=Un.PostHeight+0),t>2&&(o+=Un.ExpandButtonHeight+0),n||(o+=Un.ReplyDraftHeight+0),a&&(o+=Un.TaskTopper),o}function zn(e,t){return function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return Object(a.d)(o,n),o.prototype.render=function(){var n=Object(a.a)(Object(a.a)({},t),this.props);return I.createElement(e,n)},o}(I.PureComponent)}var Wn,Gn=n(974);function Yn(e,t){return function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return Object(a.d)(o,n),o.prototype.render=function(){return I.createElement(Gn.a,{store:t},I.createElement(e,Object(a.a)({},this.props)))},o}(I.PureComponent)}!function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(Wn||(Wn={}));var Kn,Zn=n(609),Qn=n(163),Xn=n(214),Jn=n(371),$n=(s.e.reserveTag(595723983),s.e.reserveTag(595723984),s.e.reserveTag(574456150)),ea=s.e.reserveTag(574456151),ta=s.e.reserveTag(574456152),na=s.e.reserveTag(574456153),aa=n(855),oa=function(){function e(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}(),ra=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(e){this.mockContents=e},e.prototype.getId=function(){return this.mockId},e}();!function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}(Kn||(Kn={}));var ia=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getId=function(){return this.mockId},e}(),sa=function(){function e(e,t){var n=this;this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=Kn.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=function(){var e=n.commentStore.getState();return Ie.a(e)?Ie.c(e):n.viewManager.getComponentTreeForRenderMode(u.e.Integrated)},this.getCompleteHostableCommentCardRendererOwnProps=function(e){return Object(a.a)(Object(a.a)({},n.viewManager.getHostableCommentCardRendererProps(u.e.Integrated)),{resource:{id:e},componentInstanceId:Object(c.c)()})},this.getCompletePaneOwnProps=function(){return Object(a.a)(Object(a.a)({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(e){var t=n.commentStore.getState(),a=n.commentStore.dispatch;return Ie.a(t)?Object(Zn.b)(a,n.getCompletePaneOwnProps()):Object(Zn.a)(a,n.getCompleteHostableCommentCardRendererOwnProps(e))},this.getNewThreadDraftId=function(){var e=Te.g(n.commentStore.getState(),!0);return null==e?void 0:e.draftId},this.getParentId=function(e){var t=n.commentStore.getState(),a=Te.d(t),o=a.findIndex((function(t){return t.commentId===e}));return Object(r.h)(a[o])},this.invokeModalDialog=function(e,t,a){var o={renderContextType:Object(_e.b)(n.getActiveComponentTree()),trackback:s.e.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},r=n.commentStore.dispatch,i=n.getCompletePaneOwnProps(),c=Object(Zn.b)(r,i),d=n.commentStore.getState(),l=Te.p(d),m=Te.h(d);switch(e){case Qn.a.CancelNewDraft:case Qn.a.CancelReplyDraft:case Qn.a.CancelPostEdit:return c.discardDraftAsync(o,Ce.a.SharedComments,!1);case Qn.a.DeleteThread:return l&&c.requestDeleteThread(o,l.selectedCardId),Promise.resolve(Vn.a.Handled);case Qn.a.ClosePaneDraft:return Xn.p({ownProps:i,dispatchProps:c,componentTree:n.getActiveComponentTree(),draftState:m,invokeModalDialog:n.invokeModalDialog}),Promise.resolve(Vn.a.Handled);default:Object(s.n)(e)}},this.updateEventProcessingState=function(e){var t=Te.m(n.previousStoreState),a=Te.m(e);!t&&a&&n.pauseProcessing(),t&&!a&&n.beginProcessing()},this.handleStoreUpdate=function(){var e=n.commentStore.getState(),t=Te.h(e),a=Te.h(n.previousStoreState);!Object(ge.d)(t)&&n.pendingActionReason===Kn.NeedNotDrafting&&n.pendingAction&&(Object(l.i)().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),l.a.None,l.b.FullEvent).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Kn.None);var o=Object(ge.b)(t),r=Object(ge.b)(a);o&&!r&&n.pendingActionReason===Kn.NeedDrafting&&n.pendingAction&&(Object(l.i)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),l.a.None,l.b.FullEvent).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Kn.None),n.updateEventProcessingState(e),n.previousStoreState=e},this.onDrafting=function(e){var t=Object(l.i)().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),l.a.None,l.b.FullEvent),a=Te.h(n.commentStore.getState());Object(ge.b)(a)?(t.addDataField("ActionDeferred",!1,l.d.SystemMetadata),e(),t.successTag(592269460)):(t.addDataField("ActionDeferred",!0,l.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Kn.NeedDrafting,t.successTag(592269461))},this.onNotDrafting=function(e){var t=Object(l.i)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),l.a.None,l.b.FullEvent),a=Te.h(n.commentStore.getState());Object(ge.d)(a)?(t.addDataField("ActionDeferred",!0,l.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Kn.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,l.d.SystemMetadata),e(),t.successTag(592269463))},this.runAction=function(e,t){switch(e){case Kn.NeedDrafting:return n.onDrafting(t);case Kn.NeedNotDrafting:return n.onNotDrafting(t);case Kn.None:return t()}},this.onMockUIAction=new c.a((function(e){var t=Object(l.i)().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),l.a.None,l.b.FullEvent);t.addDataField("MockUIActionType",e.actionType,l.d.SystemMetadata);try{switch(e.actionType){case Wn.CreateThread:!function(e){return e.actionType===Wn.CreateThread&&void 0!==e.content}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464):n.runAction(Kn.NeedDrafting,(function(){return n.onCreateOrReply(new oa(n.getNewThreadDraftId(),e.content))}));break;case Wn.CancelCreateThread:!function(e){return e.actionType===Wn.CancelCreateThread}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465):n.runAction(Kn.NeedDrafting,(function(){return n.onCancelCreateThread(new oa(n.getNewThreadDraftId()))}));break;case Wn.StartReplySession:!function(e){return e.actionType===Wn.StartReplySession&&void 0!==e.threadId}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466):n.runAction(Kn.NeedNotDrafting,(function(){return n.onStartReplySession(new oa(e.threadId))}));break;case Wn.CancelReplySession:!function(e){return e.actionType===Wn.CancelReplySession&&void 0!==e.threadId}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467):n.runAction(Kn.NeedDrafting,(function(){return n.onCancelReplySession(new oa(e.threadId))}));break;case Wn.PostReply:!function(e){return e.actionType===Wn.PostReply&&void 0!==e.threadId&&void 0!==e.content}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468):n.runAction(Kn.NeedDrafting,(function(){return n.onCreateOrReply(new oa(e.threadId,e.content))}));break;case Wn.DeleteComment:!function(e){return e.actionType===Wn.DeleteComment&&void 0!==e.commentId}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469):n.runAction(Kn.NeedNotDrafting,(function(){return n.onDeleteComment(e.commentId)}));break;case Wn.DeleteThread:!function(e){return e.actionType===Wn.DeleteThread&&void 0!==e.threadId}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470):n.runAction(Kn.NeedNotDrafting,(function(){return n.onDeleteThread(e.threadId)}));break;case Wn.ResolveThread:!function(e){return e.actionType===Wn.ResolveThread&&void 0!==e.threadId}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471):n.runAction(Kn.NeedNotDrafting,(function(){return n.onResolveThread(e.threadId)}));break;case Wn.ReopenThread:!function(e){return e.actionType===Wn.ReopenThread&&void 0!==e.threadId}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472):n.runAction(Kn.NeedNotDrafting,(function(){return n.onReopenThread(e.threadId)}));break;case Wn.StartEditSession:!function(e){return e.actionType===Wn.StartEditSession&&void 0!==e.commentId}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473):n.runAction(Kn.NeedNotDrafting,(function(){return n.onStartEditSession(e.commentId)}));break;case Wn.CancelEditSession:!function(e){return e.actionType===Wn.CancelEditSession&&void 0!==e.commentId}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474):n.runAction(Kn.NeedDrafting,(function(){return n.onCancelEditSession(new ra(e.commentId))}));break;case Wn.PostEdit:if(function(e){return e.actionType===Wn.PostEdit&&void 0!==e.commentId&&void 0!==e.content}(e)){var a=new ra(e.commentId);a.setContents(e.content),n.runAction(Kn.NeedDrafting,(function(){return n.onPostEdit(a)}))}else Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case Wn.SelectComment:!function(e){return e.actionType===Wn.SelectComment&&void 0!==e.commentId}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504):n.runAction(Kn.NeedNotDrafting,(function(){return n.onSelectComment(new ia(e.commentId))}));break;case Wn.ClosePane:n.onClosePane();break;case Wn.ClickGhostCard:!function(e){return e.actionType===Wn.ClickGhostCard}(e)?Object(l.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505):n.runAction(Kn.NeedNotDrafting,(function(){return n.onGhostCommentClicked()}));break;default:Object(s.n)(e.actionType)}}catch(e){return void t.failTag(592269507,Object(dn.a)(e))}t.successTag(592269508)})),this.onStartEditSession=function(e){var t=n.commentStore.getState();Xn.F({trackback:s.e.reserveTag(592269509),id:e,data:n.getRenderableItems(t),selectedComment:Te.p(t),renderContextType:Object(_e.b)(n.getActiveComponentTree()),actionDispatchers:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(e,t){Xn.m({componentTree:n.getActiveComponentTree(),focusManager:n.viewManager.getFocusManager(),trackback:s.e.reserveTag(592269510),id:e,renderContextType:Object(_e.b)(n.getActiveComponentTree()),dispatchProps:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:t})},this.onClosePane=function(){var e=n.commentStore.getState();if(Ie.b(e)){var t=n.commentStore.dispatch;Object(Zn.b)(t,n.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:Ee.a.None,trackback:s.e.reserveTag(592269511)})}else Object(l.i)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(e){var t=e.getId(),a=n.commentStore.getState(),o=Te.h(a),i=Object(ve.K)(o),c=Te.g(a),d=(null==c?void 0:c.newComment.commentId)===t?{type:"CREATE"}:{type:"REPLY",parentId:t};Xn.c({trackback:s.e.reserveTag(592269513),commentCardRef:e,draftState:o,areMentionsEnabled:Object(ve.g)(Te.l(a),Te.a(a))===r.b.Enabled,session:d,componentTree:n.getActiveComponentTree(),dispatchProps:n.getDispatchProps(t),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:aa.a.Programmatic,selectedTaskAssignee:i&&i.selectedTaskAssignee}).catch(Object(j.a)(s.e.reserveTag(592269514)))},this.onCancelCreateThread=function(e){var t=e.getId(),a=n.getDispatchProps(t),o=n.commentStore.getState(),r=Te.g(o,!0),i=(null==r?void 0:r.newComment.commentId)===e.getId(),c=Te.p(o),d=Te.h(o),l=Ie.b(o),m=Object(_e.b)(n.getActiveComponentTree()),u=Te.q(o),p=i&&Object(Jn.b)(l,m,c,r,u),f=Xe.f(n.getRenderableItemThreads(o,n.getActiveComponentTree()),t);Xn.e({trackback:s.e.reserveTag(592269516),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:a,closeOnDiscard:p,cardId:t,draftState:d,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:f})},this.onGhostCommentClicked=function(){Ie.b(n.commentStore.getState())||Object(l.i)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(x.d.Next,Object(_e.b)(n.getActiveComponentTree()))},this.onPostEdit=function(e){var t=n.commentStore.getState(),a=n.getRenderableItems(t),o=Te.h(t),i=n.getParentId(e.getId()),c=n.getDispatchProps(i),d=Te.a(t),l=Te.l(t);Xn.D({trackback:s.e.reserveTag(592269518),id:e.getId(),data:a,draftState:o,contentPromise:e.getContentsAsync(),atMentionsEnabled:Object(ve.g)(l,d)===r.b.Enabled,componentTree:n.getActiveComponentTree(),actionDispatchers:c,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:aa.a.Programmatic}).catch(Object(j.a)(s.e.reserveTag(592269519)))},this.onCancelEditSession=function(e){var t=n.commentStore.getState(),a=Te.h(t),o=Te.p(t),r=Ie.b(t),i=Te.g(t,!0),c=Te.q(t),d=Object(Jn.b)(r,Object(_e.b)(n.getActiveComponentTree()),o,i,c),l=n.getRenderableItems(t),m=n.getParentId(e.getId()),u=n.getDispatchProps(m);Xn.A({trackback:s.e.reserveTag(592269521),commentId:e.getId(),setContents:e.setContents.bind(e),data:l,draftState:a,shouldClosePaneAfterDiscardDraft:d,onWillDiscardCallback:void 0,renderContextType:Object(_e.b)(n.getActiveComponentTree()),dispatchProps:u,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onCancelReplySession=function(e){var t=n.commentStore.getState(),a=Te.g(t,!0),o=(null==a?void 0:a.newComment.commentId)===e.getId(),r=Te.p(t),i=Te.h(t),c=e.getId(),d=n.getDispatchProps(c),l=Ie.b(t),m=Object(_e.b)(n.getActiveComponentTree()),u=Te.q(n.commentStore.getState()),p=o&&Object(Jn.b)(l,m,r,a,u),f=Xe.f(n.getRenderableItemThreads(t,n.getActiveComponentTree()),c);Xn.e({trackback:s.e.reserveTag(592269522),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:d,closeOnDiscard:p,cardId:e.getId(),draftState:i,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:f})},this.onDeleteThread=function(e){var t=n.commentStore.getState(),a=Te.p(t),o=n.getDispatchProps(e);Xn.d({trackback:s.e.reserveTag(592269523),id:e,data:n.getRenderableItems(t),selectedComment:a,componentTree:n.getActiveComponentTree(),invokeModalDialog:n.invokeModalDialog,dispatchProps:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isTask:!!tn.b(t)[e],threadIndex:Xe.f(n.getRenderableItemThreads(t,n.getActiveComponentTree()),e),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(e){var t=n.commentStore.getState(),a=Te.p(t),o=n.getParentId(e),r=n.getDispatchProps(o);Xn.E({trackback:s.e.reserveTag(592269524),id:e,data:n.getRenderableItems(t),selectedComment:a,renderContextType:Object(_e.b)(n.getActiveComponentTree()),actionDispatchers:r,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onSelectComment=function(e){var t=n.commentStore.getState(),a=Te.g(t,!0),o=n.getRenderableItems(t),r=e.getId(),i=r===(null==a?void 0:a.draftId)?a&&{commentModel:a.newComment}:o.find((function(e){return Xe.e(e)===r}));if(i&&Object($e.a)(i)){var c=i,d=c.commentModel.parentId,m=n.getDispatchProps(d?c.commentModel.commentId:c.commentModel.parentId),u=Te.p(t),p=Te.h(t),f=n.getActiveComponentTree(),C=Object(De.a)(Xe.i(i),Te.i(t),Object(_e.b)(f),p,u);Xn.K({trackback:s.e.reserveTag(592269526),renderableItem:i,selectedComment:u,cardCollapsedState:C,dispatchProps:m,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:f,draftState_deprecated:p}).catch(Object(j.a)(s.e.reserveTag(590123734)))}else Object(l.i)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525)},this.onStartReplySession=function(e){Xn.a({trackback:s.e.reserveTag(592269527),threadId:e.getId(),renderContextType:Object(_e.b)(n.getActiveComponentTree()),dispatchProps:n.getDispatchProps(e.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getRenderableItems=Te.x(),this.getRenderableItemThreads=Te.w(this.getRenderableItems)}return e.prototype.initialize=function(){var e=Object(l.i)().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),l.a.None,l.b.FullEvent);this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),e.successTag(ta)},e.prototype.teardown=function(){var e,t=Object(l.i)().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),l.a.None,l.b.FullEvent);null===(e=this.registrationToken)||void 0===e||e.unsubscribe(),this.unsubscribeStoreListener(),t.successTag(na)},e.prototype.beginProcessing=function(){var e=this,t=Object(l.i)().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),l.a.None,l.b.FullEvent);this.startProcessingActionsPending=setTimeout((function(){e.onMockUIAction.startProcessing(),e.startProcessingActionsPending=void 0,t.successTag($n)}),100)},e.prototype.pauseProcessing=function(){var e=Object(l.i)().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),l.a.None,l.b.FullEvent);this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),e.successTag(ea)},e.prototype.onReopenThread=function(e,t){Xn.l({trackback:s.e.reserveTag(592269528),id:e,renderContextType:Object(_e.b)(this.getActiveComponentTree()),dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},e}(),ca=n(719);var da=n(701);function la(e,t,n,a){return function(o){return Object(u.f)().registerExtension(t,n,a).then((function(t){return o(Object(da.a)(e,t)),t}))}}var ma=n(599);var ua=n(443),pa=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);var a=this.hostableComponentRegistry.get(e);n?a.set(t,n):a.delete(t)},e.prototype.getComponent=function(e,t){var n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)},e}(),fa=function(e){function t(t){var n=e.call(this,t)||this;return t.initializeImmediately&&n.beginInitialization(),n}return Object(a.d)(t,e),t}(function(){function e(e){var t=this,n=e.apiContext,a=e.viewProvider,o=e.commentAPI,r=e.peopleAPI,i=e.localizationAPI,d=e.themeAPI,l=e.focusManager,m=e.lppManager,p=e.initializationReason,f=e.commentStore,C=e.viewStrategyFactory,h=e.mockUIDriver;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(e){t.commentStore.dispatch(fe.onInitialRender({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595646478),telemetryVisitor:t.telemetryVisitor},{commentId:e.commentId,renderContextType:e.renderContextType})),Object(we.b)(e.renderContextType)&&t.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Object(c.o)((function(){A.sendCodeMarker({context:t.apiContext,type:D.DataReceived,assertTag:s.e.reserveTag(595731293)})})),this.getComponentTree=function(e){switch(e){case Ee.a.None:Object(s.o)(!1,"Unexpected render context type:"+e,s.e.reserveTag(589088338));case Ee.a.FullPane:case Ee.a.HalfPane:return t.getComponentTreeForRenderMode(u.e.TaskPaneItem);case Ee.a.DiscreteIntegrated:return t.getComponentTreeForRenderMode(u.e.Integrated);case Ee.a.DiscreteIsolated:return t.getComponentTreeForRenderMode(u.e.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:t.commentAPI,localizationAPI:t.localizationAPI,peopleAPI:t.peopleAPI,focusManager:t.focusManager,telemetryVisitor:t.telemetryVisitor,onInitialRender:t.onInitialRender,correlationId:t.correlationId,lppManager:t.lppManager}},this.setComponentRef=function(e,n,a){t.viewManagerRefRegistry.registerComponent(e,n,a)},this.onSuggestionsDetailsChange=function(e){t.commentStore.dispatch(fe.updateSuggestionsDetails({renderContextType:Ee.a.None,trackback:s.e.reserveTag(592492758),telemetryVisitor:t.telemetryVisitor},e))},this.internalInterruptableCommandHandler=function(e){return t.activeViewStrategy.handleCommentInterruptableCommand(e,t.commentStore.dispatch,t.commentStore.getState)},this.apiContext=n,this.viewProvider=a,this.commentAPI=o,this.peopleAPI=r,this.localizationAPI=i,this.themeAPI=d,this.focusManager=l,this.lastInitializationReason=p,this.viewStrategyFactory=C,this.mockUIDriver=h,this.telemetryVisitor=L.getTelemetryVisitor(this.apiContext),this.correlationId=L.getCorrelationId(this.apiContext)||Object(c.c)(),this.lppManager=m,this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new Ln(f,this.telemetryVisitor);var b=f.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(b.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=f,this.discreteIntegratedComponentTree=new Bt(Ee.a.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new Bt(Ee.a.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new pa,v.o()&&this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new sa(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){var e,t;(0,this.commentStore.dispatch)((e={renderContextType:Ee.a.None,trackback:s.e.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},t=this.commentAPI,function(n){var a=Object(l.i)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,l.a.None,l.b.NecessaryServiceDataEvent);return t.checkAtMentionCapability().then((function(t){a.addDataField("AtMentionsEnabled",t,l.d.SystemMetadata),a.successTag(595903522),n(Object(ma.a)(e,t?ct.b.Enabled:ct.b.Disabled))}),(function(t){a.failTag(595903523,Object(dn.a)(t,-2130957528)),n(Object(ma.a)(e,ct.b.Disabled))}))})).catch(Object(j.a)(s.e.reserveTag(595152915)))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var e,t;this.initialized||(this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),v.o()||this.registerActions(),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),v.o()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),this.commentStore.dispatch(fe.updateCapabilities_deprecated({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595732560),telemetryVisitor:this.telemetryVisitor},{resolve:this.commentAPI.resolveSupported()})),v.J()&&this.commentStore.dispatch(fe.updateModelCapabilities({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595685378),telemetryVisitor:this.telemetryVisitor},this.commentAPI.resolveSupported()?We.Resolve:We.None,ve.e)),this.peopleAPI.capabilities&Fn.a.GetSuggestionsDetails&&(this.commentStore.dispatch((e={renderContextType:Ee.a.None,trackback:s.e.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},t=this.peopleAPI,function(n){if(!(t.capabilities&Fn.a.GetSuggestionsDetails))return Promise.resolve();var a=Object(l.i)().createActivityObject("RefreshSuggestionsDetails",e.telemetryVisitor,l.a.OnSuccess,l.b.NecessaryServiceDataEvent);return t.getSuggestionsDetails?t.getSuggestionsDetails().then((function(t){a.successTag(592492760),n(Object(ca.a)(e,t))}),(function(e){a.failTag(592492761,-2130957495)})):(a.failTag(592492759,-2130957494),Promise.resolve())})).catch(Object(j.a)(s.e.reserveTag(592492754))),Object(l.i)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(e){!this.initialLoadComplete&&e&&void 0===Te.m(e)&&Te.d(e).length>0&&this.onFirstLoadComplete()},e.prototype.observeStore=function(e){var t,n=this;return e.subscribe((function(){var a=e.getState();if(v.o()){var o=Te.m(a);o!==t&&(t=o,n.onChange(a))}}))},e.prototype.onFirstLoadComplete=function(){var e=this;Object(l.i)().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach((function(t){e.onCommentUIAction(t)})),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()},e.prototype.registerActions=function(){this.commentAPI.registerForAction(Mn.a.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(Mn.a.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(Mn.a.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(Mn.a.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(Mn.a.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(Mn.a.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(e){switch(e){case u.e.Integrated:return this.discreteIntegratedComponentTree;case u.e.Isolated:return this.discreteIsolatedComponentTree;case u.e.TaskPane:case u.e.TaskPaneItem:return Ie.c(this.getCommentStore().getState())}},e.prototype.getPaneOwnProps=function(){return Object(a.a)(Object(a.a)({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId})},e.prototype.getHostableCommentCardRendererProps=function(e){var t=this;return Object(a.a)(Object(a.a)({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:function(n,a){t.setComponentRef(e,n,a)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.registerCommentCardHostableComponent=function(e,t,n){var o=this,r=Yn(zn(n.HostableCommentCardRendererContainer,Object(a.a)({},this.getHostableCommentCardRendererProps(e))),this.commentStore),i=E(t,this.apiContext),s=Object(T.c)().registerComponent(i,r);return s.onComponentCommand.subscribe((function(t){o.processHostableComponentCommand(t,e)})),{componentController:s,contextAwareName:i}},e.prototype.initializeContentExtensions=function(){var e=this;Object(ua.c)("ExtensionAwareCommentPaneContainer").then((function(t){var n,o=t;if(void 0!==o){var r=Yn(v.s()?zn(o.ExtensionAwareCommentPane,Object(a.a)(Object(a.a)({},e.getPaneOwnProps()),{extensionRenderMode:u.e.Integrated,themeAPI:e.themeAPI})):zn(o.ExtensionAwareCommentPaneContainer_deprecated,Object(a.a)(Object(a.a)({},e.getPaneOwnProps()),{extensionRenderMode:u.e.Integrated,themeAPI:e.themeAPI})),e.commentStore),i=E("SharedCommentPane",e.apiContext);e.commentPaneComponentController=Object(T.c)().registerComponent(i,r),v.Z()&&e.commentStore.dispatch(la({renderContextType:Ee.a.None,trackback:s.e.reserveTag(573384478),telemetryVisitor:e.telemetryVisitor},u.b.CommentThread,i,{renderMode:u.e.TaskPane,priority:u.d.Disabled,instanceId:e.apiContext,componentDimensions:void 0})).catch(Object(j.a)(s.e.reserveTag(573384479)))}Object(ua.c)("HostableCommentCardRendererContainer").then((function(t){if(void 0!==(n=t)){var a=e.registerCommentCardHostableComponent(u.e.Integrated,"DiscreteIntegratedCommentCard",n),o=a.componentController,r=a.contextAwareName;e.discreteIntegratedComponentController=o;var i=e.registerCommentCardHostableComponent(u.e.Isolated,"DiscreteIsolatedCommentCard",n),c=i.componentController,d=i.contextAwareName;e.discreteIsolatedComponentController=c;var l=void 0;if(v.qb()){var m=e.registerCommentCardHostableComponent(u.e.TaskPaneItem,"TaskPaneItemCommentCard",n),p=m.componentController,f=m.contextAwareName;e.commentPaneItemComponentController=p,l=f}e.commentStore.dispatch(la({renderContextType:Ee.a.None,trackback:s.e.reserveTag(574428426),telemetryVisitor:e.telemetryVisitor},u.b.CommentThread,r,{renderMode:u.e.Integrated,priority:u.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(j.a)(s.e.reserveTag(595645980))),e.commentStore.dispatch(la({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595616916),telemetryVisitor:e.telemetryVisitor},u.b.CommentThread,d,{renderMode:u.e.Isolated,priority:u.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize(),isContentAvailable:function(t){var n=e.commentStore.getState(),a=Object(Bn.c)(t,Te.d(n),Te.c(n)),o=Te.h(n);return Object(Bn.a)(t,Object(Bn.b)(t,Te.d(n),a,Te.g(n,!0),o.drafts[t]),o,Ee.a.DiscreteIsolated,Object(Hn.a)(t,Ee.a.DiscreteIsolated,o))}})).catch(Object(j.a)(s.e.reserveTag(595645982))),void 0!==l&&e.commentStore.dispatch(la({renderContextType:Ee.a.None,trackback:s.e.reserveTag(546174344),telemetryVisitor:e.telemetryVisitor},u.b.CommentThread,l,{renderMode:u.e.TaskPaneItem,priority:u.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(j.a)(s.e.reserveTag(546174345)))}})).catch(Object(j.a)(s.e.reserveTag(595645984)))})).catch(Object(j.a)(s.e.reserveTag(595645986)))},e.prototype.getAverageCardSize=function(){return{width:259,height:qn({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(e,t){var n=this;switch(e.command){case"Focus":return void setTimeout((function(){var a;return null===(a=n.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===a?void 0:a.focus()}));case"UpdateComponentDataProps":break;default:return void Object(l.i)().assertConditionTag(!1,"Unexpected command type",593786644)}},e.prototype.teardownContentExtensions=function(){var e,t,n,o,r=[u.e.Integrated,u.e.Isolated];v.qb()&&(r.push(u.e.TaskPaneItem),v.Z()&&r.push(u.e.TaskPane)),this.commentStore.dispatch(fe.removeContentExtensions.apply(fe,Object(a.j)([{renderContextType:Ee.a.None,trackback:s.e.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor}],r))),null===(e=this.commentPaneComponentController)||void 0===e||e.unregister(),null===(t=this.commentPaneItemComponentController)||void 0===t||t.unregister(),null===(n=this.discreteIntegratedComponentController)||void 0===n||n.unregister(),null===(o=this.discreteIsolatedComponentController)||void 0===o||o.unregister()},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(Mn.a.AddComment),this.commentAPI.unregisterForAction(Mn.a.NextThread),this.commentAPI.unregisterForAction(Mn.a.PreviousThread),this.commentAPI.unregisterForAction(Mn.a.DeleteThread),this.commentAPI.unregisterForAction(Mn.a.BackKeyPressed),this.commentAPI.unregisterForAction(Mn.a.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&Fn.a.GetSuggestionsDetails&&(Object(l.i)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),v.o()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(e){this.commentUIActionListeners.push(e)},e.prototype.unregisterComponentUIActionListener=function(e){var t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)},e.prototype.registerInterruptableCommandListener=function(e){this.commentInterruptableCommandListeners.push(e)},e.prototype.unregisterComponentInterruptableCommandListener=function(e){var t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)},e.prototype.onCommentUIAction=function(e){var t,n;if(v.o()&&e.actionBehavior===Rn.a.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;try{for(var o=Object(a.l)(this.commentUIActionListeners),r=o.next();!r.done;r=o.next()){var i=(0,r.value)(e);if(i!==_n.a.NotHandled)return i===_n.a.Success}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===_n.a.Success},e.prototype.onCommentEventReceived=function(e,t){var n=Object(s.l)(s.c.Comments,Nn.a[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null==n||n.end(),v.o()&&!this.initialLoadComplete&&e===Nn.a.CommentContextChanged&&Ct.b(t)&&0===t.numberOfComments&&this.onFirstLoadComplete()},e.prototype.onCommentInterruptableCommandReceived=function(e){var t=Promise.resolve(Vn.a.Unhandled);return this.commentInterruptableCommandListeners.reduce((function(t,n){return t.then((function(t){return t!==Vn.a.Unhandled?Promise.resolve(t):n(e)}))}),t)},e.prototype.onViewContainerEvent=function(e){var t=this.commentStore.dispatch;switch(e.eventType){case B.a.VisibilityChanged:return void t(fe.viewContainerVisibilityChanged({renderContextType:Ee.a.None,trackback:s.e.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case B.a.ViewContainerChanged:return t(fe.viewContainerChanged({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor));case B.a.FocusTriggered:return void this.focusManager.focusCommentPaneCommand(Ie.c(this.commentStore.getState()));case B.a.FoldableLayoutStateChanged:t(fe.viewContainerFoldableLayoutStateChanged({renderContextType:Ee.a.None,trackback:s.e.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}},e}()),Ca=function(){function e(e,t){}return e.prototype.getAccountID=function(){return""},e.prototype.getLPPController=function(){},e.prototype.initializeController=function(e){},e.prototype.isInitialized=function(){return!1},e.prototype.isOnline=function(){return!1},e.prototype.refreshLPPController=function(){},e}(),ha=n(923),va=function(){function e(){this.maxAcceptableInterval=3e3,this.lastHeartBeatReceived=0,this.timerStarted=!1}return e.prototype.heartbeatReceived=function(){var e=this;this.lastHeartBeatReceived=Date.now(),this.timerStarted||(this.timerStarted=!0,setInterval((function(){e.timerFired()}),1e3))},e.prototype.timerFired=function(){var e=Date.now()-this.lastHeartBeatReceived;e>this.maxAcceptableInterval&&Object(l.i)().assertConditionTag(!1,"Max heartbeat interval exceeded: "+e,561071552)},e}(),ba=n(175),ga=n(376),ya=n(455),Ta=n(377),Ia=n(402),Oa=n(251),Sa=function(){function e(e,t,n,a,o){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=a,this.telemetryVisitor=o,this.getDraftRenderContextType=Te.v(),this.getRenderableItems=Te.x()}return e.prototype.processCommentEvent=function(e,t,n,a){var o,r=a();switch(e){case Nn.a.CommentContextChanged:if(!Ct.b(t))return void Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595912090);n(fe.commentContextChanged({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595912089),telemetryVisitor:this.telemetryVisitor},t));break;case Nn.a.CommentsChanged:if(!Ct.i(t))return void Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case Nn.a.LoadComments:if(!Ct.j(t))return void Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case Nn.a.CommentSelected:if(!Ct.h(t))return void Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId){var i=void 0;if(void 0!==Te.c(r)[t.commentId])i=Object(Ta.a)(t.commentId,Ce.a.Canvas,{selectType:t.selectionReason&&"ContentNavigation"===t.selectionReason.type&&t.selectionReason.contentNavigationReason===x.c.Keyboarding?fe.SelectActionType.SelectCard:fe.SelectActionType.ExpandCard});else{var c=Te.d(r).find((function(e){return e.commentId===t.commentId}));if(void 0===c)return;i=Object(Ta.a)(c.parentId,Ce.a.Canvas,{selectType:fe.SelectActionType.SelectPost,selectedPost:t.commentId})}n(Object(Ta.b)(void 0,{renderContextType:Ee.a.None,trackback:s.e.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},i,!1)).catch(Object(j.a)(s.e.reserveTag(579744150)))}else n(fe.clearCommentSelection({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));break;case Nn.a.CommentContextReload:if(!Ct.d(t))return void Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case Nn.a.CommentHighlighted:if(!Ct.f(t))return void Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(fe.highlightComment({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},t.commentId,Ce.a.Canvas)):n(fe.clearCommentHighlight({renderContextType:Ee.a.None,trackback:s.e.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},Ce.a.Canvas,void 0));break;case Nn.a.NextPopulatedContextDetailsUpdated:if(!Ct.l(t)||!t.contextDetails.nextPopulatedContextDetails)return void Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(fe.nextPopulatedContextDetailsUpdated({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case Nn.a.CommentHostCapabilitiesChanged:Ct.g(t)?n(fe.updateCapabilities_deprecated({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595732558),telemetryVisitor:this.telemetryVisitor},t.capabilities)):Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595732559);break;case Nn.a.ModelCapabilitiesChanged:Ct.k(t)?n(fe.updateModelCapabilities({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags,t.richTextCapabilityFlags)):Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case Nn.a.CommentError:if(!Ct.e(t))return void Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case Nn.a.ReturnToDraftRequested:Ct.m(t)&&n(fe.displayDraftWarning({draftWarningType:fn.a.ReturnToDraft,draftWarningReason:Oa.a.HostRequest},{renderContextType:Ee.a.None,trackback:s.e.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break;case Nn.a.UpdateDraftThread:Ct.o(t)?n(fe.updateDraftThread({renderContextType:Ee.a.None,trackback:s.e.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},t)):Object(l.i)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;case Nn.a.SmartReplyPopulated:if(!Ct.n(t))return void Object(l.i)().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);n(fe.populateSmartReply({renderContextType:Ee.a.None,trackback:s.e.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},t));break;case Nn.a.NativeHeartbeat:this.heartbeatHelper||(this.heartbeatHelper=new va),null===(o=this.heartbeatHelper)||void 0===o||o.heartbeatReceived();break;default:return void Object(l.i)().assertConditionTag(!1,"Deprecated event detected.",595912132)}},e.prototype.processCommentUIAction=function(e,t,n,a){var o=this,r=n();switch(e.actionType){case Mn.a.ShowHideCommentPane:return _n.c(e.actionBehavior)?Ie.b(r)?_n.a.Success:_n.a.Fail:(_n.d(e.actionBehavior)&&(Ie.b(r)?t(fe.requestClosePane({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):t(fe.requestShowPane({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),_n.a.Success);case Mn.a.AddComment:if(_n.b(e.actionBehavior)){if(!Object(Fe.a)(Te.h(r),Te.g(r)))return _n.a.Fail}else if(_n.d(e.actionBehavior)){var i={renderContextType:Ee.a.None,trackback:s.e.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return t(Object(ga.a)(i,this.commentAPI,{sessionType:"CREATE"},!(!a||!a.retainSelectionOnAddComment),this.peopleAPI)).catch(Object(j.a)(s.e.reserveTag(592314376))),_n.a.Success}return _n.a.Success;case Mn.a.NextThread:if(Object(l.i)().assertConditionTag(!_n.c(e.actionBehavior),"This action type does not support toggled status",595899713),_n.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:x.d.Next,source:Ce.a.SharedComments,expandCard:!0,iterableContentTypes:[u.b.CommentThread]},x.c.HostAction,Ee.a.None)}),t,v.ub()?void 0:Oa.a.NextThread,s.e.reserveTag(591729749));else if(_n.b(e.actionBehavior))return Object(Fe.c)(r)?_n.a.Success:_n.a.Fail;return _n.a.Success;case Mn.a.PreviousThread:if(Object(l.i)().assertConditionTag(!_n.c(e.actionBehavior),"This action type does not support toggled status",595899714),_n.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:x.d.Previous,source:Ce.a.SharedComments,expandCard:!0,iterableContentTypes:[u.b.CommentThread]},x.c.HostAction,Ee.a.None)}),t,v.ub()?void 0:Oa.a.PreviousThread,s.e.reserveTag(591729750));else if(_n.b(e.actionBehavior))return Object(Fe.c)(r)?_n.a.Success:_n.a.Fail;return _n.a.Success;case Mn.a.DeleteThread:if(Object(l.i)().assertConditionTag(!_n.c(e.actionBehavior),"This action type does not support toggled status",595899715),_n.b(e.actionBehavior)){if(!Object(Fe.b)(r.commentState))return _n.a.Fail}else _n.d(e.actionBehavior)&&this.handleActionOrReturnToDraft((function(){var e=Te.p(r);e&&t(fe.requestDeleteThread({renderContextType:Ee.a.None,trackback:s.e.reserveTag(591738706),telemetryVisitor:o.telemetryVisitor},e.selectedCardId))}),t,Oa.a.DeleteThread,s.e.reserveTag(591729751));return _n.a.Success}return _n.a.NotHandled},e.prototype.beginDraftingHelper=function(e,t,n,a){return e(Object(ga.a)({renderContextType:Ee.a.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,t,!1,this.peopleAPI)).catch(Object(j.a)(a)).then((function(){return r.f.Handled}))},e.prototype.handleCommentInterruptableCommand=function(e,t,n){switch(e.type){case"CreateComment":return this.beginDraftingHelper(t,{sessionType:"CREATE"},s.e.reserveTag(574371082),s.e.reserveTag(574371083));case"EditComment":var a=n(),o=this.getRenderableItems(a),i=Te.p(a),c=Object(Xe.a)(o,e.commentId);return c?Object(Xn.L)({comment:c,threads:o,selectedComment:i,warningType:ye.a.Edit})?(t(fe.showLowFidelityWarning({renderContextType:Ee.a.None,telemetryVisitor:this.telemetryVisitor,trackback:s.e.reserveTag(593000206)},e.commentId,ye.a.Edit)),Promise.resolve(r.f.Handled)):this.beginDraftingHelper(t,{sessionType:"EDIT",commentId:e.commentId},s.e.reserveTag(593000207),s.e.reserveTag(593000208)):(Object(l.i)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(r.f.Handled));case"ReplyComment":return this.beginDraftingHelper(t,{sessionType:"REPLY",threadId:e.threadId},s.e.reserveTag(593000209),s.e.reserveTag(593000210));case"DiscardDraft":var d=n();if(e.mode===ha.a.TryAutoDiscard)return t(Object(ya.a)({renderContextType:Ee.a.None,telemetryVisitor:this.telemetryVisitor,trackback:s.e.reserveTag(575411521)},Ce.a.Canvas)).then((function(e){return e.draftDiscardResult}));i=Te.p(d);if(e.mode===ha.a.Dialog&&Object(Ia.a)(Te.h(d))===ba.a.CannotAutoDiscard)return Ie.a(d)?Promise.resolve(r.f.Unhandled):Promise.resolve(r.f.Canceled);var m=Object(Jn.b)(Ie.e(d)===H.a.Visible,Ee.a.None,i,Te.g(d),Te.q(d));return t(Object(Dn.a)({renderContextType:Ee.a.None,telemetryVisitor:this.telemetryVisitor,trackback:s.e.reserveTag(575411522)},Ce.a.Canvas,m,void 0));default:return Promise.resolve(r.f.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(e,t,n,a){t(Object(ya.a)({renderContextType:Ee.a.None,trackback:a,telemetryVisitor:this.telemetryVisitor},Ce.a.SharedComments,n)).then((function(t){void 0!==n&&t.draftDiscardBehavior!==ba.a.NoDraft&&t.draftDiscardResult!==r.f.Handled||e()})).catch(Object(j.a)(s.e.reserveTag(591738704)))},e}(),ja=n(708),Ea=n(709),Da=n(711),xa=n(96),wa=n(717),Aa=n(718);function Pa(e,t,n,a){return function(o,r){var i=r();a&&o(a);var c=a?a.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&o(Object(wa.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953696)},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId)if(n.selectedCommentId){var d=Te.p(i);if(d&&d.selectedCardId===n.selectedCommentId)if(Object(ye.c)(d.selectionDetails)){var l=v.sb()||!d.selectionDetails.expanded_deprecated?xa.a.SelectCard:xa.a.ExpandCard;o(Object(xa.b)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953697)},n.selectedCommentId,void 0,l,Ce.a.Canvas))}else{var m=d.selectionDetails.selectedPostId,u=r();Te.d(u).find((function(e){return e.commentId===m}))?o(Object(xa.b)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953698)},n.selectedCommentId,m,xa.a.SelectPost,Ce.a.Canvas)):o(Object(xa.b)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953699)},n.selectedCommentId,void 0,xa.a.ExpandCard,Ce.a.Canvas))}else o(Object(xa.b)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953728)},n.selectedCommentId,void 0,xa.a.ExpandCard,Ce.a.Canvas))}else o(Object(Ea.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953729)}));void 0!==n.highlightedCommentId&&(n.highlightedCommentId?o(Object(Da.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953730)},n.highlightedCommentId,Ce.a.Canvas)):o(Object(ja.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(578586722)},Ce.a.Canvas,void 0)));var p=Pt(n);p&&o(Object(Aa.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953732)},p))}}}var ka=n(19),Ra=n(415);var Na=n(712),Ma=n(713);function Va(e,t,n){return function(a){Ct.p(t)?a(Object(Ma.a)(Object(ka.a)(e,s.e.reserveTag(595137280)),t.threads)):(v.N()&&a(Object(Ra.a)(Object(ka.a)(e,s.e.reserveTag(595137282)),t.comments,t.tasks,n)),a(Object(Na.a)(Object(ka.a)(e,s.e.reserveTag(595137283)),t.comments,t.tasks)))}}var _a=function(){function e(e,t,n,a){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=a}return e.prototype.processCommentEvent=function(e,t,n,a){switch(e){case Nn.a.CommentsChanged:Ct.i(t)&&n(Pa(Ee.a.None,this.telemetryVisitor,t.contextDetails,Object(fe.applyCommentChanges)({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},t.changes)));break;case Nn.a.LoadComments:Ct.j(t)&&n(Va({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case Nn.a.CommentContextReload:Ct.d(t)&&n((o={renderContextType:Ee.a.None,trackback:s.e.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},r=t,i=this.peopleAPI,c=this.telemetryVisitor,function(e,t){var n=[];Object(Ct.c)(r)?(Object(l.i)().assertConditionTag(!t||Object(ve.N)(Te.l(t()),Te.u(t())),"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),n=gt(r.commentIds,(function(){return t().commentState}))):n=r.comments;var a=Object(Ct.c)(r)?[]:r.tasks;e(Pa(o.renderContextType,c,r.contextDetails,Object(fe.reloadComments)(Object(ka.a)(o,s.e.reserveTag(595953694)),{comments:n,tasks:a}))),v.N()&&e(Object(Ra.a)(Object(ka.a)(o,s.e.reserveTag(595932895)),n,a,i)).catch(Object(j.a)(s.e.reserveTag(595645974)))}))}var o,r,i,c;this.commonViewStrategy.processCommentEvent(e,t,n,a)},e.prototype.processCommentUIAction=function(e,t,n){if(e.actionType===r.d.AddComment&&e.actionBehavior!==r.a.CheckEnabled){var a=n();Ie.b(a)&&this.focusManager.onUserAction(a.paneState.componentTree,{userAction:Ge.a.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(e,t,n)},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}();var Fa=n(714);var La=function(){function e(e,t,n,a){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=a}return e.prototype.processCommentEvent=function(e,t,n,o){switch(e){case Nn.a.CommentsChanged:Ct.i(t)&&n((r=t,i=this.telemetryVisitor,function(e,t){var n,o,c,d=t(),m=!1,u=r.contextDetails;if(""===(null==u?void 0:u.selectedCommentId)&&(u=Object(a.a)(Object(a.a)({},u),{selectedCommentId:void 0})),e(Pa(Ee.a.None,i,u,Object(fe.applyCommentChanges)({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595953743),telemetryVisitor:i},r.changes))),!r.contextDetails||!r.contextDetails.selectedCommentId){var p=Te.p(d),f=p?p.selectedCardId:void 0,C=t(),h=Te.p(C),v=Te.d(d),b=Te.d(C);if(f){if(f&&r.changes.some((function(e){return e.type===dt.a.Delete&&e.model.commentId===f}))){var g=v.findIndex((function(e){return e.commentId===f}));try{for(var y=Object(a.l)(r.changes),T=y.next();!T.done;T=y.next()){var I=T.value;switch(I.type){case dt.a.Insert:I.index<=g&&++g;break;case dt.a.Delete:I.index<g&&--g;break;case dt.a.Modify:case dt.a.Unknown:case dt.a.Load:break;default:Object(s.n)(I)}}}catch(e){n={error:e}}finally{try{T&&!T.done&&(o=y.return)&&o.call(y)}finally{if(n)throw n.error}}if(h)throw new M.a(ee.m,s.e.reserveTag(589103626),-2130957551);if(b.length){var O=g;O===b.length&&(O=b.length-1);var S=b[O],j=Object(Ke.b)(S);e(Object(fe.selectComment)({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595953744),telemetryVisitor:i},j,void 0,xa.a.ExpandCard,Ce.a.SharedComments)),m=!0}}}else!v.length&&b.length&&(e(Object(fe.selectComment)({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595947723),telemetryVisitor:i},b[0].commentId,void 0,xa.a.ExpandCard,Ce.a.SharedComments)),m=!0);Object(l.i)().assertConditionTag(m||0===b.length||""!==(null===(c=r.contextDetails)||void 0===c?void 0:c.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}));break;case Nn.a.LoadComments:Ct.j(t)&&(o().paneState.initializationStatus===Mt.a.Initialized||this.lastInitializationReason!==N.a.NewThread?n(function(e,t,n,a){return function(o,r){o(Va({renderContextType:e,trackback:s.e.reserveTag(595899530),telemetryVisitor:a},t,n));var i=r(),c=Object(ve.N)(Te.l(i),Te.u(i)),d=Te.d(i);Object(he.a)({commentData:d,pendingCommentLoad:Te.m(i),virtualized:c})&&d.length&&!Te.p(i)&&o(Object(fe.selectComment)({renderContextType:e,trackback:s.e.reserveTag(595953680),telemetryVisitor:a},d[0].commentId,void 0,xa.a.ExpandCard,Ce.a.SharedComments))}}(Ee.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor)):n(Va({renderContextType:Ee.a.None,trackback:s.e.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)));break;case Nn.a.CommentContextReload:Ct.d(t)&&n(function(e,t,n,o){return function(r,i){var c,d,m=i(),u=!1,p=[];Object(Ct.c)(t)?(Object(l.i)().assertConditionTag(Object(ve.N)(Te.l(m),Te.u(m)),"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),p=gt(t.commentIds)):p=t.comments;var f=t.contextDetails;""===(null==f?void 0:f.selectedCommentId)&&(f=Object(a.a)(Object(a.a)({},f),{selectedCommentId:void 0}));var C=Object(Ct.c)(t)?[]:t.tasks;r(Pa(e,o,f,Object(Fa.a)({renderContextType:e,telemetryVisitor:o,trackback:s.e.reserveTag(595953677)},{comments:p,tasks:C}))),v.N()&&r(Object(Ra.a)({renderContextType:e,telemetryVisitor:o,trackback:s.e.reserveTag(595162892)},p,C,n)).catch(Object(j.a)(s.e.reserveTag(595645962)));var h=null===(c=Te.p(m))||void 0===c?void 0:c.selectedCardId,b=Te.d(m),g=i(),y=Te.d(g);if(h){if(!Te.p(g)){var T=b.findIndex((function(e){return e.commentId===h}));if(T<0)return;if(y.length){var I=T;I===y.length&&(I=y.length-1);var O=Object(Ke.b)(y[I]);r(Object(fe.selectComment)({renderContextType:e,telemetryVisitor:o,trackback:s.e.reserveTag(595953678)},O,void 0,xa.a.ExpandCard,Ce.a.SharedComments)),u=!0}}}else!b.length&&y.length&&(r(Object(fe.selectComment)({renderContextType:e,telemetryVisitor:o,trackback:s.e.reserveTag(595947722)},y[0].commentId,void 0,xa.a.ExpandCard,Ce.a.SharedComments)),u=!0);Object(l.i)().assertConditionTag(u||0===y.length||""!==(null===(d=t.contextDetails)||void 0===d?void 0:d.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}(Ee.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}var r,i;this.commonViewStrategy.processCommentEvent(e,t,n,o)},e.prototype.processCommentUIAction=function(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}(),Ha=function(){function e(){}return e.prototype.createViewStrategy=function(e,t,n,a,o,r,i,s){var c=new Sa(t,n,a,o,s);switch(e.containerType){case R.a.HalfPane:return new La(c,n,i,s);case R.a.FullPane:return new _a(c,n,r,s)}},e}();function Ba(e){if(void 0===e.hostCommentAPI)throw new M.a("'hostCommentAPI' was not supplied",s.e.reserveTag(589103634),-2130957511);if(void 0===e.peopleAPI)throw new M.a("'peopleAPI' was not supplied",s.e.reserveTag(589103635),-2130957511);if(void 0===e.viewContainerProvider)throw new M.a("'viewContainerProvider' was not supplied",s.e.reserveTag(589103636),-2130957511);var t=Object(x.f)(e.apiContext),n=Object(p.a)(),a=e.themeAPI||new me,o=e.hostCommentAPI;o=new ce(e.hostCommentAPI);var r=L.getTelemetryVisitor(e.apiContext),i=new nt(n.getLocaleInfo().isRightToLeft,r),c=new Ca(e.peopleAPI,e.correlationId||"");v.B()&&v.C()&&c.initializeController(!1);var d=kn(o,e.viewContainerProvider,zt(e.viewContainerProvider.getViewContainer(),e.paneVisible,n.getLocaleInfo(),e.apiContext),L.getTelemetryVisitor(e.apiContext),t,n,i,c);return new fa({apiContext:e.apiContext,viewProvider:e.viewContainerProvider,commentAPI:o,peopleAPI:e.peopleAPI,localizationAPI:n,themeAPI:a,focusManager:i,lppManager:c,initializationReason:e.initializationReason,commentStore:d,viewStrategyFactory:new Ha,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver})}function Ua(e,t,a,o,r,b,g,y,T){try{try{if(te())return void Object(l.i)().assertConditionTag(!1,"View manager singleton cannot be instantiated more than once!",595891844)}catch(e){if(!Object(M.b)(e))throw e}F=Ba,Object(d.b)({appSettings:g||{},mapping:X}),Object(l.k)($,t),Object(l.i)().assertConditionTag(!!g,"appSettings should not be undefined",595616278);var O=Object(p.b)(r);Object(m.c)(O.getLocaleInfo().isRightToLeft),function(e){var t=n(1407),a=n(1408),o=n(1409),r=n(1410),i=Object(m.a)()?n(1411):n(1412),s=n(1413),c=n(1414),d=n(1415),l=n(1416),u=n(1417),p=n(1418),f=n(1419),C=n(1105),h={HintBarEllipses_16:I.createElement(t,null),CancelGlyph:I.createElement(a,null),NewComment:I.createElement(i,null),CancelGlyph_TaskPane:I.createElement(s,null),Send2_Fluent:I.createElement(c,null),Delete_Fluent:I.createElement(d,null),Edit_Fluent:I.createElement(l,null),Checkmark_Fluent:I.createElement(u,null),CommentReopen_Fluent:I.createElement(p,null),Error:I.createElement(f,null),ReopenThread:I.createElement(C,null),CancelGlyph_deprecated:I.createElement(o,null),CancelGlyph_TaskPane_deprecated:I.createElement(r,null)};if(e||v.b()){var b=n(1420),g=n(1421),y=n(1422),T=n(1423),O=n(1105),S=n(1424),j=n(1425);h.TaskAssign=I.createElement(b,null),h.TaskComplete=I.createElement(g,null),h.TaskDelete=I.createElement(y,null),h.TaskEdit=I.createElement(T,null),h.TaskReopen=I.createElement(O,null),h.TaskStatusCircleCheckmark=I.createElement(S,null),h.ChevronDown12=I.createElement(j,null)}if(e||v.a()){var E=n(1426),D=n(1427);h.CommentLikeEmpty=I.createElement(E,null),h.CommentLikeSolid=I.createElement(D,null)}if(e||v.D()){var x=n(1428);h.LinkToComment=I.createElement(x,null)}Object(J.jb)({icons:h})}();var S=e,E=Object(c.c)(),D=(x=i.a,new q(x,o));L.ensureViewManager({apiContext:i.a,displayMode:h.c.FullPane,foldableLayoutState:h.a.Indeterminate,initializationReason:b||N.a.PaneOpen,correlationId:E,viewContainerProvider:D,peopleAPI:a,hostCommentAPI:S,paneVisible:!1,initializeImmediately:!1}),Object(f.b)(y),v.m()&&T&&C.a.setThemeAPI(T),K(),Object(u.f)().onExtensionFirstRequested.subscribe((function(e){e.contentType===u.b.CommentThread&&e.instanceId===u.c&&ne()}))}catch(e){throw Object(j.a)(s.e.reserveTag(594367139))(e),e}var x}Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,a=new Array(n);n--;)a[n]=[t[n],e[t[n]]];return a}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return-1!==this.indexOf(e,void 0===t?0:t)}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(Element.prototype.matches.call(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var qa=n(385),za=n(222),Wa=function(){function e(){}return e.prototype.getThemeMode=function(){return za.b.getInstance().getThemeMode()},e}(),Ga=n(983);function Ya(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Ua.apply(void 0,Object(a.k)(e,[Object(qa.a)(),new Wa]))}n.d(t,"instantiate",(function(){return Ya})),n.d(t,"initializeRuntime",(function(){return ne})),n.d(t,"setWebpackPublicPath",(function(){return o.a})),n.d(t,"ScreenReaderNotifierManagerFactoryGlobal",(function(){return z.a})),n.d(t,"RichContentEditAPIFactoryGlobal",(function(){return Ga.a}))},391:function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},565:function(e,t,n){var a=n(566),o=n(391),r=n(873),i=n(1376),s=n(1093),c=function(e,t,n){var d,l,m,u,p=e&c.F,f=e&c.G,C=e&c.S,h=e&c.P,v=e&c.B,b=f?a:C?a[t]||(a[t]={}):(a[t]||{}).prototype,g=f?o:o[t]||(o[t]={}),y=g.prototype||(g.prototype={});for(d in f&&(n=t),n)m=((l=!p&&b&&void 0!==b[d])?b:n)[d],u=v&&l?s(m,a):h&&"function"==typeof m?s(Function.call,m):m,b&&i(b,d,m,e&c.U),g[d]!=m&&r(g,d,u),h&&y[d]!=m&&(y[d]=m)};a.core=o,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},566:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},667:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},668:function(e,t,n){e.exports=!n(669)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},669:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},873:function(e,t,n){var a=n(1370),o=n(1375);e.exports=n(668)?function(e,t,n){return a.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},874:function(e,t){var n=0,a=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+a).toString(36))}},875:function(e,t,n){var a=n(391),o=n(566),r=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:a.version,mode:n(1378)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},876:function(e,t,n){var a=n(1096);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==a(e)?e.split(""):Object(e)}},877:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},878:function(e,t,n){var a=n(1099)("unscopables"),o=Array.prototype;null==o[a]&&n(873)(o,a,{}),e.exports=function(e){o[a][e]=!0}}},[[1754,2,0,1]]]);
//# sourceMappingURL=sharedComments.min.js.map